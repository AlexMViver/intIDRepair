SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,090470 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@35841320]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@35841320) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@1807e3f6
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,024821 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(footer="null", PatternSelector=null, disableAnsi="null", header="null", charset="null", alwaysWriteExceptions="null", Replace=null, pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", Configuration(HiveLog4j2Test), noConsoleNoAnsi="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(direct="null", target="SYSTEM_ERR", follow="null", bufferedIo="null", immediateFlush="null", bufferSize="null", Configuration(HiveLog4j2Test), PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ignoreExceptions="null", name="console", ={}, Filter=null)
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(Replace=null, Configuration(HiveLog4j2Test), disableAnsi="null", footer="null", charset="null", header="null", alwaysWriteExceptions="null", noConsoleNoAnsi="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null)
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(interval="1", maxRandomDelay="null", modulate="true")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(min="null", tempCompressedFilePattern="null", fileIndex="null", Configuration(HiveLog4j2Test), ={}, max="30", compressionLevel="null", stopCustomActionsOnError="null")
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(append="null", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), fileGroup="null", filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", advertise="null", fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", advertiseURI="null", filePermissions="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), fileOwner="null", bufferedIo="null", immediateFlush="null", bufferSize="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), Configuration(HiveLog4j2Test), ignoreExceptions="null", name="DRFA", Filter=null, ={})
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 143655905
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-24T01:12:39.946-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/25-00:00:00.000, nextFileTime=2024/04/24-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/24-01:12:44.092, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/25-00:00:00.000, nextFileTime=2024/04/24-00:00:00.000, prevFileTime=2024/04/24-00:00:00.000, current=2024/04/24-01:12:44.093, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@2118cddf...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@2118cddf OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@25e2ab5a
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@35841320
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@35841320) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@35841320] started OK.
2024-04-24T01:12:44,258  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-24T01:12:44,609  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-24T01:12:44,667  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T01:12:44,667  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T01:12:44,667  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T01:12:44,667  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T01:12:44,668  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T01:12:44,668  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T01:12:44,668  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T01:12:44,668  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T01:12:44,668  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T01:12:44,668  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T01:12:44,669  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T01:12:44,749  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T01:12:44,754  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-24T01:12:45,293  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T01:12:45,297  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
2024-04-24T01:12:45,298  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T01:12:45,302  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-24T01:12:45,306  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T01:12:45,307  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-24T01:12:45,470  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
2024-04-24T01:12:45,481  INFO [main] utils.TestTxnDbUtil: Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/ql/target/tmp/junit_metastore_db;create=true
Hive Session ID = 41e4ecaa-bbe2-4f55-98ea-283f3f886a1e
2024-04-24T01:12:46,397  INFO [main] SessionState: Hive Session ID = 41e4ecaa-bbe2-4f55-98ea-283f3f886a1e
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:12:46,409  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
log4j: Trying to find [log4j.xml] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@76889e60.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@76889e60.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
log4j:WARN No appenders could be found for logger (org.apache.htrace.core.Tracer).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-24T01:12:46,772  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e
2024-04-24T01:12:46,775  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e
2024-04-24T01:12:46,779  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/_tmp_space.db
2024-04-24T01:12:46,801  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=41e4ecaa-bbe2-4f55-98ea-283f3f886a1e, clientType=HIVECLI]
2024-04-24T01:12:46,839  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T01:12:46,981  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T01:12:47,013  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T01:12:47,016  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-24T01:12:47,016  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-24T01:12:47,019  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T01:12:47,023  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-24T01:12:47,025  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T01:12:47,026  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-24T01:12:47,443  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-24T01:12:47,443  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@66de00f2, with PersistenceManager: null will be shutdown
2024-04-24T01:12:47,473  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@66de00f2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5e99b9c created in the thread with id: 1
2024-04-24T01:12:50,131  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@66de00f2 from thread id: 1
2024-04-24T01:12:50,150  INFO [main] metastore.HMSHandler: Setting location of default catalog, as it hasn't been done after upgrade
2024-04-24T01:12:50,178  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-24T01:12:50,225  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-24T01:12:50,250  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-24T01:12:50,253  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-24T01:12:50,355  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-24T01:12:50,361  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-24T01:12:50,366  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-24T01:12:50,368  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-24T01:12:50,369  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-24T01:12:50,370  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-24T01:12:50,372  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-24T01:12:50,376  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T01:12:50,568  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T01:12:50,616  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:12:50,650  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011250_1ec31d94-f2e2-4f7c-82e5-a5b9e474b462): drop table if exists acidTbl
2024-04-24T01:12:51,764  INFO [main] reflections.Reflections: Reflections took 279 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T01:12:51,952  INFO [main] reflections.Reflections: Reflections took 141 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T01:12:52,099  INFO [main] reflections.Reflections: Reflections took 139 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T01:12:52,131  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T01:12:52,145  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T01:12:52,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:12:52,326  INFO [main] reflections.Reflections: Reflections took 143 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T01:12:52,370  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:52,372  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:52,375  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:52,375  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=35, getValidTxns_(long)=11, isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:52,376  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011250_1ec31d94-f2e2-4f7c-82e5-a5b9e474b462); Time taken: 1.727 seconds
2024-04-24T01:12:52,378  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424011250_1ec31d94-f2e2-4f7c-82e5-a5b9e474b462
2024-04-24T01:12:52,378  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:12:52,381  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011250_1ec31d94-f2e2-4f7c-82e5-a5b9e474b462): drop table if exists acidTbl
2024-04-24T01:12:52,384  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:52,386  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:12:52,403  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:52,404  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:52,404  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011250_1ec31d94-f2e2-4f7c-82e5-a5b9e474b462); Time taken: 0.022 seconds
2024-04-24T01:12:52,404  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011250_1ec31d94-f2e2-4f7c-82e5-a5b9e474b462
2024-04-24T01:12:52,416  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T01:12:52,433  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:52,436  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T01:12:52,438  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:12:52,439  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011252_3ccb1470-ad64-49d2-8d93-144287e1d193): drop table if exists acidTblPart
2024-04-24T01:12:52,445  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T01:12:52,446  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T01:12:52,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:12:52,454  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:52,464  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:52,464  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:52,465  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=32, isCompatibleWith_(Configuration)=2, getValidTxns_(long)=1, openTxn_(String, TxnType)=5}
2024-04-24T01:12:52,465  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011252_3ccb1470-ad64-49d2-8d93-144287e1d193); Time taken: 0.025 seconds
2024-04-24T01:12:52,466  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424011252_3ccb1470-ad64-49d2-8d93-144287e1d193
2024-04-24T01:12:52,466  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:12:52,466  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011252_3ccb1470-ad64-49d2-8d93-144287e1d193): drop table if exists acidTblPart
2024-04-24T01:12:52,466  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:52,467  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:12:52,472  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:52,472  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T01:12:52,473  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011252_3ccb1470-ad64-49d2-8d93-144287e1d193); Time taken: 0.006 seconds
2024-04-24T01:12:52,473  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011252_3ccb1470-ad64-49d2-8d93-144287e1d193
2024-04-24T01:12:52,483  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T01:12:52,494  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:52,495  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T01:12:52,497  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:12:52,498  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011252_14d2a200-4914-4984-9078-3071060c2515): drop table if exists acidTbl2
2024-04-24T01:12:52,504  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T01:12:52,505  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T01:12:52,507  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:12:52,515  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:52,515  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:52,515  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:52,515  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=24, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=6}
2024-04-24T01:12:52,516  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011252_14d2a200-4914-4984-9078-3071060c2515); Time taken: 0.017 seconds
2024-04-24T01:12:52,516  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424011252_14d2a200-4914-4984-9078-3071060c2515
2024-04-24T01:12:52,516  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:12:52,516  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011252_14d2a200-4914-4984-9078-3071060c2515): drop table if exists acidTbl2
2024-04-24T01:12:52,517  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:52,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:12:52,523  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:52,523  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:52,523  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011252_14d2a200-4914-4984-9078-3071060c2515); Time taken: 0.007 seconds
2024-04-24T01:12:52,524  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011252_14d2a200-4914-4984-9078-3071060c2515
2024-04-24T01:12:52,534  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T01:12:52,545  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:52,546  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T01:12:52,546  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:12:52,547  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011252_3ef59463-50d0-491a-8d59-c3c7041a0c52): drop table if exists nonAcidOrcTbl
2024-04-24T01:12:52,551  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T01:12:52,552  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T01:12:52,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:12:52,558  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:52,558  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:52,558  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:52,559  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=22, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=4}
2024-04-24T01:12:52,559  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011252_3ef59463-50d0-491a-8d59-c3c7041a0c52); Time taken: 0.011 seconds
2024-04-24T01:12:52,559  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424011252_3ef59463-50d0-491a-8d59-c3c7041a0c52
2024-04-24T01:12:52,559  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:12:52,559  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011252_3ef59463-50d0-491a-8d59-c3c7041a0c52): drop table if exists nonAcidOrcTbl
2024-04-24T01:12:52,559  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:52,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:12:52,565  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:52,566  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:52,566  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011252_3ef59463-50d0-491a-8d59-c3c7041a0c52); Time taken: 0.006 seconds
2024-04-24T01:12:52,566  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011252_3ef59463-50d0-491a-8d59-c3c7041a0c52
2024-04-24T01:12:52,577  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T01:12:52,589  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:52,589  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T01:12:52,590  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:12:52,591  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011252_f0302c7e-c2c2-45ee-a27a-01777f514e77): drop table if exists nonAcidOrcTbl2
2024-04-24T01:12:52,595  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T01:12:52,595  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T01:12:52,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:12:52,604  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:52,605  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:52,605  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:52,605  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=24}
2024-04-24T01:12:52,605  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011252_f0302c7e-c2c2-45ee-a27a-01777f514e77); Time taken: 0.014 seconds
2024-04-24T01:12:52,606  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424011252_f0302c7e-c2c2-45ee-a27a-01777f514e77
2024-04-24T01:12:52,606  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:12:52,606  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011252_f0302c7e-c2c2-45ee-a27a-01777f514e77): drop table if exists nonAcidOrcTbl2
2024-04-24T01:12:52,606  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:52,607  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:12:52,614  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:52,614  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:52,614  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011252_f0302c7e-c2c2-45ee-a27a-01777f514e77); Time taken: 0.008 seconds
2024-04-24T01:12:52,615  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011252_f0302c7e-c2c2-45ee-a27a-01777f514e77
2024-04-24T01:12:52,625  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T01:12:52,635  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:52,635  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T01:12:52,636  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:12:52,637  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011252_b2f55190-1e20-45db-a361-376d158f933f): drop table if exists nonAcidNonBucket
2024-04-24T01:12:52,643  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T01:12:52,644  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T01:12:52,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:12:52,651  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:52,652  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:52,652  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:52,652  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=21}
2024-04-24T01:12:52,652  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011252_b2f55190-1e20-45db-a361-376d158f933f); Time taken: 0.015 seconds
2024-04-24T01:12:52,652  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424011252_b2f55190-1e20-45db-a361-376d158f933f
2024-04-24T01:12:52,652  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:12:52,653  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011252_b2f55190-1e20-45db-a361-376d158f933f): drop table if exists nonAcidNonBucket
2024-04-24T01:12:52,653  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:52,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:12:52,658  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:52,659  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:52,659  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011252_b2f55190-1e20-45db-a361-376d158f933f); Time taken: 0.006 seconds
2024-04-24T01:12:52,659  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011252_b2f55190-1e20-45db-a361-376d158f933f
2024-04-24T01:12:52,672  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T01:12:52,681  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:52,681  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T01:12:52,682  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:52,683  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011252_36f9381a-5ba3-42d2-ad1f-8d5953fa3f09): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:52,761  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T01:12:52,762  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T01:12:52,763  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:52,765  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:52,782  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T01:12:52,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:12:52,841  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:52,841  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:52,842  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:52,842  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:52,842  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=5, openTxn_(String, TxnType)=5, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=22, getValidWriteIds_(List, String)=11}
2024-04-24T01:12:52,842  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011252_36f9381a-5ba3-42d2-ad1f-8d5953fa3f09); Time taken: 0.159 seconds
2024-04-24T01:12:52,842  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424011252_36f9381a-5ba3-42d2-ad1f-8d5953fa3f09
2024-04-24T01:12:52,850  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011252_36f9381a-5ba3-42d2-ad1f-8d5953fa3f09
2024-04-24T01:12:52,900  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011252_36f9381a-5ba3-42d2-ad1f-8d5953fa3f09 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T01:12:52,900  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:12:52,904  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011252_36f9381a-5ba3-42d2-ad1f-8d5953fa3f09): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:52,904  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:53,047  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713946372, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, totalSize=0, numFilesErasureCoded=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, transactional=true, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:12:53,074  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtbl
2024-04-24T01:12:53,268  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:53,269  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=222, isCompatibleWith_(Configuration)=1}
2024-04-24T01:12:53,269  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011252_36f9381a-5ba3-42d2-ad1f-8d5953fa3f09); Time taken: 0.364 seconds
2024-04-24T01:12:53,269  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011252_36f9381a-5ba3-42d2-ad1f-8d5953fa3f09
2024-04-24T01:12:53,275  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T01:12:53,285  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:53,285  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T01:12:53,286  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:53,287  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011253_033704ed-0711-4546-8a81-b50ac4bfd5ce): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:53,292  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 2
2024-04-24T01:12:53,293  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T01:12:53,294  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:53,294  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:53,298  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T01:12:53,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:12:53,302  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:53,302  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:53,302  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:53,302  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:53,302  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=17, getValidWriteIds_(List, String)=3, getDatabase_(String)=4, isCompatibleWith_(Configuration)=2}
2024-04-24T01:12:53,303  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011253_033704ed-0711-4546-8a81-b50ac4bfd5ce); Time taken: 0.015 seconds
2024-04-24T01:12:53,303  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424011253_033704ed-0711-4546-8a81-b50ac4bfd5ce
2024-04-24T01:12:53,304  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011253_033704ed-0711-4546-8a81-b50ac4bfd5ce
2024-04-24T01:12:53,331  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011253_033704ed-0711-4546-8a81-b50ac4bfd5ce LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T01:12:53,331  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:12:53,332  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011253_033704ed-0711-4546-8a81-b50ac4bfd5ce): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:53,333  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:53,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713946373, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:12:53,345  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtblpart
2024-04-24T01:12:53,385  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:53,385  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=50}
2024-04-24T01:12:53,385  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011253_033704ed-0711-4546-8a81-b50ac4bfd5ce); Time taken: 0.052 seconds
2024-04-24T01:12:53,385  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011253_033704ed-0711-4546-8a81-b50ac4bfd5ce
2024-04-24T01:12:53,392  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T01:12:53,405  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:53,408  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T01:12:53,409  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,410  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011253_2aab274d-31d8-4972-8955-dd7e4a9790a3): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,416  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 2
2024-04-24T01:12:53,417  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T01:12:53,419  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:53,419  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:53,424  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T01:12:53,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:12:53,429  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:53,430  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:53,430  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:53,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:53,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=5, flushCache_()=0, getDatabase_(String)=4, commitTxn_(CommitTxnRequest)=23}
2024-04-24T01:12:53,431  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011253_2aab274d-31d8-4972-8955-dd7e4a9790a3); Time taken: 0.02 seconds
2024-04-24T01:12:53,431  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424011253_2aab274d-31d8-4972-8955-dd7e4a9790a3
2024-04-24T01:12:53,432  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011253_2aab274d-31d8-4972-8955-dd7e4a9790a3
2024-04-24T01:12:53,477  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011253_2aab274d-31d8-4972-8955-dd7e4a9790a3 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T01:12:53,477  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:12:53,477  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011253_2aab274d-31d8-4972-8955-dd7e4a9790a3): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,477  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:53,479  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713946373, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, transactional=false, rawDataSize=0, bucketing_version=2, numFilesErasureCoded=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:12:53,492  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl
2024-04-24T01:12:53,543  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:53,543  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=63}
2024-04-24T01:12:53,543  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011253_2aab274d-31d8-4972-8955-dd7e4a9790a3); Time taken: 0.065 seconds
2024-04-24T01:12:53,543  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011253_2aab274d-31d8-4972-8955-dd7e4a9790a3
2024-04-24T01:12:53,551  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T01:12:53,562  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:53,563  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T01:12:53,564  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,565  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011253_b1ef6c18-746f-4e09-8bda-9d54ad5714b0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,571  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 5
2024-04-24T01:12:53,571  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T01:12:53,573  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:53,573  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:53,578  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T01:12:53,578  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:12:53,582  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:53,582  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:53,582  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:53,582  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:53,582  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=20, getDatabase_(String)=4, flushCache_()=0, getValidTxns_(long)=1}
2024-04-24T01:12:53,583  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011253_b1ef6c18-746f-4e09-8bda-9d54ad5714b0); Time taken: 0.018 seconds
2024-04-24T01:12:53,583  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424011253_b1ef6c18-746f-4e09-8bda-9d54ad5714b0
2024-04-24T01:12:53,584  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011253_b1ef6c18-746f-4e09-8bda-9d54ad5714b0
2024-04-24T01:12:53,617  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011253_b1ef6c18-746f-4e09-8bda-9d54ad5714b0 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T01:12:53,617  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:12:53,617  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011253_b1ef6c18-746f-4e09-8bda-9d54ad5714b0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,617  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:53,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713946373, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, numFilesErasureCoded=0, transactional=false, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:12:53,627  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl2
2024-04-24T01:12:53,656  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:53,656  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=37, isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:53,657  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011253_b1ef6c18-746f-4e09-8bda-9d54ad5714b0); Time taken: 0.039 seconds
2024-04-24T01:12:53,657  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011253_b1ef6c18-746f-4e09-8bda-9d54ad5714b0
2024-04-24T01:12:53,664  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T01:12:53,675  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:53,675  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T01:12:53,676  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:53,677  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011253_0b9292f6-6331-4fd8-8553-1cbe02b0cfe5): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:53,683  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 7
2024-04-24T01:12:53,684  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T01:12:53,685  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:53,686  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:53,690  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T01:12:53,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:12:53,693  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:53,694  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:53,694  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:53,694  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:53,694  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=19, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=4, getValidWriteIds_(List, String)=4}
2024-04-24T01:12:53,694  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011253_0b9292f6-6331-4fd8-8553-1cbe02b0cfe5); Time taken: 0.017 seconds
2024-04-24T01:12:53,694  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424011253_0b9292f6-6331-4fd8-8553-1cbe02b0cfe5
2024-04-24T01:12:53,695  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011253_0b9292f6-6331-4fd8-8553-1cbe02b0cfe5
2024-04-24T01:12:53,719  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011253_0b9292f6-6331-4fd8-8553-1cbe02b0cfe5 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T01:12:53,719  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:12:53,720  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011253_0b9292f6-6331-4fd8-8553-1cbe02b0cfe5): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:12:53,721  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:53,723  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/_tmp_space.db/4e0a0950-8b3b-4f7c-8ba1-e435b0a8fc5a
2024-04-24T01:12:53,727  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:53,727  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=5, isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:53,727  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011253_0b9292f6-6331-4fd8-8553-1cbe02b0cfe5); Time taken: 0.007 seconds
2024-04-24T01:12:53,727  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011253_0b9292f6-6331-4fd8-8553-1cbe02b0cfe5
2024-04-24T01:12:53,733  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T01:12:53,742  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:53,742  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T01:12:53,743  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,744  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011253_5a621311-56b6-4fa9-97b6-4f234fb6fb8e): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,748  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 7
2024-04-24T01:12:53,748  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T01:12:53,749  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:53,750  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:53,753  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T01:12:53,753  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:12:53,757  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:53,757  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:53,757  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:53,757  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:53,757  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getDatabase_(String)=4, commitTxn_(CommitTxnRequest)=15, flushCache_()=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3}
2024-04-24T01:12:53,758  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011253_5a621311-56b6-4fa9-97b6-4f234fb6fb8e); Time taken: 0.013 seconds
2024-04-24T01:12:53,758  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424011253_5a621311-56b6-4fa9-97b6-4f234fb6fb8e
2024-04-24T01:12:53,758  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011253_5a621311-56b6-4fa9-97b6-4f234fb6fb8e
2024-04-24T01:12:53,784  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011253_5a621311-56b6-4fa9-97b6-4f234fb6fb8e LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T01:12:53,784  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:12:53,784  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011253_5a621311-56b6-4fa9-97b6-4f234fb6fb8e): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:12:53,784  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:53,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713946373, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, totalSize=0, numFiles=0, bucketing_version=2, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:12:53,795  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidnonbucket
2024-04-24T01:12:53,823  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:53,823  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=36}
2024-04-24T01:12:53,823  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011253_5a621311-56b6-4fa9-97b6-4f234fb6fb8e); Time taken: 0.038 seconds
2024-04-24T01:12:53,823  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011253_5a621311-56b6-4fa9-97b6-4f234fb6fb8e
2024-04-24T01:12:53,828  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T01:12:53,837  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:53,837  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T01:12:53,838  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Initializing local cache in HiveMetaStoreClient...
2024-04-24T01:12:53,866  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Local cache initialized in HiveMetaStoreClient: com.github.benmanes.caffeine.cache.BoundedLocalCache$BoundedLocalManualCache@70697478
2024-04-24T01:12:53,866  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T01:12:53,867  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011253_16dcc85f-e787-45b9-a8b2-8d189c54e5c1): drop table if exists T
2024-04-24T01:12:53,871  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 8
2024-04-24T01:12:53,871  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T01:12:53,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:12:53,877  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:53,877  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:53,877  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:53,877  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, getValidTxns_(long)=0}
2024-04-24T01:12:53,877  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011253_16dcc85f-e787-45b9-a8b2-8d189c54e5c1); Time taken: 0.01 seconds
2024-04-24T01:12:53,877  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424011253_16dcc85f-e787-45b9-a8b2-8d189c54e5c1
2024-04-24T01:12:53,877  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:12:53,878  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011253_16dcc85f-e787-45b9-a8b2-8d189c54e5c1): drop table if exists T
2024-04-24T01:12:53,878  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:53,878  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:12:53,883  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:53,883  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:53,884  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011253_16dcc85f-e787-45b9-a8b2-8d189c54e5c1); Time taken: 0.005 seconds
2024-04-24T01:12:53,884  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011253_16dcc85f-e787-45b9-a8b2-8d189c54e5c1
2024-04-24T01:12:53,891  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T01:12:53,900  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:53,900  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T01:12:53,901  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T01:12:53,902  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011253_7f3110c7-2cff-4514-9fc1-28eba4e16b35): drop table if exists Tstage
2024-04-24T01:12:53,906  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 8
2024-04-24T01:12:53,906  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T01:12:53,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:53,915  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:53,915  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:53,915  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:53,915  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=17, openTxn_(String, TxnType)=3, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=1}
2024-04-24T01:12:53,915  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011253_7f3110c7-2cff-4514-9fc1-28eba4e16b35); Time taken: 0.013 seconds
2024-04-24T01:12:53,916  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424011253_7f3110c7-2cff-4514-9fc1-28eba4e16b35
2024-04-24T01:12:53,916  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:12:53,916  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011253_7f3110c7-2cff-4514-9fc1-28eba4e16b35): drop table if exists Tstage
2024-04-24T01:12:53,916  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:53,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:53,925  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:53,925  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:53,925  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011253_7f3110c7-2cff-4514-9fc1-28eba4e16b35); Time taken: 0.009 seconds
2024-04-24T01:12:53,925  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011253_7f3110c7-2cff-4514-9fc1-28eba4e16b35
2024-04-24T01:12:53,935  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T01:12:53,947  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:53,947  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T01:12:53,948  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T01:12:53,949  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011253_a93f2d85-3055-4d1b-bed6-d50d7230cdfb): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T01:12:53,954  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 8
2024-04-24T01:12:53,955  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T01:12:53,957  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:53,957  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:53,962  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T01:12:53,962  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:12:53,966  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:53,966  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:53,966  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:53,966  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:53,967  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=22, getDatabase_(String)=4, openTxn_(String, TxnType)=4, flushCache_()=0}
2024-04-24T01:12:53,967  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011253_a93f2d85-3055-4d1b-bed6-d50d7230cdfb); Time taken: 0.017 seconds
2024-04-24T01:12:53,968  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424011253_a93f2d85-3055-4d1b-bed6-d50d7230cdfb
2024-04-24T01:12:53,968  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011253_a93f2d85-3055-4d1b-bed6-d50d7230cdfb
2024-04-24T01:12:54,003  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011253_a93f2d85-3055-4d1b-bed6-d50d7230cdfb LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T01:12:54,003  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:12:54,005  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011253_a93f2d85-3055-4d1b-bed6-d50d7230cdfb): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T01:12:54,005  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:54,007  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713946374, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional_properties=insert_only, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:12:54,019  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:12:54,064  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:54,064  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=57}
2024-04-24T01:12:54,064  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011253_a93f2d85-3055-4d1b-bed6-d50d7230cdfb); Time taken: 0.059 seconds
2024-04-24T01:12:54,065  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011253_a93f2d85-3055-4d1b-bed6-d50d7230cdfb
2024-04-24T01:12:54,073  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T01:12:54,083  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:54,083  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T01:12:54,085  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:12:54,086  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011254_dbc84c82-aaef-4f3f-9a4e-54e8b15a2443): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:12:54,095  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-24T01:12:54,096  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T01:12:54,098  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:54,098  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:54,103  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T01:12:54,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:12:54,106  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:54,107  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:54,107  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:54,107  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:54,107  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=19, openTxn_(String, TxnType)=7, getValidWriteIds_(List, String)=4, getValidTxns_(long)=2, flushCache_()=2, getDatabase_(String)=3}
2024-04-24T01:12:54,107  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011254_dbc84c82-aaef-4f3f-9a4e-54e8b15a2443); Time taken: 0.021 seconds
2024-04-24T01:12:54,108  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424011254_dbc84c82-aaef-4f3f-9a4e-54e8b15a2443
2024-04-24T01:12:54,108  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011254_dbc84c82-aaef-4f3f-9a4e-54e8b15a2443
2024-04-24T01:12:54,140  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011254_dbc84c82-aaef-4f3f-9a4e-54e8b15a2443 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T01:12:54,141  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:12:54,141  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011254_dbc84c82-aaef-4f3f-9a4e-54e8b15a2443): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:12:54,141  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:12:54,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713946374, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numRows=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:12:54,156  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:12:54,195  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:54,196  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=52, isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:54,196  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011254_dbc84c82-aaef-4f3f-9a4e-54e8b15a2443); Time taken: 0.054 seconds
2024-04-24T01:12:54,196  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011254_dbc84c82-aaef-4f3f-9a4e-54e8b15a2443
2024-04-24T01:12:54,205  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T01:12:54,215  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:54,215  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T01:12:54,216  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-24T01:12:54,217  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa): insert into Tstage values(0,2),(0,4)
2024-04-24T01:12:54,224  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-24T01:12:54,225  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T01:12:54,226  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:12:54,226  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:12:54,836  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T01:12:54,842  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T01:12:54,843  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T01:12:54,849  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T01:12:54,849  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T01:12:54,849  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T01:12:54,851  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T01:12:54,902  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:54,978  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:54,979  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:12:54,979  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:12:54,979  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:12:54,979  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:12:54,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:55,007  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:55,008  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:12:55,008  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T01:12:56,414  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:12:57,243  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:12:57,244  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:12:57,244  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:12:57,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:12:57,249  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:12:57,249  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:12:57,251  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:12:57,251  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:57,277  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:57,330  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1
2024-04-24T01:12:57,335  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T01:12:57,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T01:12:57,347  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:12:57,412  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:12:57,424  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:12:57,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:12:57,485  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:57,493  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T01:12:57,497  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:12:57,521  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:57,552  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:12:57,559  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T01:12:57,559  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:12:57,559  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:12:57,559  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:12:57,559  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T01:12:57,559  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T01:12:57,562  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:12:57,562  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:12:57,562  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:57,562  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T01:12:57,562  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:57,562  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=7, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=4, getTable_(GetTableRequest)=176, getAllTableConstraints_(AllTableConstraintsRequest)=73, getValidTxns_(long)=1, getNotNullConstraints_(NotNullConstraintsRequest)=3, commitTxn_(CommitTxnRequest)=20, flushCache_()=0, getCheckConstraints_(CheckConstraintsRequest)=3}
2024-04-24T01:12:57,562  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa); Time taken: 3.345 seconds
2024-04-24T01:12:57,563  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa
2024-04-24T01:12:57,563  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa
2024-04-24T01:12:57,588  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T01:12:57,588  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:12:57,588  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa): insert into Tstage values(0,2),(0,4)
2024-04-24T01:12:57,589  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa
2024-04-24T01:12:57,589  INFO [main] ql.Driver: Query ID = alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa
Total jobs = 1
2024-04-24T01:12:57,590  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:12:57,590  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:12:57,772  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T01:12:57,772  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T01:12:57,780  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:12:57,782  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T01:12:57,782  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-12-54_217_260865942917731829-1/dummy_path
2024-04-24T01:12:57,850  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:12:57,890  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,08KB
2024-04-24T01:12:58,033  INFO [main] beanutils.FluentPropertyBeanIntrospector: Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2024-04-24T01:12:58,053  WARN [main] impl.MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-jobtracker.properties,hadoop-metrics2.properties
2024-04-24T01:12:58,075  INFO [main] impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-04-24T01:12:58,075  INFO [main] impl.MetricsSystemImpl: JobTracker metrics system started
2024-04-24T01:12:58,090  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-12-54_217_260865942917731829-1/-mr-10001
2024-04-24T01:12:58,110  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:12:58,162  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:12:58,171  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:12:58,178  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T01:12:58,178  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T01:12:58,178  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-12-54_217_260865942917731829-1/dummy_path
2024-04-24T01:12:58,178  INFO [main] io.NullRowsInputFormat$NullRowsRecordReader: Using null rows input format
2024-04-24T01:12:58,184  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:12:58,217  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:12:58,311  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local694859577_0001
2024-04-24T01:12:58,312  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:12:58,489  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:12:58,490  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:12:58,493  INFO [Thread-78] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:12:58,495  INFO [Thread-78] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:12:58,509  INFO [Thread-78] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:12:58,513  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local694859577_0001_m_000000_0
2024-04-24T01:12:58,547  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:12:58,555  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-12-54_217_260865942917731829-1/dummy_path/null:0+1
2024-04-24T01:12:58,562  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:12:58,589  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-24T01:12:58,597  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T01:12:58,606  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:12:58,608  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:12:58,610  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:12:58,610  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:12:58,613  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T01:12:58,614  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T01:12:58,614  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:12:58,614  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T01:12:58,615  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:12:58,616  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local694859577_0001/job_local694859577_0001.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@197bd808
2024-04-24T01:12:58,621  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/_tmp.-ext-10002/000000_0
2024-04-24T01:12:58,621  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:12:58,621  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/_tmp.-ext-10002/000000_0
2024-04-24T01:12:58,642  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:12:58,660  INFO [LocalJobRunner Map Task Executor #0] impl.HadoopShimsPre2_7: Can't get KeyProvider for ORC encryption from hadoop.security.key.provider.path.
2024-04-24T01:12:58,666  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T01:12:58,735  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T01:12:58,741  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:12:58,742  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:12:58,742  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T01:12:58,742  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, 
2024-04-24T01:12:58,742  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:12:58,742  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T01:12:58,742  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:12:58,742  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T01:12:58,742  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T01:12:58,743  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:12:58,743  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:12:58,743  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T01:12:58,743  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:12:58,743  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T01:12:58,786  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-24T01:12:58,789  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:12:58,796  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local694859577_0001_m_000000_0 is done. And is in the process of committing
2024-04-24T01:12:58,797  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:12:58,797  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local694859577_0001_m_000000_0' done.
2024-04-24T01:12:58,799  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local694859577_0001_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=6546
		FILE: Number of bytes written=1178215
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=360
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=933756928
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6142
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:12:58,799  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local694859577_0001_m_000000_0
2024-04-24T01:12:58,800  INFO [Thread-78] mapred.LocalJobRunner: map task executor complete.
2024-04-24 01:12:59,507 Stage-1 map = 100%,  reduce = 0%
2024-04-24T01:12:59,507  INFO [main] exec.Task: 2024-04-24 01:12:59,507 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local694859577_0001
2024-04-24T01:12:59,511  INFO [main] exec.Task: Ended Job = job_local694859577_0001
2024-04-24T01:12:59,559  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T01:12:59,561  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T01:12:59,561  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T01:12:59,561  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T01:12:59,561  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/-ext-10000
2024-04-24T01:12:59,563  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/-ext-10002
2024-04-24T01:12:59,570  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T01:12:59,570  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1/-ext-10000
2024-04-24T01:12:59,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:12:59,590  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:59,590  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:12:59,604  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:59,610  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:12:59,611  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:12:59,670  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T01:12:59,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:12:59,687  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:59,687  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T01:12:59,687  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-12-54_217_260865942917731829-1/-mr-10001
2024-04-24T01:12:59,690  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:12:59,708  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:59,711  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T01:12:59,711  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T01:12:59,712  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:12:59,713  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:12:59,779  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T01:12:59,780  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:59,780  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=68, alter_table_(String, String, String, Table, EnvironmentContext, String)=123}
MapReduce Jobs Launched: 
2024-04-24T01:12:59,781  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:12:59,788  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:12:59,788  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:12:59,788  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa); Time taken: 2.192 seconds
2024-04-24T01:12:59,788  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011254_c7d070b6-c570-4aa3-a6b0-13abc9656cfa
2024-04-24T01:12:59,795  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T01:12:59,804  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:59,805  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T01:12:59,805  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:12:59,806  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-12-54_217_260865942917731829-1
2024-04-24T01:12:59,806  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-12-54_217_260865942917731829-1 on fs with scheme file
2024-04-24T01:12:59,807  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1
2024-04-24T01:12:59,807  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-12-54_217_260865942917731829-1 on fs with scheme file
2024-04-24T01:12:59,807  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011259_e92622bc-9541-4763-bcd2-7b241b4aa8bf): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:12:59,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:59,823  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:59,827  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T01:12:59,827  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T01:12:59,836  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:59,853  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:59,856  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:12:59,856  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:12:59,857  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:12:59,857  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:12:59,861  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:59,861  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:59,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:59,861  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=16, getCurrentNotificationEventId_()=5, flushCache_()=0, getTable_(GetTableRequest)=31}
2024-04-24T01:12:59,861  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011259_e92622bc-9541-4763-bcd2-7b241b4aa8bf); Time taken: 0.054 seconds
2024-04-24T01:12:59,861  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424011259_e92622bc-9541-4763-bcd2-7b241b4aa8bf
2024-04-24T01:12:59,862  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011259_e92622bc-9541-4763-bcd2-7b241b4aa8bf
2024-04-24T01:12:59,888  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011259_e92622bc-9541-4763-bcd2-7b241b4aa8bf LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T01:12:59,888  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:12:59,888  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011259_e92622bc-9541-4763-bcd2-7b241b4aa8bf): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:12:59,889  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:12:59,889  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:12:59,889  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:12:59,889  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:12:59,889  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:12:59,931  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:12:59,937  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:12:59,937  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:12:59,938  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011259_e92622bc-9541-4763-bcd2-7b241b4aa8bf); Time taken: 0.049 seconds
2024-04-24T01:12:59,938  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011259_e92622bc-9541-4763-bcd2-7b241b4aa8bf
2024-04-24T01:12:59,944  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T01:12:59,951  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T01:12:59,951  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T01:12:59,952  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:12:59,952  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011259_74a4af03-edb2-43b5-ace0-e969255f2d4a): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:12:59,953  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:59,970  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:59,973  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T01:12:59,973  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T01:12:59,976  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:12:59,997  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:12:59,998  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:12:59,998  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:12:59,998  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:12:59,998  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:12:59,998  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:12:59,998  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:12:59,998  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:12:59,999  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=38, commitTxn_(CommitTxnRequest)=14, getCurrentNotificationEventId_()=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T01:12:59,999  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011259_74a4af03-edb2-43b5-ace0-e969255f2d4a); Time taken: 0.046 seconds
2024-04-24T01:12:59,999  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424011259_74a4af03-edb2-43b5-ace0-e969255f2d4a
2024-04-24T01:13:00,000  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011259_74a4af03-edb2-43b5-ace0-e969255f2d4a
2024-04-24T01:13:00,025  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011259_74a4af03-edb2-43b5-ace0-e969255f2d4a LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T01:13:00,025  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:00,025  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011259_74a4af03-edb2-43b5-ace0-e969255f2d4a): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:00,026  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:00,026  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:00,026  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:00,026  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:00,026  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:00,040  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:00,047  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:00,047  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:00,048  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011259_74a4af03-edb2-43b5-ace0-e969255f2d4a); Time taken: 0.022 seconds
2024-04-24T01:13:00,048  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011259_74a4af03-edb2-43b5-ace0-e969255f2d4a
2024-04-24T01:13:00,053  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T01:13:00,063  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:00,064  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T01:13:00,065  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:00,065  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011300_0de5961e-23ef-4b06-a156-20663065aded): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:00,072  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T01:13:00,073  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T01:13:00,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:00,090  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:00,122  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T01:13:00,122  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-24T01:13:00,126  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:00,126  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:00,126  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:00,126  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=16, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=2, getTable_(GetTableRequest)=15, allocateTableWriteId_(long, String, String)=12}
2024-04-24T01:13:00,127  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011300_0de5961e-23ef-4b06-a156-20663065aded); Time taken: 0.061 seconds
2024-04-24T01:13:00,127  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424011300_0de5961e-23ef-4b06-a156-20663065aded
2024-04-24T01:13:00,127  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011300_0de5961e-23ef-4b06-a156-20663065aded
2024-04-24T01:13:00,148  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011300_0de5961e-23ef-4b06-a156-20663065aded LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T01:13:00,148  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:00,153  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011300_0de5961e-23ef-4b06-a156-20663065aded): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:00,153  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:00,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:00,169  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:00,173  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:00,222  INFO [HMSHandler #0] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:00,222  INFO [HMSHandler #2] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2
2024-04-24T01:13:00,223  INFO [HMSHandler #1] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1
2024-04-24T01:13:00,308  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T01:13:00,308  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data
2024-04-24T01:13:00,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:00,329  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:00,333  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:00,375  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T01:13:00,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:00,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:00,397  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:00,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:00,418  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T01:13:00,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:00,425  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T01:13:00,514  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:00,573  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:00,596  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-24T01:13:00,596  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data
2024-04-24T01:13:00,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:00,616  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:00,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:00,640  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T01:13:00,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:00,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:00,661  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:00,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:00,685  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-24T01:13:00,692  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:00,692  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T01:13:00,764  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:00,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:00,823  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:00,823  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=153, validatePartitionNameCharacters_(List)=1, add_partitions_(List, boolean, boolean)=136, getValidWriteIds_(List, String)=0, isCompatibleWith_(Configuration)=1, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=253, getTable_(GetTableRequest)=100}
2024-04-24T01:13:00,824  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011300_0de5961e-23ef-4b06-a156-20663065aded); Time taken: 0.67 seconds
2024-04-24T01:13:00,824  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011300_0de5961e-23ef-4b06-a156-20663065aded
2024-04-24T01:13:00,831  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T01:13:00,842  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:00,843  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T01:13:00,844  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b from T order by p, a, b
2024-04-24T01:13:00,844  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22): select p, a, b from T order by p, a, b
2024-04-24T01:13:00,852  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 19
2024-04-24T01:13:00,852  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T01:13:00,854  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:00,854  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:00,866  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:00,866  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:00,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:00,885  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:00,886  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:00,886  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:00,886  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:00,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:01,110  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:01,111  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:01,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:01,231  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:01,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:01,276  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T01:13:01,276  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T01:13:01,341  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:01,342  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:01,342  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:01,349  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-00_844_9120780706425942383-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-00_844_9120780706425942383-1
2024-04-24T01:13:01,385  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:01,393  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T01:13:01,394  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T01:13:01,395  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:01,404  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:01,417  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:01,418  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:01,418  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:01,438  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:01,438  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T01:13:01,438  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:01,438  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:01,438  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:01,439  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:01,439  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:01,439  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:01,439  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:01,439  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:01,439  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:01,439  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:01,439  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:01,439  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T01:13:01,444  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-24T01:13:01,445  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:01,445  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, getTable_(GetTableRequest)=19, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=46, flushCache_()=1, getValidWriteIds_(List, String)=10, listPartitions_(String, String, short)=57, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=19, getAggrColStatsFor_(String, String, List, List, String, String)=62}
2024-04-24T01:13:01,445  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22); Time taken: 0.601 seconds
2024-04-24T01:13:01,446  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22
2024-04-24T01:13:01,447  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22
2024-04-24T01:13:01,474  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T01:13:01,474  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:01,475  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22): select p, a, b from T order by p, a, b
2024-04-24T01:13:01,475  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22
2024-04-24T01:13:01,475  INFO [main] ql.Driver: Query ID = alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22
Total jobs = 1
2024-04-24T01:13:01,475  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:01,476  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:01,646  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:01,646  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:01,646  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:01,646  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:01,646  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:01,646  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:01,646  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:01,647  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:01,650  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:01,651  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:01,651  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:01,661  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-00_844_9120780706425942383-1/-mr-10004/37f592ba-5db5-493f-8d47-609c091ebe4b (false)
2024-04-24T01:13:01,671  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:01,687  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,99KB
2024-04-24T01:13:01,695  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:01,699  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,15KB
2024-04-24T01:13:01,700  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:01,707  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:01,716  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:01,720  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:01,723  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:01,723  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:01,723  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:01,740  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:01,746  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: insert_only 
2024-04-24T01:13:01,746  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:01,770  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T01:13:01,770  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 30 ms
2024-04-24T01:13:01,770  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T01:13:01,790  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T01:13:01,814  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1746982798_0002
2024-04-24T01:13:01,814  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:01,892  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:01,892  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:01,892  INFO [Thread-156] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:01,892  INFO [Thread-156] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:01,895  INFO [Thread-156] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:01,895  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1746982798_0002_m_000000_0
2024-04-24T01:13:01,896  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:01,897  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:01,898  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:01,906  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,99KB
2024-04-24T01:13:01,910  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:01,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:01,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:01,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:01,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:01,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:01,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:01,940  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:01,941  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:01,945  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:01,947  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:01,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:01,949  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:01,949  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:01,961  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:01,962  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:01,962  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:01,962  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T01:13:01,962  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:01,962  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:01,962  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:01,962  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:01,962  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:01,963  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:01,963  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:01,964  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:01,964  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:01,964  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:01,964  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T01:13:01,964  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:01,979  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:01,985  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1746982798_0002_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:01,986  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:01,986  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1746982798_0002_m_000000_0' done.
2024-04-24T01:13:01,986  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1746982798_0002_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=18655
		FILE: Number of bytes written=2372923
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=935854080
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8134
2024-04-24T01:13:01,987  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1746982798_0002_m_000000_0
2024-04-24T01:13:01,987  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1746982798_0002_m_000001_0
2024-04-24T01:13:01,988  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:01,988  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:01,989  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:01,991  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,99KB
2024-04-24T01:13:01,993  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:01,995  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:01,999  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:01,999  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:02,000  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:02,000  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:02,000  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:02,000  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:02,001  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:02,001  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:02,002  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:02,002  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:02,002  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:02,002  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:02,003  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:02,003  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:02,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T01:13:02,005  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:02,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:02,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:02,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T01:13:02,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:02,014  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:02,017  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1746982798_0002_m_000001_0 is done. And is in the process of committing
2024-04-24T01:13:02,018  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:02,018  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1746982798_0002_m_000001_0' done.
2024-04-24T01:13:02,018  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1746982798_0002_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=27344
		FILE: Number of bytes written=2373013
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=935854080
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8134
2024-04-24T01:13:02,019  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1746982798_0002_m_000001_0
2024-04-24T01:13:02,019  INFO [Thread-156] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:02,022  INFO [Thread-156] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:02,022  INFO [pool-16-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1746982798_0002_r_000000_0
2024-04-24T01:13:02,026  INFO [pool-16-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:02,029  INFO [pool-16-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@724343cf
2024-04-24T01:13:02,030  WARN [pool-16-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:02,045  INFO [pool-16-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:02,049  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1746982798_0002_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:02,073  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local1746982798_0002_m_000000_0 decomp: 54 len: 58 to MEMORY
2024-04-24T01:13:02,075  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1746982798_0002_m_000000_0
2024-04-24T01:13:02,078  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->54
2024-04-24T01:13:02,082  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local1746982798_0002_m_000001_0 decomp: 54 len: 58 to MEMORY
2024-04-24T01:13:02,082  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1746982798_0002_m_000001_0
2024-04-24T01:13:02,082  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 2, commitMemory -> 54, usedMemory ->108
2024-04-24T01:13:02,083  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:02,083  INFO [pool-16-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T01:13:02,084  INFO [pool-16-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:02,096  INFO [pool-16-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T01:13:02,096  INFO [pool-16-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 64 bytes
2024-04-24T01:13:02,099  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 108 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:02,099  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merging 1 files, 110 bytes from disk
2024-04-24T01:13:02,100  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:02,100  INFO [pool-16-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:02,100  INFO [pool-16-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 84 bytes
2024-04-24T01:13:02,101  INFO [pool-16-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T01:13:02,103  INFO [pool-16-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:02,105  INFO [pool-16-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,15KB
2024-04-24T01:13:02,107  INFO [pool-16-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:02,107  INFO [pool-16-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:02,107  INFO [pool-16-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<>>
2024-04-24T01:13:02,107  INFO [pool-16-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:02,108  INFO [pool-16-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@1f2a9156, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@36a71a79, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2] : [int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@2f67dec7
2024-04-24T01:13:02,112  INFO [pool-16-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-00_844_9120780706425942383-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-00_844_9120780706425942383-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:02,112  INFO [pool-16-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-00_844_9120780706425942383-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-00_844_9120780706425942383-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:02,112  INFO [pool-16-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-00_844_9120780706425942383-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-00_844_9120780706425942383-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:02,134  INFO [pool-16-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:02,135  INFO [pool-16-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:02,135  INFO [pool-16-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:02,135  INFO [pool-16-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:02,135  INFO [pool-16-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T01:13:02,135  INFO [pool-16-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_0:4, 
2024-04-24T01:13:02,136  INFO [pool-16-thread-1] mapred.Task: Task:attempt_local1746982798_0002_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:02,137  INFO [pool-16-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:02,137  INFO [pool-16-thread-1] mapred.Task: Task 'attempt_local1746982798_0002_r_000000_0' done.
2024-04-24T01:13:02,138  INFO [pool-16-thread-1] mapred.Task: Final Counters for attempt_local1746982798_0002_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=34851
		FILE: Number of bytes written=2373294
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=116
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=935854080
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:02,138  INFO [pool-16-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1746982798_0002_r_000000_0
2024-04-24T01:13:02,138  INFO [Thread-156] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:02,896 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:02,896  INFO [main] exec.Task: 2024-04-24 01:13:02,896 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1746982798_0002
2024-04-24T01:13:02,898  INFO [main] exec.Task: Ended Job = job_local1746982798_0002
2024-04-24T01:13:02,900  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:02,900  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:02,901  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:02,901  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:02,901  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:02,901  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22); Time taken: 1.425 seconds
2024-04-24T01:13:02,901  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011300_7fcd68f9-82c6-405f-b822-44ad25392e22
2024-04-24T01:13:02,907  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T01:13:02,915  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:02,915  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T01:13:02,924  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:02,941  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-24T01:13:02,942  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:02,942  WARN [main] ql.TestTxnAddPartition: addPartitionMMVectorized: read data(add 2 parts w/data and 1 empty vect): 
2024-04-24T01:13:02,942  INFO [main] ql.TestTxnAddPartition: 0	0	2
0	0	4
1	0	2
1	0	4

2024-04-24T01:13:02,942  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T01:13:02,943  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-00_844_9120780706425942383-1
2024-04-24T01:13:02,944  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-00_844_9120780706425942383-1 on fs with scheme file
2024-04-24T01:13:02,945  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011302_775635da-de9b-4e83-a93d-0d01ab87cbea): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T01:13:02,953  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T01:13:02,954  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T01:13:02,956  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:02,961  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:02,961  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:02,963  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:02,989  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:02,990  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:02,990  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:02,990  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:03,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:03,047  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:03,048  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:03,090  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:03,120  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:03,148  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:03,148  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:03,234  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:03,234  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:03,234  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:03,238  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:03,244  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T01:13:03,244  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T01:13:03,246  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:03,287  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:03,302  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:03,303  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:03,303  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:03,305  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:03,305  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:03,308  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:03,308  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T01:13:03,308  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:03,309  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=3, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=2, listPartitions_(String, String, short)=25, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=5, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=57, getTable_(GetTableRequest)=26, getAllTableConstraints_(AllTableConstraintsRequest)=14}
2024-04-24T01:13:03,309  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011302_775635da-de9b-4e83-a93d-0d01ab87cbea); Time taken: 0.363 seconds
2024-04-24T01:13:03,309  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011302_775635da-de9b-4e83-a93d-0d01ab87cbea): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T01:13:03,310  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T01:13:03,348  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:03,348  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T01:13:03,348  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011302_775635da-de9b-4e83-a93d-0d01ab87cbea); Time taken: 0.039 seconds
2024-04-24T01:13:03,348  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:03,356  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T01:13:03,364  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:03,365  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T01:13:03,368  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:03,368  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-02_945_875407900731203958-1
2024-04-24T01:13:03,368  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-02_945_875407900731203958-1 on fs with scheme file
2024-04-24T01:13:03,369  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011303_0624e7c0-6c07-41bc-991b-1dc72f0ac7a7): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:03,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:03,387  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,392  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T01:13:03,393  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T01:13:03,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:03,414  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,415  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:03,415  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:03,415  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:03,415  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:03,415  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:03,415  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:03,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:03,416  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, getCurrentNotificationEventId_()=4, isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=5, getTable_(GetTableRequest)=34, getValidTxns_(long)=1, flushCache_()=0}
2024-04-24T01:13:03,416  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011303_0624e7c0-6c07-41bc-991b-1dc72f0ac7a7); Time taken: 0.046 seconds
2024-04-24T01:13:03,416  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424011303_0624e7c0-6c07-41bc-991b-1dc72f0ac7a7
2024-04-24T01:13:03,417  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011303_0624e7c0-6c07-41bc-991b-1dc72f0ac7a7
2024-04-24T01:13:03,439  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011303_0624e7c0-6c07-41bc-991b-1dc72f0ac7a7 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T01:13:03,439  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:03,439  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011303_0624e7c0-6c07-41bc-991b-1dc72f0ac7a7): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:03,440  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:03,440  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:03,440  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:03,440  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:03,440  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:03,530  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:03,538  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:03,538  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:03,538  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011303_0624e7c0-6c07-41bc-991b-1dc72f0ac7a7); Time taken: 0.099 seconds
2024-04-24T01:13:03,538  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011303_0624e7c0-6c07-41bc-991b-1dc72f0ac7a7
2024-04-24T01:13:03,544  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T01:13:03,553  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:03,553  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T01:13:03,556  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011303_9ec730b2-3b06-43c5-8160-f9c9a347c18b): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:03,560  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T01:13:03,561  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T01:13:03,562  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:03,580  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,595  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-24T01:13:03,595  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-24T01:13:03,596  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:03,597  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:03,597  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:03,597  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=16, getTable_(GetTableRequest)=19, allocateTableWriteId_(long, String, String)=13, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:03,597  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011303_9ec730b2-3b06-43c5-8160-f9c9a347c18b); Time taken: 0.042 seconds
2024-04-24T01:13:03,598  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424011303_9ec730b2-3b06-43c5-8160-f9c9a347c18b
2024-04-24T01:13:03,598  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011303_9ec730b2-3b06-43c5-8160-f9c9a347c18b
2024-04-24T01:13:03,626  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011303_9ec730b2-3b06-43c5-8160-f9c9a347c18b LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T01:13:03,626  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:03,633  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011303_9ec730b2-3b06-43c5-8160-f9c9a347c18b): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:03,634  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:03,634  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:03,654  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:03,687 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T01:13:03,687 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T01:13:03,689 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-24T01:13:03,690 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T01:13:03,694 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T01:13:03,694  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:03,694  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:03,695  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011303_9ec730b2-3b06-43c5-8160-f9c9a347c18b); Time taken: 0.061 seconds
2024-04-24T01:13:03,695  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011303_9ec730b2-3b06-43c5-8160-f9c9a347c18b
2024-04-24T01:13:03,698  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:03,709  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:03,709  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011303_80a2e60b-5817-4784-a19f-0d0ed55b0e5d): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:03,713  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T01:13:03,714  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T01:13:03,715  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:03,728  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:03,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-24T01:13:03,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:03,786  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-24T01:13:03,786  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-24T01:13:03,788  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:03,788  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:03,788  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:03,788  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getPartitionWithAuthInfo_(String, String, List, String, List)=33, rollbackTxn_(long)=13, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0, getTable_(GetTableRequest)=13, allocateTableWriteId_(long, String, String)=10}
2024-04-24T01:13:03,789  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011303_80a2e60b-5817-4784-a19f-0d0ed55b0e5d); Time taken: 0.079 seconds
2024-04-24T01:13:03,789  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424011303_80a2e60b-5817-4784-a19f-0d0ed55b0e5d
2024-04-24T01:13:03,789  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011303_80a2e60b-5817-4784-a19f-0d0ed55b0e5d
2024-04-24T01:13:03,816  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011303_80a2e60b-5817-4784-a19f-0d0ed55b0e5d LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T01:13:03,816  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:03,827  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011303_80a2e60b-5817-4784-a19f-0d0ed55b0e5d): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:03,828  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:03,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:03,842  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,842  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:03,858  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T01:13:03,862  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T01:13:03,865  INFO [HMSHandler #3] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3
2024-04-24T01:13:03,906  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-24T01:13:03,906  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data
2024-04-24T01:13:03,906  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:03,923  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:03,944  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-24T01:13:03,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:03,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:03,957  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:03,958  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:03,974  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-24T01:13:03,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:03,980  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-24T01:13:04,041  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:04,083  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:04,097  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:04,097  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=102, isCompatibleWith_(Configuration)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=49, validatePartitionNameCharacters_(List)=0, getTable_(GetTableRequest)=44, add_partitions_(List, boolean, boolean)=63, getValidWriteIds_(List, String)=1}
2024-04-24T01:13:04,097  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011303_80a2e60b-5817-4784-a19f-0d0ed55b0e5d); Time taken: 0.27 seconds
2024-04-24T01:13:04,097  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011303_80a2e60b-5817-4784-a19f-0d0ed55b0e5d
2024-04-24T01:13:04,102  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T01:13:04,110  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:04,113  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T01:13:04,114  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b from T order by p, a, b
2024-04-24T01:13:04,115  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6): select p, a, b from T order by p, a, b
2024-04-24T01:13:04,128  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 23
2024-04-24T01:13:04,128  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T01:13:04,131  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:04,131  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:04,140  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:04,140  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:04,141  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:04,155  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:04,156  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:04,156  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:04,156  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:04,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:04,224  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:04,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:04,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:04,302  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:04,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:04,333  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T01:13:04,333  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T01:13:04,400  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:04,401  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:04,401  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:04,403  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-04_114_1388498449598002531-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-04_114_1388498449598002531-1
2024-04-24T01:13:04,411  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:04,415  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T01:13:04,415  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T01:13:04,416  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:04,417  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:04,427  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:04,428  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:04,428  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:04,429  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:04,429  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:04,429  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:04,429  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:04,429  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T01:13:04,431  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-24T01:13:04,431  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:04,431  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=3, getAggrColStatsFor_(String, String, List, List, String, String)=51, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=43, getValidWriteIds_(List, String)=10, getTable_(GetTableRequest)=15, openTxn_(String, TxnType)=12, listPartitions_(String, String, short)=37, commitTxn_(CommitTxnRequest)=17}
2024-04-24T01:13:04,431  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6); Time taken: 0.316 seconds
2024-04-24T01:13:04,432  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6
2024-04-24T01:13:04,433  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6
2024-04-24T01:13:04,462  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6 LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T01:13:04,462  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:04,463  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6): select p, a, b from T order by p, a, b
2024-04-24T01:13:04,464  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6
2024-04-24T01:13:04,464  INFO [main] ql.Driver: Query ID = alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6
Total jobs = 1
2024-04-24T01:13:04,464  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:04,464  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:04,641  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:04,641  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:04,641  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:04,641  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:04,642  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:04,642  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:04,642  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:04,642  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:04,644  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:04,644  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:04,644  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:04,652  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-04_114_1388498449598002531-1/-mr-10004/22b5f271-f3dc-41b4-ad81-9f0c585f5d2c (false)
2024-04-24T01:13:04,663  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:04,667  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,34KB
2024-04-24T01:13:04,672  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:04,676  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,15KB
2024-04-24T01:13:04,677  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:04,686  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:04,695  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:04,700  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:04,702  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:04,702  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:04,702  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:04,714  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:04,714  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: insert_only 
2024-04-24T01:13:04,714  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:04,722  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-24T01:13:04,722  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 8 ms
2024-04-24T01:13:04,722  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T01:13:04,741  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T01:13:04,769  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local940968239_0003
2024-04-24T01:13:04,769  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:04,848  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:04,848  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:04,849  INFO [Thread-250] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:04,849  INFO [Thread-250] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:04,852  INFO [Thread-250] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:04,852  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local940968239_0003_m_000000_0
2024-04-24T01:13:04,853  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:04,853  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:04,854  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:04,856  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,34KB
2024-04-24T01:13:04,858  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:04,860  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:04,866  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:04,866  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:04,866  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:04,866  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:04,866  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:04,866  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:04,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:04,867  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:04,868  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:04,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:04,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:04,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:04,869  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:04,869  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:04,869  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:04,869  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:04,870  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:04,870  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:04,870  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:04,870  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:04,870  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:04,870  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:04,870  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T01:13:04,871  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:04,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:04,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:04,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T01:13:04,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:04,882  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:04,887  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local940968239_0003_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:04,888  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:04,888  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local940968239_0003_m_000000_0' done.
2024-04-24T01:13:04,888  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local940968239_0003_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=51487
		FILE: Number of bytes written=3566122
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1009778688
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8492
2024-04-24T01:13:04,888  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local940968239_0003_m_000000_0
2024-04-24T01:13:04,888  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local940968239_0003_m_000001_0
2024-04-24T01:13:04,889  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:04,889  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:04,890  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:04,892  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,34KB
2024-04-24T01:13:04,894  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:04,895  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:04,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:04,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:04,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:04,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:04,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:04,902  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:04,903  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:04,903  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:04,904  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:04,904  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:04,904  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:04,904  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:04,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:04,906  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:04,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:04,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:04,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T01:13:04,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:04,916  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:04,920  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local940968239_0003_m_000001_0 is done. And is in the process of committing
2024-04-24T01:13:04,921  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:04,921  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local940968239_0003_m_000001_0' done.
2024-04-24T01:13:04,921  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local940968239_0003_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=61058
		FILE: Number of bytes written=3566212
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1009778688
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8492
2024-04-24T01:13:04,921  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local940968239_0003_m_000001_0
2024-04-24T01:13:04,921  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local940968239_0003_m_000002_0
2024-04-24T01:13:04,921  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:04,922  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:04,923  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:04,924  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,34KB
2024-04-24T01:13:04,926  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:04,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:04,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:04,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:04,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:04,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:04,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:04,938  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:04,938  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:04,938  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:04,939  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:04,939  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:04,939  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:04,939  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:04,940  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:04,940  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:04,940  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:04,940  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:04,940  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:04,940  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:04,940  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:04,940  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:04,941  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:04,941  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:04,941  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T01:13:04,941  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:04,941  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:04,941  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:04,941  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T01:13:04,942  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:04,950  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:04,954  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local940968239_0003_m_000002_0 is done. And is in the process of committing
2024-04-24T01:13:04,955  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:04,955  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local940968239_0003_m_000002_0' done.
2024-04-24T01:13:04,955  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local940968239_0003_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=70117
		FILE: Number of bytes written=3566302
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1009778688
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8492
2024-04-24T01:13:04,955  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local940968239_0003_m_000002_0
2024-04-24T01:13:04,955  INFO [Thread-250] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:04,956  INFO [Thread-250] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:04,957  INFO [pool-21-thread-1] mapred.LocalJobRunner: Starting task: attempt_local940968239_0003_r_000000_0
2024-04-24T01:13:04,957  INFO [pool-21-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:04,957  INFO [pool-21-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@db03a5
2024-04-24T01:13:04,957  WARN [pool-21-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:04,958  INFO [pool-21-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:04,959  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local940968239_0003_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:04,960  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local940968239_0003_m_000002_0 decomp: 54 len: 58 to MEMORY
2024-04-24T01:13:04,960  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local940968239_0003_m_000002_0
2024-04-24T01:13:04,960  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->54
2024-04-24T01:13:04,963  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local940968239_0003_m_000001_0 decomp: 54 len: 58 to MEMORY
2024-04-24T01:13:04,963  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local940968239_0003_m_000001_0
2024-04-24T01:13:04,963  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 2, commitMemory -> 54, usedMemory ->108
2024-04-24T01:13:04,966  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local940968239_0003_m_000000_0 decomp: 54 len: 58 to MEMORY
2024-04-24T01:13:04,966  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local940968239_0003_m_000000_0
2024-04-24T01:13:04,966  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 3, commitMemory -> 108, usedMemory ->162
2024-04-24T01:13:04,966  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:04,967  INFO [pool-21-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T01:13:04,967  INFO [pool-21-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:04,973  INFO [pool-21-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-24T01:13:04,973  INFO [pool-21-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 96 bytes
2024-04-24T01:13:04,976  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 162 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:04,976  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merging 1 files, 162 bytes from disk
2024-04-24T01:13:04,976  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:04,976  INFO [pool-21-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:04,976  INFO [pool-21-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 136 bytes
2024-04-24T01:13:04,977  INFO [pool-21-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T01:13:04,977  INFO [pool-21-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:04,979  INFO [pool-21-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,15KB
2024-04-24T01:13:04,981  INFO [pool-21-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:04,981  INFO [pool-21-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:04,981  INFO [pool-21-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<>>
2024-04-24T01:13:04,981  INFO [pool-21-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:04,982  INFO [pool-21-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@40c2d53f, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@1dca3eba, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2] : [int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@7454defd
2024-04-24T01:13:04,982  INFO [pool-21-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-04_114_1388498449598002531-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-04_114_1388498449598002531-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:04,983  INFO [pool-21-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-04_114_1388498449598002531-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-04_114_1388498449598002531-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:04,983  INFO [pool-21-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-04_114_1388498449598002531-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-04_114_1388498449598002531-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:04,991  INFO [pool-21-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:04,992  INFO [pool-21-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:04,992  INFO [pool-21-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:6, 
2024-04-24T01:13:04,992  INFO [pool-21-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:04,992  INFO [pool-21-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-24T01:13:04,992  INFO [pool-21-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:6, RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:04,993  INFO [pool-21-thread-1] mapred.Task: Task:attempt_local940968239_0003_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:04,994  INFO [pool-21-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:04,994  INFO [pool-21-thread-1] mapred.Task: Task 'attempt_local940968239_0003_r_000000_0' done.
2024-04-24T01:13:04,994  INFO [pool-21-thread-1] mapred.Task: Final Counters for attempt_local940968239_0003_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=77766
		FILE: Number of bytes written=3566671
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=174
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1009778688
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:04,994  INFO [pool-21-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local940968239_0003_r_000000_0
2024-04-24T01:13:04,994  INFO [Thread-250] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:05,854 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:05,854  INFO [main] exec.Task: 2024-04-24 01:13:05,854 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local940968239_0003
2024-04-24T01:13:05,856  INFO [main] exec.Task: Ended Job = job_local940968239_0003
2024-04-24T01:13:05,857  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:05,858  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:05,858  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:05,858  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:05,858  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:05,858  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6); Time taken: 1.394 seconds
2024-04-24T01:13:05,858  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011304_50ce5abd-e03d-4964-8ac7-6d262e02e2d6
2024-04-24T01:13:05,863  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T01:13:05,871  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:05,871  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T01:13:05,875  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:05,876  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-24T01:13:05,876  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:05,876  WARN [main] ql.TestTxnAddPartition: addPartitionMMVectorized: read data(add 2 existing parts and 1 empty vect): 
2024-04-24T01:13:05,876  INFO [main] ql.TestTxnAddPartition: 0	0	2
0	0	4
1	0	2
1	0	4
3	0	2
3	0	4

2024-04-24T01:13:05,877  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T01:13:05,877  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-04_114_1388498449598002531-1
2024-04-24T01:13:05,878  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-04_114_1388498449598002531-1 on fs with scheme file
2024-04-24T01:13:05,878  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011305_5c8da709-518d-488c-bd5a-0b793179fbd1): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T01:13:05,882  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-24T01:13:05,883  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T01:13:05,884  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:05,888  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:05,888  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:05,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:05,907  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:05,907  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:05,908  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:05,908  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:05,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:05,937  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:05,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:05,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:06,007  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,007  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:06,032  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:06,032  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:06,093  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:06,093  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:06,093  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:06,095  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:06,100  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T01:13:06,100  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T01:13:06,101  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:06,131  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:06,146  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:06,147  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:06,147  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:06,149  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:06,149  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:06,150  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:06,150  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T01:13:06,150  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:06,150  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=18, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, listPartitions_(String, String, short)=12, getAggrColStatsFor_(String, String, List, List, String, String)=47, getAllTableConstraints_(AllTableConstraintsRequest)=8, isCompatibleWith_(Configuration)=2}
2024-04-24T01:13:06,150  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011305_5c8da709-518d-488c-bd5a-0b793179fbd1); Time taken: 0.272 seconds
2024-04-24T01:13:06,151  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011305_5c8da709-518d-488c-bd5a-0b793179fbd1): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T01:13:06,151  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T01:13:06,167  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:06,168  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T01:13:06,168  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011305_5c8da709-518d-488c-bd5a-0b793179fbd1); Time taken: 0.016 seconds
2024-04-24T01:13:06,168  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:06,176  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T01:13:06,186  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:06,186  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T01:13:06,188  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:06,189  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-05_878_3560221798185535093-1
2024-04-24T01:13:06,189  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/41e4ecaa-bbe2-4f55-98ea-283f3f886a1e/hive_2024-04-24_01-13-05_878_3560221798185535093-1 on fs with scheme file
2024-04-24T01:13:06,190  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011306_79338dc0-b023-4ad6-9bd6-3793f88ceb79): drop table if exists acidTbl
2024-04-24T01:13:06,194  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-24T01:13:06,194  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T01:13:06,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:06,204  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,204  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:06,205  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:06,205  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:06,205  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=19}
2024-04-24T01:13:06,205  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011306_79338dc0-b023-4ad6-9bd6-3793f88ceb79); Time taken: 0.015 seconds
2024-04-24T01:13:06,206  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424011306_79338dc0-b023-4ad6-9bd6-3793f88ceb79
2024-04-24T01:13:06,207  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011306_79338dc0-b023-4ad6-9bd6-3793f88ceb79
2024-04-24T01:13:06,226  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011306_79338dc0-b023-4ad6-9bd6-3793f88ceb79 LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T01:13:06,226  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:06,226  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011306_79338dc0-b023-4ad6-9bd6-3793f88ceb79): drop table if exists acidTbl
2024-04-24T01:13:06,226  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:06,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:06,236  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:06,246  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,247  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:06,502  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:06,502  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=11, dropTable_(String, String, boolean, boolean, boolean)=264, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:06,503  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011306_79338dc0-b023-4ad6-9bd6-3793f88ceb79); Time taken: 0.276 seconds
2024-04-24T01:13:06,503  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011306_79338dc0-b023-4ad6-9bd6-3793f88ceb79
2024-04-24T01:13:06,510  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T01:13:06,520  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:06,521  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T01:13:06,522  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:06,523  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011306_123cb12f-08bb-43a2-8e4d-8ce2f6b22611): drop table if exists acidTblPart
2024-04-24T01:13:06,533  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-24T01:13:06,533  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-24T01:13:06,536  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:06,568  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,568  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:06,569  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:06,569  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:06,569  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=33, commitTxn_(CommitTxnRequest)=19, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=10, flushCache_()=0}
2024-04-24T01:13:06,569  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011306_123cb12f-08bb-43a2-8e4d-8ce2f6b22611); Time taken: 0.047 seconds
2024-04-24T01:13:06,570  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240424011306_123cb12f-08bb-43a2-8e4d-8ce2f6b22611
2024-04-24T01:13:06,570  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011306_123cb12f-08bb-43a2-8e4d-8ce2f6b22611
2024-04-24T01:13:06,602  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011306_123cb12f-08bb-43a2-8e4d-8ce2f6b22611 LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T01:13:06,602  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:06,602  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011306_123cb12f-08bb-43a2-8e4d-8ce2f6b22611): drop table if exists acidTblPart
2024-04-24T01:13:06,602  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:06,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:06,617  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:06,632  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:06,710  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:06,710  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=93, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=15}
2024-04-24T01:13:06,711  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011306_123cb12f-08bb-43a2-8e4d-8ce2f6b22611); Time taken: 0.108 seconds
2024-04-24T01:13:06,711  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011306_123cb12f-08bb-43a2-8e4d-8ce2f6b22611
2024-04-24T01:13:06,715  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-24T01:13:06,724  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:06,724  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-24T01:13:06,725  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:06,725  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011306_34aca36c-4d6d-426d-9f5c-c64249ecdc14): drop table if exists acidTbl2
2024-04-24T01:13:06,728  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-24T01:13:06,728  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-24T01:13:06,730  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:06,730  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:06,730  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:06,730  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14}
2024-04-24T01:13:06,730  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011306_34aca36c-4d6d-426d-9f5c-c64249ecdc14); Time taken: 0.005 seconds
2024-04-24T01:13:06,730  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240424011306_34aca36c-4d6d-426d-9f5c-c64249ecdc14
2024-04-24T01:13:06,730  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:06,730  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011306_34aca36c-4d6d-426d-9f5c-c64249ecdc14): drop table if exists acidTbl2
2024-04-24T01:13:06,731  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:06,731  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T01:13:06,732  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:06,732  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:06,732  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011306_34aca36c-4d6d-426d-9f5c-c64249ecdc14); Time taken: 0.002 seconds
2024-04-24T01:13:06,732  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011306_34aca36c-4d6d-426d-9f5c-c64249ecdc14
2024-04-24T01:13:06,739  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-24T01:13:06,746  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:06,747  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-24T01:13:06,747  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:06,748  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011306_8bf50518-1b03-426c-b603-86ba034fbb10): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:06,750  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-24T01:13:06,751  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-24T01:13:06,752  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:06,780  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,780  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:06,780  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:06,780  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:06,780  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=15, getTable_(GetTableRequest)=28, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T01:13:06,780  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011306_8bf50518-1b03-426c-b603-86ba034fbb10); Time taken: 0.032 seconds
2024-04-24T01:13:06,780  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240424011306_8bf50518-1b03-426c-b603-86ba034fbb10
2024-04-24T01:13:06,781  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011306_8bf50518-1b03-426c-b603-86ba034fbb10
2024-04-24T01:13:06,807  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011306_8bf50518-1b03-426c-b603-86ba034fbb10 LockResponse(lockid:20, state:ACQUIRED)
2024-04-24T01:13:06,807  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:06,807  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011306_8bf50518-1b03-426c-b603-86ba034fbb10): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:06,807  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:06,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:06,824  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:06,839  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:06,917  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:06,917  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=17, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=93}
2024-04-24T01:13:06,917  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011306_8bf50518-1b03-426c-b603-86ba034fbb10); Time taken: 0.11 seconds
2024-04-24T01:13:06,917  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011306_8bf50518-1b03-426c-b603-86ba034fbb10
2024-04-24T01:13:06,923  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-24T01:13:06,931  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:06,931  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-24T01:13:06,932  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:06,932  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011306_e53320e6-010f-4cd5-8fd1-4b0edfe6fd40): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:06,935  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 28
2024-04-24T01:13:06,936  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-24T01:13:06,937  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:06,949  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,949  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:06,949  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:06,949  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:06,950  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=12, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, flushCache_()=1, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:06,950  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011306_e53320e6-010f-4cd5-8fd1-4b0edfe6fd40); Time taken: 0.017 seconds
2024-04-24T01:13:06,950  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240424011306_e53320e6-010f-4cd5-8fd1-4b0edfe6fd40
2024-04-24T01:13:06,951  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011306_e53320e6-010f-4cd5-8fd1-4b0edfe6fd40
2024-04-24T01:13:06,977  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011306_e53320e6-010f-4cd5-8fd1-4b0edfe6fd40 LockResponse(lockid:21, state:ACQUIRED)
2024-04-24T01:13:06,977  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:06,977  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011306_e53320e6-010f-4cd5-8fd1-4b0edfe6fd40): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:06,978  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:06,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:06,999  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:06,999  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:07,018  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:07,018  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:07,096  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,097  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=21, dropTable_(String, String, boolean, boolean, boolean)=97, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,097  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011306_e53320e6-010f-4cd5-8fd1-4b0edfe6fd40); Time taken: 0.119 seconds
2024-04-24T01:13:07,097  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011306_e53320e6-010f-4cd5-8fd1-4b0edfe6fd40
2024-04-24T01:13:07,104  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-24T01:13:07,115  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,115  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-24T01:13:07,116  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:07,117  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_da6e5333-1086-4b3f-8543-7f64b688a085): drop table if exists nonAcidNonBucket
2024-04-24T01:13:07,121  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 28
2024-04-24T01:13:07,122  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-24T01:13:07,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:07,144  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:07,144  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,144  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,144  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,144  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=4, getTable_(GetTableRequest)=21, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=19, flushCache_()=0}
2024-04-24T01:13:07,145  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_da6e5333-1086-4b3f-8543-7f64b688a085); Time taken: 0.027 seconds
2024-04-24T01:13:07,145  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240424011307_da6e5333-1086-4b3f-8543-7f64b688a085
2024-04-24T01:13:07,146  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011307_da6e5333-1086-4b3f-8543-7f64b688a085
2024-04-24T01:13:07,175  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011307_da6e5333-1086-4b3f-8543-7f64b688a085 LockResponse(lockid:22, state:ACQUIRED)
2024-04-24T01:13:07,175  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:07,175  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_da6e5333-1086-4b3f-8543-7f64b688a085): drop table if exists nonAcidNonBucket
2024-04-24T01:13:07,175  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:07,195  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:07,196  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:07,215  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:07,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:07,285  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,286  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=21, dropTable_(String, String, boolean, boolean, boolean)=89, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,286  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_da6e5333-1086-4b3f-8543-7f64b688a085); Time taken: 0.11 seconds
2024-04-24T01:13:07,286  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_da6e5333-1086-4b3f-8543-7f64b688a085
2024-04-24T01:13:07,293  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-24T01:13:07,307  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,307  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-24T01:13:07,309  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T01:13:07,435  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T01:13:07,435  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T01:13:07,436  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T01:13:07,438  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = b9092c49-57ca-40a9-b62f-90e854601960
2024-04-24T01:13:07,441  INFO [main] SessionState: Hive Session ID = b9092c49-57ca-40a9-b62f-90e854601960
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:07,442  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:07,448  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b9092c49-57ca-40a9-b62f-90e854601960
2024-04-24T01:13:07,450  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960
2024-04-24T01:13:07,453  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b9092c49-57ca-40a9-b62f-90e854601960/_tmp_space.db
2024-04-24T01:13:07,453  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=b9092c49-57ca-40a9-b62f-90e854601960, clientType=HIVECLI]
2024-04-24T01:13:07,454  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:07,454  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_11ecd9c9-c200-430a-bff9-6996b56ab969): drop table if exists acidTbl
2024-04-24T01:13:07,467  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T01:13:07,467  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T01:13:07,470  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:07,475  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,475  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,475  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,475  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=12, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=22}
2024-04-24T01:13:07,475  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_11ecd9c9-c200-430a-bff9-6996b56ab969); Time taken: 0.021 seconds
2024-04-24T01:13:07,475  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424011307_11ecd9c9-c200-430a-bff9-6996b56ab969
2024-04-24T01:13:07,476  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:07,476  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_11ecd9c9-c200-430a-bff9-6996b56ab969): drop table if exists acidTbl
2024-04-24T01:13:07,476  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:07,482  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,483  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,483  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_11ecd9c9-c200-430a-bff9-6996b56ab969); Time taken: 0.006 seconds
2024-04-24T01:13:07,483  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_11ecd9c9-c200-430a-bff9-6996b56ab969
2024-04-24T01:13:07,491  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T01:13:07,500  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,500  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T01:13:07,501  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:07,502  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_7b3eb594-fb0b-4098-b7de-7be11778916e): drop table if exists acidTblPart
2024-04-24T01:13:07,506  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T01:13:07,507  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T01:13:07,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:07,513  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,514  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,514  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,514  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, flushCache_()=0, openTxn_(String, TxnType)=4, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,514  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_7b3eb594-fb0b-4098-b7de-7be11778916e); Time taken: 0.013 seconds
2024-04-24T01:13:07,514  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424011307_7b3eb594-fb0b-4098-b7de-7be11778916e
2024-04-24T01:13:07,514  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:07,514  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_7b3eb594-fb0b-4098-b7de-7be11778916e): drop table if exists acidTblPart
2024-04-24T01:13:07,515  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:07,522  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,522  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,522  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_7b3eb594-fb0b-4098-b7de-7be11778916e); Time taken: 0.008 seconds
2024-04-24T01:13:07,522  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_7b3eb594-fb0b-4098-b7de-7be11778916e
2024-04-24T01:13:07,531  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T01:13:07,539  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,539  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T01:13:07,540  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:07,541  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_3ae54542-0fcd-4fdb-bc25-feff6de909f9): drop table if exists acidTbl2
2024-04-24T01:13:07,544  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T01:13:07,544  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T01:13:07,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:07,550  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,551  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,551  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,551  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=17, isCompatibleWith_(Configuration)=2, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T01:13:07,551  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_3ae54542-0fcd-4fdb-bc25-feff6de909f9); Time taken: 0.01 seconds
2024-04-24T01:13:07,551  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424011307_3ae54542-0fcd-4fdb-bc25-feff6de909f9
2024-04-24T01:13:07,551  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:07,551  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_3ae54542-0fcd-4fdb-bc25-feff6de909f9): drop table if exists acidTbl2
2024-04-24T01:13:07,552  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:07,556  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,556  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,556  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_3ae54542-0fcd-4fdb-bc25-feff6de909f9); Time taken: 0.005 seconds
2024-04-24T01:13:07,556  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_3ae54542-0fcd-4fdb-bc25-feff6de909f9
2024-04-24T01:13:07,563  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T01:13:07,570  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,570  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T01:13:07,571  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:07,572  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_24d7e491-e4ce-4f2f-89c5-93139a0d3a97): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:07,575  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T01:13:07,575  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T01:13:07,576  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:07,580  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,580  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,580  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,580  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14}
2024-04-24T01:13:07,581  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_24d7e491-e4ce-4f2f-89c5-93139a0d3a97); Time taken: 0.008 seconds
2024-04-24T01:13:07,581  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424011307_24d7e491-e4ce-4f2f-89c5-93139a0d3a97
2024-04-24T01:13:07,581  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:07,581  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_24d7e491-e4ce-4f2f-89c5-93139a0d3a97): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:07,581  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:07,585  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,586  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,586  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_24d7e491-e4ce-4f2f-89c5-93139a0d3a97); Time taken: 0.004 seconds
2024-04-24T01:13:07,586  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_24d7e491-e4ce-4f2f-89c5-93139a0d3a97
2024-04-24T01:13:07,592  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T01:13:07,599  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,599  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T01:13:07,600  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:07,600  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_337bbee8-55c1-4f67-8fc1-009c3fb4b133): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:07,603  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T01:13:07,604  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T01:13:07,605  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:07,609  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,609  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,609  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,609  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13}
2024-04-24T01:13:07,609  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_337bbee8-55c1-4f67-8fc1-009c3fb4b133); Time taken: 0.009 seconds
2024-04-24T01:13:07,609  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424011307_337bbee8-55c1-4f67-8fc1-009c3fb4b133
2024-04-24T01:13:07,610  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:07,610  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_337bbee8-55c1-4f67-8fc1-009c3fb4b133): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:07,610  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:07,614  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,615  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,615  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_337bbee8-55c1-4f67-8fc1-009c3fb4b133); Time taken: 0.004 seconds
2024-04-24T01:13:07,615  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_337bbee8-55c1-4f67-8fc1-009c3fb4b133
2024-04-24T01:13:07,622  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T01:13:07,632  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,633  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T01:13:07,634  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:07,634  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_6f1cbca9-4fb3-4c57-9ba5-a3235a822c34): drop table if exists nonAcidNonBucket
2024-04-24T01:13:07,638  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T01:13:07,638  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T01:13:07,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:07,646  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,646  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,646  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,646  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T01:13:07,646  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_6f1cbca9-4fb3-4c57-9ba5-a3235a822c34); Time taken: 0.012 seconds
2024-04-24T01:13:07,647  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424011307_6f1cbca9-4fb3-4c57-9ba5-a3235a822c34
2024-04-24T01:13:07,647  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:07,647  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_6f1cbca9-4fb3-4c57-9ba5-a3235a822c34): drop table if exists nonAcidNonBucket
2024-04-24T01:13:07,647  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,647  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:07,654  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,654  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,654  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_6f1cbca9-4fb3-4c57-9ba5-a3235a822c34); Time taken: 0.007 seconds
2024-04-24T01:13:07,654  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_6f1cbca9-4fb3-4c57-9ba5-a3235a822c34
2024-04-24T01:13:07,662  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T01:13:07,672  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,672  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T01:13:07,673  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:07,673  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_51afcd50-4111-4808-8cad-c2f4e4be7f9d): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:07,678  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T01:13:07,678  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T01:13:07,679  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:07,679  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:07,688  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T01:13:07,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:07,691  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:07,691  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,691  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=1, getValidWriteIds_(List, String)=8}
2024-04-24T01:13:07,691  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_51afcd50-4111-4808-8cad-c2f4e4be7f9d); Time taken: 0.018 seconds
2024-04-24T01:13:07,692  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424011307_51afcd50-4111-4808-8cad-c2f4e4be7f9d
2024-04-24T01:13:07,692  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011307_51afcd50-4111-4808-8cad-c2f4e4be7f9d
2024-04-24T01:13:07,723  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011307_51afcd50-4111-4808-8cad-c2f4e4be7f9d LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T01:13:07,723  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:07,725  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_51afcd50-4111-4808-8cad-c2f4e4be7f9d): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:07,725  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713946387, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, totalSize=0, transactional=true, numRows=0, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:07,738  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtbl
2024-04-24T01:13:07,796  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=70, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,797  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_51afcd50-4111-4808-8cad-c2f4e4be7f9d); Time taken: 0.071 seconds
2024-04-24T01:13:07,797  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_51afcd50-4111-4808-8cad-c2f4e4be7f9d
2024-04-24T01:13:07,802  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T01:13:07,808  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,808  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T01:13:07,809  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:07,809  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_842d5685-bb71-4f61-be7b-c2ce69fc9a96): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:07,814  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T01:13:07,814  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T01:13:07,815  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:07,815  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:07,819  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T01:13:07,819  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:07,821  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:07,821  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,822  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,822  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,822  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1, openTxn_(String, TxnType)=3}
2024-04-24T01:13:07,822  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_842d5685-bb71-4f61-be7b-c2ce69fc9a96); Time taken: 0.013 seconds
2024-04-24T01:13:07,822  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424011307_842d5685-bb71-4f61-be7b-c2ce69fc9a96
2024-04-24T01:13:07,823  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011307_842d5685-bb71-4f61-be7b-c2ce69fc9a96
2024-04-24T01:13:07,843  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011307_842d5685-bb71-4f61-be7b-c2ce69fc9a96 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T01:13:07,843  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:07,844  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_842d5685-bb71-4f61-be7b-c2ce69fc9a96): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:07,844  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,845  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713946387, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:07,852  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtblpart
2024-04-24T01:13:07,875  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,875  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=30, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,875  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_842d5685-bb71-4f61-be7b-c2ce69fc9a96); Time taken: 0.031 seconds
2024-04-24T01:13:07,876  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_842d5685-bb71-4f61-be7b-c2ce69fc9a96
2024-04-24T01:13:07,880  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T01:13:07,889  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,890  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T01:13:07,891  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:07,891  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_1b7a63e7-f683-42d0-8531-54d49d2c1904): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:07,894  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T01:13:07,894  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T01:13:07,895  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:07,895  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:07,898  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T01:13:07,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:07,901  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:07,901  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:07,901  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:07,901  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:07,902  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=3, getValidWriteIds_(List, String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=14}
2024-04-24T01:13:07,902  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_1b7a63e7-f683-42d0-8531-54d49d2c1904); Time taken: 0.01 seconds
2024-04-24T01:13:07,902  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424011307_1b7a63e7-f683-42d0-8531-54d49d2c1904
2024-04-24T01:13:07,903  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011307_1b7a63e7-f683-42d0-8531-54d49d2c1904
2024-04-24T01:13:07,921  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011307_1b7a63e7-f683-42d0-8531-54d49d2c1904 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T01:13:07,921  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:07,921  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_1b7a63e7-f683-42d0-8531-54d49d2c1904): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:07,922  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:07,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713946387, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, bucketing_version=2, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:07,935  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl
2024-04-24T01:13:07,966  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:07,966  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=42, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:07,966  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_1b7a63e7-f683-42d0-8531-54d49d2c1904); Time taken: 0.045 seconds
2024-04-24T01:13:07,966  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_1b7a63e7-f683-42d0-8531-54d49d2c1904
2024-04-24T01:13:07,974  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T01:13:07,984  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:07,984  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T01:13:07,985  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:07,986  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011307_7fcd2f85-d3f0-4efb-8678-41cf82cb6d21): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:07,990  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T01:13:07,991  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T01:13:07,992  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:07,992  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:07,996  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T01:13:07,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:08,000  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:08,000  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:08,000  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:08,000  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:08,001  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=4, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=1, openTxn_(String, TxnType)=4, getValidWriteIds_(List, String)=4}
2024-04-24T01:13:08,001  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011307_7fcd2f85-d3f0-4efb-8678-41cf82cb6d21); Time taken: 0.014 seconds
2024-04-24T01:13:08,001  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424011307_7fcd2f85-d3f0-4efb-8678-41cf82cb6d21
2024-04-24T01:13:08,002  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011307_7fcd2f85-d3f0-4efb-8678-41cf82cb6d21
2024-04-24T01:13:08,032  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011307_7fcd2f85-d3f0-4efb-8678-41cf82cb6d21 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T01:13:08,032  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:08,032  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011307_7fcd2f85-d3f0-4efb-8678-41cf82cb6d21): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:08,032  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:08,034  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713946388, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, bucketing_version=2, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numFilesErasureCoded=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:08,047  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl2
2024-04-24T01:13:08,075  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:08,075  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=41}
2024-04-24T01:13:08,076  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011307_7fcd2f85-d3f0-4efb-8678-41cf82cb6d21); Time taken: 0.043 seconds
2024-04-24T01:13:08,076  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011307_7fcd2f85-d3f0-4efb-8678-41cf82cb6d21
2024-04-24T01:13:08,080  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T01:13:08,087  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:08,087  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T01:13:08,088  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:08,089  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011308_28b986b4-86fa-4848-8b65-6b7fbf15a3c4): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:08,092  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T01:13:08,092  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T01:13:08,093  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:08,093  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:08,096  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T01:13:08,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:08,099  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:08,099  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:08,099  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:08,099  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:08,099  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=12, flushCache_()=0}
2024-04-24T01:13:08,099  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011308_28b986b4-86fa-4848-8b65-6b7fbf15a3c4); Time taken: 0.011 seconds
2024-04-24T01:13:08,099  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424011308_28b986b4-86fa-4848-8b65-6b7fbf15a3c4
2024-04-24T01:13:08,100  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011308_28b986b4-86fa-4848-8b65-6b7fbf15a3c4
2024-04-24T01:13:08,116  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011308_28b986b4-86fa-4848-8b65-6b7fbf15a3c4 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T01:13:08,116  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:08,117  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011308_28b986b4-86fa-4848-8b65-6b7fbf15a3c4): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:08,117  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:08,119  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b9092c49-57ca-40a9-b62f-90e854601960/_tmp_space.db/0f11e68d-1bc0-41cb-9cad-9595444b9ee7
2024-04-24T01:13:08,122  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:08,122  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-24T01:13:08,122  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011308_28b986b4-86fa-4848-8b65-6b7fbf15a3c4); Time taken: 0.005 seconds
2024-04-24T01:13:08,122  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011308_28b986b4-86fa-4848-8b65-6b7fbf15a3c4
2024-04-24T01:13:08,127  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T01:13:08,134  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:08,134  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T01:13:08,135  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:08,135  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011308_deb8a494-3819-4e2f-a5e2-70904923f069): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:08,138  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T01:13:08,138  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T01:13:08,139  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:08,139  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:08,142  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T01:13:08,142  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:08,144  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:08,144  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:08,144  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:08,144  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:08,144  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=3, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-24T01:13:08,144  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011308_deb8a494-3819-4e2f-a5e2-70904923f069); Time taken: 0.009 seconds
2024-04-24T01:13:08,145  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424011308_deb8a494-3819-4e2f-a5e2-70904923f069
2024-04-24T01:13:08,145  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011308_deb8a494-3819-4e2f-a5e2-70904923f069
2024-04-24T01:13:08,161  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011308_deb8a494-3819-4e2f-a5e2-70904923f069 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T01:13:08,161  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:08,161  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011308_deb8a494-3819-4e2f-a5e2-70904923f069): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:08,162  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:08,163  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713946388, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, totalSize=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:08,170  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidnonbucket
2024-04-24T01:13:08,188  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:08,188  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=26, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:08,188  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011308_deb8a494-3819-4e2f-a5e2-70904923f069); Time taken: 0.027 seconds
2024-04-24T01:13:08,188  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011308_deb8a494-3819-4e2f-a5e2-70904923f069
2024-04-24T01:13:08,193  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T01:13:08,199  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:08,199  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T01:13:08,200  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T01:13:08,200  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011308_c0e5db4b-4642-4f8b-8f04-b9e61b3194e6): drop table if exists T
2024-04-24T01:13:08,203  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T01:13:08,203  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T01:13:08,204  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:08,257  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:08,257  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:08,257  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:08,258  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:08,258  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=53, flushCache_()=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:08,258  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011308_c0e5db4b-4642-4f8b-8f04-b9e61b3194e6); Time taken: 0.057 seconds
2024-04-24T01:13:08,258  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424011308_c0e5db4b-4642-4f8b-8f04-b9e61b3194e6
2024-04-24T01:13:08,259  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011308_c0e5db4b-4642-4f8b-8f04-b9e61b3194e6
2024-04-24T01:13:08,293  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011308_c0e5db4b-4642-4f8b-8f04-b9e61b3194e6 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T01:13:08,293  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:08,293  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011308_c0e5db4b-4642-4f8b-8f04-b9e61b3194e6): drop table if exists T
2024-04-24T01:13:08,293  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:08,293  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:08,311  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:08,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:08,330  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:08,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T01:13:08,554  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t does not exist; Force to delete it.
2024-04-24T01:13:08,554 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:08,555  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:08,555  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=243, getTable_(GetTableRequest)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:08,555  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011308_c0e5db4b-4642-4f8b-8f04-b9e61b3194e6); Time taken: 0.262 seconds
2024-04-24T01:13:08,555  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011308_c0e5db4b-4642-4f8b-8f04-b9e61b3194e6
2024-04-24T01:13:08,560  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T01:13:08,568  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:08,569  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T01:13:08,570  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T01:13:08,571  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011308_b3bd6210-1116-4503-8704-03c4b62c1443): drop table if exists Tstage
2024-04-24T01:13:08,582  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 5
2024-04-24T01:13:08,583  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T01:13:08,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:08,599  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:08,599  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:08,599  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:08,599  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:08,600  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=2, openTxn_(String, TxnType)=12, getTable_(GetTableRequest)=14, flushCache_()=0}
2024-04-24T01:13:08,600  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011308_b3bd6210-1116-4503-8704-03c4b62c1443); Time taken: 0.028 seconds
2024-04-24T01:13:08,600  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424011308_b3bd6210-1116-4503-8704-03c4b62c1443
2024-04-24T01:13:08,601  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011308_b3bd6210-1116-4503-8704-03c4b62c1443
2024-04-24T01:13:08,620  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011308_b3bd6210-1116-4503-8704-03c4b62c1443 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T01:13:08,620  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:08,620  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011308_b3bd6210-1116-4503-8704-03c4b62c1443): drop table if exists Tstage
2024-04-24T01:13:08,620  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:08,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:08,633  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:08,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:08,646  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:08,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T01:13:08,699  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage does not exist; Force to delete it.
2024-04-24T01:13:08,699 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:08,699  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:08,699  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=13, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=66}
2024-04-24T01:13:08,699  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011308_b3bd6210-1116-4503-8704-03c4b62c1443); Time taken: 0.079 seconds
2024-04-24T01:13:08,699  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011308_b3bd6210-1116-4503-8704-03c4b62c1443
2024-04-24T01:13:08,704  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T01:13:08,713  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:08,713  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T01:13:08,714  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:08,714  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011308_dc2068d0-b3c6-43b2-9ab2-265796e57fa3): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:08,718  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 8
2024-04-24T01:13:08,719  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T01:13:08,719  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:08,719  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:08,727  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T01:13:08,728  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:08,730  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:08,730  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:08,730  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:08,730  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:08,730  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, getDatabase_(String)=3, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, flushCache_()=0, getValidWriteIds_(List, String)=7}
2024-04-24T01:13:08,730  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011308_dc2068d0-b3c6-43b2-9ab2-265796e57fa3); Time taken: 0.016 seconds
2024-04-24T01:13:08,731  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424011308_dc2068d0-b3c6-43b2-9ab2-265796e57fa3
2024-04-24T01:13:08,731  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011308_dc2068d0-b3c6-43b2-9ab2-265796e57fa3
2024-04-24T01:13:08,758  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011308_dc2068d0-b3c6-43b2-9ab2-265796e57fa3 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T01:13:08,758  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:08,759  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011308_dc2068d0-b3c6-43b2-9ab2-265796e57fa3): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:08,759  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:08,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713946388, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:08,771  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:08,838  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:08,838  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=78, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:08,838  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011308_dc2068d0-b3c6-43b2-9ab2-265796e57fa3); Time taken: 0.079 seconds
2024-04-24T01:13:08,839  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011308_dc2068d0-b3c6-43b2-9ab2-265796e57fa3
2024-04-24T01:13:08,845  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T01:13:08,856  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:08,856  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T01:13:08,857  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:08,858  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011308_6648b207-7ac8-4431-83a5-422bfc4b4bf8): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:08,862  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 9
2024-04-24T01:13:08,863  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T01:13:08,864  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:08,864  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:08,868  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T01:13:08,869  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:08,873  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:08,873  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:08,873  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:08,873  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:08,873  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=18, getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getDatabase_(String)=5, flushCache_()=0}
2024-04-24T01:13:08,874  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011308_6648b207-7ac8-4431-83a5-422bfc4b4bf8); Time taken: 0.016 seconds
2024-04-24T01:13:08,874  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424011308_6648b207-7ac8-4431-83a5-422bfc4b4bf8
2024-04-24T01:13:08,874  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011308_6648b207-7ac8-4431-83a5-422bfc4b4bf8
2024-04-24T01:13:08,903  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011308_6648b207-7ac8-4431-83a5-422bfc4b4bf8 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T01:13:08,903  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:08,903  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011308_6648b207-7ac8-4431-83a5-422bfc4b4bf8): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:08,903  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:08,906  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713946388, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, bucketing_version=2, numRows=0, numFilesErasureCoded=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:08,918  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:08,945  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:08,946  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=40, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:08,946  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011308_6648b207-7ac8-4431-83a5-422bfc4b4bf8); Time taken: 0.042 seconds
2024-04-24T01:13:08,946  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011308_6648b207-7ac8-4431-83a5-422bfc4b4bf8
2024-04-24T01:13:08,952  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T01:13:08,963  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:08,963  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T01:13:08,964  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:08,964  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134): insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:08,969  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 10
2024-04-24T01:13:08,969  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T01:13:08,970  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:08,970  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:08,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:08,994  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:08,995  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:08,995  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:08,995  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:08,995  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:08,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:09,016  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:09,016  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:09,016  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T01:13:09,053  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:09,200  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:09,200  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:09,200  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:09,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:09,203  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:09,203  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:09,203  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:09,204  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:09,216  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:09,219  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1
2024-04-24T01:13:09,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:09,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:09,225  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:09,228  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:09,229  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:09,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:09,255  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:09,256  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T01:13:09,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:09,275  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:09,277  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:09,277  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T01:13:09,277  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:09,277  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:09,277  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:09,277  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T01:13:09,277  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T01:13:09,279  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:09,279  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:09,279  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:09,279  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T01:13:09,279  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:09,279  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=91, getValidTxns_(long)=1, getValidWriteIds_(List, String)=5, flushCache_()=0, commitTxn_(CommitTxnRequest)=17, getAllTableConstraints_(AllTableConstraintsRequest)=57, getNotNullConstraints_(NotNullConstraintsRequest)=2, getCheckConstraints_(CheckConstraintsRequest)=1, isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=4}
2024-04-24T01:13:09,280  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134); Time taken: 0.315 seconds
2024-04-24T01:13:09,280  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134
2024-04-24T01:13:09,280  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134
2024-04-24T01:13:09,303  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T01:13:09,303  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:09,303  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134): insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:09,305  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134
2024-04-24T01:13:09,305  INFO [main] ql.Driver: Query ID = alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134
Total jobs = 1
2024-04-24T01:13:09,305  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:09,305  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:09,468  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T01:13:09,468  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T01:13:09,471  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:09,471  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T01:13:09,471  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-08_964_8690839373995036120-1/dummy_path
2024-04-24T01:13:09,482  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:09,483  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,11KB
2024-04-24T01:13:09,484  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:09,488  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-08_964_8690839373995036120-1/-mr-10001
2024-04-24T01:13:09,493  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:09,502  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:09,508  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:09,509  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T01:13:09,509  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T01:13:09,509  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-08_964_8690839373995036120-1/dummy_path
2024-04-24T01:13:09,510  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:13:09,530  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:13:09,562  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local491374230_0004
2024-04-24T01:13:09,562  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:09,643  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:09,644  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:09,644  INFO [Thread-359] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:09,644  INFO [Thread-359] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:09,646  INFO [Thread-359] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:09,646  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local491374230_0004_m_000000_0
2024-04-24T01:13:09,649  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:09,649  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-08_964_8690839373995036120-1/dummy_path/null:0+1
2024-04-24T01:13:09,652  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:09,653  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,11KB
2024-04-24T01:13:09,653  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T01:13:09,656  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:09,656  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:09,657  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:09,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:09,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T01:13:09,657  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T01:13:09,658  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:09,658  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T01:13:09,658  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:09,658  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local491374230_0004/job_local491374230_0004.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1104e3ea
2024-04-24T01:13:09,659  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:09,659  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:09,659  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:09,661  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:09,661  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T01:13:09,669  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T01:13:09,669  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:09,669  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:09,669  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T01:13:09,669  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-24T01:13:09,669  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:09,670  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T01:13:09,678  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:09,679  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:09,681  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local491374230_0004_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:09,682  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:09,682  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local491374230_0004_m_000000_0' done.
2024-04-24T01:13:09,682  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local491374230_0004_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=88087
		FILE: Number of bytes written=4748120
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1009254400
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6168
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:09,682  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local491374230_0004_m_000000_0
2024-04-24T01:13:09,682  INFO [Thread-359] mapred.LocalJobRunner: map task executor complete.
2024-04-24 01:13:10,645 Stage-1 map = 100%,  reduce = 0%
2024-04-24T01:13:10,646  INFO [main] exec.Task: 2024-04-24 01:13:10,645 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local491374230_0004
2024-04-24T01:13:10,647  INFO [main] exec.Task: Ended Job = job_local491374230_0004
2024-04-24T01:13:10,649  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T01:13:10,650  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T01:13:10,650  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T01:13:10,650  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T01:13:10,650  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/-ext-10000
2024-04-24T01:13:10,651  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/-ext-10002
2024-04-24T01:13:10,651  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T01:13:10,652  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1/-ext-10000
2024-04-24T01:13:10,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:10,671  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:10,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:10,691  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:10,694  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:10,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:10,749  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T01:13:10,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:10,760  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:10,760  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T01:13:10,760  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-08_964_8690839373995036120-1/-mr-10001
2024-04-24T01:13:10,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:10,772  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:10,773  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T01:13:10,773  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T01:13:10,773  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:10,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:10,808  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T01:13:10,808  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:10,808  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, alter_table_(String, String, String, Table, EnvironmentContext, String)=90, getTable_(GetTableRequest)=61}
MapReduce Jobs Launched: 
2024-04-24T01:13:10,809  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:10,809  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:10,809  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:10,809  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134); Time taken: 1.505 seconds
2024-04-24T01:13:10,809  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011308_18c5bef0-7905-4c3a-b9e2-b3d921a1a134
2024-04-24T01:13:10,815  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T01:13:10,824  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:10,824  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T01:13:10,825  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:10,826  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-08_964_8690839373995036120-1
2024-04-24T01:13:10,827  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-08_964_8690839373995036120-1 on fs with scheme file
2024-04-24T01:13:10,827  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1
2024-04-24T01:13:10,827  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-08_964_8690839373995036120-1 on fs with scheme file
2024-04-24T01:13:10,828  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011310_a874d06b-7e28-4046-ab0f-8c0361472e1d): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:10,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:10,845  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:10,848  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T01:13:10,848  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T01:13:10,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:10,863  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:10,863  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:10,863  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:10,863  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:10,863  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:10,863  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:10,863  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:10,863  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:10,863  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=0, getTable_(GetTableRequest)=28, flushCache_()=0, getCurrentNotificationEventId_()=3, openTxn_(String, TxnType)=3}
2024-04-24T01:13:10,864  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011310_a874d06b-7e28-4046-ab0f-8c0361472e1d); Time taken: 0.036 seconds
2024-04-24T01:13:10,864  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424011310_a874d06b-7e28-4046-ab0f-8c0361472e1d
2024-04-24T01:13:10,865  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011310_a874d06b-7e28-4046-ab0f-8c0361472e1d
2024-04-24T01:13:10,886  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011310_a874d06b-7e28-4046-ab0f-8c0361472e1d LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T01:13:10,886  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:10,886  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011310_a874d06b-7e28-4046-ab0f-8c0361472e1d): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:10,886  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:10,887  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:10,887  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:10,887  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:10,887  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:10,899  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:10,904  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:10,905  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:10,905  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011310_a874d06b-7e28-4046-ab0f-8c0361472e1d); Time taken: 0.018 seconds
2024-04-24T01:13:10,905  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011310_a874d06b-7e28-4046-ab0f-8c0361472e1d
2024-04-24T01:13:10,911  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T01:13:11,079  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:11,080  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T01:13:11,081  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:11,082  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011311_b816b112-032a-47a5-9b3b-2af7167e0d36): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:11,083  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:11,122  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,125  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T01:13:11,126  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T01:13:11,128  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:11,144  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,144  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:11,144  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:11,144  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:11,144  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:11,145  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:11,145  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:11,145  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:11,145  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=55, flushCache_()=0, commitTxn_(CommitTxnRequest)=176, getValidTxns_(long)=1, getCurrentNotificationEventId_()=1, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:11,145  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011311_b816b112-032a-47a5-9b3b-2af7167e0d36); Time taken: 0.063 seconds
2024-04-24T01:13:11,145  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424011311_b816b112-032a-47a5-9b3b-2af7167e0d36
2024-04-24T01:13:11,146  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011311_b816b112-032a-47a5-9b3b-2af7167e0d36
2024-04-24T01:13:11,175  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011311_b816b112-032a-47a5-9b3b-2af7167e0d36 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T01:13:11,175  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:11,175  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011311_b816b112-032a-47a5-9b3b-2af7167e0d36): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:11,175  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:11,176  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:11,176  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:11,176  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:11,176  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:11,187  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:11,193  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:11,193  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:11,193  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011311_b816b112-032a-47a5-9b3b-2af7167e0d36); Time taken: 0.017 seconds
2024-04-24T01:13:11,193  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011311_b816b112-032a-47a5-9b3b-2af7167e0d36
2024-04-24T01:13:11,197  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T01:13:11,203  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:11,203  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T01:13:11,203  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:11,204  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011311_96691a3c-cf15-4f34-afcf-351e6d319293): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:11,208  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T01:13:11,209  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T01:13:11,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:11,224  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,237  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T01:13:11,238  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-24T01:13:11,241  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:11,241  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:11,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:11,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=14, allocateTableWriteId_(long, String, String)=11, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=4, getValidTxns_(long)=1}
2024-04-24T01:13:11,241  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011311_96691a3c-cf15-4f34-afcf-351e6d319293); Time taken: 0.037 seconds
2024-04-24T01:13:11,242  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424011311_96691a3c-cf15-4f34-afcf-351e6d319293
2024-04-24T01:13:11,242  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011311_96691a3c-cf15-4f34-afcf-351e6d319293
2024-04-24T01:13:11,259  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011311_96691a3c-cf15-4f34-afcf-351e6d319293 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T01:13:11,259  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:11,263  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011311_96691a3c-cf15-4f34-afcf-351e6d319293): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:11,264  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:11,264  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:11,273  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,274  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:11,290  INFO [HMSHandler #4] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:11,290  INFO [HMSHandler #5] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1
2024-04-24T01:13:11,290  INFO [HMSHandler #6] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2
2024-04-24T01:13:11,334  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T01:13:11,334  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data
2024-04-24T01:13:11,335  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:11,344  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:11,366  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T01:13:11,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:11,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:11,376  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:11,398  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T01:13:11,411  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:11,411  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T01:13:11,474  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:11,503  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:11,515  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-24T01:13:11,515  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data
2024-04-24T01:13:11,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:11,528  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,529  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:11,547  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T01:13:11,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:11,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:11,562  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,563  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:11,583  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-24T01:13:11,588  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:11,588  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T01:13:11,630  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:11,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:11,676  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:11,676  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=163, add_partitions_(List, boolean, boolean)=60, getTable_(GetTableRequest)=56, getPartitionWithAuthInfo_(String, String, List, String, List)=106, validatePartitionNameCharacters_(List)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:11,677  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011311_96691a3c-cf15-4f34-afcf-351e6d319293); Time taken: 0.413 seconds
2024-04-24T01:13:11,677  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011311_96691a3c-cf15-4f34-afcf-351e6d319293
2024-04-24T01:13:11,682  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T01:13:11,691  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:11,691  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T01:13:11,692  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:11,693  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:11,697  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T01:13:11,697  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T01:13:11,701  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:11,701  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:11,708  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:11,708  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:11,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:11,721  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,721  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:11,721  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:11,721  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:11,744  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:11,798  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:11,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:11,842  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:11,853  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:11,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:11,876  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:11,876  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:11,943  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:11,943  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:11,943  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:11,945  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-11_692_2412270775359408055-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-11_692_2412270775359408055-1
2024-04-24T01:13:11,952  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:11,956  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], VALUE._col2=Column[_col4]}
2024-04-24T01:13:11,956  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3]}
2024-04-24T01:13:11,957  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:11,957  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:11,969  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:11,969  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:11,969  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:11,970  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:11,970  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:11,970  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:11,970  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:11,971  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T01:13:11,972  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T01:13:11,972  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:11,972  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=12, flushCache_()=0, getValidWriteIds_(List, String)=9, listPartitions_(String, String, short)=31, openTxn_(String, TxnType)=3, getAllTableConstraints_(AllTableConstraintsRequest)=44, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getAggrColStatsFor_(String, String, List, List, String, String)=32, getValidTxns_(long)=3}
2024-04-24T01:13:11,972  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae); Time taken: 0.279 seconds
2024-04-24T01:13:11,972  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae
2024-04-24T01:13:11,973  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae
2024-04-24T01:13:11,994  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T01:13:11,995  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:11,995  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:11,996  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae
2024-04-24T01:13:11,996  INFO [main] ql.Driver: Query ID = alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae
Total jobs = 1
2024-04-24T01:13:11,996  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:11,996  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:12,159  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:12,159  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:12,159  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:12,159  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:12,159  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:12,159  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:12,159  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:12,159  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:12,162  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:12,162  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:12,162  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:12,170  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-11_692_2412270775359408055-1/-mr-10004/a31f9a71-eb43-47e4-9572-20ad74e526c6 (false)
2024-04-24T01:13:12,180  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:12,181  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,08KB
2024-04-24T01:13:12,186  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:12,187  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T01:13:12,188  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:12,194  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:12,202  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:12,207  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:12,208  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:12,208  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:12,208  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:12,209  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:12,209  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T01:13:12,209  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:12,220  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T01:13:12,220  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 11 ms
2024-04-24T01:13:12,220  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T01:13:12,238  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T01:13:12,269  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local883548363_0005
2024-04-24T01:13:12,269  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:12,337  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:12,337  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:12,337  INFO [Thread-434] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:12,337  INFO [Thread-434] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:12,340  INFO [Thread-434] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:12,340  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local883548363_0005_m_000000_0
2024-04-24T01:13:12,341  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:12,342  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:12,342  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:12,343  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-24T01:13:12,354  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T01:13:12,355  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:12,361  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T01:13:12,361  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:12,367  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:12,367  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:12,367  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:12,367  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:12,367  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:12,368  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:12,368  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:12,372  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:12,373  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:12,373  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:12,373  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T01:13:12,374  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:12,374  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:12,375  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:12,376  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:12,376  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:12,376  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:12,376  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:12,376  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-24T01:13:12,376  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:12,376  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:12,377  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:12,377  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:12,377  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:12,377  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:12,377  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:12,378  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:12,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:12,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:12,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T01:13:12,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:12,393  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:12,397  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local883548363_0005_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:12,397  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:12,397  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local883548363_0005_m_000000_0' done.
2024-04-24T01:13:12,398  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local883548363_0005_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=99217
		FILE: Number of bytes written=5936351
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130364928
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7213
2024-04-24T01:13:12,398  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local883548363_0005_m_000000_0
2024-04-24T01:13:12,398  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local883548363_0005_m_000001_0
2024-04-24T01:13:12,399  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:12,400  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:12,400  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:12,401  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-24T01:13:12,403  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T01:13:12,403  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:12,407  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T01:13:12,408  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:12,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:12,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:12,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:12,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:12,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:12,414  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:12,414  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:12,417  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:12,418  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:12,418  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:12,418  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T01:13:12,418  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:12,418  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:12,419  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:12,419  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:12,419  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:2, 
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:12,420  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:12,421  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:12,421  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:12,421  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:12,421  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T01:13:12,421  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:12,429  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:12,433  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local883548363_0005_m_000001_0 is done. And is in the process of committing
2024-04-24T01:13:12,434  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:12,434  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local883548363_0005_m_000001_0' done.
2024-04-24T01:13:12,434  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local883548363_0005_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=107439
		FILE: Number of bytes written=5936799
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130364928
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7213
2024-04-24T01:13:12,434  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local883548363_0005_m_000001_0
2024-04-24T01:13:12,434  INFO [Thread-434] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:12,435  INFO [Thread-434] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:12,435  INFO [pool-30-thread-1] mapred.LocalJobRunner: Starting task: attempt_local883548363_0005_r_000000_0
2024-04-24T01:13:12,436  INFO [pool-30-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:12,436  INFO [pool-30-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5dbc810f
2024-04-24T01:13:12,436  WARN [pool-30-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:12,437  INFO [pool-30-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:12,437  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local883548363_0005_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:12,442  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local883548363_0005_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-24T01:13:12,442  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local883548363_0005_m_000000_0
2024-04-24T01:13:12,442  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-24T01:13:12,444  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local883548363_0005_m_000001_0 decomp: 412 len: 416 to MEMORY
2024-04-24T01:13:12,444  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local883548363_0005_m_000001_0
2024-04-24T01:13:12,444  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 2, commitMemory -> 412, usedMemory ->824
2024-04-24T01:13:12,445  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:12,445  INFO [pool-30-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T01:13:12,445  INFO [pool-30-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:12,451  INFO [pool-30-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T01:13:12,451  INFO [pool-30-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 750 bytes
2024-04-24T01:13:12,454  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 824 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:12,454  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merging 1 files, 826 bytes from disk
2024-04-24T01:13:12,454  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:12,454  INFO [pool-30-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:12,454  INFO [pool-30-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 785 bytes
2024-04-24T01:13:12,454  INFO [pool-30-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T01:13:12,455  INFO [pool-30-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:12,456  INFO [pool-30-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T01:13:12,457  INFO [pool-30-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:12,457  INFO [pool-30-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:12,457  INFO [pool-30-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-24T01:13:12,457  INFO [pool-30-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:12,458  INFO [pool-30-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@26924bf2, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@2c79008>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@2c36c3a9, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@8725572
2024-04-24T01:13:12,458  INFO [pool-30-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-11_692_2412270775359408055-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-11_692_2412270775359408055-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:12,458  INFO [pool-30-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-11_692_2412270775359408055-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-11_692_2412270775359408055-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:12,458  INFO [pool-30-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-11_692_2412270775359408055-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-11_692_2412270775359408055-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:12,466  INFO [pool-30-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:12,467  INFO [pool-30-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:12,467  INFO [pool-30-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-24T01:13:12,467  INFO [pool-30-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:12,467  INFO [pool-30-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T01:13:12,467  INFO [pool-30-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-24T01:13:12,468  INFO [pool-30-thread-1] mapred.Task: Task:attempt_local883548363_0005_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:12,468  INFO [pool-30-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:12,468  INFO [pool-30-thread-1] mapred.Task: Task 'attempt_local883548363_0005_r_000000_0' done.
2024-04-24T01:13:12,468  INFO [pool-30-thread-1] mapred.Task: Final Counters for attempt_local883548363_0005_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=115442
		FILE: Number of bytes written=5938500
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=832
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130364928
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:12,468  INFO [pool-30-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local883548363_0005_r_000000_0
2024-04-24T01:13:12,469  INFO [Thread-434] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:13,340 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:13,340  INFO [main] exec.Task: 2024-04-24 01:13:13,340 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local883548363_0005
2024-04-24T01:13:13,341  INFO [main] exec.Task: Ended Job = job_local883548363_0005
2024-04-24T01:13:13,343  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:13,343  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:13,344  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:13,344  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:13,344  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:13,344  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae); Time taken: 1.348 seconds
2024-04-24T01:13:13,344  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011311_6ed94115-7cdd-4b73-9cd7-29460f656cae
2024-04-24T01:13:13,349  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T01:13:13,356  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:13,356  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T01:13:13,362  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:13,364  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T01:13:13,364  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:4, 
2024-04-24T01:13:13,364  WARN [main] ql.TestTxnAddPartition: addPartition: read data(add 2 parts w/data and 1 empty): 
2024-04-24T01:13:13,364  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0

2024-04-24T01:13:13,364  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:13,364  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-11_692_2412270775359408055-1
2024-04-24T01:13:13,365  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-11_692_2412270775359408055-1 on fs with scheme file
2024-04-24T01:13:13,366  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011313_15863afc-3ce5-435d-b80e-84c739aa07b4): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:13,369  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T01:13:13,369  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T01:13:13,370  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:13,373  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:13,373  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:13,373  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:13,382  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,382  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:13,382  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:13,382  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:13,397  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:13,413  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:13,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:13,435  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:13,447  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:13,459  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:13,459  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:13,521  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:13,521  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:13,521  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:13,525  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:13,531  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T01:13:13,531  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4]}
2024-04-24T01:13:13,532  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:13,548  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:13,558  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:13,559  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:13,559  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:13,559  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:13,559  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T01:13:13,560  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:13,560  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, flushCache_()=0, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=9, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, getAggrColStatsFor_(String, String, List, List, String, String)=23, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=9, listPartitions_(String, String, short)=10}
2024-04-24T01:13:13,560  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011313_15863afc-3ce5-435d-b80e-84c739aa07b4); Time taken: 0.194 seconds
2024-04-24T01:13:13,560  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011313_15863afc-3ce5-435d-b80e-84c739aa07b4): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:13,560  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T01:13:13,571  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:13,572  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T01:13:13,572  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011313_15863afc-3ce5-435d-b80e-84c739aa07b4); Time taken: 0.011 seconds
2024-04-24T01:13:13,572  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:13,577  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T01:13:13,583  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:13,584  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T01:13:13,585  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:13,585  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-13_366_1577454562797072706-1
2024-04-24T01:13:13,585  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-13_366_1577454562797072706-1 on fs with scheme file
2024-04-24T01:13:13,586  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011313_bf653f76-5603-44d5-a4f3-5b0d93142618): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:13,586  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:13,608  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,611  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T01:13:13,611  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T01:13:13,615  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:13,627  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,627  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:13,627  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:13,627  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:13,627  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:13,628  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:13,628  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:13,628  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:13,628  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=34, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, getValidTxns_(long)=1, getCurrentNotificationEventId_()=3, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:13,628  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011313_bf653f76-5603-44d5-a4f3-5b0d93142618); Time taken: 0.042 seconds
2024-04-24T01:13:13,628  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424011313_bf653f76-5603-44d5-a4f3-5b0d93142618
2024-04-24T01:13:13,629  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011313_bf653f76-5603-44d5-a4f3-5b0d93142618
2024-04-24T01:13:13,646  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011313_bf653f76-5603-44d5-a4f3-5b0d93142618 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T01:13:13,646  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:13,646  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011313_bf653f76-5603-44d5-a4f3-5b0d93142618): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:13,646  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:13,646  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:13,646  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:13,647  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:13,647  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:13,658  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:13,663  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:13,663  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:13,664  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011313_bf653f76-5603-44d5-a4f3-5b0d93142618); Time taken: 0.017 seconds
2024-04-24T01:13:13,664  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011313_bf653f76-5603-44d5-a4f3-5b0d93142618
2024-04-24T01:13:13,668  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T01:13:13,675  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:13,675  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T01:13:13,676  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011313_66f4bb46-bc05-413d-8097-4a65e25f3d4e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:13,679  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T01:13:13,679  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T01:13:13,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:13,689  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,700  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-24T01:13:13,700  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-24T01:13:13,701  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:13,701  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:13,701  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:13,701  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=9, allocateTableWriteId_(long, String, String)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-24T01:13:13,702  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011313_66f4bb46-bc05-413d-8097-4a65e25f3d4e); Time taken: 0.025 seconds
2024-04-24T01:13:13,702  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424011313_66f4bb46-bc05-413d-8097-4a65e25f3d4e
2024-04-24T01:13:13,702  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011313_66f4bb46-bc05-413d-8097-4a65e25f3d4e
2024-04-24T01:13:13,719  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011313_66f4bb46-bc05-413d-8097-4a65e25f3d4e LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T01:13:13,719  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:13,723  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011313_66f4bb46-bc05-413d-8097-4a65e25f3d4e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:13,724  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:13,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:13,733  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,733  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:13,754 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T01:13:13,755 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T01:13:13,756 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-24T01:13:13,757 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T01:13:13,759 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T01:13:13,759  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:13,759  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T01:13:13,759  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011313_66f4bb46-bc05-413d-8097-4a65e25f3d4e); Time taken: 0.036 seconds
2024-04-24T01:13:13,759  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011313_66f4bb46-bc05-413d-8097-4a65e25f3d4e
2024-04-24T01:13:13,761  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:13,769  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:13,769  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011313_7a01551a-ac40-41d6-bb0a-3c96da8f41a7): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:13,779  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T01:13:13,780  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T01:13:13,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:13,791  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:13,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-24T01:13:13,826  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:13,838  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-24T01:13:13,838  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-24T01:13:13,839  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:13,839  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:13,839  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:13,840  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, rollbackTxn_(long)=10, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=10, getTable_(GetTableRequest)=10, allocateTableWriteId_(long, String, String)=7, getPartitionWithAuthInfo_(String, String, List, String, List)=29}
2024-04-24T01:13:13,840  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011313_7a01551a-ac40-41d6-bb0a-3c96da8f41a7); Time taken: 0.07 seconds
2024-04-24T01:13:13,840  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424011313_7a01551a-ac40-41d6-bb0a-3c96da8f41a7
2024-04-24T01:13:13,840  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011313_7a01551a-ac40-41d6-bb0a-3c96da8f41a7
2024-04-24T01:13:13,858  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011313_7a01551a-ac40-41d6-bb0a-3c96da8f41a7 LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T01:13:13,858  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:13,867  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011313_7a01551a-ac40-41d6-bb0a-3c96da8f41a7): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:13,867  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:13,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:13,877  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:13,894  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T01:13:13,899  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T01:13:13,902  INFO [HMSHandler #7] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3
2024-04-24T01:13:13,935  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-24T01:13:13,935  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data
2024-04-24T01:13:13,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:13,944  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:13,965  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-24T01:13:13,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:13,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:13,978  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:13,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:13,991  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-24T01:13:13,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:13,995  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-24T01:13:14,044  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:14,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:14,088  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:14,088  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=80, getPartitionWithAuthInfo_(String, String, List, String, List)=44, validatePartitionNameCharacters_(List)=0, getTable_(GetTableRequest)=33, add_partitions_(List, boolean, boolean)=58, getValidWriteIds_(List, String)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:14,089  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011313_7a01551a-ac40-41d6-bb0a-3c96da8f41a7); Time taken: 0.221 seconds
2024-04-24T01:13:14,089  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011313_7a01551a-ac40-41d6-bb0a-3c96da8f41a7
2024-04-24T01:13:14,094  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T01:13:14,101  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:14,103  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T01:13:14,104  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:14,104  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:14,109  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-24T01:13:14,109  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T01:13:14,110  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:14,110  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:14,124  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:14,124  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:14,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:14,138  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:14,139  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:14,139  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:14,139  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:14,163  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:14,220  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:14,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:14,267  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:14,278  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:14,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:14,295  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:14,295  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:14,349  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:14,350  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:14,350  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:14,352  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-14_104_4490522337237873275-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-14_104_4490522337237873275-1
2024-04-24T01:13:14,361  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:14,366  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col1], VALUE._col0=Column[_col2], VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3]}
2024-04-24T01:13:14,366  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], VALUE._col2=Column[_col4], VALUE._col0=Column[_col2]}
2024-04-24T01:13:14,367  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:14,369  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:14,382  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:14,383  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:14,383  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:14,383  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:14,383  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:14,383  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T01:13:14,385  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T01:13:14,385  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:14,385  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=14, listPartitions_(String, String, short)=29, getAggrColStatsFor_(String, String, List, List, String, String)=27, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=16, commitTxn_(CommitTxnRequest)=15, getAllTableConstraints_(AllTableConstraintsRequest)=48}
2024-04-24T01:13:14,385  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252); Time taken: 0.281 seconds
2024-04-24T01:13:14,385  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252
2024-04-24T01:13:14,387  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252
2024-04-24T01:13:14,414  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252 LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T01:13:14,414  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:14,415  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:14,415  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252
2024-04-24T01:13:14,415  INFO [main] ql.Driver: Query ID = alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252
Total jobs = 1
2024-04-24T01:13:14,415  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:14,415  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:14,583  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:14,584  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:14,584  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:14,584  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:14,584  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:14,584  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:14,584  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:14,584  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:14,587  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:14,587  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:14,587  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:14,595  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-14_104_4490522337237873275-1/-mr-10004/52c62e72-3bf0-41b9-ba98-92c737b84926 (false)
2024-04-24T01:13:14,604  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:14,606  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,43KB
2024-04-24T01:13:14,612  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:14,614  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T01:13:14,615  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:14,624  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:14,634  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:14,638  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:14,640  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:14,640  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:14,640  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:14,640  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:14,640  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: default 
2024-04-24T01:13:14,641  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:14,652  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-24T01:13:14,652  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 12 ms
2024-04-24T01:13:14,652  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T01:13:14,671  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T01:13:14,691  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local647913397_0006
2024-04-24T01:13:14,691  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:14,756  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:14,757  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:14,757  INFO [Thread-528] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:14,757  INFO [Thread-528] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:14,759  INFO [Thread-528] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:14,759  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local647913397_0006_m_000000_0
2024-04-24T01:13:14,760  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:14,760  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:14,761  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:14,762  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-24T01:13:14,764  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T01:13:14,764  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:14,769  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T01:13:14,769  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:14,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:14,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:14,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:14,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:14,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:14,774  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:14,774  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:14,777  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:14,778  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:14,778  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:14,778  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T01:13:14,778  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:14,778  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:14,779  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:14,779  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:14,779  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:14,780  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T01:13:14,781  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:14,781  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:14,781  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:14,781  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T01:13:14,781  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:14,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:14,795  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local647913397_0006_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:14,795  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:14,795  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local647913397_0006_m_000000_0' done.
2024-04-24T01:13:14,796  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local647913397_0006_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=130932
		FILE: Number of bytes written=7128792
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1107820544
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-24T01:13:14,796  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local647913397_0006_m_000000_0
2024-04-24T01:13:14,796  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local647913397_0006_m_000001_0
2024-04-24T01:13:14,796  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:14,797  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:14,797  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:14,798  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-24T01:13:14,800  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T01:13:14,800  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:14,806  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T01:13:14,806  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:14,813  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:14,813  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:14,813  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:14,813  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:14,813  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:14,814  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:14,814  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:14,818  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:14,819  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:14,819  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:14,819  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T01:13:14,819  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:14,819  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:14,820  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:14,820  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:14,820  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:14,820  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:14,820  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:14,820  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T01:13:14,821  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:14,821  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:14,821  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:14,821  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T01:13:14,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:14,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:14,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T01:13:14,822  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:14,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:14,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:14,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T01:13:14,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:14,832  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:14,836  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local647913397_0006_m_000001_0 is done. And is in the process of committing
2024-04-24T01:13:14,837  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:14,837  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local647913397_0006_m_000001_0' done.
2024-04-24T01:13:14,837  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local647913397_0006_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=140004
		FILE: Number of bytes written=7129240
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1107820544
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-24T01:13:14,837  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local647913397_0006_m_000001_0
2024-04-24T01:13:14,837  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local647913397_0006_m_000002_0
2024-04-24T01:13:14,838  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:14,839  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:14,840  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:14,840  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-24T01:13:14,842  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T01:13:14,843  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:14,848  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T01:13:14,848  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:14,855  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:14,855  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:14,855  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:14,855  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:14,855  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:14,856  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:14,856  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:14,860  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:14,861  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:14,861  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:14,861  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T01:13:14,861  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:14,861  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:14,862  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T01:13:14,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:14,872  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:14,876  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local647913397_0006_m_000002_0 is done. And is in the process of committing
2024-04-24T01:13:14,877  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:14,877  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local647913397_0006_m_000002_0' done.
2024-04-24T01:13:14,877  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local647913397_0006_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=148564
		FILE: Number of bytes written=7129688
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1107820544
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-24T01:13:14,877  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local647913397_0006_m_000002_0
2024-04-24T01:13:14,878  INFO [Thread-528] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:14,880  INFO [Thread-528] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:14,880  INFO [pool-34-thread-1] mapred.LocalJobRunner: Starting task: attempt_local647913397_0006_r_000000_0
2024-04-24T01:13:14,881  INFO [pool-34-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:14,881  INFO [pool-34-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@298e0a9
2024-04-24T01:13:14,882  WARN [pool-34-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:14,883  INFO [pool-34-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:14,884  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local647913397_0006_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:14,885  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local647913397_0006_m_000002_0 decomp: 412 len: 416 to MEMORY
2024-04-24T01:13:14,885  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local647913397_0006_m_000002_0
2024-04-24T01:13:14,885  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-24T01:13:14,888  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local647913397_0006_m_000001_0 decomp: 412 len: 416 to MEMORY
2024-04-24T01:13:14,888  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local647913397_0006_m_000001_0
2024-04-24T01:13:14,888  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 2, commitMemory -> 412, usedMemory ->824
2024-04-24T01:13:14,891  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local647913397_0006_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-24T01:13:14,892  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local647913397_0006_m_000000_0
2024-04-24T01:13:14,892  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 3, commitMemory -> 824, usedMemory ->1236
2024-04-24T01:13:14,892  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:14,892  INFO [pool-34-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T01:13:14,893  INFO [pool-34-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:14,899  INFO [pool-34-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-24T01:13:14,899  INFO [pool-34-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 1125 bytes
2024-04-24T01:13:14,902  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 1236 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:14,902  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merging 1 files, 1236 bytes from disk
2024-04-24T01:13:14,902  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:14,902  INFO [pool-34-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:14,902  INFO [pool-34-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 1195 bytes
2024-04-24T01:13:14,903  INFO [pool-34-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T01:13:14,903  INFO [pool-34-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:14,904  INFO [pool-34-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T01:13:14,905  INFO [pool-34-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:14,905  INFO [pool-34-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:14,905  INFO [pool-34-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-24T01:13:14,905  INFO [pool-34-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:14,906  INFO [pool-34-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@27c44afe, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@2c79008>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@640dc80d, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@ff1b032
2024-04-24T01:13:14,906  INFO [pool-34-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-14_104_4490522337237873275-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-14_104_4490522337237873275-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:14,906  INFO [pool-34-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-14_104_4490522337237873275-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-14_104_4490522337237873275-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:14,906  INFO [pool-34-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-14_104_4490522337237873275-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-14_104_4490522337237873275-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:14,914  INFO [pool-34-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:14,915  INFO [pool-34-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:14,915  INFO [pool-34-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:14,915  INFO [pool-34-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:14,915  INFO [pool-34-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-24T01:13:14,916  INFO [pool-34-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:6, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:6, 
2024-04-24T01:13:14,916  INFO [pool-34-thread-1] mapred.Task: Task:attempt_local647913397_0006_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:14,917  INFO [pool-34-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:14,917  INFO [pool-34-thread-1] mapred.Task: Task 'attempt_local647913397_0006_r_000000_0' done.
2024-04-24T01:13:14,917  INFO [pool-34-thread-1] mapred.Task: Final Counters for attempt_local647913397_0006_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=157426
		FILE: Number of bytes written=7132189
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=1248
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1107820544
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:14,917  INFO [pool-34-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local647913397_0006_r_000000_0
2024-04-24T01:13:14,917  INFO [Thread-528] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:15,761 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:15,761  INFO [main] exec.Task: 2024-04-24 01:13:15,761 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local647913397_0006
2024-04-24T01:13:15,764  INFO [main] exec.Task: Ended Job = job_local647913397_0006
2024-04-24T01:13:15,767  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:15,768  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:15,768  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:15,768  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:15,768  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:15,768  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252); Time taken: 1.352 seconds
2024-04-24T01:13:15,768  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011314_0516d88d-9c8d-4010-9ade-6e277fc69252
2024-04-24T01:13:15,775  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T01:13:15,786  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:15,786  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T01:13:15,792  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:15,793  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T01:13:15,794  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:15,794  WARN [main] ql.TestTxnAddPartition: addPartition: read data(add 2 existing parts and 1 empty): 
2024-04-24T01:13:15,794  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":3,"bucketid":536870912,"rowid":0}	3	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0
{"writeid":3,"bucketid":536870912,"rowid":1}	3	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0

2024-04-24T01:13:15,794  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:15,794  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-14_104_4490522337237873275-1
2024-04-24T01:13:15,795  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-14_104_4490522337237873275-1 on fs with scheme file
2024-04-24T01:13:15,796  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011315_614c6211-94e4-48b1-ac2f-f6f6ffbcedfa): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:15,804  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-24T01:13:15,804  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T01:13:15,806  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:15,811  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:15,811  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:15,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:15,823  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:15,823  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:15,823  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:15,823  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:15,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:15,851  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:15,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:15,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:15,904  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:15,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:15,923  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:15,923  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:15,990  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:15,990  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:15,990  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:15,992  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:15,995  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0], VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3]}
2024-04-24T01:13:15,995  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], VALUE._col2=Column[_col4], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T01:13:15,996  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:16,018  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:16,027  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:16,028  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:16,028  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:16,029  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:16,029  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T01:13:16,029  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:16,029  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=7, getTable_(GetTableRequest)=11, getAllTableConstraints_(AllTableConstraintsRequest)=6, listPartitions_(String, String, short)=15, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=3, commitTxn_(CommitTxnRequest)=17, getAggrColStatsFor_(String, String, List, List, String, String)=36}
2024-04-24T01:13:16,029  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011315_614c6211-94e4-48b1-ac2f-f6f6ffbcedfa); Time taken: 0.233 seconds
2024-04-24T01:13:16,030  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011315_614c6211-94e4-48b1-ac2f-f6f6ffbcedfa): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:16,030  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T01:13:16,041  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:16,041  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T01:13:16,041  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011315_614c6211-94e4-48b1-ac2f-f6f6ffbcedfa); Time taken: 0.011 seconds
2024-04-24T01:13:16,041  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:16,046  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T01:13:16,052  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:16,052  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T01:13:16,053  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:16,053  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-15_796_154898780069514783-1
2024-04-24T01:13:16,053  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9092c49-57ca-40a9-b62f-90e854601960/hive_2024-04-24_01-13-15_796_154898780069514783-1 on fs with scheme file
2024-04-24T01:13:16,054  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011316_bf971b86-1e58-4e24-b4c5-0abdfdf2b1c0): drop table if exists acidTbl
2024-04-24T01:13:16,056  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-24T01:13:16,056  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T01:13:16,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:16,065  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,065  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:16,065  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:16,065  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:16,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-24T01:13:16,066  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011316_bf971b86-1e58-4e24-b4c5-0abdfdf2b1c0); Time taken: 0.011 seconds
2024-04-24T01:13:16,066  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424011316_bf971b86-1e58-4e24-b4c5-0abdfdf2b1c0
2024-04-24T01:13:16,066  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011316_bf971b86-1e58-4e24-b4c5-0abdfdf2b1c0
2024-04-24T01:13:16,084  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011316_bf971b86-1e58-4e24-b4c5-0abdfdf2b1c0 LockResponse(lockid:20, state:ACQUIRED)
2024-04-24T01:13:16,084  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:16,084  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011316_bf971b86-1e58-4e24-b4c5-0abdfdf2b1c0): drop table if exists acidTbl
2024-04-24T01:13:16,085  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:16,085  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:16,097  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:16,110  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,110  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:16,264  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:16,264  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=167, getTable_(GetTableRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:16,264  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011316_bf971b86-1e58-4e24-b4c5-0abdfdf2b1c0); Time taken: 0.18 seconds
2024-04-24T01:13:16,264  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011316_bf971b86-1e58-4e24-b4c5-0abdfdf2b1c0
2024-04-24T01:13:16,268  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T01:13:16,273  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:16,274  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T01:13:16,274  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:16,275  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011316_59061922-6866-405d-9e87-bc337aa278c2): drop table if exists acidTblPart
2024-04-24T01:13:16,277  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-24T01:13:16,277  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-24T01:13:16,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:16,290  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,290  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:16,290  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:16,291  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:16,291  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=12, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T01:13:16,291  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011316_59061922-6866-405d-9e87-bc337aa278c2); Time taken: 0.015 seconds
2024-04-24T01:13:16,291  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240424011316_59061922-6866-405d-9e87-bc337aa278c2
2024-04-24T01:13:16,292  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011316_59061922-6866-405d-9e87-bc337aa278c2
2024-04-24T01:13:16,311  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011316_59061922-6866-405d-9e87-bc337aa278c2 LockResponse(lockid:21, state:ACQUIRED)
2024-04-24T01:13:16,311  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:16,311  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011316_59061922-6866-405d-9e87-bc337aa278c2): drop table if exists acidTblPart
2024-04-24T01:13:16,311  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:16,311  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:16,319  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:16,326  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,327  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:16,394  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:16,394  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=75, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-24T01:13:16,395  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011316_59061922-6866-405d-9e87-bc337aa278c2); Time taken: 0.083 seconds
2024-04-24T01:13:16,395  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011316_59061922-6866-405d-9e87-bc337aa278c2
2024-04-24T01:13:16,400  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-24T01:13:16,409  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:16,409  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-24T01:13:16,410  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:16,411  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011316_882677d4-2c87-4369-832d-9e6ce9c7c406): drop table if exists acidTbl2
2024-04-24T01:13:16,414  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-24T01:13:16,414  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-24T01:13:16,415  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:16,415  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:16,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:16,415  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=0, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15}
2024-04-24T01:13:16,415  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011316_882677d4-2c87-4369-832d-9e6ce9c7c406); Time taken: 0.004 seconds
2024-04-24T01:13:16,416  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240424011316_882677d4-2c87-4369-832d-9e6ce9c7c406
2024-04-24T01:13:16,416  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:16,416  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011316_882677d4-2c87-4369-832d-9e6ce9c7c406): drop table if exists acidTbl2
2024-04-24T01:13:16,416  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:16,417  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T01:13:16,417  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:16,417  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-24T01:13:16,417  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011316_882677d4-2c87-4369-832d-9e6ce9c7c406); Time taken: 0.001 seconds
2024-04-24T01:13:16,417  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011316_882677d4-2c87-4369-832d-9e6ce9c7c406
2024-04-24T01:13:16,423  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-24T01:13:16,428  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:16,428  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-24T01:13:16,429  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:16,429  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011316_db9bf054-0934-4d4d-9280-714e040e16fc): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:16,432  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-24T01:13:16,432  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-24T01:13:16,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:16,456  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,457  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:16,457  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:16,457  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:16,457  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=1, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=24, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:16,457  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011316_db9bf054-0934-4d4d-9280-714e040e16fc); Time taken: 0.028 seconds
2024-04-24T01:13:16,457  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240424011316_db9bf054-0934-4d4d-9280-714e040e16fc
2024-04-24T01:13:16,458  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011316_db9bf054-0934-4d4d-9280-714e040e16fc
2024-04-24T01:13:16,473  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011316_db9bf054-0934-4d4d-9280-714e040e16fc LockResponse(lockid:22, state:ACQUIRED)
2024-04-24T01:13:16,473  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:16,473  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011316_db9bf054-0934-4d4d-9280-714e040e16fc): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:16,473  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:16,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:16,488  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:16,506  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:16,590  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:16,590  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=101}
2024-04-24T01:13:16,591  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011316_db9bf054-0934-4d4d-9280-714e040e16fc); Time taken: 0.117 seconds
2024-04-24T01:13:16,591  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011316_db9bf054-0934-4d4d-9280-714e040e16fc
2024-04-24T01:13:16,595  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-24T01:13:16,600  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:16,600  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-24T01:13:16,601  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:16,602  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011316_c22c6611-7b19-446b-9219-b3af12f17a37): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:16,605  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-24T01:13:16,605  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-24T01:13:16,606  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:16,620  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,621  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:16,621  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:16,621  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:16,621  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=15, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=1}
2024-04-24T01:13:16,621  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011316_c22c6611-7b19-446b-9219-b3af12f17a37); Time taken: 0.019 seconds
2024-04-24T01:13:16,621  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240424011316_c22c6611-7b19-446b-9219-b3af12f17a37
2024-04-24T01:13:16,622  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011316_c22c6611-7b19-446b-9219-b3af12f17a37
2024-04-24T01:13:16,637  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011316_c22c6611-7b19-446b-9219-b3af12f17a37 LockResponse(lockid:23, state:ACQUIRED)
2024-04-24T01:13:16,637  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:16,637  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011316_c22c6611-7b19-446b-9219-b3af12f17a37): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:16,637  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:16,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:16,648  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:16,664  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,665  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:16,707  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:16,707  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=59, getTable_(GetTableRequest)=11}
2024-04-24T01:13:16,707  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011316_c22c6611-7b19-446b-9219-b3af12f17a37); Time taken: 0.07 seconds
2024-04-24T01:13:16,708  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011316_c22c6611-7b19-446b-9219-b3af12f17a37
2024-04-24T01:13:16,713  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-24T01:13:16,719  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:16,719  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-24T01:13:16,720  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:16,720  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011316_d4e9f4d4-a992-4609-863f-4af7c990a304): drop table if exists nonAcidNonBucket
2024-04-24T01:13:16,723  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-24T01:13:16,723  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-24T01:13:16,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:16,737  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,737  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:16,737  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:16,737  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:16,737  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getTable_(GetTableRequest)=13, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T01:13:16,737  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011316_d4e9f4d4-a992-4609-863f-4af7c990a304); Time taken: 0.017 seconds
2024-04-24T01:13:16,738  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240424011316_d4e9f4d4-a992-4609-863f-4af7c990a304
2024-04-24T01:13:16,738  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011316_d4e9f4d4-a992-4609-863f-4af7c990a304
2024-04-24T01:13:16,758  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011316_d4e9f4d4-a992-4609-863f-4af7c990a304 LockResponse(lockid:24, state:ACQUIRED)
2024-04-24T01:13:16,758  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:16,758  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011316_d4e9f4d4-a992-4609-863f-4af7c990a304): drop table if exists nonAcidNonBucket
2024-04-24T01:13:16,758  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:16,758  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:16,770  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,770  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:16,781  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:16,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:16,824  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:16,824  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=54, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=12}
2024-04-24T01:13:16,824  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011316_d4e9f4d4-a992-4609-863f-4af7c990a304); Time taken: 0.066 seconds
2024-04-24T01:13:16,824  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011316_d4e9f4d4-a992-4609-863f-4af7c990a304
2024-04-24T01:13:16,828  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-24T01:13:16,835  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:16,835  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-24T01:13:16,836  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T01:13:16,936  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T01:13:16,939  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 88bcec10-c6ba-40ee-ac84-4470c6123193
2024-04-24T01:13:16,944  INFO [main] SessionState: Hive Session ID = 88bcec10-c6ba-40ee-ac84-4470c6123193
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:16,945  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:16,952  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/88bcec10-c6ba-40ee-ac84-4470c6123193
2024-04-24T01:13:16,955  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193
2024-04-24T01:13:16,958  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/88bcec10-c6ba-40ee-ac84-4470c6123193/_tmp_space.db
2024-04-24T01:13:16,959  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=88bcec10-c6ba-40ee-ac84-4470c6123193, clientType=HIVECLI]
2024-04-24T01:13:16,959  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:16,960  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011316_03c72fb7-fe91-469f-81e5-7db8bff698cd): drop table if exists acidTbl
2024-04-24T01:13:16,973  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T01:13:16,974  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T01:13:16,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:16,983  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:16,983  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:16,983  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:16,984  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=3, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=13}
2024-04-24T01:13:16,984  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011316_03c72fb7-fe91-469f-81e5-7db8bff698cd); Time taken: 0.023 seconds
2024-04-24T01:13:16,984  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424011316_03c72fb7-fe91-469f-81e5-7db8bff698cd
2024-04-24T01:13:16,984  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:16,984  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011316_03c72fb7-fe91-469f-81e5-7db8bff698cd): drop table if exists acidTbl
2024-04-24T01:13:16,985  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:16,985  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:16,991  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:16,991  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:16,991  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011316_03c72fb7-fe91-469f-81e5-7db8bff698cd); Time taken: 0.007 seconds
2024-04-24T01:13:16,991  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011316_03c72fb7-fe91-469f-81e5-7db8bff698cd
2024-04-24T01:13:17,000  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T01:13:17,010  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,010  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T01:13:17,011  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:17,012  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_2384fe4b-2efe-475b-9d14-f81161ff19d1): drop table if exists acidTblPart
2024-04-24T01:13:17,017  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T01:13:17,018  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T01:13:17,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:17,025  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,025  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,025  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,025  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=5, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=19}
2024-04-24T01:13:17,026  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_2384fe4b-2efe-475b-9d14-f81161ff19d1); Time taken: 0.013 seconds
2024-04-24T01:13:17,026  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424011317_2384fe4b-2efe-475b-9d14-f81161ff19d1
2024-04-24T01:13:17,026  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:17,026  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_2384fe4b-2efe-475b-9d14-f81161ff19d1): drop table if exists acidTblPart
2024-04-24T01:13:17,027  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,027  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:17,033  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,034  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,034  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_2384fe4b-2efe-475b-9d14-f81161ff19d1); Time taken: 0.007 seconds
2024-04-24T01:13:17,034  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_2384fe4b-2efe-475b-9d14-f81161ff19d1
2024-04-24T01:13:17,041  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T01:13:17,051  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,051  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T01:13:17,053  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:17,053  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_de75e042-3346-418d-971c-d7fd833ab6b7): drop table if exists acidTbl2
2024-04-24T01:13:17,056  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T01:13:17,057  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T01:13:17,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:17,064  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,064  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,064  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,064  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T01:13:17,065  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_de75e042-3346-418d-971c-d7fd833ab6b7); Time taken: 0.011 seconds
2024-04-24T01:13:17,065  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424011317_de75e042-3346-418d-971c-d7fd833ab6b7
2024-04-24T01:13:17,065  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:17,065  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_de75e042-3346-418d-971c-d7fd833ab6b7): drop table if exists acidTbl2
2024-04-24T01:13:17,065  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,066  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:17,071  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,071  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,071  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_de75e042-3346-418d-971c-d7fd833ab6b7); Time taken: 0.006 seconds
2024-04-24T01:13:17,071  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_de75e042-3346-418d-971c-d7fd833ab6b7
2024-04-24T01:13:17,078  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T01:13:17,086  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,086  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T01:13:17,087  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:17,087  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_1bfdfc71-9dde-4e4a-9489-d1c555dd9b2b): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:17,090  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T01:13:17,091  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T01:13:17,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:17,096  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,096  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,096  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,096  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=15}
2024-04-24T01:13:17,096  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_1bfdfc71-9dde-4e4a-9489-d1c555dd9b2b); Time taken: 0.009 seconds
2024-04-24T01:13:17,097  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424011317_1bfdfc71-9dde-4e4a-9489-d1c555dd9b2b
2024-04-24T01:13:17,097  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:17,097  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_1bfdfc71-9dde-4e4a-9489-d1c555dd9b2b): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:17,097  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:17,102  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,102  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,102  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_1bfdfc71-9dde-4e4a-9489-d1c555dd9b2b); Time taken: 0.005 seconds
2024-04-24T01:13:17,102  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_1bfdfc71-9dde-4e4a-9489-d1c555dd9b2b
2024-04-24T01:13:17,109  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T01:13:17,115  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,115  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T01:13:17,116  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:17,116  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_6c894a87-2f17-48e0-a0b6-bed7eab9b52f): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:17,118  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T01:13:17,119  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T01:13:17,120  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:17,124  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,124  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,124  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,124  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13}
2024-04-24T01:13:17,124  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_6c894a87-2f17-48e0-a0b6-bed7eab9b52f); Time taken: 0.008 seconds
2024-04-24T01:13:17,125  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424011317_6c894a87-2f17-48e0-a0b6-bed7eab9b52f
2024-04-24T01:13:17,125  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:17,125  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_6c894a87-2f17-48e0-a0b6-bed7eab9b52f): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:17,125  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:17,129  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,130  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,130  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_6c894a87-2f17-48e0-a0b6-bed7eab9b52f); Time taken: 0.004 seconds
2024-04-24T01:13:17,130  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_6c894a87-2f17-48e0-a0b6-bed7eab9b52f
2024-04-24T01:13:17,136  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T01:13:17,143  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,143  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T01:13:17,144  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:17,144  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_e4e8560d-2c88-46b2-bc23-c446b596cf08): drop table if exists nonAcidNonBucket
2024-04-24T01:13:17,146  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T01:13:17,147  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T01:13:17,153  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:17,157  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,157  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,157  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,157  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=5}
2024-04-24T01:13:17,157  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_e4e8560d-2c88-46b2-bc23-c446b596cf08); Time taken: 0.013 seconds
2024-04-24T01:13:17,158  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424011317_e4e8560d-2c88-46b2-bc23-c446b596cf08
2024-04-24T01:13:17,158  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:17,158  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_e4e8560d-2c88-46b2-bc23-c446b596cf08): drop table if exists nonAcidNonBucket
2024-04-24T01:13:17,158  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:17,162  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,162  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,162  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_e4e8560d-2c88-46b2-bc23-c446b596cf08); Time taken: 0.004 seconds
2024-04-24T01:13:17,162  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_e4e8560d-2c88-46b2-bc23-c446b596cf08
2024-04-24T01:13:17,168  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T01:13:17,174  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,174  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T01:13:17,175  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,175  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_a6b1cefc-4f15-4edd-940e-b8c8e6b4d4b6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,178  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T01:13:17,178  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T01:13:17,179  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:17,179  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:17,186  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T01:13:17,186  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:17,188  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:17,188  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,188  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,188  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,188  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=5, getDatabase_(String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-24T01:13:17,188  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_a6b1cefc-4f15-4edd-940e-b8c8e6b4d4b6); Time taken: 0.013 seconds
2024-04-24T01:13:17,189  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424011317_a6b1cefc-4f15-4edd-940e-b8c8e6b4d4b6
2024-04-24T01:13:17,189  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011317_a6b1cefc-4f15-4edd-940e-b8c8e6b4d4b6
2024-04-24T01:13:17,220  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011317_a6b1cefc-4f15-4edd-940e-b8c8e6b4d4b6 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T01:13:17,220  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:17,221  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_a6b1cefc-4f15-4edd-940e-b8c8e6b4d4b6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,221  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713946397, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, totalSize=0, numRows=0, numFilesErasureCoded=0, numFiles=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:17,234  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtbl
2024-04-24T01:13:17,276  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,276  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=54, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,277  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_a6b1cefc-4f15-4edd-940e-b8c8e6b4d4b6); Time taken: 0.055 seconds
2024-04-24T01:13:17,277  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_a6b1cefc-4f15-4edd-940e-b8c8e6b4d4b6
2024-04-24T01:13:17,281  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T01:13:17,288  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,289  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T01:13:17,289  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,290  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_aa91a012-1b18-4cc6-85e4-c5da17cdf7c5): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,293  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T01:13:17,293  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T01:13:17,293  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:17,294  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:17,296  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T01:13:17,296  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:17,298  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:17,298  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,298  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,298  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,298  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:17,298  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_aa91a012-1b18-4cc6-85e4-c5da17cdf7c5); Time taken: 0.008 seconds
2024-04-24T01:13:17,299  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424011317_aa91a012-1b18-4cc6-85e4-c5da17cdf7c5
2024-04-24T01:13:17,299  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011317_aa91a012-1b18-4cc6-85e4-c5da17cdf7c5
2024-04-24T01:13:17,313  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011317_aa91a012-1b18-4cc6-85e4-c5da17cdf7c5 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T01:13:17,313  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:17,314  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_aa91a012-1b18-4cc6-85e4-c5da17cdf7c5): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,314  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713946397, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:17,323  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtblpart
2024-04-24T01:13:17,345  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,345  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=29}
2024-04-24T01:13:17,345  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_aa91a012-1b18-4cc6-85e4-c5da17cdf7c5); Time taken: 0.031 seconds
2024-04-24T01:13:17,345  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_aa91a012-1b18-4cc6-85e4-c5da17cdf7c5
2024-04-24T01:13:17,349  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T01:13:17,355  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,355  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T01:13:17,356  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,356  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_8d615432-cb28-4789-9979-2e1e17009753): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,359  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T01:13:17,360  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T01:13:17,360  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:17,360  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:17,363  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T01:13:17,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:17,365  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:17,365  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,365  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,365  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,365  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getDatabase_(String)=2, flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3}
2024-04-24T01:13:17,365  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_8d615432-cb28-4789-9979-2e1e17009753); Time taken: 0.009 seconds
2024-04-24T01:13:17,365  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424011317_8d615432-cb28-4789-9979-2e1e17009753
2024-04-24T01:13:17,366  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011317_8d615432-cb28-4789-9979-2e1e17009753
2024-04-24T01:13:17,383  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011317_8d615432-cb28-4789-9979-2e1e17009753 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T01:13:17,384  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:17,384  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_8d615432-cb28-4789-9979-2e1e17009753): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,384  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713946397, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0, transactional=false, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:17,395  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl
2024-04-24T01:13:17,418  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,418  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=33}
2024-04-24T01:13:17,418  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_8d615432-cb28-4789-9979-2e1e17009753); Time taken: 0.034 seconds
2024-04-24T01:13:17,419  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_8d615432-cb28-4789-9979-2e1e17009753
2024-04-24T01:13:17,424  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T01:13:17,431  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,431  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T01:13:17,432  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,432  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_7a008d1a-4861-4715-83cf-e7af2d366a8b): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,435  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T01:13:17,436  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T01:13:17,437  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:17,437  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:17,440  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T01:13:17,440  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:17,443  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:17,443  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,443  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,443  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,443  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, flushCache_()=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:17,444  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_7a008d1a-4861-4715-83cf-e7af2d366a8b); Time taken: 0.011 seconds
2024-04-24T01:13:17,444  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424011317_7a008d1a-4861-4715-83cf-e7af2d366a8b
2024-04-24T01:13:17,444  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011317_7a008d1a-4861-4715-83cf-e7af2d366a8b
2024-04-24T01:13:17,461  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011317_7a008d1a-4861-4715-83cf-e7af2d366a8b LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T01:13:17,461  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:17,461  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_7a008d1a-4861-4715-83cf-e7af2d366a8b): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,461  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,462  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713946397, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, numFilesErasureCoded=0, totalSize=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:17,469  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl2
2024-04-24T01:13:17,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,493  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=30}
2024-04-24T01:13:17,493  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_7a008d1a-4861-4715-83cf-e7af2d366a8b); Time taken: 0.031 seconds
2024-04-24T01:13:17,493  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_7a008d1a-4861-4715-83cf-e7af2d366a8b
2024-04-24T01:13:17,499  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T01:13:17,507  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,507  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T01:13:17,508  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,508  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_b32d8529-d3a2-4bd1-b3ec-b95d63b9c2e5): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,511  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T01:13:17,512  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T01:13:17,512  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:17,512  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:17,515  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T01:13:17,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:17,517  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:17,517  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,517  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,517  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,518  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,518  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_b32d8529-d3a2-4bd1-b3ec-b95d63b9c2e5); Time taken: 0.009 seconds
2024-04-24T01:13:17,518  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424011317_b32d8529-d3a2-4bd1-b3ec-b95d63b9c2e5
2024-04-24T01:13:17,518  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011317_b32d8529-d3a2-4bd1-b3ec-b95d63b9c2e5
2024-04-24T01:13:17,537  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011317_b32d8529-d3a2-4bd1-b3ec-b95d63b9c2e5 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T01:13:17,537  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:17,538  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_b32d8529-d3a2-4bd1-b3ec-b95d63b9c2e5): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:17,538  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,539  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/88bcec10-c6ba-40ee-ac84-4470c6123193/_tmp_space.db/a230067f-b3bf-4b5c-abe6-5b8eed911f87
2024-04-24T01:13:17,542  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,543  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,543  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_b32d8529-d3a2-4bd1-b3ec-b95d63b9c2e5); Time taken: 0.004 seconds
2024-04-24T01:13:17,543  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_b32d8529-d3a2-4bd1-b3ec-b95d63b9c2e5
2024-04-24T01:13:17,549  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T01:13:17,557  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,557  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T01:13:17,557  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,558  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_871d45f6-3eac-4d6c-930c-4c6f3e7d6a84): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,561  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T01:13:17,561  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T01:13:17,562  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:17,562  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:17,565  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T01:13:17,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:17,567  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:17,567  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,567  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,568  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,568  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, getValidWriteIds_(List, String)=3}
2024-04-24T01:13:17,568  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_871d45f6-3eac-4d6c-930c-4c6f3e7d6a84); Time taken: 0.01 seconds
2024-04-24T01:13:17,568  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424011317_871d45f6-3eac-4d6c-930c-4c6f3e7d6a84
2024-04-24T01:13:17,569  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011317_871d45f6-3eac-4d6c-930c-4c6f3e7d6a84
2024-04-24T01:13:17,586  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011317_871d45f6-3eac-4d6c-930c-4c6f3e7d6a84 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T01:13:17,586  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:17,586  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_871d45f6-3eac-4d6c-930c-4c6f3e7d6a84): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:17,586  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713946397, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0, transactional=false, numRows=0, numFilesErasureCoded=0, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:17,594  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidnonbucket
2024-04-24T01:13:17,612  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,612  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=25, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:17,613  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_871d45f6-3eac-4d6c-930c-4c6f3e7d6a84); Time taken: 0.026 seconds
2024-04-24T01:13:17,613  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_871d45f6-3eac-4d6c-930c-4c6f3e7d6a84
2024-04-24T01:13:17,617  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T01:13:17,624  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,624  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T01:13:17,625  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T01:13:17,626  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_5e7d0e4e-8a91-4080-b9a3-47e60090d8cf): drop table if exists T
2024-04-24T01:13:17,628  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T01:13:17,629  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T01:13:17,630  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:17,650  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:17,650  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,650  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,650  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,650  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=20, openTxn_(String, TxnType)=3}
2024-04-24T01:13:17,651  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_5e7d0e4e-8a91-4080-b9a3-47e60090d8cf); Time taken: 0.024 seconds
2024-04-24T01:13:17,651  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424011317_5e7d0e4e-8a91-4080-b9a3-47e60090d8cf
2024-04-24T01:13:17,651  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011317_5e7d0e4e-8a91-4080-b9a3-47e60090d8cf
2024-04-24T01:13:17,674  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011317_5e7d0e4e-8a91-4080-b9a3-47e60090d8cf LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T01:13:17,674  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:17,674  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_5e7d0e4e-8a91-4080-b9a3-47e60090d8cf): drop table if exists T
2024-04-24T01:13:17,674  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,674  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:17,682  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:17,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:17,691  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:17,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T01:13:17,862  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t does not exist; Force to delete it.
2024-04-24T01:13:17,862 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:17,862  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:17,862  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=180}
2024-04-24T01:13:17,862  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_5e7d0e4e-8a91-4080-b9a3-47e60090d8cf); Time taken: 0.188 seconds
2024-04-24T01:13:17,863  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_5e7d0e4e-8a91-4080-b9a3-47e60090d8cf
2024-04-24T01:13:17,867  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T01:13:17,875  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:17,877  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T01:13:17,878  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T01:13:17,878  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011317_c653e74a-8a0a-4c49-88bb-b37f9e3c895a): drop table if exists Tstage
2024-04-24T01:13:17,887  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T01:13:17,888  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T01:13:17,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:17,915  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:17,915  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:17,915  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:17,915  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:17,915  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, getTable_(GetTableRequest)=25, openTxn_(String, TxnType)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14}
2024-04-24T01:13:17,916  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011317_c653e74a-8a0a-4c49-88bb-b37f9e3c895a); Time taken: 0.037 seconds
2024-04-24T01:13:17,916  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424011317_c653e74a-8a0a-4c49-88bb-b37f9e3c895a
2024-04-24T01:13:17,916  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011317_c653e74a-8a0a-4c49-88bb-b37f9e3c895a
2024-04-24T01:13:17,933  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011317_c653e74a-8a0a-4c49-88bb-b37f9e3c895a LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T01:13:17,933  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:17,933  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011317_c653e74a-8a0a-4c49-88bb-b37f9e3c895a): drop table if exists Tstage
2024-04-24T01:13:17,933  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:17,933  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:17,947  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:17,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:17,963  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:17,964  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T01:13:18,022  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage does not exist; Force to delete it.
2024-04-24T01:13:18,022 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:18,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:18,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=74}
2024-04-24T01:13:18,023  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011317_c653e74a-8a0a-4c49-88bb-b37f9e3c895a); Time taken: 0.089 seconds
2024-04-24T01:13:18,023  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011317_c653e74a-8a0a-4c49-88bb-b37f9e3c895a
2024-04-24T01:13:18,028  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T01:13:18,036  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:18,036  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T01:13:18,037  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:18,037  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011318_d6ff04f5-9ac5-42fe-83ea-78fd2b095795): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:18,042  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 3
2024-04-24T01:13:18,042  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T01:13:18,043  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:18,043  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:18,049  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T01:13:18,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:18,052  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:18,052  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:18,052  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:18,052  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:18,052  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getValidWriteIds_(List, String)=6, getDatabase_(String)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:18,052  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011318_d6ff04f5-9ac5-42fe-83ea-78fd2b095795); Time taken: 0.015 seconds
2024-04-24T01:13:18,053  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424011318_d6ff04f5-9ac5-42fe-83ea-78fd2b095795
2024-04-24T01:13:18,053  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011318_d6ff04f5-9ac5-42fe-83ea-78fd2b095795
2024-04-24T01:13:18,071  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011318_d6ff04f5-9ac5-42fe-83ea-78fd2b095795 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T01:13:18,071  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:18,072  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011318_d6ff04f5-9ac5-42fe-83ea-78fd2b095795): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:18,072  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:18,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713946398, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:18,079  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:18,113  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:18,113  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=41}
2024-04-24T01:13:18,114  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011318_d6ff04f5-9ac5-42fe-83ea-78fd2b095795); Time taken: 0.041 seconds
2024-04-24T01:13:18,114  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011318_d6ff04f5-9ac5-42fe-83ea-78fd2b095795
2024-04-24T01:13:18,118  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T01:13:18,123  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:18,124  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T01:13:18,124  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:18,124  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011318_45b5a9f5-c948-4398-9db2-bbe99474275d): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:18,127  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 6
2024-04-24T01:13:18,127  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T01:13:18,128  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:18,128  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:18,131  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T01:13:18,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:18,132  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:18,132  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:18,133  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:18,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:18,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getDatabase_(String)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=10}
2024-04-24T01:13:18,133  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011318_45b5a9f5-c948-4398-9db2-bbe99474275d); Time taken: 0.009 seconds
2024-04-24T01:13:18,133  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424011318_45b5a9f5-c948-4398-9db2-bbe99474275d
2024-04-24T01:13:18,133  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011318_45b5a9f5-c948-4398-9db2-bbe99474275d
2024-04-24T01:13:18,149  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011318_45b5a9f5-c948-4398-9db2-bbe99474275d LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T01:13:18,150  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:18,150  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011318_45b5a9f5-c948-4398-9db2-bbe99474275d): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:18,150  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:18,151  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713946398, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, transactional=false, totalSize=0, numFiles=0, bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:18,157  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:18,180  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:18,180  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=28}
2024-04-24T01:13:18,180  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011318_45b5a9f5-c948-4398-9db2-bbe99474275d); Time taken: 0.03 seconds
2024-04-24T01:13:18,180  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011318_45b5a9f5-c948-4398-9db2-bbe99474275d
2024-04-24T01:13:18,185  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T01:13:18,194  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:18,194  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T01:13:18,195  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(1,4)
2024-04-24T01:13:18,196  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37): insert into Tstage values(0,2),(1,4)
2024-04-24T01:13:18,200  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-24T01:13:18,201  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T01:13:18,202  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:18,202  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:18,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:18,224  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:18,225  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:18,225  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:18,225  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:18,225  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:18,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:18,241  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:18,241  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:18,241  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T01:13:18,270  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:18,365  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:18,365  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:18,366  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:18,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:18,369  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:18,369  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:18,369  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:18,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:18,382  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:18,385  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1
2024-04-24T01:13:18,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:18,390  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:18,394  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:18,400  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T01:13:18,401  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T01:13:18,402  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:18,403  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:18,418  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:18,429  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:18,430  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:18,430  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:18,430  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:18,430  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:18,430  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T01:13:18,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:18,431  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6, getAllTableConstraints_(AllTableConstraintsRequest)=40, flushCache_()=0, getNotNullConstraints_(NotNullConstraintsRequest)=2, getTable_(GetTableRequest)=59, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, getCheckConstraints_(CheckConstraintsRequest)=2}
2024-04-24T01:13:18,431  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37); Time taken: 0.234 seconds
2024-04-24T01:13:18,431  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37
2024-04-24T01:13:18,431  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37
2024-04-24T01:13:18,449  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T01:13:18,449  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:18,449  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37): insert into Tstage values(0,2),(1,4)
2024-04-24T01:13:18,450  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37
2024-04-24T01:13:18,450  INFO [main] ql.Driver: Query ID = alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37
Total jobs = 1
2024-04-24T01:13:18,450  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:18,450  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:18,683  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T01:13:18,683  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:18,683  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:18,683  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:18,683  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:18,683  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:18,683  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:18,683  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:18,685  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:18,685  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T01:13:18,686  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-18_196_8761718605777648293-1/dummy_path
2024-04-24T01:13:18,695  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:18,696  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T01:13:18,701  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:18,702  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T01:13:18,703  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:18,707  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-18_196_8761718605777648293-1/-mr-10001
2024-04-24T01:13:18,711  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:18,719  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:18,723  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:18,724  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T01:13:18,724  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T01:13:18,724  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-18_196_8761718605777648293-1/dummy_path
2024-04-24T01:13:18,725  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:13:18,744  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:13:18,763  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1242246410_0007
2024-04-24T01:13:18,763  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:18,829  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:18,830  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:18,830  INFO [Thread-642] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:18,830  INFO [Thread-642] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:18,831  INFO [Thread-642] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:18,831  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1242246410_0007_m_000000_0
2024-04-24T01:13:18,834  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:18,835  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-18_196_8761718605777648293-1/dummy_path/null:0+1
2024-04-24T01:13:18,837  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:18,838  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T01:13:18,838  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T01:13:18,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:18,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:18,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:18,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:18,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:18,843  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:18,843  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:18,843  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:18,844  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:18,844  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:18,844  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T01:13:18,845  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T01:13:18,845  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:18,845  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T01:13:18,845  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T01:13:18,845  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:18,845  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T01:13:18,846  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T01:13:18,846  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T01:13:18,847  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-24T01:13:18,849  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:18,849  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:18,849  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:18,849  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T01:13:18,849  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:18,861  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:18,867  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1242246410_0007_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:18,867  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:18,867  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1242246410_0007_m_000000_0' done.
2024-04-24T01:13:18,868  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1242246410_0007_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=167135
		FILE: Number of bytes written=8324080
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130364928
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-24T01:13:18,868  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1242246410_0007_m_000000_0
2024-04-24T01:13:18,868  INFO [Thread-642] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:18,869  INFO [Thread-642] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:18,869  INFO [pool-37-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1242246410_0007_r_000000_0
2024-04-24T01:13:18,872  INFO [pool-37-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:18,872  INFO [pool-37-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2695efc2
2024-04-24T01:13:18,872  WARN [pool-37-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:18,873  INFO [pool-37-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:18,873  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1242246410_0007_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:18,876  INFO [localfetcher#5] reduce.LocalFetcher: localfetcher#5 about to shuffle output of map attempt_local1242246410_0007_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-24T01:13:18,876  INFO [localfetcher#5] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1242246410_0007_m_000000_0
2024-04-24T01:13:18,876  INFO [localfetcher#5] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-24T01:13:18,876  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:18,877  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:18,877  INFO [pool-37-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:18,883  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:18,883  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T01:13:18,885  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:18,885  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-24T01:13:18,885  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:18,885  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:18,886  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T01:13:18,886  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:18,886  INFO [pool-37-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:18,887  INFO [pool-37-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T01:13:18,889  INFO [pool-37-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:18,889  INFO [pool-37-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:18,889  INFO [pool-37-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T01:13:18,889  INFO [pool-37-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T01:13:18,890  INFO [pool-37-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1242246410_0007/job_local1242246410_0007.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3bcb48fb
2024-04-24T01:13:18,890  INFO [pool-37-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:18,890  INFO [pool-37-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:18,890  INFO [pool-37-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T01:13:18,890  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-24T01:13:18,890  INFO [pool-37-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/_tmp.-ext-10000/000000_0
2024-04-24T01:13:18,890  INFO [pool-37-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-24T01:13:18,890  INFO [pool-37-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/_tmp.-ext-10000/000000_0
2024-04-24T01:13:18,902  INFO [pool-37-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:0, RECORDS_OUT_1_default.tstage:0, 
2024-04-24T01:13:18,903  INFO [pool-37-thread-1] mapred.Task: Task:attempt_local1242246410_0007_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:18,903  INFO [pool-37-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:18,903  INFO [pool-37-thread-1] mapred.Task: Task 'attempt_local1242246410_0007_r_000000_0' done.
2024-04-24T01:13:18,903  INFO [pool-37-thread-1] mapred.Task: Final Counters for attempt_local1242246410_0007_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=173601
		FILE: Number of bytes written=8324146
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130364928
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:18,903  INFO [pool-37-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1242246410_0007_r_000000_0
2024-04-24T01:13:18,903  INFO [pool-37-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1242246410_0007_r_000001_0
2024-04-24T01:13:18,904  INFO [pool-37-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:18,904  INFO [pool-37-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7e5b8e9b
2024-04-24T01:13:18,904  WARN [pool-37-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:18,905  INFO [pool-37-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:18,906  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1242246410_0007_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:18,908  INFO [localfetcher#6] reduce.LocalFetcher: localfetcher#6 about to shuffle output of map attempt_local1242246410_0007_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T01:13:18,909  INFO [localfetcher#6] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1242246410_0007_m_000000_0
2024-04-24T01:13:18,909  INFO [localfetcher#6] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T01:13:18,909  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:18,909  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:18,910  INFO [pool-37-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:18,918  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:18,918  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T01:13:18,921  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:18,921  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T01:13:18,921  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:18,921  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:18,921  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T01:13:18,921  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:18,922  INFO [pool-37-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:18,923  INFO [pool-37-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T01:13:18,924  INFO [pool-37-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:18,924  INFO [pool-37-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:18,924  INFO [pool-37-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T01:13:18,924  INFO [pool-37-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T01:13:18,925  INFO [pool-37-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1242246410_0007/job_local1242246410_0007.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6fc859b2
2024-04-24T01:13:18,925  INFO [pool-37-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/_tmp.-ext-10000/000001_0
2024-04-24T01:13:18,925  INFO [pool-37-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-24T01:13:18,925  INFO [pool-37-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/_tmp.-ext-10000/000001_0
2024-04-24T01:13:18,926  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T01:13:18,926  INFO [pool-37-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T01:13:18,931  INFO [pool-37-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T01:13:18,931  INFO [pool-37-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:18,931  INFO [pool-37-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:18,931  INFO [pool-37-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T01:13:18,931  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T01:13:18,938  INFO [pool-37-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:18,939  INFO [pool-37-thread-1] mapred.Task: Task:attempt_local1242246410_0007_r_000001_0 is done. And is in the process of committing
2024-04-24T01:13:18,939  INFO [pool-37-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:18,939  INFO [pool-37-thread-1] mapred.Task: Task 'attempt_local1242246410_0007_r_000001_0' done.
2024-04-24T01:13:18,939  INFO [pool-37-thread-1] mapred.Task: Final Counters for attempt_local1242246410_0007_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=180097
		FILE: Number of bytes written=8324534
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130364928
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:18,940  INFO [pool-37-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1242246410_0007_r_000001_0
2024-04-24T01:13:18,940  INFO [Thread-642] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:19,832 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:19,832  INFO [main] exec.Task: 2024-04-24 01:13:19,832 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1242246410_0007
2024-04-24T01:13:19,834  INFO [main] exec.Task: Ended Job = job_local1242246410_0007
2024-04-24T01:13:19,836  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T01:13:19,837  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1/-ext-10000
2024-04-24T01:13:19,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:19,847  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:19,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:19,858  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:19,860  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:19,860  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:19,893  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T01:13:19,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:19,904  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:19,904  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T01:13:19,904  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-18_196_8761718605777648293-1/-mr-10001
2024-04-24T01:13:19,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:19,918  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:19,919  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T01:13:19,919  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T01:13:19,919  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:19,920  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:19,952  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=2, numRows=2, totalSize=252, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T01:13:19,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:19,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=66, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=42}
MapReduce Jobs Launched: 
2024-04-24T01:13:19,952  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:19,953  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:19,953  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:19,953  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37); Time taken: 1.503 seconds
2024-04-24T01:13:19,953  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011318_09f94d23-559f-4c0c-8c53-0259eeb2bb37
2024-04-24T01:13:19,957  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T01:13:19,963  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:19,963  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T01:13:19,964  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:19,964  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1
2024-04-24T01:13:19,964  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-18_196_8761718605777648293-1 on fs with scheme file
2024-04-24T01:13:19,964  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-18_196_8761718605777648293-1
2024-04-24T01:13:19,965  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-18_196_8761718605777648293-1 on fs with scheme file
2024-04-24T01:13:19,965  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011319_dc59d132-94cb-43eb-ab2e-8b0871cbd349): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:19,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:19,976  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:19,978  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T01:13:19,979  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T01:13:19,982  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:19,992  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:19,993  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:19,993  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:19,993  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:19,993  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:19,993  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:19,993  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:19,993  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:19,993  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getCurrentNotificationEventId_()=3, getTable_(GetTableRequest)=22}
2024-04-24T01:13:19,993  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011319_dc59d132-94cb-43eb-ab2e-8b0871cbd349); Time taken: 0.028 seconds
2024-04-24T01:13:19,993  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424011319_dc59d132-94cb-43eb-ab2e-8b0871cbd349
2024-04-24T01:13:19,994  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011319_dc59d132-94cb-43eb-ab2e-8b0871cbd349
2024-04-24T01:13:20,010  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011319_dc59d132-94cb-43eb-ab2e-8b0871cbd349 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T01:13:20,010  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:20,010  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011319_dc59d132-94cb-43eb-ab2e-8b0871cbd349): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:20,010  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:20,011  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:20,011  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:20,011  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:20,011  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:20,021  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:20,032  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:20,032  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:20,032  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011319_dc59d132-94cb-43eb-ab2e-8b0871cbd349); Time taken: 0.022 seconds
2024-04-24T01:13:20,032  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011319_dc59d132-94cb-43eb-ab2e-8b0871cbd349
2024-04-24T01:13:20,037  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T01:13:20,046  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:20,046  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T01:13:20,046  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data'
2024-04-24T01:13:20,047  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011320_bd8d2fb7-8287-44a2-97db-93cbf89bc84d): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data'
2024-04-24T01:13:20,049  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T01:13:20,050  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T01:13:20,050  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:20,058  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:20,068  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 19
2024-04-24T01:13:20,068  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [19])
2024-04-24T01:13:20,069  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:20,069  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:20,069  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:20,069  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=8, allocateTableWriteId_(long, String, String)=7}
2024-04-24T01:13:20,070  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011320_bd8d2fb7-8287-44a2-97db-93cbf89bc84d); Time taken: 0.022 seconds
2024-04-24T01:13:20,070  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424011320_bd8d2fb7-8287-44a2-97db-93cbf89bc84d
2024-04-24T01:13:20,070  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011320_bd8d2fb7-8287-44a2-97db-93cbf89bc84d
2024-04-24T01:13:20,089  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011320_bd8d2fb7-8287-44a2-97db-93cbf89bc84d LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T01:13:20,089  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:20,095  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011320_bd8d2fb7-8287-44a2-97db-93cbf89bc84d): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data'
2024-04-24T01:13:20,095  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:20,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:20,104  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:20,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:20,123  INFO [HMSHandler #8] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:20,174  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T01:13:20,175  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data
2024-04-24T01:13:20,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:20,188  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:20,189  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:20,220  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T01:13:20,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:20,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:20,234  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:20,235  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:20,253  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T01:13:20,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:20,263  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T01:13:20,320  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:20,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:20,369  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:20,370  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=88, getValidWriteIds_(List, String)=1, getTable_(GetTableRequest)=36, getPartitionWithAuthInfo_(String, String, List, String, List)=66, validatePartitionNameCharacters_(List)=0, isCompatibleWith_(Configuration)=1, add_partitions_(List, boolean, boolean)=70}
2024-04-24T01:13:20,370  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011320_bd8d2fb7-8287-44a2-97db-93cbf89bc84d); Time taken: 0.274 seconds
2024-04-24T01:13:20,370  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011320_bd8d2fb7-8287-44a2-97db-93cbf89bc84d
2024-04-24T01:13:20,375  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T01:13:20,382  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:20,382  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T01:13:20,383  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:20,383  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:20,386  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T01:13:20,387  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T01:13:20,387  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:20,387  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:20,394  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:20,394  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:20,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:20,403  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:20,404  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:20,404  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:20,404  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:20,418  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:20,458  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:20,458  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:20,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:20,488  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:20,488  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:20,504  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:20,504  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:20,561  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:20,561  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:20,561  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:20,563  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-20_383_4822974216102685663-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-20_383_4822974216102685663-1
2024-04-24T01:13:20,570  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:20,573  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], KEY.reducesinkkey0=Column[_col1], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T01:13:20,573  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4], VALUE._col0=Column[_col2]}
2024-04-24T01:13:20,574  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:20,584  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:20,584  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:20,584  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:20,584  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:20,585  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:20,585  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:20,585  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:20,585  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:20,585  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T01:13:20,586  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T01:13:20,586  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:20,586  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {listPartitions_(String, String, short)=11, getValidWriteIds_(List, String)=8, openTxn_(String, TxnType)=3, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=25, getAllTableConstraints_(AllTableConstraintsRequest)=33, getValidTxns_(long)=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:20,586  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65); Time taken: 0.203 seconds
2024-04-24T01:13:20,586  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65
2024-04-24T01:13:20,587  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65
2024-04-24T01:13:20,604  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T01:13:20,604  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:20,605  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:20,605  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65
2024-04-24T01:13:20,605  INFO [main] ql.Driver: Query ID = alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65
Total jobs = 1
2024-04-24T01:13:20,605  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:20,605  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:20,782  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:20,782  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:20,782  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:20,782  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:20,782  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:20,782  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:20,782  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:20,782  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:20,785  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:20,785  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:20,785  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:20,795  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:20,796  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,34KB
2024-04-24T01:13:20,803  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:20,817  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T01:13:20,819  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:20,828  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:20,842  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:20,847  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:20,849  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:20,849  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:20,849  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:20,849  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:20,850  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T01:13:20,850  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:20,862  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T01:13:20,863  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 1). duration: 14 ms
2024-04-24T01:13:20,863  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:13:20,887  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:13:20,913  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local30649203_0008
2024-04-24T01:13:20,913  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:20,982  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:20,982  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:20,982  INFO [Thread-723] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:20,982  INFO [Thread-723] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:20,984  INFO [Thread-723] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:20,984  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local30649203_0008_m_000000_0
2024-04-24T01:13:20,984  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:20,985  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:20,985  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:20,987  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,34KB
2024-04-24T01:13:20,988  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T01:13:20,988  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0 with {include: [true, true, true], offset: 0, length: 252, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:20,996  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T01:13:20,996  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:21,010  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:21,010  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:21,010  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:21,010  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:21,010  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:21,011  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:21,011  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:21,012  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:21,013  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:21,013  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:21,013  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T01:13:21,013  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:21,013  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:21,014  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:21,015  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:21,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:21,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:21,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T01:13:21,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:21,026  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:21,029  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local30649203_0008_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:21,030  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:21,030  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local30649203_0008_m_000000_0' done.
2024-04-24T01:13:21,030  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local30649203_0008_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=188107
		FILE: Number of bytes written=9504295
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=8
		Total committed heap usage (bytes)=1110441984
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=6464
2024-04-24T01:13:21,030  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local30649203_0008_m_000000_0
2024-04-24T01:13:21,030  INFO [Thread-723] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:21,031  INFO [Thread-723] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:21,031  INFO [pool-43-thread-1] mapred.LocalJobRunner: Starting task: attempt_local30649203_0008_r_000000_0
2024-04-24T01:13:21,032  INFO [pool-43-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:21,032  INFO [pool-43-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4caef5ec
2024-04-24T01:13:21,032  WARN [pool-43-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:21,033  INFO [pool-43-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:21,033  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local30649203_0008_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:21,034  INFO [localfetcher#7] reduce.LocalFetcher: localfetcher#7 about to shuffle output of map attempt_local30649203_0008_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-24T01:13:21,034  INFO [localfetcher#7] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local30649203_0008_m_000000_0
2024-04-24T01:13:21,034  INFO [localfetcher#7] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-24T01:13:21,035  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:21,035  INFO [pool-43-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:21,035  INFO [pool-43-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:21,041  INFO [pool-43-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:21,041  INFO [pool-43-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-24T01:13:21,044  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 412 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:21,044  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merging 1 files, 416 bytes from disk
2024-04-24T01:13:21,044  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:21,044  INFO [pool-43-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:21,044  INFO [pool-43-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-24T01:13:21,044  INFO [pool-43-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:21,045  INFO [pool-43-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:21,048  INFO [pool-43-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T01:13:21,049  INFO [pool-43-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:21,049  INFO [pool-43-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:21,049  INFO [pool-43-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-24T01:13:21,050  INFO [pool-43-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:21,050  INFO [pool-43-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@417966b6, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@2c79008>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@3a923bea, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@229538aa
2024-04-24T01:13:21,050  INFO [pool-43-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-20_383_4822974216102685663-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-20_383_4822974216102685663-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:21,050  INFO [pool-43-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-20_383_4822974216102685663-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-20_383_4822974216102685663-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:21,050  INFO [pool-43-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-20_383_4822974216102685663-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-20_383_4822974216102685663-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:21,058  INFO [pool-43-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:21,058  INFO [pool-43-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:21,058  INFO [pool-43-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:21,058  INFO [pool-43-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:21,058  INFO [pool-43-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T01:13:21,059  INFO [pool-43-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_0:2, 
2024-04-24T01:13:21,059  INFO [pool-43-thread-1] mapred.Task: Task:attempt_local30649203_0008_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:21,059  INFO [pool-43-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:21,059  INFO [pool-43-thread-1] mapred.Task: Task 'attempt_local30649203_0008_r_000000_0' done.
2024-04-24T01:13:21,059  INFO [pool-43-thread-1] mapred.Task: Final Counters for attempt_local30649203_0008_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=195252
		FILE: Number of bytes written=9505196
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=416
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1110441984
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:21,060  INFO [pool-43-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local30649203_0008_r_000000_0
2024-04-24T01:13:21,060  INFO [Thread-723] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:21,983 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:21,983  INFO [main] exec.Task: 2024-04-24 01:13:21,983 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local30649203_0008
2024-04-24T01:13:21,984  INFO [main] exec.Task: Ended Job = job_local30649203_0008
2024-04-24T01:13:21,986  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:21,986  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:21,987  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:21,987  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:21,987  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:21,987  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65); Time taken: 1.381 seconds
2024-04-24T01:13:21,987  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011320_f6d3dfc0-27ec-4690-b550-29c864efbd65
2024-04-24T01:13:21,992  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T01:13:21,999  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:21,999  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T01:13:22,003  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:22,004  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T01:13:22,004  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:2, 
2024-04-24T01:13:22,004  WARN [main] ql.TestTxnAddPartition: addPartitionBucketed: read data(add partition (p=0)): 
2024-04-24T01:13:22,004  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536936448,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0
{"writeid":1,"bucketid":536936448,"rowid":1}	0	1	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0

2024-04-24T01:13:22,004  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:22,004  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-20_383_4822974216102685663-1
2024-04-24T01:13:22,005  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/88bcec10-c6ba-40ee-ac84-4470c6123193/hive_2024-04-24_01-13-20_383_4822974216102685663-1 on fs with scheme file
2024-04-24T01:13:22,005  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_ad16603c-097e-4206-a4d6-2faeccfae7b9): drop table if exists acidTbl
2024-04-24T01:13:22,009  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-24T01:13:22,009  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T01:13:22,010  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:22,017  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,017  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,017  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,017  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,017  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13}
2024-04-24T01:13:22,017  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_ad16603c-097e-4206-a4d6-2faeccfae7b9); Time taken: 0.012 seconds
2024-04-24T01:13:22,018  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424011322_ad16603c-097e-4206-a4d6-2faeccfae7b9
2024-04-24T01:13:22,018  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011322_ad16603c-097e-4206-a4d6-2faeccfae7b9
2024-04-24T01:13:22,033  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011322_ad16603c-097e-4206-a4d6-2faeccfae7b9 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T01:13:22,033  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:22,033  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_ad16603c-097e-4206-a4d6-2faeccfae7b9): drop table if exists acidTbl
2024-04-24T01:13:22,033  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,033  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:22,041  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:22,049  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:22,179  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,179  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=137, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-24T01:13:22,179  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_ad16603c-097e-4206-a4d6-2faeccfae7b9); Time taken: 0.146 seconds
2024-04-24T01:13:22,179  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_ad16603c-097e-4206-a4d6-2faeccfae7b9
2024-04-24T01:13:22,185  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T01:13:22,193  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,194  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T01:13:22,194  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:22,195  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_3c5cbe42-b1af-4fba-89ae-004797d06163): drop table if exists acidTblPart
2024-04-24T01:13:22,198  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 21
2024-04-24T01:13:22,199  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T01:13:22,200  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:22,211  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,212  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,212  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,212  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,212  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=12, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=15}
2024-04-24T01:13:22,212  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_3c5cbe42-b1af-4fba-89ae-004797d06163); Time taken: 0.017 seconds
2024-04-24T01:13:22,213  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424011322_3c5cbe42-b1af-4fba-89ae-004797d06163
2024-04-24T01:13:22,214  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011322_3c5cbe42-b1af-4fba-89ae-004797d06163
2024-04-24T01:13:22,234  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011322_3c5cbe42-b1af-4fba-89ae-004797d06163 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T01:13:22,234  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:22,234  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_3c5cbe42-b1af-4fba-89ae-004797d06163): drop table if exists acidTblPart
2024-04-24T01:13:22,234  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,235  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:22,243  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:22,256  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:22,305  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,305  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=62, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8}
2024-04-24T01:13:22,305  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_3c5cbe42-b1af-4fba-89ae-004797d06163); Time taken: 0.071 seconds
2024-04-24T01:13:22,305  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_3c5cbe42-b1af-4fba-89ae-004797d06163
2024-04-24T01:13:22,310  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T01:13:22,316  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,316  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T01:13:22,316  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:22,317  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_e9250aa2-d52d-4482-8892-b7e4da2b1adf): drop table if exists acidTbl2
2024-04-24T01:13:22,319  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 21
2024-04-24T01:13:22,319  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T01:13:22,321  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,321  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,321  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,321  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, flushCache_()=0, getTable_(GetTableRequest)=1}
2024-04-24T01:13:22,321  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_e9250aa2-d52d-4482-8892-b7e4da2b1adf); Time taken: 0.004 seconds
2024-04-24T01:13:22,322  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424011322_e9250aa2-d52d-4482-8892-b7e4da2b1adf
2024-04-24T01:13:22,322  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:22,322  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_e9250aa2-d52d-4482-8892-b7e4da2b1adf): drop table if exists acidTbl2
2024-04-24T01:13:22,322  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,323  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T01:13:22,323  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,323  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-24T01:13:22,324  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_e9250aa2-d52d-4482-8892-b7e4da2b1adf); Time taken: 0.001 seconds
2024-04-24T01:13:22,324  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_e9250aa2-d52d-4482-8892-b7e4da2b1adf
2024-04-24T01:13:22,329  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T01:13:22,335  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,336  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T01:13:22,336  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:22,336  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_9a7c63dd-9fd3-4796-ba91-36a7e74372b2): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:22,339  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 21
2024-04-24T01:13:22,339  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T01:13:22,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:22,368  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,369  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,369  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,369  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,369  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=28, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2}
2024-04-24T01:13:22,369  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_9a7c63dd-9fd3-4796-ba91-36a7e74372b2); Time taken: 0.033 seconds
2024-04-24T01:13:22,369  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424011322_9a7c63dd-9fd3-4796-ba91-36a7e74372b2
2024-04-24T01:13:22,370  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011322_9a7c63dd-9fd3-4796-ba91-36a7e74372b2
2024-04-24T01:13:22,385  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011322_9a7c63dd-9fd3-4796-ba91-36a7e74372b2 LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T01:13:22,385  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:22,385  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_9a7c63dd-9fd3-4796-ba91-36a7e74372b2): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:22,385  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:22,395  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:22,405  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,405  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:22,505  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,506  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=11, dropTable_(String, String, boolean, boolean, boolean)=109}
2024-04-24T01:13:22,506  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_9a7c63dd-9fd3-4796-ba91-36a7e74372b2); Time taken: 0.12 seconds
2024-04-24T01:13:22,506  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_9a7c63dd-9fd3-4796-ba91-36a7e74372b2
2024-04-24T01:13:22,510  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-24T01:13:22,516  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,517  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-24T01:13:22,518  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:22,518  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_9507f6f3-78ca-4446-b6d4-8a5eb77646ba): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:22,521  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 21
2024-04-24T01:13:22,521  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T01:13:22,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:22,531  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,531  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,531  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,531  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,532  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=9, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T01:13:22,532  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_9507f6f3-78ca-4446-b6d4-8a5eb77646ba); Time taken: 0.013 seconds
2024-04-24T01:13:22,532  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424011322_9507f6f3-78ca-4446-b6d4-8a5eb77646ba
2024-04-24T01:13:22,533  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011322_9507f6f3-78ca-4446-b6d4-8a5eb77646ba
2024-04-24T01:13:22,552  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011322_9507f6f3-78ca-4446-b6d4-8a5eb77646ba LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T01:13:22,552  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:22,552  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_9507f6f3-78ca-4446-b6d4-8a5eb77646ba): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:22,553  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,553  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:22,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:22,575  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,575  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:22,611  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,611  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=46, getTable_(GetTableRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,611  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_9507f6f3-78ca-4446-b6d4-8a5eb77646ba); Time taken: 0.059 seconds
2024-04-24T01:13:22,611  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_9507f6f3-78ca-4446-b6d4-8a5eb77646ba
2024-04-24T01:13:22,615  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T01:13:22,622  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,622  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T01:13:22,622  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:22,623  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_ed5c4d8c-1f27-43ed-b47c-1c86362925d3): drop table if exists nonAcidNonBucket
2024-04-24T01:13:22,626  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 21
2024-04-24T01:13:22,626  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T01:13:22,627  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:22,636  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,636  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,636  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,636  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,637  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9, flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10}
2024-04-24T01:13:22,637  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_ed5c4d8c-1f27-43ed-b47c-1c86362925d3); Time taken: 0.013 seconds
2024-04-24T01:13:22,637  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424011322_ed5c4d8c-1f27-43ed-b47c-1c86362925d3
2024-04-24T01:13:22,638  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011322_ed5c4d8c-1f27-43ed-b47c-1c86362925d3
2024-04-24T01:13:22,653  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011322_ed5c4d8c-1f27-43ed-b47c-1c86362925d3 LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T01:13:22,653  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:22,653  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_ed5c4d8c-1f27-43ed-b47c-1c86362925d3): drop table if exists nonAcidNonBucket
2024-04-24T01:13:22,653  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:22,663  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,663  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:22,673  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:22,674  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:22,710  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,711  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=47, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,711  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_ed5c4d8c-1f27-43ed-b47c-1c86362925d3); Time taken: 0.057 seconds
2024-04-24T01:13:22,711  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_ed5c4d8c-1f27-43ed-b47c-1c86362925d3
2024-04-24T01:13:22,715  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T01:13:22,723  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,724  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T01:13:22,724  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T01:13:22,808  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T01:13:22,809  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T01:13:22,811  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 22549cb4-a6a5-4a88-adc0-505919c5d058
2024-04-24T01:13:22,813  INFO [main] SessionState: Hive Session ID = 22549cb4-a6a5-4a88-adc0-505919c5d058
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:22,814  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:22,819  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/22549cb4-a6a5-4a88-adc0-505919c5d058
2024-04-24T01:13:22,822  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/22549cb4-a6a5-4a88-adc0-505919c5d058
2024-04-24T01:13:22,824  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/22549cb4-a6a5-4a88-adc0-505919c5d058/_tmp_space.db
2024-04-24T01:13:22,824  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=22549cb4-a6a5-4a88-adc0-505919c5d058, clientType=HIVECLI]
2024-04-24T01:13:22,825  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:22,825  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_59094ea4-45cd-46a4-bb38-2bbbb572cef4): drop table if exists acidTbl
2024-04-24T01:13:22,837  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T01:13:22,837  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T01:13:22,840  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:22,844  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,844  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,844  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,844  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=11, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=13}
2024-04-24T01:13:22,844  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_59094ea4-45cd-46a4-bb38-2bbbb572cef4); Time taken: 0.019 seconds
2024-04-24T01:13:22,845  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424011322_59094ea4-45cd-46a4-bb38-2bbbb572cef4
2024-04-24T01:13:22,845  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:22,845  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_59094ea4-45cd-46a4-bb38-2bbbb572cef4): drop table if exists acidTbl
2024-04-24T01:13:22,845  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,845  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:22,849  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,849  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,849  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_59094ea4-45cd-46a4-bb38-2bbbb572cef4); Time taken: 0.003 seconds
2024-04-24T01:13:22,849  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_59094ea4-45cd-46a4-bb38-2bbbb572cef4
2024-04-24T01:13:22,855  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T01:13:22,862  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,862  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T01:13:22,863  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:22,864  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_3fd1ba81-05d6-47cd-8d11-c4cbd4d5e4e0): drop table if exists acidTblPart
2024-04-24T01:13:22,866  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T01:13:22,866  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T01:13:22,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:22,870  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,870  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,870  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,870  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,871  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_3fd1ba81-05d6-47cd-8d11-c4cbd4d5e4e0); Time taken: 0.006 seconds
2024-04-24T01:13:22,871  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424011322_3fd1ba81-05d6-47cd-8d11-c4cbd4d5e4e0
2024-04-24T01:13:22,871  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:22,871  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_3fd1ba81-05d6-47cd-8d11-c4cbd4d5e4e0): drop table if exists acidTblPart
2024-04-24T01:13:22,871  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:22,874  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,875  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,875  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_3fd1ba81-05d6-47cd-8d11-c4cbd4d5e4e0); Time taken: 0.003 seconds
2024-04-24T01:13:22,875  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_3fd1ba81-05d6-47cd-8d11-c4cbd4d5e4e0
2024-04-24T01:13:22,880  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T01:13:22,887  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,887  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T01:13:22,888  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:22,888  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_cacde236-d772-4c6d-9627-17613b4c727b): drop table if exists acidTbl2
2024-04-24T01:13:22,890  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T01:13:22,891  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T01:13:22,891  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:22,894  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,894  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,894  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,895  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,895  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_cacde236-d772-4c6d-9627-17613b4c727b); Time taken: 0.006 seconds
2024-04-24T01:13:22,895  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424011322_cacde236-d772-4c6d-9627-17613b4c727b
2024-04-24T01:13:22,895  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:22,895  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_cacde236-d772-4c6d-9627-17613b4c727b): drop table if exists acidTbl2
2024-04-24T01:13:22,895  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:22,899  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,899  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,899  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_cacde236-d772-4c6d-9627-17613b4c727b); Time taken: 0.004 seconds
2024-04-24T01:13:22,899  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_cacde236-d772-4c6d-9627-17613b4c727b
2024-04-24T01:13:22,904  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T01:13:22,910  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,910  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T01:13:22,910  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:22,911  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_79810888-118b-466c-8dd5-fd879f239d26): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:22,913  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T01:13:22,913  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T01:13:22,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:22,917  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,917  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,917  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,917  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-24T01:13:22,917  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_79810888-118b-466c-8dd5-fd879f239d26); Time taken: 0.007 seconds
2024-04-24T01:13:22,917  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424011322_79810888-118b-466c-8dd5-fd879f239d26
2024-04-24T01:13:22,917  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:22,917  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_79810888-118b-466c-8dd5-fd879f239d26): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:22,918  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:22,921  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,921  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,921  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_79810888-118b-466c-8dd5-fd879f239d26); Time taken: 0.004 seconds
2024-04-24T01:13:22,921  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_79810888-118b-466c-8dd5-fd879f239d26
2024-04-24T01:13:22,926  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T01:13:22,932  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,932  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T01:13:22,933  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:22,933  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_9e1d1ce6-522e-4694-8ccb-1ff79b4a3951): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:22,935  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T01:13:22,936  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T01:13:22,936  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:22,940  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,940  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,940  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,940  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0}
2024-04-24T01:13:22,940  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_9e1d1ce6-522e-4694-8ccb-1ff79b4a3951); Time taken: 0.007 seconds
2024-04-24T01:13:22,940  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424011322_9e1d1ce6-522e-4694-8ccb-1ff79b4a3951
2024-04-24T01:13:22,940  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:22,940  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_9e1d1ce6-522e-4694-8ccb-1ff79b4a3951): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:22,940  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:22,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:22,944  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_9e1d1ce6-522e-4694-8ccb-1ff79b4a3951); Time taken: 0.004 seconds
2024-04-24T01:13:22,944  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_9e1d1ce6-522e-4694-8ccb-1ff79b4a3951
2024-04-24T01:13:22,949  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T01:13:22,955  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,955  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T01:13:22,956  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:22,956  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_2ddc7698-4de5-4ad8-bc1d-ce85c7663523): drop table if exists nonAcidNonBucket
2024-04-24T01:13:22,958  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T01:13:22,959  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T01:13:22,959  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:22,962  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,962  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,963  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,963  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:22,963  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_2ddc7698-4de5-4ad8-bc1d-ce85c7663523); Time taken: 0.007 seconds
2024-04-24T01:13:22,963  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424011322_2ddc7698-4de5-4ad8-bc1d-ce85c7663523
2024-04-24T01:13:22,963  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:22,963  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_2ddc7698-4de5-4ad8-bc1d-ce85c7663523): drop table if exists nonAcidNonBucket
2024-04-24T01:13:22,963  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:22,964  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:22,967  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:22,967  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:22,967  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_2ddc7698-4de5-4ad8-bc1d-ce85c7663523); Time taken: 0.004 seconds
2024-04-24T01:13:22,967  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_2ddc7698-4de5-4ad8-bc1d-ce85c7663523
2024-04-24T01:13:22,974  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T01:13:22,982  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:22,982  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T01:13:22,983  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:22,983  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011322_263cccad-a401-4c0a-81af-2cefcb036b0d): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:22,986  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T01:13:22,986  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T01:13:22,987  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:22,987  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:22,992  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T01:13:22,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:22,995  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:22,995  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:22,995  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:22,995  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:22,995  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getDatabase_(String)=1, getValidWriteIds_(List, String)=5, flushCache_()=0}
2024-04-24T01:13:22,995  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011322_263cccad-a401-4c0a-81af-2cefcb036b0d); Time taken: 0.012 seconds
2024-04-24T01:13:22,995  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424011322_263cccad-a401-4c0a-81af-2cefcb036b0d
2024-04-24T01:13:22,995  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011322_263cccad-a401-4c0a-81af-2cefcb036b0d
2024-04-24T01:13:23,016  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011322_263cccad-a401-4c0a-81af-2cefcb036b0d LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T01:13:23,016  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:23,017  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011322_263cccad-a401-4c0a-81af-2cefcb036b0d): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:23,017  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,018  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713946403, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, totalSize=0, numFilesErasureCoded=0, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:23,025  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtbl
2024-04-24T01:13:23,070  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,071  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=52}
2024-04-24T01:13:23,071  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011322_263cccad-a401-4c0a-81af-2cefcb036b0d); Time taken: 0.053 seconds
2024-04-24T01:13:23,071  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011322_263cccad-a401-4c0a-81af-2cefcb036b0d
2024-04-24T01:13:23,075  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T01:13:23,082  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,082  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T01:13:23,082  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:23,083  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_9017238a-c531-4286-a1dd-d8bc932f13a5): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:23,087  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T01:13:23,087  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T01:13:23,088  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:23,088  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:23,091  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T01:13:23,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:23,094  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:23,094  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,094  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,094  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,094  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, getValidWriteIds_(List, String)=3}
2024-04-24T01:13:23,094  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_9017238a-c531-4286-a1dd-d8bc932f13a5); Time taken: 0.011 seconds
2024-04-24T01:13:23,094  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424011323_9017238a-c531-4286-a1dd-d8bc932f13a5
2024-04-24T01:13:23,094  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_9017238a-c531-4286-a1dd-d8bc932f13a5
2024-04-24T01:13:23,110  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_9017238a-c531-4286-a1dd-d8bc932f13a5 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T01:13:23,110  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:23,110  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_9017238a-c531-4286-a1dd-d8bc932f13a5): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:23,111  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,111  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713946403, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:23,118  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtblpart
2024-04-24T01:13:23,137  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,137  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=26}
2024-04-24T01:13:23,137  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_9017238a-c531-4286-a1dd-d8bc932f13a5); Time taken: 0.027 seconds
2024-04-24T01:13:23,137  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_9017238a-c531-4286-a1dd-d8bc932f13a5
2024-04-24T01:13:23,143  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T01:13:23,150  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,150  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T01:13:23,150  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,151  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_9679606c-b029-4933-aba0-7b27429dcaa0): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,153  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T01:13:23,153  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T01:13:23,154  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:23,154  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:23,157  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T01:13:23,157  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:23,159  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:23,159  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,159  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,159  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,159  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13, getDatabase_(String)=2, getValidTxns_(long)=0}
2024-04-24T01:13:23,159  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_9679606c-b029-4933-aba0-7b27429dcaa0); Time taken: 0.008 seconds
2024-04-24T01:13:23,159  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424011323_9679606c-b029-4933-aba0-7b27429dcaa0
2024-04-24T01:13:23,160  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_9679606c-b029-4933-aba0-7b27429dcaa0
2024-04-24T01:13:23,182  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_9679606c-b029-4933-aba0-7b27429dcaa0 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T01:13:23,182  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:23,182  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_9679606c-b029-4933-aba0-7b27429dcaa0): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,182  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,183  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713946403, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, bucketing_version=2, rawDataSize=0, numRows=0, totalSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:23,194  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl
2024-04-24T01:13:23,219  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,220  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=36}
2024-04-24T01:13:23,220  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_9679606c-b029-4933-aba0-7b27429dcaa0); Time taken: 0.037 seconds
2024-04-24T01:13:23,220  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_9679606c-b029-4933-aba0-7b27429dcaa0
2024-04-24T01:13:23,226  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T01:13:23,234  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,234  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T01:13:23,235  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,235  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_8dd2001f-a778-465d-b24f-10b74e5bbf5e): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,237  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T01:13:23,238  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T01:13:23,238  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:23,238  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:23,241  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T01:13:23,241  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:23,243  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:23,243  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,243  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,243  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,243  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0}
2024-04-24T01:13:23,243  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_8dd2001f-a778-465d-b24f-10b74e5bbf5e); Time taken: 0.008 seconds
2024-04-24T01:13:23,244  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424011323_8dd2001f-a778-465d-b24f-10b74e5bbf5e
2024-04-24T01:13:23,244  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_8dd2001f-a778-465d-b24f-10b74e5bbf5e
2024-04-24T01:13:23,266  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_8dd2001f-a778-465d-b24f-10b74e5bbf5e LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T01:13:23,266  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:23,266  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_8dd2001f-a778-465d-b24f-10b74e5bbf5e): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,266  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,267  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713946403, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=false, numRows=0, rawDataSize=0, numFilesErasureCoded=0, totalSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:23,278  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl2
2024-04-24T01:13:23,302  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,302  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=35}
2024-04-24T01:13:23,303  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_8dd2001f-a778-465d-b24f-10b74e5bbf5e); Time taken: 0.036 seconds
2024-04-24T01:13:23,303  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_8dd2001f-a778-465d-b24f-10b74e5bbf5e
2024-04-24T01:13:23,307  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T01:13:23,314  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,314  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T01:13:23,314  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:23,315  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_cd0697e2-4be3-40af-b3b4-26b87b775564): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:23,317  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T01:13:23,318  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T01:13:23,318  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:23,318  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:23,321  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T01:13:23,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:23,323  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:23,323  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,323  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,323  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,323  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3}
2024-04-24T01:13:23,323  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_cd0697e2-4be3-40af-b3b4-26b87b775564); Time taken: 0.008 seconds
2024-04-24T01:13:23,324  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424011323_cd0697e2-4be3-40af-b3b4-26b87b775564
2024-04-24T01:13:23,324  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_cd0697e2-4be3-40af-b3b4-26b87b775564
2024-04-24T01:13:23,341  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_cd0697e2-4be3-40af-b3b4-26b87b775564 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T01:13:23,342  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:23,342  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_cd0697e2-4be3-40af-b3b4-26b87b775564): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:23,342  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,344  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/22549cb4-a6a5-4a88-adc0-505919c5d058/_tmp_space.db/d5cfde45-427c-4dca-a975-92438917bb83
2024-04-24T01:13:23,346  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,347  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-24T01:13:23,347  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_cd0697e2-4be3-40af-b3b4-26b87b775564); Time taken: 0.004 seconds
2024-04-24T01:13:23,347  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_cd0697e2-4be3-40af-b3b4-26b87b775564
2024-04-24T01:13:23,351  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T01:13:23,357  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,357  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T01:13:23,358  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,358  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_09e07cd6-a6bc-4a74-ba69-835635e2eadb): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,361  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T01:13:23,361  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T01:13:23,362  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:23,362  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:23,364  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T01:13:23,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:23,366  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:23,366  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,366  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,366  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,366  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T01:13:23,367  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_09e07cd6-a6bc-4a74-ba69-835635e2eadb); Time taken: 0.008 seconds
2024-04-24T01:13:23,367  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424011323_09e07cd6-a6bc-4a74-ba69-835635e2eadb
2024-04-24T01:13:23,367  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_09e07cd6-a6bc-4a74-ba69-835635e2eadb
2024-04-24T01:13:23,383  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_09e07cd6-a6bc-4a74-ba69-835635e2eadb LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T01:13:23,383  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:23,383  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_09e07cd6-a6bc-4a74-ba69-835635e2eadb): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:23,383  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713946403, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, totalSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, bucketing_version=2, numFiles=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:23,392  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidnonbucket
2024-04-24T01:13:23,412  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,412  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=26}
2024-04-24T01:13:23,412  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_09e07cd6-a6bc-4a74-ba69-835635e2eadb); Time taken: 0.029 seconds
2024-04-24T01:13:23,412  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_09e07cd6-a6bc-4a74-ba69-835635e2eadb
2024-04-24T01:13:23,416  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T01:13:23,424  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,424  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T01:13:23,431  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T01:13:23,431  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_7b4478f7-875b-4332-951e-ff5eedc6b870): drop table if exists T
2024-04-24T01:13:23,434  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T01:13:23,434  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T01:13:23,435  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:23,457  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:23,457  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,457  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,457  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,457  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=22, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:23,458  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_7b4478f7-875b-4332-951e-ff5eedc6b870); Time taken: 0.026 seconds
2024-04-24T01:13:23,458  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424011323_7b4478f7-875b-4332-951e-ff5eedc6b870
2024-04-24T01:13:23,458  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_7b4478f7-875b-4332-951e-ff5eedc6b870
2024-04-24T01:13:23,479  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_7b4478f7-875b-4332-951e-ff5eedc6b870 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T01:13:23,479  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:23,480  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_7b4478f7-875b-4332-951e-ff5eedc6b870): drop table if exists T
2024-04-24T01:13:23,480  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,480  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:23,488  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:23,488  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:23,496  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:23,497  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T01:13:23,680  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t does not exist; Force to delete it.
2024-04-24T01:13:23,680 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:23,681  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,681  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=193}
2024-04-24T01:13:23,681  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_7b4478f7-875b-4332-951e-ff5eedc6b870); Time taken: 0.201 seconds
2024-04-24T01:13:23,681  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_7b4478f7-875b-4332-951e-ff5eedc6b870
2024-04-24T01:13:23,687  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T01:13:23,696  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,697  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T01:13:23,700  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T01:13:23,701  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_49480fd1-14a4-4797-bdfc-64484cd532e2): drop table if exists Tstage
2024-04-24T01:13:23,704  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T01:13:23,704  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T01:13:23,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:23,736  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:23,736  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,736  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,736  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,736  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=18, getTable_(GetTableRequest)=31, openTxn_(String, TxnType)=3}
2024-04-24T01:13:23,736  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_49480fd1-14a4-4797-bdfc-64484cd532e2); Time taken: 0.035 seconds
2024-04-24T01:13:23,737  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424011323_49480fd1-14a4-4797-bdfc-64484cd532e2
2024-04-24T01:13:23,738  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_49480fd1-14a4-4797-bdfc-64484cd532e2
2024-04-24T01:13:23,765  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_49480fd1-14a4-4797-bdfc-64484cd532e2 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T01:13:23,765  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:23,766  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_49480fd1-14a4-4797-bdfc-64484cd532e2): drop table if exists Tstage
2024-04-24T01:13:23,766  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:23,784  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:23,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:23,802  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:23,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T01:13:23,863  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage does not exist; Force to delete it.
2024-04-24T01:13:23,863 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:23,863  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,863  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=78, getTable_(GetTableRequest)=18, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:23,864  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_49480fd1-14a4-4797-bdfc-64484cd532e2); Time taken: 0.097 seconds
2024-04-24T01:13:23,864  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_49480fd1-14a4-4797-bdfc-64484cd532e2
2024-04-24T01:13:23,870  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T01:13:23,880  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,880  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T01:13:23,881  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:23,881  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_0bf4d087-a70c-45fb-bc76-f0b0d0c7b48b): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:23,885  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 3
2024-04-24T01:13:23,886  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T01:13:23,887  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:23,887  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:23,894  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T01:13:23,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:23,898  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:23,898  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,898  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,898  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,898  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=7, getDatabase_(String)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=17, getValidTxns_(long)=1}
2024-04-24T01:13:23,898  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_0bf4d087-a70c-45fb-bc76-f0b0d0c7b48b); Time taken: 0.017 seconds
2024-04-24T01:13:23,899  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424011323_0bf4d087-a70c-45fb-bc76-f0b0d0c7b48b
2024-04-24T01:13:23,899  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_0bf4d087-a70c-45fb-bc76-f0b0d0c7b48b
2024-04-24T01:13:23,923  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_0bf4d087-a70c-45fb-bc76-f0b0d0c7b48b LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T01:13:23,923  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:23,924  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_0bf4d087-a70c-45fb-bc76-f0b0d0c7b48b): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:23,924  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:23,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713946403, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:23,931  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:23,969  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:23,969  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=45}
2024-04-24T01:13:23,970  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_0bf4d087-a70c-45fb-bc76-f0b0d0c7b48b); Time taken: 0.045 seconds
2024-04-24T01:13:23,970  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_0bf4d087-a70c-45fb-bc76-f0b0d0c7b48b
2024-04-24T01:13:23,976  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T01:13:23,985  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:23,985  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T01:13:23,986  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:23,986  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011323_fa08281e-02bc-461b-b7da-3dd7f8e7a0f9): create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:23,990  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-24T01:13:23,991  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T01:13:23,992  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:23,992  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:23,996  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T01:13:23,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:23,999  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:23,999  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:23,999  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:23,999  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:23,999  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0, getValidWriteIds_(List, String)=4}
2024-04-24T01:13:23,999  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011323_fa08281e-02bc-461b-b7da-3dd7f8e7a0f9); Time taken: 0.013 seconds
2024-04-24T01:13:24,000  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424011323_fa08281e-02bc-461b-b7da-3dd7f8e7a0f9
2024-04-24T01:13:24,000  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011323_fa08281e-02bc-461b-b7da-3dd7f8e7a0f9
2024-04-24T01:13:24,022  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011323_fa08281e-02bc-461b-b7da-3dd7f8e7a0f9 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T01:13:24,022  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:24,023  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011323_fa08281e-02bc-461b-b7da-3dd7f8e7a0f9): create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:24,023  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:24,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713946404, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:24,034  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:24,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:24,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=38}
2024-04-24T01:13:24,063  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011323_fa08281e-02bc-461b-b7da-3dd7f8e7a0f9); Time taken: 0.039 seconds
2024-04-24T01:13:24,063  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011323_fa08281e-02bc-461b-b7da-3dd7f8e7a0f9
2024-04-24T01:13:24,068  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T01:13:24,077  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:24,077  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T01:13:24,078  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-24T01:13:24,078  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3): insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-24T01:13:24,082  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-24T01:13:24,082  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T01:13:24,083  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:24,083  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:24,087  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:24,099  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:24,099  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:24,099  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:24,099  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:24,099  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:24,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:24,111  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:24,112  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T01:13:24,125  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:24,125  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T01:13:24,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:24,245  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:24,245  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:24,245  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:24,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:24,249  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:24,249  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:24,249  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:24,249  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:24,257  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:24,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T01:13:24,265  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:24,267  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:24,278  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 17
2024-04-24T01:13:24,279  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=tstage (txnIds: [17])
2024-04-24T01:13:24,280  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:24,283  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T01:13:24,284  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T01:13:24,285  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:24,286  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:24,295  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:24,303  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:24,304  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:24,304  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:24,304  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:24,304  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:24,305  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_ps_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T01:13:24,322  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T01:13:24,322  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:24,322  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=2, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=14, getNotNullConstraints_(NotNullConstraintsRequest)=2, listPartitionsWithAuthInfo_(String, String, List, short, String, List)=17, allocateTableWriteId_(long, String, String)=9, getAllTableConstraints_(AllTableConstraintsRequest)=30, getValidWriteIds_(List, String)=6, flushCache_()=0, getTable_(GetTableRequest)=41}
2024-04-24T01:13:24,322  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3); Time taken: 0.244 seconds
2024-04-24T01:13:24,323  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3
2024-04-24T01:13:24,323  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3
2024-04-24T01:13:24,348  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T01:13:24,348  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:24,351  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3): insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-24T01:13:24,352  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3
2024-04-24T01:13:24,352  INFO [main] ql.Driver: Query ID = alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3
Total jobs = 1
2024-04-24T01:13:24,352  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:24,352  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:24,549  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T01:13:24,549  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:24,549  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:24,549  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:24,549  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:24,549  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:24,549  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:24,549  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:24,551  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:24,551  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T01:13:24,552  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/22549cb4-a6a5-4a88-adc0-505919c5d058/hive_2024-04-24_01-13-24_078_4215687706634123071-1/dummy_path
2024-04-24T01:13:24,561  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:24,562  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T01:13:24,567  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:24,569  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T01:13:24,570  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:24,574  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/22549cb4-a6a5-4a88-adc0-505919c5d058/hive_2024-04-24_01-13-24_078_4215687706634123071-1/-mr-10000
2024-04-24T01:13:24,577  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:24,585  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:24,590  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:24,591  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T01:13:24,591  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T01:13:24,591  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/22549cb4-a6a5-4a88-adc0-505919c5d058/hive_2024-04-24_01-13-24_078_4215687706634123071-1/dummy_path
2024-04-24T01:13:24,591  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:13:24,608  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:13:24,638  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1626307569_0009
2024-04-24T01:13:24,638  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:24,732  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:24,733  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:24,733  INFO [Thread-810] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:24,733  INFO [Thread-810] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:24,734  INFO [Thread-810] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:24,734  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1626307569_0009_m_000000_0
2024-04-24T01:13:24,737  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:24,738  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/22549cb4-a6a5-4a88-adc0-505919c5d058/hive_2024-04-24_01-13-24_078_4215687706634123071-1/dummy_path/null:0+1
2024-04-24T01:13:24,740  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:24,741  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T01:13:24,741  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T01:13:24,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:24,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:24,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:24,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:24,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:24,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:24,747  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:24,748  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:24,748  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:24,748  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:24,749  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T01:13:24,749  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T01:13:24,749  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:24,749  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T01:13:24,749  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T01:13:24,749  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T01:13:24,750  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T01:13:24,751  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:24,753  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:24,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:24,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:24,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T01:13:24,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:24,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:24,768  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1626307569_0009_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:24,769  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:24,769  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1626307569_0009_m_000000_0' done.
2024-04-24T01:13:24,769  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1626307569_0009_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=201479
		FILE: Number of bytes written=10695853
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1110441984
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-24T01:13:24,769  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1626307569_0009_m_000000_0
2024-04-24T01:13:24,769  INFO [Thread-810] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:24,771  INFO [Thread-810] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:24,771  INFO [pool-46-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1626307569_0009_r_000000_0
2024-04-24T01:13:24,773  INFO [pool-46-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:24,773  INFO [pool-46-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@793331cb
2024-04-24T01:13:24,773  WARN [pool-46-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:24,774  INFO [pool-46-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:24,775  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1626307569_0009_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:24,778  INFO [localfetcher#8] reduce.LocalFetcher: localfetcher#8 about to shuffle output of map attempt_local1626307569_0009_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-24T01:13:24,778  INFO [localfetcher#8] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1626307569_0009_m_000000_0
2024-04-24T01:13:24,778  INFO [localfetcher#8] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-24T01:13:24,778  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:24,779  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:24,779  INFO [pool-46-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:24,789  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:24,790  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T01:13:24,792  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:24,792  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-24T01:13:24,792  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:24,792  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:24,792  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T01:13:24,793  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:24,793  INFO [pool-46-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:24,794  INFO [pool-46-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T01:13:24,795  INFO [pool-46-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:24,795  INFO [pool-46-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:24,795  INFO [pool-46-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T01:13:24,795  INFO [pool-46-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T01:13:24,795  INFO [pool-46-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1626307569_0009/job_local1626307569_0009.xml], properties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@8e24ecb
2024-04-24T01:13:24,796  INFO [pool-46-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:24,796  INFO [pool-46-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:24,796  INFO [pool-46-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T01:13:24,796  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-24T01:13:24,796  INFO [pool-46-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1
2024-04-24T01:13:24,796  INFO [pool-46-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1
2024-04-24T01:13:24,796  INFO [pool-46-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:24,803  INFO [pool-46-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_OPERATOR_FS_6:0, RECORDS_OUT_1_default.tstage:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:24,803  INFO [pool-46-thread-1] mapred.Task: Task:attempt_local1626307569_0009_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:24,803  INFO [pool-46-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:24,803  INFO [pool-46-thread-1] mapred.Task: Task 'attempt_local1626307569_0009_r_000000_0' done.
2024-04-24T01:13:24,803  INFO [pool-46-thread-1] mapred.Task: Final Counters for attempt_local1626307569_0009_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=207611
		FILE: Number of bytes written=10695915
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1110441984
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:24,803  INFO [pool-46-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1626307569_0009_r_000000_0
2024-04-24T01:13:24,804  INFO [pool-46-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1626307569_0009_r_000001_0
2024-04-24T01:13:24,804  INFO [pool-46-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:24,804  INFO [pool-46-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1f1d910e
2024-04-24T01:13:24,804  WARN [pool-46-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:24,806  INFO [pool-46-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:24,806  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1626307569_0009_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:24,809  INFO [localfetcher#9] reduce.LocalFetcher: localfetcher#9 about to shuffle output of map attempt_local1626307569_0009_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T01:13:24,809  INFO [localfetcher#9] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1626307569_0009_m_000000_0
2024-04-24T01:13:24,809  INFO [localfetcher#9] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T01:13:24,810  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:24,810  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:24,810  INFO [pool-46-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:24,816  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:24,816  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T01:13:24,818  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:24,819  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T01:13:24,819  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:24,819  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:24,819  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T01:13:24,819  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:24,819  INFO [pool-46-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:24,820  INFO [pool-46-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T01:13:24,821  INFO [pool-46-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:24,821  INFO [pool-46-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:24,821  INFO [pool-46-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T01:13:24,821  INFO [pool-46-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T01:13:24,822  INFO [pool-46-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1626307569_0009/job_local1626307569_0009.xml], properties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6d9d27af
2024-04-24T01:13:24,822  INFO [pool-46-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1
2024-04-24T01:13:24,822  INFO [pool-46-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1
2024-04-24T01:13:24,823  INFO [pool-46-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:24,823  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T01:13:24,823  INFO [pool-46-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T01:13:24,834  INFO [pool-46-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T01:13:24,839  INFO [pool-46-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:24,840  INFO [pool-46-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:24,840  INFO [pool-46-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T01:13:24,840  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T01:13:24,847  INFO [pool-46-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T01:13:24,860  INFO [pool-46-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T01:13:24,860  INFO [pool-46-thread-1] mapred.Task: Task:attempt_local1626307569_0009_r_000001_0 is done. And is in the process of committing
2024-04-24T01:13:24,861  INFO [pool-46-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:24,861  INFO [pool-46-thread-1] mapred.Task: Task 'attempt_local1626307569_0009_r_000001_0' done.
2024-04-24T01:13:24,861  INFO [pool-46-thread-1] mapred.Task: Final Counters for attempt_local1626307569_0009_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=213773
		FILE: Number of bytes written=10697003
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1110441984
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:24,861  INFO [pool-46-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1626307569_0009_r_000001_0
2024-04-24T01:13:24,861  INFO [Thread-810] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:25,734 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:25,734  INFO [main] exec.Task: 2024-04-24 01:13:25,734 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1626307569_0009
2024-04-24T01:13:25,735  INFO [main] exec.Task: Ended Job = job_local1626307569_0009
2024-04-24T01:13:25,736  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T01:13:25,736  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T01:13:25,737  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/_tmp.delta_0000001_0000001_0000
2024-04-24T01:13:25,739  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage partition (p=1)
2024-04-24T01:13:25,739  INFO [main] exec.Task: Loading data to table default.tstage partition (p=1) from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1
2024-04-24T01:13:25,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:25,749  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:25,749  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T01:13:25,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:25,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:25,761  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:25,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T01:13:25,778  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T01:13:25,779  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.default.tstage	
2024-04-24T01:13:25,836  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T01:13:25,867  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T01:13:25,868  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:25,876  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:25,876  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T01:13:25,877  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/22549cb4-a6a5-4a88-adc0-505919c5d058/hive_2024-04-24_01-13-24_078_4215687706634123071-1/-mr-10000
2024-04-24T01:13:25,878  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:25,886  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:25,886  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T01:13:25,908  WARN [stats-updater-thread-0] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T01:13:25,909  INFO [main] FileOperations: Read stats for default.tstage/p=1/, numRows, true, 2, false: 
2024-04-24T01:13:25,909  INFO [main] FileOperations: Read stats for default.tstage/p=1/, rawDataSize, true, 0, false: 
2024-04-24T01:13:25,909  INFO [main] stats.BasicStatsTask: Partition {p=1} stats: [numFiles=1, numRows=2, totalSize=692, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T01:13:25,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.tstage	
2024-04-24T01:13:25,909  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T01:13:25,982  INFO [main] FileOperations: Read stats for default.tstage/p=1/, insertCount, true, 2, false: 
2024-04-24T01:13:25,982  INFO [main] FileOperations: Read stats for default.tstage/p=1/, updateCount, true, 0, false: 
2024-04-24T01:13:25,982  INFO [main] FileOperations: Read stats for default.tstage/p=1/, deleteCount, true, 0, false: 
2024-04-24T01:13:25,986  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:25,986  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, alter_partitions_(String, String, List, EnvironmentContext, String, long)=73, getTable_(GetTableRequest)=38, getValidWriteIds_(List, String)=0, validatePartitionNameCharacters_(List)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=45, isCompatibleWith_(Configuration)=0, add_partition_(Partition)=57}
MapReduce Jobs Launched: 
2024-04-24T01:13:25,986  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:25,986  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:25,986  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:25,986  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3); Time taken: 1.635 seconds
2024-04-24T01:13:25,986  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011324_d82de604-fa5c-404e-a348-fcaaad2ea5a3
2024-04-24T01:13:25,997  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:25,998  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T01:13:25,999  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0'
2024-04-24T01:13:25,999  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/22549cb4-a6a5-4a88-adc0-505919c5d058/hive_2024-04-24_01-13-24_078_4215687706634123071-1
2024-04-24T01:13:26,000  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/22549cb4-a6a5-4a88-adc0-505919c5d058/hive_2024-04-24_01-13-24_078_4215687706634123071-1 on fs with scheme file
2024-04-24T01:13:26,000  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_505787a6-3d1a-43b6-a734-56eec2f97649): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0'
2024-04-24T01:13:26,003  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T01:13:26,004  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T01:13:26,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:26,013  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
FAILED: SemanticException [Error 10413]: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
2024-04-24T01:13:26,016 ERROR [main] ql.Driver: FAILED: SemanticException [Error 10413]: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
org.apache.hadoop.hive.ql.parse.SemanticException: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
	at org.apache.hadoop.hive.ql.io.AcidUtils.validateAcidFiles(AcidUtils.java:3072)
	at org.apache.hadoop.hive.ql.io.AcidUtils.validateAcidPartitionLocation(AcidUtils.java:3089)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionAnalyzer.postProcess(AlterTableAddPartitionAnalyzer.java:78)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AbstractAddPartitionAnalyzer.analyzeCommand(AbstractAddPartitionAnalyzer.java:78)
	at org.apache.hadoop.hive.ql.ddl.table.AbstractAlterTableAnalyzer.analyzeInternal(AbstractAlterTableAnalyzer.java:62)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionTransactional(TestTxnAddPartition.java:296)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T01:13:26,016  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,016  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12, flushCache_()=0}
2024-04-24T01:13:26,017  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_505787a6-3d1a-43b6-a734-56eec2f97649); Time taken: 0.016 seconds
2024-04-24T01:13:26,017  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:26,022  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,032  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:26,032  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_00911295-2227-45f9-8797-a5eb5d24354c): drop table if exists acidTbl
2024-04-24T01:13:26,036  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T01:13:26,036  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T01:13:26,037  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:26,045  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,045  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,045  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,045  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,045  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, rollbackTxn_(long)=15}
2024-04-24T01:13:26,046  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_00911295-2227-45f9-8797-a5eb5d24354c); Time taken: 0.013 seconds
2024-04-24T01:13:26,046  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424011326_00911295-2227-45f9-8797-a5eb5d24354c
2024-04-24T01:13:26,046  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011326_00911295-2227-45f9-8797-a5eb5d24354c
2024-04-24T01:13:26,067  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011326_00911295-2227-45f9-8797-a5eb5d24354c LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T01:13:26,067  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:26,067  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_00911295-2227-45f9-8797-a5eb5d24354c): drop table if exists acidTbl
2024-04-24T01:13:26,067  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,067  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:26,075  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:26,082  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,082  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:26,200  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,200  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=125, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:26,200  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_00911295-2227-45f9-8797-a5eb5d24354c); Time taken: 0.133 seconds
2024-04-24T01:13:26,200  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_00911295-2227-45f9-8797-a5eb5d24354c
2024-04-24T01:13:26,204  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T01:13:26,210  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,212  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T01:13:26,213  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:26,213  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_356b3f61-013d-4361-b3f8-cdb974403842): drop table if exists acidTblPart
2024-04-24T01:13:26,216  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T01:13:26,216  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T01:13:26,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:26,236  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,236  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,236  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,236  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,236  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=19, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:26,237  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_356b3f61-013d-4361-b3f8-cdb974403842); Time taken: 0.023 seconds
2024-04-24T01:13:26,237  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424011326_356b3f61-013d-4361-b3f8-cdb974403842
2024-04-24T01:13:26,237  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011326_356b3f61-013d-4361-b3f8-cdb974403842
2024-04-24T01:13:26,253  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011326_356b3f61-013d-4361-b3f8-cdb974403842 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T01:13:26,253  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:26,253  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_356b3f61-013d-4361-b3f8-cdb974403842): drop table if exists acidTblPart
2024-04-24T01:13:26,253  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:26,261  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,261  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:26,268  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:26,312  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,312  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=51, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-24T01:13:26,312  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_356b3f61-013d-4361-b3f8-cdb974403842); Time taken: 0.059 seconds
2024-04-24T01:13:26,313  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_356b3f61-013d-4361-b3f8-cdb974403842
2024-04-24T01:13:26,317  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T01:13:26,323  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,323  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T01:13:26,323  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:26,324  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_79cc3fe3-501b-406b-bdca-38e95459a577): drop table if exists acidTbl2
2024-04-24T01:13:26,326  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T01:13:26,326  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T01:13:26,327  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,327  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,327  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,327  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=0}
2024-04-24T01:13:26,327  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_79cc3fe3-501b-406b-bdca-38e95459a577); Time taken: 0.003 seconds
2024-04-24T01:13:26,328  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424011326_79cc3fe3-501b-406b-bdca-38e95459a577
2024-04-24T01:13:26,328  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:26,328  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_79cc3fe3-501b-406b-bdca-38e95459a577): drop table if exists acidTbl2
2024-04-24T01:13:26,328  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,328  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T01:13:26,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-24T01:13:26,329  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_79cc3fe3-501b-406b-bdca-38e95459a577); Time taken: 0.001 seconds
2024-04-24T01:13:26,329  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_79cc3fe3-501b-406b-bdca-38e95459a577
2024-04-24T01:13:26,334  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T01:13:26,340  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,340  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T01:13:26,341  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:26,341  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_b38f200b-44b4-4595-b4b5-ba028eaf49e6): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:26,344  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 18
2024-04-24T01:13:26,344  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T01:13:26,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:26,368  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,368  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,368  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,368  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,368  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=23, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:26,369  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_b38f200b-44b4-4595-b4b5-ba028eaf49e6); Time taken: 0.027 seconds
2024-04-24T01:13:26,369  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424011326_b38f200b-44b4-4595-b4b5-ba028eaf49e6
2024-04-24T01:13:26,369  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011326_b38f200b-44b4-4595-b4b5-ba028eaf49e6
2024-04-24T01:13:26,384  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011326_b38f200b-44b4-4595-b4b5-ba028eaf49e6 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T01:13:26,384  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:26,384  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_b38f200b-44b4-4595-b4b5-ba028eaf49e6): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:26,384  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:26,394  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:26,404  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:26,440  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,440  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=46, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9}
2024-04-24T01:13:26,440  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_b38f200b-44b4-4595-b4b5-ba028eaf49e6); Time taken: 0.056 seconds
2024-04-24T01:13:26,440  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_b38f200b-44b4-4595-b4b5-ba028eaf49e6
2024-04-24T01:13:26,444  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T01:13:26,450  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,450  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T01:13:26,451  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:26,452  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_b224358e-e35b-46ab-bcb3-6b062a247c99): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:26,454  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 18
2024-04-24T01:13:26,454  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T01:13:26,455  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:26,465  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,465  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,465  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,465  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,465  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=10}
2024-04-24T01:13:26,466  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_b224358e-e35b-46ab-bcb3-6b062a247c99); Time taken: 0.014 seconds
2024-04-24T01:13:26,466  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424011326_b224358e-e35b-46ab-bcb3-6b062a247c99
2024-04-24T01:13:26,466  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011326_b224358e-e35b-46ab-bcb3-6b062a247c99
2024-04-24T01:13:26,481  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011326_b224358e-e35b-46ab-bcb3-6b062a247c99 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T01:13:26,481  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:26,481  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_b224358e-e35b-46ab-bcb3-6b062a247c99): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:26,481  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:26,491  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,491  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:26,503  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,503  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:26,540  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,540  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=49, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:26,540  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_b224358e-e35b-46ab-bcb3-6b062a247c99); Time taken: 0.059 seconds
2024-04-24T01:13:26,540  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_b224358e-e35b-46ab-bcb3-6b062a247c99
2024-04-24T01:13:26,544  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T01:13:26,550  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,550  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T01:13:26,551  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:26,551  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_a6eef4d0-7991-4501-869f-39caaef533b2): drop table if exists nonAcidNonBucket
2024-04-24T01:13:26,554  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 18
2024-04-24T01:13:26,554  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T01:13:26,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:26,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,565  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,565  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,565  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,566  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-24T01:13:26,566  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_a6eef4d0-7991-4501-869f-39caaef533b2); Time taken: 0.014 seconds
2024-04-24T01:13:26,566  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424011326_a6eef4d0-7991-4501-869f-39caaef533b2
2024-04-24T01:13:26,566  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011326_a6eef4d0-7991-4501-869f-39caaef533b2
2024-04-24T01:13:26,583  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011326_a6eef4d0-7991-4501-869f-39caaef533b2 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T01:13:26,583  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:26,583  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_a6eef4d0-7991-4501-869f-39caaef533b2): drop table if exists nonAcidNonBucket
2024-04-24T01:13:26,583  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:26,593  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:26,603  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:26,603  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:26,641  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,641  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=47}
2024-04-24T01:13:26,641  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_a6eef4d0-7991-4501-869f-39caaef533b2); Time taken: 0.058 seconds
2024-04-24T01:13:26,641  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_a6eef4d0-7991-4501-869f-39caaef533b2
2024-04-24T01:13:26,646  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-24T01:13:26,654  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,654  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-24T01:13:26,655  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T01:13:26,735  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T01:13:26,741  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T01:13:26,741  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T01:13:26,743  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 3e80f1c0-321f-40e7-b8da-9a54f71b598d
2024-04-24T01:13:26,746  INFO [main] SessionState: Hive Session ID = 3e80f1c0-321f-40e7-b8da-9a54f71b598d
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:26,746  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:26,752  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3e80f1c0-321f-40e7-b8da-9a54f71b598d
2024-04-24T01:13:26,754  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d
2024-04-24T01:13:26,757  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3e80f1c0-321f-40e7-b8da-9a54f71b598d/_tmp_space.db
2024-04-24T01:13:26,757  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=3e80f1c0-321f-40e7-b8da-9a54f71b598d, clientType=HIVECLI]
2024-04-24T01:13:26,758  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:26,758  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_10820cd3-80e3-4c8f-ad17-e438b13c2546): drop table if exists acidTbl
2024-04-24T01:13:26,767  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T01:13:26,768  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T01:13:26,770  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:26,780  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,780  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,780  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,781  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=9, commitTxn_(CommitTxnRequest)=14}
2024-04-24T01:13:26,781  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_10820cd3-80e3-4c8f-ad17-e438b13c2546); Time taken: 0.022 seconds
2024-04-24T01:13:26,781  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424011326_10820cd3-80e3-4c8f-ad17-e438b13c2546
2024-04-24T01:13:26,781  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:26,781  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_10820cd3-80e3-4c8f-ad17-e438b13c2546): drop table if exists acidTbl
2024-04-24T01:13:26,781  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:26,785  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,785  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:26,785  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_10820cd3-80e3-4c8f-ad17-e438b13c2546); Time taken: 0.004 seconds
2024-04-24T01:13:26,786  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_10820cd3-80e3-4c8f-ad17-e438b13c2546
2024-04-24T01:13:26,791  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T01:13:26,797  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,797  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T01:13:26,798  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:26,799  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_8ae67f47-fc0e-4e00-822a-7bee43193320): drop table if exists acidTblPart
2024-04-24T01:13:26,801  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T01:13:26,802  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T01:13:26,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:26,806  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,806  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,806  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,806  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T01:13:26,806  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_8ae67f47-fc0e-4e00-822a-7bee43193320); Time taken: 0.007 seconds
2024-04-24T01:13:26,807  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424011326_8ae67f47-fc0e-4e00-822a-7bee43193320
2024-04-24T01:13:26,807  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:26,807  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_8ae67f47-fc0e-4e00-822a-7bee43193320): drop table if exists acidTblPart
2024-04-24T01:13:26,807  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:26,811  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,811  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:26,811  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_8ae67f47-fc0e-4e00-822a-7bee43193320); Time taken: 0.004 seconds
2024-04-24T01:13:26,812  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_8ae67f47-fc0e-4e00-822a-7bee43193320
2024-04-24T01:13:26,817  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T01:13:26,825  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,825  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T01:13:26,826  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:26,827  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_ced65aa1-5641-4a99-aef8-2b6e28167a25): drop table if exists acidTbl2
2024-04-24T01:13:26,830  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T01:13:26,830  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T01:13:26,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:26,835  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,835  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,835  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,835  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=0}
2024-04-24T01:13:26,836  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_ced65aa1-5641-4a99-aef8-2b6e28167a25); Time taken: 0.008 seconds
2024-04-24T01:13:26,836  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424011326_ced65aa1-5641-4a99-aef8-2b6e28167a25
2024-04-24T01:13:26,836  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:26,836  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_ced65aa1-5641-4a99-aef8-2b6e28167a25): drop table if exists acidTbl2
2024-04-24T01:13:26,836  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,836  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:26,840  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,840  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:26,840  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_ced65aa1-5641-4a99-aef8-2b6e28167a25); Time taken: 0.004 seconds
2024-04-24T01:13:26,840  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_ced65aa1-5641-4a99-aef8-2b6e28167a25
2024-04-24T01:13:26,847  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T01:13:26,853  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,853  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T01:13:26,854  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:26,854  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_34108f10-dd4b-4571-8461-e0cbac874ff2): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:26,857  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T01:13:26,857  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T01:13:26,858  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:26,861  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,861  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,861  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14}
2024-04-24T01:13:26,862  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_34108f10-dd4b-4571-8461-e0cbac874ff2); Time taken: 0.007 seconds
2024-04-24T01:13:26,862  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424011326_34108f10-dd4b-4571-8461-e0cbac874ff2
2024-04-24T01:13:26,862  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:26,862  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_34108f10-dd4b-4571-8461-e0cbac874ff2): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:26,862  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,862  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:26,865  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:26,866  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_34108f10-dd4b-4571-8461-e0cbac874ff2); Time taken: 0.003 seconds
2024-04-24T01:13:26,866  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_34108f10-dd4b-4571-8461-e0cbac874ff2
2024-04-24T01:13:26,871  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T01:13:26,878  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,878  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T01:13:26,878  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:26,879  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_f420b973-81d3-4627-8bc5-07a7068954e1): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:26,881  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T01:13:26,881  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T01:13:26,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:26,885  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,886  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,886  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,886  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T01:13:26,886  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_f420b973-81d3-4627-8bc5-07a7068954e1); Time taken: 0.007 seconds
2024-04-24T01:13:26,886  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424011326_f420b973-81d3-4627-8bc5-07a7068954e1
2024-04-24T01:13:26,886  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:26,886  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_f420b973-81d3-4627-8bc5-07a7068954e1): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:26,886  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:26,890  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,890  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:26,890  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_f420b973-81d3-4627-8bc5-07a7068954e1); Time taken: 0.004 seconds
2024-04-24T01:13:26,890  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_f420b973-81d3-4627-8bc5-07a7068954e1
2024-04-24T01:13:26,896  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T01:13:26,902  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,902  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T01:13:26,903  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:26,903  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_81c9a9f9-a2ee-4267-9e0e-fe67b0ef9ae0): drop table if exists nonAcidNonBucket
2024-04-24T01:13:26,906  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T01:13:26,906  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T01:13:26,907  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:26,910  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,911  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,911  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,911  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:26,911  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_81c9a9f9-a2ee-4267-9e0e-fe67b0ef9ae0); Time taken: 0.008 seconds
2024-04-24T01:13:26,911  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424011326_81c9a9f9-a2ee-4267-9e0e-fe67b0ef9ae0
2024-04-24T01:13:26,911  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:26,911  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_81c9a9f9-a2ee-4267-9e0e-fe67b0ef9ae0): drop table if exists nonAcidNonBucket
2024-04-24T01:13:26,911  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,912  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:26,915  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:26,915  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:26,916  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_81c9a9f9-a2ee-4267-9e0e-fe67b0ef9ae0); Time taken: 0.004 seconds
2024-04-24T01:13:26,916  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_81c9a9f9-a2ee-4267-9e0e-fe67b0ef9ae0
2024-04-24T01:13:26,922  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T01:13:26,929  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:26,929  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T01:13:26,930  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:26,931  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011326_8d209b88-52a6-451a-813e-41d386792f6e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:26,933  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T01:13:26,934  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T01:13:26,934  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:26,934  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:26,941  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T01:13:26,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:26,943  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:26,943  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:26,943  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:26,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:26,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6, getDatabase_(String)=2, flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=0}
2024-04-24T01:13:26,944  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011326_8d209b88-52a6-451a-813e-41d386792f6e); Time taken: 0.013 seconds
2024-04-24T01:13:26,944  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424011326_8d209b88-52a6-451a-813e-41d386792f6e
2024-04-24T01:13:26,945  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011326_8d209b88-52a6-451a-813e-41d386792f6e
2024-04-24T01:13:26,973  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011326_8d209b88-52a6-451a-813e-41d386792f6e LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T01:13:26,973  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:26,974  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011326_8d209b88-52a6-451a-813e-41d386792f6e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:26,974  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:26,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713946406, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numRows=0, rawDataSize=0, totalSize=0, transactional=true, numFilesErasureCoded=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:26,984  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtbl
2024-04-24T01:13:27,045  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,045  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=69, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:27,045  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011326_8d209b88-52a6-451a-813e-41d386792f6e); Time taken: 0.071 seconds
2024-04-24T01:13:27,045  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011326_8d209b88-52a6-451a-813e-41d386792f6e
2024-04-24T01:13:27,052  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T01:13:27,062  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,062  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T01:13:27,063  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:27,064  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_6c4d1152-4cf2-4961-87cf-bbd1de02475e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:27,068  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T01:13:27,068  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T01:13:27,069  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:27,069  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:27,073  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T01:13:27,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:27,080  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:27,080  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,080  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,080  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=3, flushCache_()=1, commitTxn_(CommitTxnRequest)=18, getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=1, getDatabase_(String)=7}
2024-04-24T01:13:27,081  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_6c4d1152-4cf2-4961-87cf-bbd1de02475e); Time taken: 0.016 seconds
2024-04-24T01:13:27,081  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424011327_6c4d1152-4cf2-4961-87cf-bbd1de02475e
2024-04-24T01:13:27,081  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_6c4d1152-4cf2-4961-87cf-bbd1de02475e
2024-04-24T01:13:27,100  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_6c4d1152-4cf2-4961-87cf-bbd1de02475e LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T01:13:27,100  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:27,100  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_6c4d1152-4cf2-4961-87cf-bbd1de02475e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:27,101  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,101  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713946407, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:27,108  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtblpart
2024-04-24T01:13:27,124  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,124  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-24T01:13:27,125  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_6c4d1152-4cf2-4961-87cf-bbd1de02475e); Time taken: 0.024 seconds
2024-04-24T01:13:27,125  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_6c4d1152-4cf2-4961-87cf-bbd1de02475e
2024-04-24T01:13:27,129  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T01:13:27,134  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,135  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T01:13:27,135  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,136  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_2793e8a3-34bd-4b5f-86cf-972ee39eb499): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,138  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T01:13:27,138  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T01:13:27,139  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:27,139  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:27,141  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T01:13:27,142  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:27,143  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:27,143  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,143  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,143  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,144  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2}
2024-04-24T01:13:27,144  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_2793e8a3-34bd-4b5f-86cf-972ee39eb499); Time taken: 0.007 seconds
2024-04-24T01:13:27,144  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424011327_2793e8a3-34bd-4b5f-86cf-972ee39eb499
2024-04-24T01:13:27,144  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_2793e8a3-34bd-4b5f-86cf-972ee39eb499
2024-04-24T01:13:27,159  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_2793e8a3-34bd-4b5f-86cf-972ee39eb499 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T01:13:27,159  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:27,159  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_2793e8a3-34bd-4b5f-86cf-972ee39eb499): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,159  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,160  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713946407, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:27,166  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl
2024-04-24T01:13:27,188  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,189  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=28}
2024-04-24T01:13:27,189  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_2793e8a3-34bd-4b5f-86cf-972ee39eb499); Time taken: 0.029 seconds
2024-04-24T01:13:27,189  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_2793e8a3-34bd-4b5f-86cf-972ee39eb499
2024-04-24T01:13:27,193  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T01:13:27,199  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,199  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T01:13:27,200  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,200  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_e5cfd8c4-3d7a-455c-9c04-157333b59510): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,202  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T01:13:27,203  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T01:13:27,203  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:27,203  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:27,206  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T01:13:27,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:27,208  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:27,208  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,208  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,208  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2}
2024-04-24T01:13:27,208  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_e5cfd8c4-3d7a-455c-9c04-157333b59510); Time taken: 0.008 seconds
2024-04-24T01:13:27,208  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424011327_e5cfd8c4-3d7a-455c-9c04-157333b59510
2024-04-24T01:13:27,209  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_e5cfd8c4-3d7a-455c-9c04-157333b59510
2024-04-24T01:13:27,224  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_e5cfd8c4-3d7a-455c-9c04-157333b59510 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T01:13:27,224  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:27,224  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_e5cfd8c4-3d7a-455c-9c04-157333b59510): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,224  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713946407, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, totalSize=0, numRows=0, numFilesErasureCoded=0, bucketing_version=2, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:27,230  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl2
2024-04-24T01:13:27,246  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,246  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:27,247  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_e5cfd8c4-3d7a-455c-9c04-157333b59510); Time taken: 0.022 seconds
2024-04-24T01:13:27,247  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_e5cfd8c4-3d7a-455c-9c04-157333b59510
2024-04-24T01:13:27,250  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T01:13:27,257  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,257  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T01:13:27,258  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:27,258  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_873e48ed-1281-43ab-91e1-67334d359944): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:27,261  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T01:13:27,261  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T01:13:27,261  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:27,261  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:27,264  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T01:13:27,264  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:27,266  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:27,266  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,266  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,267  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,267  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:27,267  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_873e48ed-1281-43ab-91e1-67334d359944); Time taken: 0.008 seconds
2024-04-24T01:13:27,267  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424011327_873e48ed-1281-43ab-91e1-67334d359944
2024-04-24T01:13:27,268  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_873e48ed-1281-43ab-91e1-67334d359944
2024-04-24T01:13:27,290  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_873e48ed-1281-43ab-91e1-67334d359944 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T01:13:27,290  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:27,291  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_873e48ed-1281-43ab-91e1-67334d359944): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:27,291  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,292  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3e80f1c0-321f-40e7-b8da-9a54f71b598d/_tmp_space.db/2aff0fbf-939f-4608-8695-2e83c288ec09
2024-04-24T01:13:27,295  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,295  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:27,296  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_873e48ed-1281-43ab-91e1-67334d359944); Time taken: 0.004 seconds
2024-04-24T01:13:27,296  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_873e48ed-1281-43ab-91e1-67334d359944
2024-04-24T01:13:27,302  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T01:13:27,308  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,309  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T01:13:27,309  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,310  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_a21a9c57-1db0-4ca5-9e61-5a3416dd756c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,312  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T01:13:27,313  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T01:13:27,313  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:27,313  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:27,316  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T01:13:27,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:27,318  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:27,318  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,318  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,318  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,318  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13}
2024-04-24T01:13:27,318  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_a21a9c57-1db0-4ca5-9e61-5a3416dd756c); Time taken: 0.009 seconds
2024-04-24T01:13:27,318  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424011327_a21a9c57-1db0-4ca5-9e61-5a3416dd756c
2024-04-24T01:13:27,319  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_a21a9c57-1db0-4ca5-9e61-5a3416dd756c
2024-04-24T01:13:27,334  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_a21a9c57-1db0-4ca5-9e61-5a3416dd756c LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T01:13:27,334  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:27,334  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_a21a9c57-1db0-4ca5-9e61-5a3416dd756c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:27,334  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,335  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713946407, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, totalSize=0, numFiles=0, numRows=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:27,342  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidnonbucket
2024-04-24T01:13:27,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,361  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=25, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:27,361  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_a21a9c57-1db0-4ca5-9e61-5a3416dd756c); Time taken: 0.027 seconds
2024-04-24T01:13:27,361  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_a21a9c57-1db0-4ca5-9e61-5a3416dd756c
2024-04-24T01:13:27,366  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T01:13:27,372  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,372  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T01:13:27,373  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T01:13:27,373  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_a394a2da-e381-41e7-82e8-1214df61844b): drop table if exists T
2024-04-24T01:13:27,376  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T01:13:27,376  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T01:13:27,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:27,398  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:27,398  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,398  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,398  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,399  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=21, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:27,399  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_a394a2da-e381-41e7-82e8-1214df61844b); Time taken: 0.025 seconds
2024-04-24T01:13:27,399  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424011327_a394a2da-e381-41e7-82e8-1214df61844b
2024-04-24T01:13:27,400  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_a394a2da-e381-41e7-82e8-1214df61844b
2024-04-24T01:13:27,419  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_a394a2da-e381-41e7-82e8-1214df61844b LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T01:13:27,419  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:27,419  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_a394a2da-e381-41e7-82e8-1214df61844b): drop table if exists T
2024-04-24T01:13:27,419  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,420  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:27,427  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:27,427  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:27,434  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:27,435  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T01:13:27,557  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t does not exist; Force to delete it.
2024-04-24T01:13:27,557 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:27,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=130, getTable_(GetTableRequest)=7}
2024-04-24T01:13:27,558  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_a394a2da-e381-41e7-82e8-1214df61844b); Time taken: 0.138 seconds
2024-04-24T01:13:27,558  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_a394a2da-e381-41e7-82e8-1214df61844b
2024-04-24T01:13:27,562  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T01:13:27,570  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,570  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T01:13:27,571  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T01:13:27,571  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_0248d7fd-845e-4684-92b8-4906d503772e): drop table if exists Tstage
2024-04-24T01:13:27,574  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T01:13:27,575  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T01:13:27,575  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:27,583  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:27,584  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,584  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,584  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,584  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=4}
2024-04-24T01:13:27,584  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_0248d7fd-845e-4684-92b8-4906d503772e); Time taken: 0.013 seconds
2024-04-24T01:13:27,584  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424011327_0248d7fd-845e-4684-92b8-4906d503772e
2024-04-24T01:13:27,585  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_0248d7fd-845e-4684-92b8-4906d503772e
2024-04-24T01:13:27,605  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_0248d7fd-845e-4684-92b8-4906d503772e LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T01:13:27,605  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:27,605  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_0248d7fd-845e-4684-92b8-4906d503772e): drop table if exists Tstage
2024-04-24T01:13:27,605  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,605  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:27,613  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:27,613  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:27,621  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:27,622  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T01:13:27,707  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage does not exist; Force to delete it.
2024-04-24T01:13:27,707 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:27,707  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,708  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=94}
2024-04-24T01:13:27,708  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_0248d7fd-845e-4684-92b8-4906d503772e); Time taken: 0.102 seconds
2024-04-24T01:13:27,708  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_0248d7fd-845e-4684-92b8-4906d503772e
2024-04-24T01:13:27,713  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T01:13:27,721  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,722  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T01:13:27,723  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:27,724  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_a5cce254-6329-410d-b1cf-e96a306f8a98): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:27,727  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T01:13:27,727  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T01:13:27,728  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:27,728  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:27,734  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T01:13:27,734  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:27,736  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:27,736  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,736  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,736  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,736  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=6, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:27,736  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_a5cce254-6329-410d-b1cf-e96a306f8a98); Time taken: 0.012 seconds
2024-04-24T01:13:27,737  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424011327_a5cce254-6329-410d-b1cf-e96a306f8a98
2024-04-24T01:13:27,737  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_a5cce254-6329-410d-b1cf-e96a306f8a98
2024-04-24T01:13:27,758  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_a5cce254-6329-410d-b1cf-e96a306f8a98 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T01:13:27,758  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:27,759  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_a5cce254-6329-410d-b1cf-e96a306f8a98): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:27,759  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713946407, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:27,767  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:27,803  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,803  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:27,803  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_a5cce254-6329-410d-b1cf-e96a306f8a98); Time taken: 0.044 seconds
2024-04-24T01:13:27,803  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_a5cce254-6329-410d-b1cf-e96a306f8a98
2024-04-24T01:13:27,808  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T01:13:27,815  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,815  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T01:13:27,816  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:27,816  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_d57e48af-3c32-4065-933f-c1995669180e): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:27,821  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 3
2024-04-24T01:13:27,821  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T01:13:27,822  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:27,822  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:27,826  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T01:13:27,826  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:27,829  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:27,829  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:27,829  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:27,829  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:27,829  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3}
2024-04-24T01:13:27,829  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_d57e48af-3c32-4065-933f-c1995669180e); Time taken: 0.013 seconds
2024-04-24T01:13:27,830  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424011327_d57e48af-3c32-4065-933f-c1995669180e
2024-04-24T01:13:27,830  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_d57e48af-3c32-4065-933f-c1995669180e
2024-04-24T01:13:27,853  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_d57e48af-3c32-4065-933f-c1995669180e LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T01:13:27,853  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:27,853  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_d57e48af-3c32-4065-933f-c1995669180e): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:27,853  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:27,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713946407, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, bucketing_version=2, transactional=false, numFilesErasureCoded=0, numRows=0, rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:27,863  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:27,880  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:27,880  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=26, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:27,881  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_d57e48af-3c32-4065-933f-c1995669180e); Time taken: 0.027 seconds
2024-04-24T01:13:27,881  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_d57e48af-3c32-4065-933f-c1995669180e
2024-04-24T01:13:27,887  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T01:13:27,897  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:27,898  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T01:13:27,899  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:27,899  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207): insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:27,903  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 6
2024-04-24T01:13:27,904  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T01:13:27,905  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:27,905  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:27,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:27,967  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:27,968  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:27,968  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:27,968  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:27,968  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:27,968  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:27,985  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:27,985  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:27,985  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T01:13:28,015  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:28,110  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:28,110  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:28,110  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:28,111  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:28,114  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:28,114  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:28,114  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:28,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:28,124  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:28,126  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1
2024-04-24T01:13:28,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:28,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:28,132  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:28,135  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:28,135  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:28,144  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:28,156  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:28,156  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T01:13:28,157  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:28,170  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:28,171  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:28,171  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T01:13:28,172  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:28,172  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:28,172  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:28,172  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T01:13:28,172  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T01:13:28,173  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:28,173  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:28,173  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:28,173  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T01:13:28,173  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:28,173  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=1, getTable_(GetTableRequest)=110, isCompatibleWith_(Configuration)=2, flushCache_()=0, openTxn_(String, TxnType)=4, getValidTxns_(long)=1, getValidWriteIds_(List, String)=5, getAllTableConstraints_(AllTableConstraintsRequest)=36, commitTxn_(CommitTxnRequest)=17, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-24T01:13:28,173  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207); Time taken: 0.274 seconds
2024-04-24T01:13:28,173  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207
2024-04-24T01:13:28,174  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207
2024-04-24T01:13:28,191  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T01:13:28,191  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:28,191  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207): insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:28,192  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207
2024-04-24T01:13:28,192  INFO [main] ql.Driver: Query ID = alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207
Total jobs = 1
2024-04-24T01:13:28,192  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:28,192  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:28,393  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T01:13:28,393  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T01:13:28,395  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:28,395  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T01:13:28,395  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-27_899_2950068356505971439-1/dummy_path
2024-04-24T01:13:28,405  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:28,407  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,11KB
2024-04-24T01:13:28,408  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:28,412  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-27_899_2950068356505971439-1/-mr-10001
2024-04-24T01:13:28,416  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:28,424  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:28,432  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:28,433  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T01:13:28,433  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T01:13:28,433  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-27_899_2950068356505971439-1/dummy_path
2024-04-24T01:13:28,433  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:13:28,452  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:13:28,472  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local484427458_0010
2024-04-24T01:13:28,473  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:28,544  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:28,544  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:28,544  INFO [Thread-919] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:28,544  INFO [Thread-919] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:28,546  INFO [Thread-919] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:28,546  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local484427458_0010_m_000000_0
2024-04-24T01:13:28,549  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:28,550  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-27_899_2950068356505971439-1/dummy_path/null:0+1
2024-04-24T01:13:28,553  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:28,553  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,11KB
2024-04-24T01:13:28,554  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T01:13:28,556  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:28,557  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:28,557  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:28,557  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:28,558  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T01:13:28,558  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T01:13:28,558  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:28,558  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T01:13:28,558  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:28,558  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local484427458_0010/job_local484427458_0010.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@479f3428
2024-04-24T01:13:28,559  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:28,559  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:28,559  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:28,561  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:28,561  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:28,569  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T01:13:28,577  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_1_default.tstage:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T01:13:28,578  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:28,580  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local484427458_0010_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:28,581  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:28,581  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local484427458_0010_m_000000_0' done.
2024-04-24T01:13:28,581  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local484427458_0010_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=221459
		FILE: Number of bytes written=11874851
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130889216
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6168
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:28,581  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local484427458_0010_m_000000_0
2024-04-24T01:13:28,581  INFO [Thread-919] mapred.LocalJobRunner: map task executor complete.
2024-04-24 01:13:29,545 Stage-1 map = 100%,  reduce = 0%
2024-04-24T01:13:29,545  INFO [main] exec.Task: 2024-04-24 01:13:29,545 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local484427458_0010
2024-04-24T01:13:29,546  INFO [main] exec.Task: Ended Job = job_local484427458_0010
2024-04-24T01:13:29,547  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T01:13:29,548  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T01:13:29,548  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T01:13:29,548  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T01:13:29,548  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/-ext-10000
2024-04-24T01:13:29,548  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/-ext-10002
2024-04-24T01:13:29,548  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T01:13:29,548  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1/-ext-10000
2024-04-24T01:13:29,549  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:29,559  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:29,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,572  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:29,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:29,605  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T01:13:29,605  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:29,616  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,616  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T01:13:29,616  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-27_899_2950068356505971439-1/-mr-10001
2024-04-24T01:13:29,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:29,627  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,628  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T01:13:29,628  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T01:13:29,629  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:29,629  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:29,669  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T01:13:29,670  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:29,670  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=43, alter_table_(String, String, String, Table, EnvironmentContext, String)=73, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T01:13:29,671  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:29,671  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:29,671  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:29,671  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207); Time taken: 1.479 seconds
2024-04-24T01:13:29,671  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011327_c342f48a-0248-41d6-b41a-6b80932d3207
2024-04-24T01:13:29,677  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T01:13:29,686  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:29,686  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T01:13:29,686  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:29,687  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-27_899_2950068356505971439-1
2024-04-24T01:13:29,687  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-27_899_2950068356505971439-1 on fs with scheme file
2024-04-24T01:13:29,687  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1
2024-04-24T01:13:29,688  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-27_899_2950068356505971439-1 on fs with scheme file
2024-04-24T01:13:29,688  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011329_5d2ba360-d1bb-4dba-bb04-d18ba24e5137): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:29,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:29,700  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,702  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T01:13:29,702  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T01:13:29,707  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:29,723  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,723  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:29,723  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:29,723  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:29,723  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:29,724  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:29,724  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:29,724  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:29,724  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, getCurrentNotificationEventId_()=3, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=27, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T01:13:29,724  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011329_5d2ba360-d1bb-4dba-bb04-d18ba24e5137); Time taken: 0.036 seconds
2024-04-24T01:13:29,725  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424011329_5d2ba360-d1bb-4dba-bb04-d18ba24e5137
2024-04-24T01:13:29,726  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011329_5d2ba360-d1bb-4dba-bb04-d18ba24e5137
2024-04-24T01:13:29,743  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011329_5d2ba360-d1bb-4dba-bb04-d18ba24e5137 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T01:13:29,743  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:29,743  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011329_5d2ba360-d1bb-4dba-bb04-d18ba24e5137): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:29,743  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:29,743  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:29,743  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:29,743  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:29,743  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:29,754  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:29,759  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:29,760  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:29,760  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011329_5d2ba360-d1bb-4dba-bb04-d18ba24e5137); Time taken: 0.016 seconds
2024-04-24T01:13:29,760  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011329_5d2ba360-d1bb-4dba-bb04-d18ba24e5137
2024-04-24T01:13:29,764  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T01:13:29,771  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:29,773  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T01:13:29,773  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:29,774  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011329_0d061636-1fdf-4ed0-9f14-95b3e4b0177f): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:29,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:29,785  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,787  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T01:13:29,788  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T01:13:29,789  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:29,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,798  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:29,799  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:29,799  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:29,799  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:29,799  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:29,799  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:29,799  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:29,799  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=20, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getCurrentNotificationEventId_()=1, getValidTxns_(long)=0}
2024-04-24T01:13:29,799  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011329_0d061636-1fdf-4ed0-9f14-95b3e4b0177f); Time taken: 0.026 seconds
2024-04-24T01:13:29,800  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424011329_0d061636-1fdf-4ed0-9f14-95b3e4b0177f
2024-04-24T01:13:29,800  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011329_0d061636-1fdf-4ed0-9f14-95b3e4b0177f
2024-04-24T01:13:29,815  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011329_0d061636-1fdf-4ed0-9f14-95b3e4b0177f LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T01:13:29,815  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:29,816  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011329_0d061636-1fdf-4ed0-9f14-95b3e4b0177f): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:29,816  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:29,816  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:29,816  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:29,816  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:29,816  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:29,827  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:29,832  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:29,832  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:29,832  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011329_0d061636-1fdf-4ed0-9f14-95b3e4b0177f); Time taken: 0.016 seconds
2024-04-24T01:13:29,832  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011329_0d061636-1fdf-4ed0-9f14-95b3e4b0177f
2024-04-24T01:13:29,836  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T01:13:29,842  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:29,842  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T01:13:29,843  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:29,843  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011329_64249b5e-ce28-4feb-a3e0-b3985e457413): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:29,846  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T01:13:29,846  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T01:13:29,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:29,854  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,863  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T01:13:29,864  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-24T01:13:29,865  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:29,865  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:29,866  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:29,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, getValidTxns_(long)=1, flushCache_()=0, allocateTableWriteId_(long, String, String)=8}
2024-04-24T01:13:29,866  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011329_64249b5e-ce28-4feb-a3e0-b3985e457413); Time taken: 0.023 seconds
2024-04-24T01:13:29,866  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424011329_64249b5e-ce28-4feb-a3e0-b3985e457413
2024-04-24T01:13:29,866  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011329_64249b5e-ce28-4feb-a3e0-b3985e457413
2024-04-24T01:13:29,881  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011329_64249b5e-ce28-4feb-a3e0-b3985e457413 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T01:13:29,881  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:29,885  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011329_64249b5e-ce28-4feb-a3e0-b3985e457413): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:29,886  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:29,886  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:29,893  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:29,907  INFO [HMSHandler #10] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1
2024-04-24T01:13:29,907  INFO [HMSHandler #9] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:29,907  INFO [HMSHandler #11] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2
2024-04-24T01:13:29,942  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T01:13:29,942  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data
2024-04-24T01:13:29,942  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:29,950  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:29,969  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T01:13:29,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:29,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:29,979  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:29,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:29,989  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T01:13:29,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:29,993  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T01:13:30,032  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:30,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:30,072  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-24T01:13:30,072  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data
2024-04-24T01:13:30,072  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:30,080  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:30,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:30,092  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T01:13:30,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:30,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:30,099  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:30,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:30,111  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-24T01:13:30,115  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:30,115  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T01:13:30,154  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:30,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:30,184  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:30,185  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {add_partitions_(List, boolean, boolean)=49, getPartitionWithAuthInfo_(String, String, List, String, List)=79, validatePartitionNameCharacters_(List)=0, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=119, getValidWriteIds_(List, String)=0, getTable_(GetTableRequest)=40, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:30,185  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011329_64249b5e-ce28-4feb-a3e0-b3985e457413); Time taken: 0.299 seconds
2024-04-24T01:13:30,185  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011329_64249b5e-ce28-4feb-a3e0-b3985e457413
2024-04-24T01:13:30,191  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T01:13:30,200  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:30,201  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T01:13:30,201  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:30,202  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:30,214  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T01:13:30,215  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T01:13:30,218  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:30,218  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:30,225  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:30,225  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:30,226  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:30,234  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:30,234  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:30,234  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:30,234  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:30,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:30,287  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:30,288  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:30,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:30,351  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:30,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:30,369  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T01:13:30,369  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T01:13:30,430  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:30,430  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:30,430  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:30,432  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-30_202_918454777108310562-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-30_202_918454777108310562-1
2024-04-24T01:13:30,440  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:30,445  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col0], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T01:13:30,445  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T01:13:30,446  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:30,447  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:30,462  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:30,463  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:30,463  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:30,465  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:30,466  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:30,466  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:30,466  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:30,466  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T01:13:30,468  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-24T01:13:30,468  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:30,468  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=2, flushCache_()=0, listPartitions_(String, String, short)=40, getValidTxns_(long)=3, getAllTableConstraints_(AllTableConstraintsRequest)=31, getAggrColStatsFor_(String, String, List, List, String, String)=28, commitTxn_(CommitTxnRequest)=16, getValidWriteIds_(List, String)=7, openTxn_(String, TxnType)=11}
2024-04-24T01:13:30,469  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414); Time taken: 0.266 seconds
2024-04-24T01:13:30,469  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414
2024-04-24T01:13:30,471  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414
2024-04-24T01:13:30,502  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T01:13:30,502  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:30,503  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:30,503  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414
2024-04-24T01:13:30,503  INFO [main] ql.Driver: Query ID = alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414
Total jobs = 1
2024-04-24T01:13:30,503  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:30,503  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:30,714  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:30,715  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:30,715  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:30,715  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:30,715  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:30,715  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:30,715  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:30,715  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:30,717  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:30,717  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:30,717  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:30,724  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-30_202_918454777108310562-1/-mr-10004/5c4c568b-9f09-4aaf-bfcf-f4bb6f4881b5 (false)
2024-04-24T01:13:30,733  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:30,738  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,06KB
2024-04-24T01:13:30,743  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:30,745  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,40KB
2024-04-24T01:13:30,746  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:30,754  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:30,763  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:30,767  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:30,768  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:30,768  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:30,768  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:30,769  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:30,769  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T01:13:30,769  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:30,784  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T01:13:30,784  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 15 ms
2024-04-24T01:13:30,784  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T01:13:30,803  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T01:13:30,837  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1248143912_0011
2024-04-24T01:13:30,837  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:30,901  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:30,902  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:30,902  INFO [Thread-996] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:30,902  INFO [Thread-996] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:30,904  INFO [Thread-996] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:30,904  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1248143912_0011_m_000000_0
2024-04-24T01:13:30,905  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:30,905  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:30,906  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:30,910  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,06KB
2024-04-24T01:13:30,911  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:30,914  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:30,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:30,920  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:30,920  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:30,920  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:30,920  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:30,920  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:30,921  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:30,921  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:30,921  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:30,922  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:30,922  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:30,923  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:30,923  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:30,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:30,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:30,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:30,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:30,924  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:30,924  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:30,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:30,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:30,925  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:30,925  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:30,925  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T01:13:30,925  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:30,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:30,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:30,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T01:13:30,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:30,936  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:30,939  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1248143912_0011_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:30,939  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:30,939  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1248143912_0011_m_000000_0' done.
2024-04-24T01:13:30,939  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1248143912_0011_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=233622
		FILE: Number of bytes written=13069657
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1129840640
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8202
2024-04-24T01:13:30,939  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1248143912_0011_m_000000_0
2024-04-24T01:13:30,940  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1248143912_0011_m_000001_0
2024-04-24T01:13:30,940  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:30,940  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:30,941  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:30,942  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,06KB
2024-04-24T01:13:30,943  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:30,943  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:30,944  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:30,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:30,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:30,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:30,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:30,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:30,950  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:30,950  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:30,950  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:30,951  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:30,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:30,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:30,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:30,952  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:30,952  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:30,952  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:30,953  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T01:13:30,953  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:30,953  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:30,953  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:30,953  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:30,953  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:30,953  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:30,953  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:30,954  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:30,954  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:30,954  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:30,954  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T01:13:30,954  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:30,963  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:30,967  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1248143912_0011_m_000001_0 is done. And is in the process of committing
2024-04-24T01:13:30,968  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:30,968  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1248143912_0011_m_000001_0' done.
2024-04-24T01:13:30,968  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1248143912_0011_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=242365
		FILE: Number of bytes written=13069781
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1129840640
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8202
2024-04-24T01:13:30,968  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1248143912_0011_m_000001_0
2024-04-24T01:13:30,968  INFO [Thread-996] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:30,969  INFO [Thread-996] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:30,969  INFO [pool-58-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1248143912_0011_r_000000_0
2024-04-24T01:13:30,970  INFO [pool-58-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:30,970  INFO [pool-58-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6688c12a
2024-04-24T01:13:30,970  WARN [pool-58-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:30,971  INFO [pool-58-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:30,972  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1248143912_0011_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:30,975  INFO [localfetcher#10] reduce.LocalFetcher: localfetcher#10 about to shuffle output of map attempt_local1248143912_0011_m_000001_0 decomp: 88 len: 92 to MEMORY
2024-04-24T01:13:30,975  INFO [localfetcher#10] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1248143912_0011_m_000001_0
2024-04-24T01:13:30,975  INFO [localfetcher#10] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->88
2024-04-24T01:13:30,977  INFO [localfetcher#10] reduce.LocalFetcher: localfetcher#10 about to shuffle output of map attempt_local1248143912_0011_m_000000_0 decomp: 88 len: 92 to MEMORY
2024-04-24T01:13:30,977  INFO [localfetcher#10] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1248143912_0011_m_000000_0
2024-04-24T01:13:30,977  INFO [localfetcher#10] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 2, commitMemory -> 88, usedMemory ->176
2024-04-24T01:13:30,978  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:30,978  INFO [pool-58-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T01:13:30,978  INFO [pool-58-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:30,984  INFO [pool-58-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T01:13:30,984  INFO [pool-58-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 104 bytes
2024-04-24T01:13:30,987  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 176 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:30,987  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merging 1 files, 178 bytes from disk
2024-04-24T01:13:30,987  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:30,987  INFO [pool-58-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:30,987  INFO [pool-58-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 138 bytes
2024-04-24T01:13:30,987  INFO [pool-58-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T01:13:30,988  INFO [pool-58-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:30,989  INFO [pool-58-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,40KB
2024-04-24T01:13:30,990  INFO [pool-58-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:30,990  INFO [pool-58-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:30,990  INFO [pool-58-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int>>
2024-04-24T01:13:30,990  INFO [pool-58-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:30,991  INFO [pool-58-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@4d13fb13, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@6b851395, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@bba30cc
2024-04-24T01:13:30,992  INFO [pool-58-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-30_202_918454777108310562-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-30_202_918454777108310562-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:30,992  INFO [pool-58-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-30_202_918454777108310562-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-30_202_918454777108310562-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:30,992  INFO [pool-58-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-30_202_918454777108310562-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-30_202_918454777108310562-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:31,000  INFO [pool-58-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:31,000  INFO [pool-58-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:31,001  INFO [pool-58-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:31,001  INFO [pool-58-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:31,001  INFO [pool-58-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T01:13:31,001  INFO [pool-58-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-24T01:13:31,002  INFO [pool-58-thread-1] mapred.Task: Task:attempt_local1248143912_0011_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:31,002  INFO [pool-58-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:31,002  INFO [pool-58-thread-1] mapred.Task: Task 'attempt_local1248143912_0011_r_000000_0' done.
2024-04-24T01:13:31,002  INFO [pool-58-thread-1] mapred.Task: Final Counters for attempt_local1248143912_0011_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=250266
		FILE: Number of bytes written=13070186
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=184
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1129840640
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:31,002  INFO [pool-58-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1248143912_0011_r_000000_0
2024-04-24T01:13:31,003  INFO [Thread-996] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:31,903 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:31,903  INFO [main] exec.Task: 2024-04-24 01:13:31,903 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1248143912_0011
2024-04-24T01:13:31,903  INFO [main] exec.Task: Ended Job = job_local1248143912_0011
2024-04-24T01:13:31,905  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:31,905  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:31,905  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:31,905  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:31,905  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:31,905  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414); Time taken: 1.402 seconds
2024-04-24T01:13:31,905  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011330_a5e01571-4232-4d94-97a0-69593a09c414
2024-04-24T01:13:31,909  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T01:13:31,916  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:31,916  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T01:13:31,920  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:31,921  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-24T01:13:31,922  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:4, 
2024-04-24T01:13:31,922  WARN [main] ql.TestTxnAddPartition: addPartitionVectorized: read data(add 2 parts w/data and 1 empty vect): 
2024-04-24T01:13:31,922  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4

2024-04-24T01:13:31,922  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:31,922  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-30_202_918454777108310562-1
2024-04-24T01:13:31,923  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-30_202_918454777108310562-1 on fs with scheme file
2024-04-24T01:13:31,923  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011331_13e37b57-50ae-4657-865b-29d8c92afcc4): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:31,926  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T01:13:31,927  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T01:13:31,927  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:31,930  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:31,930  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:31,931  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:31,939  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:31,940  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:31,940  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:31,940  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:31,958  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:31,970  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:31,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:31,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:32,004  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:32,015  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T01:13:32,016  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T01:13:32,064  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:32,064  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:32,064  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:32,066  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:32,069  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T01:13:32,069  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2]}
2024-04-24T01:13:32,070  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:32,085  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:32,095  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:32,095  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:32,095  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:32,097  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:32,097  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:32,097  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:32,097  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T01:13:32,097  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:32,097  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=7, commitTxn_(CommitTxnRequest)=10, getAggrColStatsFor_(String, String, List, List, String, String)=21, getTable_(GetTableRequest)=8, flushCache_()=0, getValidWriteIds_(List, String)=2, listPartitions_(String, String, short)=10, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:32,098  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011331_13e37b57-50ae-4657-865b-29d8c92afcc4); Time taken: 0.174 seconds
2024-04-24T01:13:32,098  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011331_13e37b57-50ae-4657-865b-29d8c92afcc4): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:32,098  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T01:13:32,110  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:32,110  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T01:13:32,110  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011331_13e37b57-50ae-4657-865b-29d8c92afcc4); Time taken: 0.012 seconds
2024-04-24T01:13:32,110  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:32,116  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T01:13:32,124  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:32,124  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T01:13:32,125  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:32,125  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-31_923_787013300383651333-1
2024-04-24T01:13:32,125  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-31_923_787013300383651333-1 on fs with scheme file
2024-04-24T01:13:32,125  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011332_9e665117-4a6d-40f8-be14-c055221b0b96): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:32,126  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:32,135  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,137  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T01:13:32,138  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T01:13:32,140  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:32,150  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,150  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:32,150  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:32,150  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:32,150  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:32,151  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:32,151  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:32,151  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:32,151  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=0, getCurrentNotificationEventId_()=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=19, commitTxn_(CommitTxnRequest)=14}
2024-04-24T01:13:32,151  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011332_9e665117-4a6d-40f8-be14-c055221b0b96); Time taken: 0.026 seconds
2024-04-24T01:13:32,151  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424011332_9e665117-4a6d-40f8-be14-c055221b0b96
2024-04-24T01:13:32,152  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011332_9e665117-4a6d-40f8-be14-c055221b0b96
2024-04-24T01:13:32,166  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011332_9e665117-4a6d-40f8-be14-c055221b0b96 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T01:13:32,166  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:32,166  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011332_9e665117-4a6d-40f8-be14-c055221b0b96): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:32,167  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:32,167  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:32,167  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:32,167  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:32,167  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:32,177  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:32,182  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:32,182  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:32,182  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011332_9e665117-4a6d-40f8-be14-c055221b0b96); Time taken: 0.016 seconds
2024-04-24T01:13:32,182  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011332_9e665117-4a6d-40f8-be14-c055221b0b96
2024-04-24T01:13:32,186  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T01:13:32,192  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:32,193  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T01:13:32,193  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011332_ac857eec-0aa8-457a-99e7-a522382b618c): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:32,196  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T01:13:32,196  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T01:13:32,197  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:32,208  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,217  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-24T01:13:32,218  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-24T01:13:32,219  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:32,219  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:32,219  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:32,219  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, allocateTableWriteId_(long, String, String)=8, getTable_(GetTableRequest)=11, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T01:13:32,219  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011332_ac857eec-0aa8-457a-99e7-a522382b618c); Time taken: 0.026 seconds
2024-04-24T01:13:32,219  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424011332_ac857eec-0aa8-457a-99e7-a522382b618c
2024-04-24T01:13:32,219  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011332_ac857eec-0aa8-457a-99e7-a522382b618c
2024-04-24T01:13:32,234  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011332_ac857eec-0aa8-457a-99e7-a522382b618c LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T01:13:32,234  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:32,238  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011332_ac857eec-0aa8-457a-99e7-a522382b618c): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:32,238  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:32,238  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:32,246  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:32,265 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T01:13:32,265 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T01:13:32,267 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-24T01:13:32,268 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T01:13:32,269 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T01:13:32,269  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:32,270  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:32,270  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011332_ac857eec-0aa8-457a-99e7-a522382b618c); Time taken: 0.031 seconds
2024-04-24T01:13:32,270  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011332_ac857eec-0aa8-457a-99e7-a522382b618c
2024-04-24T01:13:32,273  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:32,280  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:32,280  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011332_7c7aaccf-97a6-4b7c-b8b1-c07819f31314): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:32,283  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T01:13:32,283  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T01:13:32,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:32,291  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,293  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:32,305  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-24T01:13:32,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:32,337  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-24T01:13:32,337  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-24T01:13:32,338  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:32,338  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:32,338  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:32,338  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=24, allocateTableWriteId_(long, String, String)=8, getValidTxns_(long)=1, rollbackTxn_(long)=10, flushCache_()=0, getTable_(GetTableRequest)=7, openTxn_(String, TxnType)=2}
2024-04-24T01:13:32,339  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011332_7c7aaccf-97a6-4b7c-b8b1-c07819f31314); Time taken: 0.058 seconds
2024-04-24T01:13:32,339  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424011332_7c7aaccf-97a6-4b7c-b8b1-c07819f31314
2024-04-24T01:13:32,339  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011332_7c7aaccf-97a6-4b7c-b8b1-c07819f31314
2024-04-24T01:13:32,362  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011332_7c7aaccf-97a6-4b7c-b8b1-c07819f31314 LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T01:13:32,362  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:32,373  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011332_7c7aaccf-97a6-4b7c-b8b1-c07819f31314): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:32,373  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:32,373  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:32,382  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,382  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:32,391  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T01:13:32,393  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T01:13:32,395  INFO [HMSHandler #12] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3
2024-04-24T01:13:32,417  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-24T01:13:32,417  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data
2024-04-24T01:13:32,417  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:32,425  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:32,437  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-24T01:13:32,437  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:32,437  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:32,444  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:32,455  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-24T01:13:32,459  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:32,459  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-24T01:13:32,500  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:32,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:32,542  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:32,542  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=1, add_partitions_(List, boolean, boolean)=35, getTable_(GetTableRequest)=24, getPartitionWithAuthInfo_(String, String, List, String, List)=37, validatePartitionNameCharacters_(List)=0, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=67, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:32,542  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011332_7c7aaccf-97a6-4b7c-b8b1-c07819f31314); Time taken: 0.168 seconds
2024-04-24T01:13:32,542  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011332_7c7aaccf-97a6-4b7c-b8b1-c07819f31314
2024-04-24T01:13:32,548  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T01:13:32,557  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:32,559  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T01:13:32,560  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:32,560  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:32,563  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-24T01:13:32,564  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T01:13:32,564  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:32,564  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:32,571  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:32,571  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:32,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:32,583  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,584  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:32,584  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:32,584  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:32,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:32,634  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:32,634  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:32,687  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:32,697  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:32,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:32,714  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:32,714  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:32,768  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:32,768  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:32,768  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:32,770  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-32_560_3812883307298338839-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-32_560_3812883307298338839-1
2024-04-24T01:13:32,777  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:32,780  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T01:13:32,780  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2]}
2024-04-24T01:13:32,781  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:32,781  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:32,792  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:32,793  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:32,793  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:32,795  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:32,795  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:32,795  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:32,795  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:32,795  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T01:13:32,796  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-24T01:13:32,796  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:32,796  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=11, listPartitions_(String, String, short)=35, openTxn_(String, TxnType)=3, getAggrColStatsFor_(String, String, List, List, String, String)=26, commitTxn_(CommitTxnRequest)=17, getValidTxns_(long)=0, getValidWriteIds_(List, String)=6, getAllTableConstraints_(AllTableConstraintsRequest)=29, flushCache_()=0}
2024-04-24T01:13:32,797  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073); Time taken: 0.236 seconds
2024-04-24T01:13:32,797  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073
2024-04-24T01:13:32,798  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073
2024-04-24T01:13:32,816  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073 LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T01:13:32,816  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:32,817  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:32,817  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073
2024-04-24T01:13:32,817  INFO [main] ql.Driver: Query ID = alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073
Total jobs = 1
2024-04-24T01:13:32,817  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:32,817  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:32,981  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:32,981  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:32,981  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:32,981  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:32,981  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:32,981  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:32,981  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:32,981  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:32,984  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:32,984  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:32,984  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:32,991  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-32_560_3812883307298338839-1/-mr-10004/af581b65-a847-4693-b434-a648837e56da (false)
2024-04-24T01:13:33,000  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:33,002  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T01:13:33,006  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:33,008  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T01:13:33,009  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:33,014  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:33,022  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:33,026  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:33,027  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:33,027  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:33,027  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:33,028  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:33,028  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: default 
2024-04-24T01:13:33,028  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:33,042  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-24T01:13:33,042  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 14 ms
2024-04-24T01:13:33,042  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T01:13:33,060  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T01:13:33,080  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local92327530_0012
2024-04-24T01:13:33,080  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:33,143  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:33,143  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:33,143  INFO [Thread-1091] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:33,143  INFO [Thread-1091] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:33,146  INFO [Thread-1091] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:33,146  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local92327530_0012_m_000000_0
2024-04-24T01:13:33,146  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:33,147  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,147  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:33,148  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T01:13:33,149  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,150  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:33,151  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:33,157  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:33,157  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:33,157  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:33,157  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:33,157  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:33,158  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:33,158  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:33,159  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:33,159  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:33,159  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:33,159  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:33,159  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:33,160  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T01:13:33,161  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:33,161  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:33,161  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:33,161  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T01:13:33,161  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:33,171  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:33,174  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local92327530_0012_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:33,175  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,175  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local92327530_0012_m_000000_0' done.
2024-04-24T01:13:33,175  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local92327530_0012_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=267291
		FILE: Number of bytes written=14258600
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1129840640
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-24T01:13:33,175  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local92327530_0012_m_000000_0
2024-04-24T01:13:33,175  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local92327530_0012_m_000001_0
2024-04-24T01:13:33,176  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:33,176  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,176  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:33,177  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T01:13:33,178  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,188  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:33,189  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:33,194  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:33,194  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:33,194  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:33,194  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:33,194  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:33,195  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:33,195  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:33,195  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:33,196  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:33,196  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:33,196  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:33,196  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:33,197  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:33,198  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:33,198  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:33,198  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:33,198  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:33,198  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T01:13:33,198  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:33,206  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:33,209  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local92327530_0012_m_000001_0 is done. And is in the process of committing
2024-04-24T01:13:33,209  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,209  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local92327530_0012_m_000001_0' done.
2024-04-24T01:13:33,209  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local92327530_0012_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=276905
		FILE: Number of bytes written=14258724
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=9
		Total committed heap usage (bytes)=1130364928
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-24T01:13:33,210  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local92327530_0012_m_000001_0
2024-04-24T01:13:33,210  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local92327530_0012_m_000002_0
2024-04-24T01:13:33,210  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:33,211  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,211  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:33,212  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T01:13:33,213  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,213  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:33,214  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:33,219  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:33,219  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:33,219  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:33,219  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:33,219  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:33,220  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:33,220  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:33,220  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:33,221  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:33,221  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:33,221  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T01:13:33,221  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T01:13:33,222  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:33,223  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:33,223  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:33,223  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:33,223  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T01:13:33,223  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:33,232  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:33,235  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local92327530_0012_m_000002_0 is done. And is in the process of committing
2024-04-24T01:13:33,235  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:33,236  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local92327530_0012_m_000002_0' done.
2024-04-24T01:13:33,236  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local92327530_0012_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=286007
		FILE: Number of bytes written=14258848
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130364928
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-24T01:13:33,236  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local92327530_0012_m_000002_0
2024-04-24T01:13:33,236  INFO [Thread-1091] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:33,236  INFO [Thread-1091] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:33,237  INFO [pool-62-thread-1] mapred.LocalJobRunner: Starting task: attempt_local92327530_0012_r_000000_0
2024-04-24T01:13:33,237  INFO [pool-62-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:33,237  INFO [pool-62-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2dac7511
2024-04-24T01:13:33,237  WARN [pool-62-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:33,238  INFO [pool-62-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:33,239  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local92327530_0012_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:33,240  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local92327530_0012_m_000002_0 decomp: 88 len: 92 to MEMORY
2024-04-24T01:13:33,240  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local92327530_0012_m_000002_0
2024-04-24T01:13:33,240  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->88
2024-04-24T01:13:33,242  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local92327530_0012_m_000001_0 decomp: 88 len: 92 to MEMORY
2024-04-24T01:13:33,242  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local92327530_0012_m_000001_0
2024-04-24T01:13:33,242  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 2, commitMemory -> 88, usedMemory ->176
2024-04-24T01:13:33,245  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local92327530_0012_m_000000_0 decomp: 88 len: 92 to MEMORY
2024-04-24T01:13:33,245  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local92327530_0012_m_000000_0
2024-04-24T01:13:33,245  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 3, commitMemory -> 176, usedMemory ->264
2024-04-24T01:13:33,245  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:33,245  INFO [pool-62-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T01:13:33,245  INFO [pool-62-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:33,253  INFO [pool-62-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-24T01:13:33,253  INFO [pool-62-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 156 bytes
2024-04-24T01:13:33,256  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 264 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:33,256  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merging 1 files, 264 bytes from disk
2024-04-24T01:13:33,256  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:33,256  INFO [pool-62-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:33,256  INFO [pool-62-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 224 bytes
2024-04-24T01:13:33,256  INFO [pool-62-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T01:13:33,257  INFO [pool-62-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:33,257  INFO [pool-62-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T01:13:33,258  INFO [pool-62-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:33,258  INFO [pool-62-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:33,258  INFO [pool-62-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int>>
2024-04-24T01:13:33,258  INFO [pool-62-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:33,259  INFO [pool-62-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@4f5ad340, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@6379560, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@4d78ad95
2024-04-24T01:13:33,259  INFO [pool-62-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-32_560_3812883307298338839-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-32_560_3812883307298338839-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:33,259  INFO [pool-62-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-32_560_3812883307298338839-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-32_560_3812883307298338839-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:33,259  INFO [pool-62-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-32_560_3812883307298338839-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-32_560_3812883307298338839-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:33,266  INFO [pool-62-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:33,267  INFO [pool-62-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:33,267  INFO [pool-62-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:33,267  INFO [pool-62-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:33,267  INFO [pool-62-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-24T01:13:33,268  INFO [pool-62-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, RECORDS_OUT_OPERATOR_FS_4:6, 
2024-04-24T01:13:33,268  INFO [pool-62-thread-1] mapred.Task: Task:attempt_local92327530_0012_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:33,268  INFO [pool-62-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:33,268  INFO [pool-62-thread-1] mapred.Task: Task 'attempt_local92327530_0012_r_000000_0' done.
2024-04-24T01:13:33,269  INFO [pool-62-thread-1] mapred.Task: Final Counters for attempt_local92327530_0012_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=294126
		FILE: Number of bytes written=14259403
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=276
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1130364928
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:33,269  INFO [pool-62-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local92327530_0012_r_000000_0
2024-04-24T01:13:33,269  INFO [Thread-1091] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:34,145 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:34,145  INFO [main] exec.Task: 2024-04-24 01:13:34,145 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local92327530_0012
2024-04-24T01:13:34,146  INFO [main] exec.Task: Ended Job = job_local92327530_0012
2024-04-24T01:13:34,148  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:34,148  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:34,149  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:34,149  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:34,149  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:34,149  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073); Time taken: 1.331 seconds
2024-04-24T01:13:34,149  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011332_7f965dde-f132-45fe-80c1-cfe7429fb073
2024-04-24T01:13:34,154  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T01:13:34,160  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:34,161  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T01:13:34,165  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:34,166  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-24T01:13:34,166  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:6, 
2024-04-24T01:13:34,166  WARN [main] ql.TestTxnAddPartition: addPartitionVectorized: read data(add 2 existing parts and 1 empty vect): 
2024-04-24T01:13:34,166  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4
{"writeid":3,"bucketid":536870912,"rowid":0}	3	0	2
{"writeid":3,"bucketid":536870912,"rowid":1}	3	0	4

2024-04-24T01:13:34,166  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:34,167  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-32_560_3812883307298338839-1
2024-04-24T01:13:34,168  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-32_560_3812883307298338839-1 on fs with scheme file
2024-04-24T01:13:34,168  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011334_fcc83b49-c344-46d4-b8c7-1b781160b3cd): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:34,174  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-24T01:13:34,175  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T01:13:34,177  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:34,180  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:34,180  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:34,180  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:34,188  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,188  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:34,188  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:34,188  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:34,203  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:34,215  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:34,216  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:34,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:34,256  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:34,267  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T01:13:34,267  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T01:13:34,326  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:34,327  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:34,327  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:34,329  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:34,334  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3]}
2024-04-24T01:13:34,334  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3]}
2024-04-24T01:13:34,335  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:34,359  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:34,370  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:34,371  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:34,371  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:34,372  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:34,372  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:34,372  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:34,373  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T01:13:34,373  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:34,373  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {listPartitions_(String, String, short)=11, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=6, getValidWriteIds_(List, String)=4, getAggrColStatsFor_(String, String, List, List, String, String)=20, getValidTxns_(long)=2, getAllTableConstraints_(AllTableConstraintsRequest)=6, flushCache_()=0}
2024-04-24T01:13:34,373  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011334_fcc83b49-c344-46d4-b8c7-1b781160b3cd); Time taken: 0.205 seconds
2024-04-24T01:13:34,373  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011334_fcc83b49-c344-46d4-b8c7-1b781160b3cd): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T01:13:34,373  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T01:13:34,385  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:34,385  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T01:13:34,386  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011334_fcc83b49-c344-46d4-b8c7-1b781160b3cd); Time taken: 0.012 seconds
2024-04-24T01:13:34,386  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:34,392  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T01:13:34,400  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:34,400  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T01:13:34,401  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:34,402  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-34_168_6324333669071791536-1
2024-04-24T01:13:34,402  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e80f1c0-321f-40e7-b8da-9a54f71b598d/hive_2024-04-24_01-13-34_168_6324333669071791536-1 on fs with scheme file
2024-04-24T01:13:34,402  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011334_e1a82252-4aaf-4ec9-9cd9-ef6b86a4ffd7): drop table if exists acidTbl
2024-04-24T01:13:34,405  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-24T01:13:34,405  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T01:13:34,406  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:34,414  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,414  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:34,414  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:34,414  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:34,414  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=15, flushCache_()=0}
2024-04-24T01:13:34,414  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011334_e1a82252-4aaf-4ec9-9cd9-ef6b86a4ffd7); Time taken: 0.012 seconds
2024-04-24T01:13:34,415  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424011334_e1a82252-4aaf-4ec9-9cd9-ef6b86a4ffd7
2024-04-24T01:13:34,415  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011334_e1a82252-4aaf-4ec9-9cd9-ef6b86a4ffd7
2024-04-24T01:13:34,433  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011334_e1a82252-4aaf-4ec9-9cd9-ef6b86a4ffd7 LockResponse(lockid:20, state:ACQUIRED)
2024-04-24T01:13:34,433  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:34,433  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011334_e1a82252-4aaf-4ec9-9cd9-ef6b86a4ffd7): drop table if exists acidTbl
2024-04-24T01:13:34,433  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:34,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:34,442  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:34,450  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:34,577  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:34,578  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=135, getTable_(GetTableRequest)=9}
2024-04-24T01:13:34,578  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011334_e1a82252-4aaf-4ec9-9cd9-ef6b86a4ffd7); Time taken: 0.144 seconds
2024-04-24T01:13:34,578  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011334_e1a82252-4aaf-4ec9-9cd9-ef6b86a4ffd7
2024-04-24T01:13:34,582  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T01:13:34,589  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:34,589  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T01:13:34,590  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:34,590  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011334_90ea7535-1b3c-411b-ad15-8ef21fbe6299): drop table if exists acidTblPart
2024-04-24T01:13:34,598  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-24T01:13:34,598  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-24T01:13:34,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:34,618  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,618  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:34,618  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:34,618  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:34,619  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=19, openTxn_(String, TxnType)=8, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-24T01:13:34,619  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011334_90ea7535-1b3c-411b-ad15-8ef21fbe6299); Time taken: 0.028 seconds
2024-04-24T01:13:34,619  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240424011334_90ea7535-1b3c-411b-ad15-8ef21fbe6299
2024-04-24T01:13:34,619  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011334_90ea7535-1b3c-411b-ad15-8ef21fbe6299
2024-04-24T01:13:34,638  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011334_90ea7535-1b3c-411b-ad15-8ef21fbe6299 LockResponse(lockid:21, state:ACQUIRED)
2024-04-24T01:13:34,638  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:34,638  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011334_90ea7535-1b3c-411b-ad15-8ef21fbe6299): drop table if exists acidTblPart
2024-04-24T01:13:34,638  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:34,639  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:34,650  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,650  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:34,658  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,658  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:34,705  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:34,706  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=11, dropTable_(String, String, boolean, boolean, boolean)=55}
2024-04-24T01:13:34,706  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011334_90ea7535-1b3c-411b-ad15-8ef21fbe6299); Time taken: 0.067 seconds
2024-04-24T01:13:34,706  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011334_90ea7535-1b3c-411b-ad15-8ef21fbe6299
2024-04-24T01:13:34,710  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-24T01:13:34,716  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:34,716  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-24T01:13:34,716  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:34,717  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011334_31d167f3-8c04-47ff-a9ad-78c8541af164): drop table if exists acidTbl2
2024-04-24T01:13:34,719  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-24T01:13:34,720  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-24T01:13:34,721  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:34,721  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:34,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:34,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T01:13:34,721  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011334_31d167f3-8c04-47ff-a9ad-78c8541af164); Time taken: 0.004 seconds
2024-04-24T01:13:34,722  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240424011334_31d167f3-8c04-47ff-a9ad-78c8541af164
2024-04-24T01:13:34,722  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:34,722  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011334_31d167f3-8c04-47ff-a9ad-78c8541af164): drop table if exists acidTbl2
2024-04-24T01:13:34,722  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:34,723  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T01:13:34,723  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:34,724  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=1}
2024-04-24T01:13:34,724  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011334_31d167f3-8c04-47ff-a9ad-78c8541af164); Time taken: 0.001 seconds
2024-04-24T01:13:34,724  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011334_31d167f3-8c04-47ff-a9ad-78c8541af164
2024-04-24T01:13:34,731  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-24T01:13:34,737  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:34,737  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-24T01:13:34,737  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:34,738  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011334_f7bd630b-e404-4107-ad39-bff0a95a6134): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:34,740  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-24T01:13:34,741  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-24T01:13:34,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:34,765  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,765  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:34,765  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:34,765  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:34,765  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=24, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=13}
2024-04-24T01:13:34,765  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011334_f7bd630b-e404-4107-ad39-bff0a95a6134); Time taken: 0.027 seconds
2024-04-24T01:13:34,766  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240424011334_f7bd630b-e404-4107-ad39-bff0a95a6134
2024-04-24T01:13:34,766  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011334_f7bd630b-e404-4107-ad39-bff0a95a6134
2024-04-24T01:13:34,783  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011334_f7bd630b-e404-4107-ad39-bff0a95a6134 LockResponse(lockid:22, state:ACQUIRED)
2024-04-24T01:13:34,783  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:34,783  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011334_f7bd630b-e404-4107-ad39-bff0a95a6134): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:34,783  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:34,783  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:34,792  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,793  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:34,802  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:34,851  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:34,851  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=59, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:34,851  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011334_f7bd630b-e404-4107-ad39-bff0a95a6134); Time taken: 0.068 seconds
2024-04-24T01:13:34,851  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011334_f7bd630b-e404-4107-ad39-bff0a95a6134
2024-04-24T01:13:34,855  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-24T01:13:34,861  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:34,862  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-24T01:13:34,862  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:34,863  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011334_dd8a8ed7-3245-4930-bef2-810cd6c018fc): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:34,865  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-24T01:13:34,866  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-24T01:13:34,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:34,875  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,876  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:34,876  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:34,876  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:34,876  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=9}
2024-04-24T01:13:34,876  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011334_dd8a8ed7-3245-4930-bef2-810cd6c018fc); Time taken: 0.013 seconds
2024-04-24T01:13:34,876  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240424011334_dd8a8ed7-3245-4930-bef2-810cd6c018fc
2024-04-24T01:13:34,877  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011334_dd8a8ed7-3245-4930-bef2-810cd6c018fc
2024-04-24T01:13:34,891  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011334_dd8a8ed7-3245-4930-bef2-810cd6c018fc LockResponse(lockid:23, state:ACQUIRED)
2024-04-24T01:13:34,891  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:34,892  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011334_dd8a8ed7-3245-4930-bef2-810cd6c018fc): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:34,892  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:34,892  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:34,906  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,906  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:34,916  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,916  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:34,959  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:34,959  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=14, dropTable_(String, String, boolean, boolean, boolean)=53, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:34,959  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011334_dd8a8ed7-3245-4930-bef2-810cd6c018fc); Time taken: 0.067 seconds
2024-04-24T01:13:34,959  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011334_dd8a8ed7-3245-4930-bef2-810cd6c018fc
2024-04-24T01:13:34,965  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-24T01:13:34,973  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:34,973  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-24T01:13:34,974  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:34,975  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011334_155421fb-1a7e-4fd5-a350-0bf28eccaa31): drop table if exists nonAcidNonBucket
2024-04-24T01:13:34,977  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-24T01:13:34,977  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-24T01:13:34,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:34,989  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:34,989  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:34,989  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:34,989  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:34,989  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=11}
2024-04-24T01:13:34,989  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011334_155421fb-1a7e-4fd5-a350-0bf28eccaa31); Time taken: 0.014 seconds
2024-04-24T01:13:34,989  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240424011334_155421fb-1a7e-4fd5-a350-0bf28eccaa31
2024-04-24T01:13:34,990  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011334_155421fb-1a7e-4fd5-a350-0bf28eccaa31
2024-04-24T01:13:35,006  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011334_155421fb-1a7e-4fd5-a350-0bf28eccaa31 LockResponse(lockid:24, state:ACQUIRED)
2024-04-24T01:13:35,007  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:35,007  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011334_155421fb-1a7e-4fd5-a350-0bf28eccaa31): drop table if exists nonAcidNonBucket
2024-04-24T01:13:35,007  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,007  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:35,018  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:35,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:35,029  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:35,029  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:35,067  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,068  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=12, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=48}
2024-04-24T01:13:35,068  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011334_155421fb-1a7e-4fd5-a350-0bf28eccaa31); Time taken: 0.06 seconds
2024-04-24T01:13:35,068  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011334_155421fb-1a7e-4fd5-a350-0bf28eccaa31
2024-04-24T01:13:35,072  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-24T01:13:35,079  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,080  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-24T01:13:35,080  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T01:13:35,161  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T01:13:35,161  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T01:13:35,161  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T01:13:35,162  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T01:13:35,162  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T01:13:35,162  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T01:13:35,162  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T01:13:35,162  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T01:13:35,162  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T01:13:35,162  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T01:13:35,162  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T01:13:35,164  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 6aeab11d-3227-4d54-8821-713cb688814b
2024-04-24T01:13:35,167  INFO [main] SessionState: Hive Session ID = 6aeab11d-3227-4d54-8821-713cb688814b
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:35,168  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:35,173  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6aeab11d-3227-4d54-8821-713cb688814b
2024-04-24T01:13:35,176  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b
2024-04-24T01:13:35,178  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6aeab11d-3227-4d54-8821-713cb688814b/_tmp_space.db
2024-04-24T01:13:35,179  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=6aeab11d-3227-4d54-8821-713cb688814b, clientType=HIVECLI]
2024-04-24T01:13:35,179  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:35,179  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_96fec60e-abfe-4719-9213-20e3b5e6573a): drop table if exists acidTbl
2024-04-24T01:13:35,188  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T01:13:35,188  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T01:13:35,191  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:35,194  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,194  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,194  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,194  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=8}
2024-04-24T01:13:35,194  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_96fec60e-abfe-4719-9213-20e3b5e6573a); Time taken: 0.015 seconds
2024-04-24T01:13:35,195  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424011335_96fec60e-abfe-4719-9213-20e3b5e6573a
2024-04-24T01:13:35,195  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:35,195  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_96fec60e-abfe-4719-9213-20e3b5e6573a): drop table if exists acidTbl
2024-04-24T01:13:35,195  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:35,199  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,199  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,199  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_96fec60e-abfe-4719-9213-20e3b5e6573a); Time taken: 0.004 seconds
2024-04-24T01:13:35,200  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_96fec60e-abfe-4719-9213-20e3b5e6573a
2024-04-24T01:13:35,208  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T01:13:35,216  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,216  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T01:13:35,217  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:35,217  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_5e5626ea-bd03-4efd-b40b-dfe7b2ba6f03): drop table if exists acidTblPart
2024-04-24T01:13:35,220  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T01:13:35,221  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T01:13:35,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:35,226  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,226  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,226  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,227  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=17}
2024-04-24T01:13:35,227  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_5e5626ea-bd03-4efd-b40b-dfe7b2ba6f03); Time taken: 0.009 seconds
2024-04-24T01:13:35,227  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424011335_5e5626ea-bd03-4efd-b40b-dfe7b2ba6f03
2024-04-24T01:13:35,227  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:35,227  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_5e5626ea-bd03-4efd-b40b-dfe7b2ba6f03): drop table if exists acidTblPart
2024-04-24T01:13:35,227  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:35,233  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,233  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,233  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_5e5626ea-bd03-4efd-b40b-dfe7b2ba6f03); Time taken: 0.006 seconds
2024-04-24T01:13:35,233  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_5e5626ea-bd03-4efd-b40b-dfe7b2ba6f03
2024-04-24T01:13:35,240  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T01:13:35,246  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,246  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T01:13:35,247  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:35,247  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_62eb2af0-7762-430b-a02d-edfece33ad74): drop table if exists acidTbl2
2024-04-24T01:13:35,249  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T01:13:35,250  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T01:13:35,250  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:35,253  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,253  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,254  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,254  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, flushCache_()=1, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T01:13:35,254  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_62eb2af0-7762-430b-a02d-edfece33ad74); Time taken: 0.007 seconds
2024-04-24T01:13:35,254  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424011335_62eb2af0-7762-430b-a02d-edfece33ad74
2024-04-24T01:13:35,254  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:35,254  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_62eb2af0-7762-430b-a02d-edfece33ad74): drop table if exists acidTbl2
2024-04-24T01:13:35,254  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:35,258  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,258  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,258  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_62eb2af0-7762-430b-a02d-edfece33ad74); Time taken: 0.004 seconds
2024-04-24T01:13:35,258  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_62eb2af0-7762-430b-a02d-edfece33ad74
2024-04-24T01:13:35,264  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T01:13:35,270  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,270  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T01:13:35,271  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:35,271  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_9033bb20-6c7a-48db-9806-effe3a1df149): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:35,274  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T01:13:35,274  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T01:13:35,275  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:35,278  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,278  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,278  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,278  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T01:13:35,278  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_9033bb20-6c7a-48db-9806-effe3a1df149); Time taken: 0.007 seconds
2024-04-24T01:13:35,279  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424011335_9033bb20-6c7a-48db-9806-effe3a1df149
2024-04-24T01:13:35,279  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:35,279  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_9033bb20-6c7a-48db-9806-effe3a1df149): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:35,279  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,279  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:35,282  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,283  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,283  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_9033bb20-6c7a-48db-9806-effe3a1df149); Time taken: 0.003 seconds
2024-04-24T01:13:35,283  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_9033bb20-6c7a-48db-9806-effe3a1df149
2024-04-24T01:13:35,288  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T01:13:35,295  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,295  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T01:13:35,295  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:35,296  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_8bc4b468-b2f2-4cac-9083-f76f70229411): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:35,298  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T01:13:35,298  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T01:13:35,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:35,302  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,302  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,302  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,302  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:35,302  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_8bc4b468-b2f2-4cac-9083-f76f70229411); Time taken: 0.006 seconds
2024-04-24T01:13:35,303  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424011335_8bc4b468-b2f2-4cac-9083-f76f70229411
2024-04-24T01:13:35,303  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:35,303  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_8bc4b468-b2f2-4cac-9083-f76f70229411): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:35,303  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,303  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:35,307  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,307  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,307  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_8bc4b468-b2f2-4cac-9083-f76f70229411); Time taken: 0.004 seconds
2024-04-24T01:13:35,307  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_8bc4b468-b2f2-4cac-9083-f76f70229411
2024-04-24T01:13:35,313  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T01:13:35,319  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,320  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T01:13:35,320  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:35,320  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_59f6d0b1-6633-472c-a6e2-921e43d49ce6): drop table if exists nonAcidNonBucket
2024-04-24T01:13:35,323  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T01:13:35,323  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T01:13:35,324  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:35,327  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,327  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,327  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,328  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=13}
2024-04-24T01:13:35,328  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_59f6d0b1-6633-472c-a6e2-921e43d49ce6); Time taken: 0.007 seconds
2024-04-24T01:13:35,328  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424011335_59f6d0b1-6633-472c-a6e2-921e43d49ce6
2024-04-24T01:13:35,328  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:35,328  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_59f6d0b1-6633-472c-a6e2-921e43d49ce6): drop table if exists nonAcidNonBucket
2024-04-24T01:13:35,328  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,328  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:35,332  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,332  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,332  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_59f6d0b1-6633-472c-a6e2-921e43d49ce6); Time taken: 0.004 seconds
2024-04-24T01:13:35,332  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_59f6d0b1-6633-472c-a6e2-921e43d49ce6
2024-04-24T01:13:35,338  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T01:13:35,345  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,345  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T01:13:35,346  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,346  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_b04c44e2-ff11-4eba-9b45-382b7c53600e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,350  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T01:13:35,350  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T01:13:35,351  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:35,351  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:35,357  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T01:13:35,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:35,360  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:35,360  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,360  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,360  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,360  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=3, flushCache_()=0, getValidWriteIds_(List, String)=6, getDatabase_(String)=2}
2024-04-24T01:13:35,360  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_b04c44e2-ff11-4eba-9b45-382b7c53600e); Time taken: 0.014 seconds
2024-04-24T01:13:35,361  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424011335_b04c44e2-ff11-4eba-9b45-382b7c53600e
2024-04-24T01:13:35,361  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011335_b04c44e2-ff11-4eba-9b45-382b7c53600e
2024-04-24T01:13:35,384  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011335_b04c44e2-ff11-4eba-9b45-382b7c53600e LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T01:13:35,384  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:35,385  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_b04c44e2-ff11-4eba-9b45-382b7c53600e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,385  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,386  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713946415, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, bucketing_version=2, numRows=0, numFilesErasureCoded=0, transactional=true, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:35,393  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtbl
2024-04-24T01:13:35,436  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,436  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=50, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,436  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_b04c44e2-ff11-4eba-9b45-382b7c53600e); Time taken: 0.051 seconds
2024-04-24T01:13:35,437  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_b04c44e2-ff11-4eba-9b45-382b7c53600e
2024-04-24T01:13:35,441  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T01:13:35,447  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,447  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T01:13:35,448  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,448  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_3b934abf-4a5b-49d6-bf4f-830daf9a3899): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,453  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T01:13:35,454  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T01:13:35,454  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:35,454  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:35,457  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T01:13:35,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:35,459  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:35,459  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,459  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,459  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,459  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=5, getValidWriteIds_(List, String)=3, getDatabase_(String)=1, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,459  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_3b934abf-4a5b-49d6-bf4f-830daf9a3899); Time taken: 0.011 seconds
2024-04-24T01:13:35,460  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424011335_3b934abf-4a5b-49d6-bf4f-830daf9a3899
2024-04-24T01:13:35,460  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011335_3b934abf-4a5b-49d6-bf4f-830daf9a3899
2024-04-24T01:13:35,475  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011335_3b934abf-4a5b-49d6-bf4f-830daf9a3899 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T01:13:35,475  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:35,476  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_3b934abf-4a5b-49d6-bf4f-830daf9a3899): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,476  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713946415, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:35,483  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtblpart
2024-04-24T01:13:35,505  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,505  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=28, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,506  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_3b934abf-4a5b-49d6-bf4f-830daf9a3899); Time taken: 0.029 seconds
2024-04-24T01:13:35,506  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_3b934abf-4a5b-49d6-bf4f-830daf9a3899
2024-04-24T01:13:35,510  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T01:13:35,517  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,517  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T01:13:35,518  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,518  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_03cafe8f-8653-44fc-9665-71c13498d24c): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,520  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T01:13:35,521  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T01:13:35,521  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:35,521  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:35,524  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T01:13:35,524  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:35,526  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:35,526  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,526  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,526  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,526  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, flushCache_()=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:35,526  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_03cafe8f-8653-44fc-9665-71c13498d24c); Time taken: 0.008 seconds
2024-04-24T01:13:35,526  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424011335_03cafe8f-8653-44fc-9665-71c13498d24c
2024-04-24T01:13:35,526  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011335_03cafe8f-8653-44fc-9665-71c13498d24c
2024-04-24T01:13:35,542  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011335_03cafe8f-8653-44fc-9665-71c13498d24c LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T01:13:35,542  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:35,542  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_03cafe8f-8653-44fc-9665-71c13498d24c): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,542  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713946415, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, bucketing_version=2, numRows=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:35,549  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl
2024-04-24T01:13:35,565  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,566  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,566  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_03cafe8f-8653-44fc-9665-71c13498d24c); Time taken: 0.023 seconds
2024-04-24T01:13:35,566  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_03cafe8f-8653-44fc-9665-71c13498d24c
2024-04-24T01:13:35,570  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T01:13:35,576  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,576  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T01:13:35,577  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,577  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_da6f6a3b-3cf9-47bc-a816-66df744b6b0e): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,579  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T01:13:35,580  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T01:13:35,580  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:35,580  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:35,584  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T01:13:35,584  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:35,586  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:35,586  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,586  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,587  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,587  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2}
2024-04-24T01:13:35,587  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_da6f6a3b-3cf9-47bc-a816-66df744b6b0e); Time taken: 0.01 seconds
2024-04-24T01:13:35,587  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424011335_da6f6a3b-3cf9-47bc-a816-66df744b6b0e
2024-04-24T01:13:35,588  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011335_da6f6a3b-3cf9-47bc-a816-66df744b6b0e
2024-04-24T01:13:35,611  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011335_da6f6a3b-3cf9-47bc-a816-66df744b6b0e LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T01:13:35,611  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:35,611  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_da6f6a3b-3cf9-47bc-a816-66df744b6b0e): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,611  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,612  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713946415, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, transactional=false, rawDataSize=0, totalSize=0, bucketing_version=2, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:35,623  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl2
2024-04-24T01:13:35,648  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,648  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=36, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:35,648  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_da6f6a3b-3cf9-47bc-a816-66df744b6b0e); Time taken: 0.037 seconds
2024-04-24T01:13:35,648  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_da6f6a3b-3cf9-47bc-a816-66df744b6b0e
2024-04-24T01:13:35,655  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T01:13:35,664  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,664  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T01:13:35,665  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,665  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_cfa1fa62-1573-419b-9a0a-632b33be430b): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,668  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T01:13:35,669  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T01:13:35,669  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:35,669  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:35,673  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T01:13:35,673  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:35,676  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:35,676  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,676  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,676  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,676  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, flushCache_()=0, getValidTxns_(long)=0, getDatabase_(String)=2, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3}
2024-04-24T01:13:35,676  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_cfa1fa62-1573-419b-9a0a-632b33be430b); Time taken: 0.011 seconds
2024-04-24T01:13:35,677  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424011335_cfa1fa62-1573-419b-9a0a-632b33be430b
2024-04-24T01:13:35,677  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011335_cfa1fa62-1573-419b-9a0a-632b33be430b
2024-04-24T01:13:35,698  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011335_cfa1fa62-1573-419b-9a0a-632b33be430b LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T01:13:35,698  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:35,698  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_cfa1fa62-1573-419b-9a0a-632b33be430b): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:35,698  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,700  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6aeab11d-3227-4d54-8821-713cb688814b/_tmp_space.db/cb2dd59f-ace9-494d-99f9-6f7b9f92cc5c
2024-04-24T01:13:35,703  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,703  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-24T01:13:35,703  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_cfa1fa62-1573-419b-9a0a-632b33be430b); Time taken: 0.005 seconds
2024-04-24T01:13:35,703  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_cfa1fa62-1573-419b-9a0a-632b33be430b
2024-04-24T01:13:35,708  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T01:13:35,715  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,715  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T01:13:35,716  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,716  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_b4c34055-218b-4cbd-8f22-ec49114dc410): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,718  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T01:13:35,719  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T01:13:35,719  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:35,719  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:35,722  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T01:13:35,722  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:35,724  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:35,724  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,724  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,724  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,724  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T01:13:35,724  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_b4c34055-218b-4cbd-8f22-ec49114dc410); Time taken: 0.008 seconds
2024-04-24T01:13:35,724  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424011335_b4c34055-218b-4cbd-8f22-ec49114dc410
2024-04-24T01:13:35,725  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011335_b4c34055-218b-4cbd-8f22-ec49114dc410
2024-04-24T01:13:35,743  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011335_b4c34055-218b-4cbd-8f22-ec49114dc410 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T01:13:35,743  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:35,743  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_b4c34055-218b-4cbd-8f22-ec49114dc410): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:35,743  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,744  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713946415, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, rawDataSize=0, numFiles=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:35,751  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidnonbucket
2024-04-24T01:13:35,768  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:35,768  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-24T01:13:35,768  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_b4c34055-218b-4cbd-8f22-ec49114dc410); Time taken: 0.025 seconds
2024-04-24T01:13:35,768  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_b4c34055-218b-4cbd-8f22-ec49114dc410
2024-04-24T01:13:35,773  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T01:13:35,780  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:35,780  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T01:13:35,781  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T01:13:35,781  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011335_d03fd322-5599-4a97-aa99-c113445d879b): drop table if exists T
2024-04-24T01:13:35,783  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T01:13:35,784  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T01:13:35,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:35,809  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:35,809  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:35,809  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:35,809  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:35,809  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=25, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T01:13:35,809  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011335_d03fd322-5599-4a97-aa99-c113445d879b); Time taken: 0.028 seconds
2024-04-24T01:13:35,809  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424011335_d03fd322-5599-4a97-aa99-c113445d879b
2024-04-24T01:13:35,810  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011335_d03fd322-5599-4a97-aa99-c113445d879b
2024-04-24T01:13:35,829  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011335_d03fd322-5599-4a97-aa99-c113445d879b LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T01:13:35,829  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:35,829  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011335_d03fd322-5599-4a97-aa99-c113445d879b): drop table if exists T
2024-04-24T01:13:35,829  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:35,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:35,837  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:35,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:35,844  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:35,845  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T01:13:36,016  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t does not exist; Force to delete it.
2024-04-24T01:13:36,016 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:36,016  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:36,016  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=179}
2024-04-24T01:13:36,016  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011335_d03fd322-5599-4a97-aa99-c113445d879b); Time taken: 0.187 seconds
2024-04-24T01:13:36,016  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011335_d03fd322-5599-4a97-aa99-c113445d879b
2024-04-24T01:13:36,022  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T01:13:36,032  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:36,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T01:13:36,035  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T01:13:36,036  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011336_d384b754-1408-46af-b7e6-449195a28915): drop table if exists Tstage
2024-04-24T01:13:36,048  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T01:13:36,048  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T01:13:36,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:36,084  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:36,084  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:36,084  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:36,084  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:36,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=12, commitTxn_(CommitTxnRequest)=18, flushCache_()=0, getTable_(GetTableRequest)=35, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:36,085  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011336_d384b754-1408-46af-b7e6-449195a28915); Time taken: 0.048 seconds
2024-04-24T01:13:36,085  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424011336_d384b754-1408-46af-b7e6-449195a28915
2024-04-24T01:13:36,086  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011336_d384b754-1408-46af-b7e6-449195a28915
2024-04-24T01:13:36,108  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011336_d384b754-1408-46af-b7e6-449195a28915 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T01:13:36,108  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:36,108  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011336_d384b754-1408-46af-b7e6-449195a28915): drop table if exists Tstage
2024-04-24T01:13:36,109  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:36,109  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:36,119  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:36,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:36,130  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:36,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T01:13:36,168  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage does not exist; Force to delete it.
2024-04-24T01:13:36,168 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:36,168  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:36,168  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=49}
2024-04-24T01:13:36,169  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011336_d384b754-1408-46af-b7e6-449195a28915); Time taken: 0.06 seconds
2024-04-24T01:13:36,169  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011336_d384b754-1408-46af-b7e6-449195a28915
2024-04-24T01:13:36,173  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T01:13:36,181  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:36,181  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T01:13:36,182  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:36,182  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011336_4a00846c-9b28-4dee-9ad1-e87582467f16): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:36,185  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T01:13:36,185  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T01:13:36,186  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:36,186  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:36,192  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T01:13:36,192  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:36,194  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:36,195  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:36,195  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:36,195  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:36,195  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getDatabase_(String)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=2, flushCache_()=1}
2024-04-24T01:13:36,195  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011336_4a00846c-9b28-4dee-9ad1-e87582467f16); Time taken: 0.013 seconds
2024-04-24T01:13:36,195  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424011336_4a00846c-9b28-4dee-9ad1-e87582467f16
2024-04-24T01:13:36,195  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011336_4a00846c-9b28-4dee-9ad1-e87582467f16
2024-04-24T01:13:36,216  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011336_4a00846c-9b28-4dee-9ad1-e87582467f16 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T01:13:36,216  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:36,217  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011336_4a00846c-9b28-4dee-9ad1-e87582467f16): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T01:13:36,217  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:36,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713946416, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:36,224  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:36,271  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:36,271  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=53, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:36,272  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011336_4a00846c-9b28-4dee-9ad1-e87582467f16); Time taken: 0.054 seconds
2024-04-24T01:13:36,272  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011336_4a00846c-9b28-4dee-9ad1-e87582467f16
2024-04-24T01:13:36,276  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T01:13:36,283  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:36,283  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T01:13:36,283  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:36,284  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011336_51996a18-7ba1-4169-a5aa-be3b2ca5a1d0): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:36,286  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 5
2024-04-24T01:13:36,286  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T01:13:36,287  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:36,287  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:36,290  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T01:13:36,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:36,292  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:36,292  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:36,292  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:36,292  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:36,292  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, getValidWriteIds_(List, String)=3}
2024-04-24T01:13:36,293  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011336_51996a18-7ba1-4169-a5aa-be3b2ca5a1d0); Time taken: 0.008 seconds
2024-04-24T01:13:36,293  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424011336_51996a18-7ba1-4169-a5aa-be3b2ca5a1d0
2024-04-24T01:13:36,293  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011336_51996a18-7ba1-4169-a5aa-be3b2ca5a1d0
2024-04-24T01:13:36,308  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011336_51996a18-7ba1-4169-a5aa-be3b2ca5a1d0 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T01:13:36,308  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:36,308  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011336_51996a18-7ba1-4169-a5aa-be3b2ca5a1d0): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:36,309  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:36,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713946416, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFilesErasureCoded=0, numFiles=0, transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:36,319  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:36,349  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:36,349  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=40}
2024-04-24T01:13:36,350  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011336_51996a18-7ba1-4169-a5aa-be3b2ca5a1d0); Time taken: 0.041 seconds
2024-04-24T01:13:36,350  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011336_51996a18-7ba1-4169-a5aa-be3b2ca5a1d0
2024-04-24T01:13:36,357  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T01:13:36,367  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:36,367  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T01:13:36,368  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(1,4)
2024-04-24T01:13:36,368  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c): insert into Tstage values(0,2),(1,4)
2024-04-24T01:13:36,373  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-24T01:13:36,373  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T01:13:36,374  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:36,374  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:36,379  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:36,396  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:36,396  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:36,396  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:36,396  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:36,396  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:36,397  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:36,409  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:36,410  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:36,410  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T01:13:36,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:36,521  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:36,521  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:36,521  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:36,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:36,524  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:36,524  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:36,524  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:36,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:36,534  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:36,537  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1
2024-04-24T01:13:36,540  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:36,541  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:36,543  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:36,548  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T01:13:36,548  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T01:13:36,549  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:36,549  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:36,558  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:36,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:36,571  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:36,571  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:36,571  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:36,571  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:36,571  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T01:13:36,572  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:36,572  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=51, getAllTableConstraints_(AllTableConstraintsRequest)=28, commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-24T01:13:36,572  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c); Time taken: 0.204 seconds
2024-04-24T01:13:36,572  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c
2024-04-24T01:13:36,572  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c
2024-04-24T01:13:36,588  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T01:13:36,588  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:36,588  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c): insert into Tstage values(0,2),(1,4)
2024-04-24T01:13:36,589  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c
2024-04-24T01:13:36,589  INFO [main] ql.Driver: Query ID = alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c
Total jobs = 1
2024-04-24T01:13:36,589  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:36,589  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:36,751  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T01:13:36,751  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:36,751  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:36,751  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:36,751  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:36,751  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:36,751  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:36,751  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:36,754  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:36,754  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T01:13:36,754  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-36_368_6450252923638162659-1/dummy_path
2024-04-24T01:13:36,763  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:36,764  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T01:13:36,769  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:36,770  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T01:13:36,771  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:36,774  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-36_368_6450252923638162659-1/-mr-10001
2024-04-24T01:13:36,779  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:36,787  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:36,792  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:36,793  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T01:13:36,793  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T01:13:36,793  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-36_368_6450252923638162659-1/dummy_path
2024-04-24T01:13:36,793  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:13:36,811  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:13:36,833  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1041780219_0013
2024-04-24T01:13:36,833  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:36,900  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:36,900  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:36,900  INFO [Thread-1202] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:36,900  INFO [Thread-1202] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:36,902  INFO [Thread-1202] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:36,902  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1041780219_0013_m_000000_0
2024-04-24T01:13:36,905  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:36,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-36_368_6450252923638162659-1/dummy_path/null:0+1
2024-04-24T01:13:36,908  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:36,908  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T01:13:36,909  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T01:13:36,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:36,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:36,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:36,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:36,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:36,926  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:36,926  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:36,926  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:36,927  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:36,927  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:36,927  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T01:13:36,927  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T01:13:36,927  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:36,928  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T01:13:36,928  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T01:13:36,928  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:36,928  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T01:13:36,928  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T01:13:36,928  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T01:13:36,929  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:36,932  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:36,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:36,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:36,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T01:13:36,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:36,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:36,948  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1041780219_0013_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:36,949  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:36,949  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1041780219_0013_m_000000_0' done.
2024-04-24T01:13:36,949  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1041780219_0013_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=303990
		FILE: Number of bytes written=15452423
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=11
		Total committed heap usage (bytes)=1129840640
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-24T01:13:36,949  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1041780219_0013_m_000000_0
2024-04-24T01:13:36,949  INFO [Thread-1202] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:36,950  INFO [Thread-1202] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:36,950  INFO [pool-65-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1041780219_0013_r_000000_0
2024-04-24T01:13:36,953  INFO [pool-65-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:36,953  INFO [pool-65-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2ec0de91
2024-04-24T01:13:36,953  WARN [pool-65-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:36,954  INFO [pool-65-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:36,954  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1041780219_0013_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:36,957  INFO [localfetcher#12] reduce.LocalFetcher: localfetcher#12 about to shuffle output of map attempt_local1041780219_0013_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-24T01:13:36,957  INFO [localfetcher#12] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1041780219_0013_m_000000_0
2024-04-24T01:13:36,957  INFO [localfetcher#12] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-24T01:13:36,958  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:36,958  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:36,958  INFO [pool-65-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:36,964  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:36,964  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T01:13:36,966  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:36,967  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-24T01:13:36,967  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:36,967  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:36,968  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T01:13:36,968  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:36,968  INFO [pool-65-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:36,969  INFO [pool-65-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T01:13:36,970  INFO [pool-65-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:36,970  INFO [pool-65-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:36,970  INFO [pool-65-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T01:13:36,970  INFO [pool-65-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T01:13:36,971  INFO [pool-65-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1041780219_0013/job_local1041780219_0013.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@284d5833
2024-04-24T01:13:36,971  INFO [pool-65-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:36,971  INFO [pool-65-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:0, 
2024-04-24T01:13:36,971  INFO [pool-65-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T01:13:36,971  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-24T01:13:36,971  INFO [pool-65-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/_tmp.-ext-10000/000000_0
2024-04-24T01:13:36,971  INFO [pool-65-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-24T01:13:36,971  INFO [pool-65-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/_tmp.-ext-10000/000000_0
2024-04-24T01:13:36,983  INFO [pool-65-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:0, RECORDS_OUT_1_default.tstage:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:36,983  INFO [pool-65-thread-1] mapred.Task: Task:attempt_local1041780219_0013_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:36,984  INFO [pool-65-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:36,984  INFO [pool-65-thread-1] mapred.Task: Task 'attempt_local1041780219_0013_r_000000_0' done.
2024-04-24T01:13:36,984  INFO [pool-65-thread-1] mapred.Task: Final Counters for attempt_local1041780219_0013_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=310456
		FILE: Number of bytes written=15452489
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1129840640
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:36,984  INFO [pool-65-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1041780219_0013_r_000000_0
2024-04-24T01:13:36,984  INFO [pool-65-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1041780219_0013_r_000001_0
2024-04-24T01:13:36,985  INFO [pool-65-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:36,985  INFO [pool-65-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3ed03c47
2024-04-24T01:13:36,985  WARN [pool-65-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:36,987  INFO [pool-65-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:36,987  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1041780219_0013_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:36,990  INFO [localfetcher#13] reduce.LocalFetcher: localfetcher#13 about to shuffle output of map attempt_local1041780219_0013_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T01:13:36,990  INFO [localfetcher#13] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1041780219_0013_m_000000_0
2024-04-24T01:13:36,990  INFO [localfetcher#13] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T01:13:36,991  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:36,991  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:36,992  INFO [pool-65-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:36,998  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:36,998  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T01:13:37,000  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:37,001  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T01:13:37,001  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:37,001  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:37,001  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T01:13:37,001  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:37,001  INFO [pool-65-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:37,002  INFO [pool-65-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T01:13:37,003  INFO [pool-65-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:37,003  INFO [pool-65-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T01:13:37,003  INFO [pool-65-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T01:13:37,003  INFO [pool-65-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T01:13:37,004  INFO [pool-65-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1041780219_0013/job_local1041780219_0013.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1b30a78d
2024-04-24T01:13:37,004  INFO [pool-65-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/_tmp.-ext-10000/000001_0
2024-04-24T01:13:37,004  INFO [pool-65-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-24T01:13:37,004  INFO [pool-65-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/_tmp.-ext-10000/000001_0
2024-04-24T01:13:37,005  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T01:13:37,005  INFO [pool-65-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T01:13:37,010  INFO [pool-65-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T01:13:37,010  INFO [pool-65-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T01:13:37,010  INFO [pool-65-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T01:13:37,010  INFO [pool-65-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T01:13:37,010  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T01:13:37,017  INFO [pool-65-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.tstage:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-24T01:13:37,018  INFO [pool-65-thread-1] mapred.Task: Task:attempt_local1041780219_0013_r_000001_0 is done. And is in the process of committing
2024-04-24T01:13:37,018  INFO [pool-65-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:37,018  INFO [pool-65-thread-1] mapred.Task: Task 'attempt_local1041780219_0013_r_000001_0' done.
2024-04-24T01:13:37,018  INFO [pool-65-thread-1] mapred.Task: Final Counters for attempt_local1041780219_0013_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=316952
		FILE: Number of bytes written=15452877
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1129840640
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:37,018  INFO [pool-65-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1041780219_0013_r_000001_0
2024-04-24T01:13:37,018  INFO [Thread-1202] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:37,902 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:37,902  INFO [main] exec.Task: 2024-04-24 01:13:37,902 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1041780219_0013
2024-04-24T01:13:37,904  INFO [main] exec.Task: Ended Job = job_local1041780219_0013
2024-04-24T01:13:37,907  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T01:13:37,908  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1/-ext-10000
2024-04-24T01:13:37,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:37,924  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:37,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:37,938  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:37,940  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:37,940  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:37,970  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T01:13:37,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:37,980  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:37,980  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T01:13:37,980  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-36_368_6450252923638162659-1/-mr-10001
2024-04-24T01:13:37,982  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:37,991  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:37,992  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T01:13:37,992  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T01:13:37,992  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:37,992  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:38,021  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=2, numRows=2, totalSize=252, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T01:13:38,021  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:38,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=50, alter_table_(String, String, String, Table, EnvironmentContext, String)=59, isCompatibleWith_(Configuration)=1}
MapReduce Jobs Launched: 
2024-04-24T01:13:38,022  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:38,022  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:38,022  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:38,022  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c); Time taken: 1.433 seconds
2024-04-24T01:13:38,022  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011336_3fa5a5bf-d1bc-4b0a-977c-f538390e0c3c
2024-04-24T01:13:38,026  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T01:13:38,033  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:38,033  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T01:13:38,033  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:38,034  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-36_368_6450252923638162659-1
2024-04-24T01:13:38,034  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-36_368_6450252923638162659-1 on fs with scheme file
2024-04-24T01:13:38,035  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1
2024-04-24T01:13:38,035  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-36_368_6450252923638162659-1 on fs with scheme file
2024-04-24T01:13:38,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011338_70f83ad2-51e9-4e35-9b9b-ff34d4c52bc3): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:38,035  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:38,045  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:38,047  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T01:13:38,047  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T01:13:38,050  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:38,060  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:38,060  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:38,060  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:38,060  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:38,060  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:38,060  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:38,060  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:38,060  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:38,060  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=20, getValidTxns_(long)=1, flushCache_()=0, getCurrentNotificationEventId_()=2, openTxn_(String, TxnType)=2}
2024-04-24T01:13:38,061  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011338_70f83ad2-51e9-4e35-9b9b-ff34d4c52bc3); Time taken: 0.025 seconds
2024-04-24T01:13:38,061  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424011338_70f83ad2-51e9-4e35-9b9b-ff34d4c52bc3
2024-04-24T01:13:38,061  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011338_70f83ad2-51e9-4e35-9b9b-ff34d4c52bc3
2024-04-24T01:13:38,076  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011338_70f83ad2-51e9-4e35-9b9b-ff34d4c52bc3 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T01:13:38,076  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:38,076  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011338_70f83ad2-51e9-4e35-9b9b-ff34d4c52bc3): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:38,076  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:38,076  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:38,076  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:38,076  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:38,076  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:38,086  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:38,096  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:38,096  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:38,096  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011338_70f83ad2-51e9-4e35-9b9b-ff34d4c52bc3); Time taken: 0.02 seconds
2024-04-24T01:13:38,096  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011338_70f83ad2-51e9-4e35-9b9b-ff34d4c52bc3
2024-04-24T01:13:38,100  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T01:13:38,107  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:38,107  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T01:13:38,108  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data'
2024-04-24T01:13:38,108  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011338_460bb768-4648-42ec-a77a-860b15d3df48): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data'
2024-04-24T01:13:38,110  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T01:13:38,111  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T01:13:38,111  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:38,119  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:38,128  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 19
2024-04-24T01:13:38,128  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [19])
2024-04-24T01:13:38,129  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:38,129  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:38,129  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:38,129  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=11, allocateTableWriteId_(long, String, String)=8, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-24T01:13:38,130  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011338_460bb768-4648-42ec-a77a-860b15d3df48); Time taken: 0.021 seconds
2024-04-24T01:13:38,130  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424011338_460bb768-4648-42ec-a77a-860b15d3df48
2024-04-24T01:13:38,130  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011338_460bb768-4648-42ec-a77a-860b15d3df48
2024-04-24T01:13:38,145  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011338_460bb768-4648-42ec-a77a-860b15d3df48 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T01:13:38,145  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:38,149  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011338_460bb768-4648-42ec-a77a-860b15d3df48): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data'
2024-04-24T01:13:38,149  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:38,149  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:38,157  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:38,157  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:38,170  INFO [HMSHandler #13] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:38,198  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T01:13:38,199  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data
2024-04-24T01:13:38,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:38,209  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:38,209  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:38,227  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T01:13:38,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:38,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:38,234  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:38,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:38,245  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T01:13:38,250  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:38,250  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T01:13:38,296  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:38,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:38,348  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:38,349  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=79, getTable_(GetTableRequest)=25, add_partitions_(List, boolean, boolean)=41, getPartitionWithAuthInfo_(String, String, List, String, List)=46, validatePartitionNameCharacters_(List)=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=1}
2024-04-24T01:13:38,349  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011338_460bb768-4648-42ec-a77a-860b15d3df48); Time taken: 0.199 seconds
2024-04-24T01:13:38,349  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011338_460bb768-4648-42ec-a77a-860b15d3df48
2024-04-24T01:13:38,356  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T01:13:38,366  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:38,367  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T01:13:38,367  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:38,368  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:38,372  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T01:13:38,372  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T01:13:38,373  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:38,373  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:38,382  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:38,382  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:38,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:38,395  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:38,396  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:38,396  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:38,396  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:38,420  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:38,465  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:38,465  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:38,485  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:38,495  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:38,495  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:38,510  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T01:13:38,510  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T01:13:38,562  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:38,562  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:38,562  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:38,563  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-38_368_1278564895811602786-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-38_368_1278564895811602786-1
2024-04-24T01:13:38,570  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:38,574  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T01:13:38,574  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T01:13:38,575  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:38,576  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:38,586  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:38,587  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:38,587  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:38,587  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:38,587  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:38,587  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T01:13:38,588  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T01:13:38,589  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:38,589  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=10, getTable_(GetTableRequest)=13, isCompatibleWith_(Configuration)=1, listPartitions_(String, String, short)=11, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=18, getAggrColStatsFor_(String, String, List, List, String, String)=24, getAllTableConstraints_(AllTableConstraintsRequest)=40, openTxn_(String, TxnType)=3}
2024-04-24T01:13:38,589  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70); Time taken: 0.221 seconds
2024-04-24T01:13:38,589  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70
2024-04-24T01:13:38,590  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70
2024-04-24T01:13:38,606  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T01:13:38,607  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:38,607  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T01:13:38,608  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70
2024-04-24T01:13:38,608  INFO [main] ql.Driver: Query ID = alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70
Total jobs = 1
2024-04-24T01:13:38,608  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:38,608  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:38,782  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:38,783  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:38,783  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:38,783  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:38,783  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:38,783  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:38,783  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:38,783  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:38,785  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:38,785  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:38,785  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:38,794  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:38,795  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T01:13:38,800  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:38,801  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T01:13:38,801  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:38,808  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:38,815  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:38,819  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:38,820  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:38,820  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:38,820  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:38,820  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:38,821  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T01:13:38,821  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:38,829  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T01:13:38,830  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 1). duration: 10 ms
2024-04-24T01:13:38,830  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:13:38,847  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:13:38,866  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local249193142_0014
2024-04-24T01:13:38,866  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:38,931  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:38,931  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:38,931  INFO [Thread-1283] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:38,932  INFO [Thread-1283] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:38,933  INFO [Thread-1283] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:38,933  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local249193142_0014_m_000000_0
2024-04-24T01:13:38,934  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:38,934  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:38,935  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:38,935  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T01:13:38,936  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T01:13:38,936  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0 with {include: [true, true, true], offset: 0, length: 252, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:38,943  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T01:13:38,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:38,947  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:38,947  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:38,947  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:38,947  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:38,947  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:38,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:38,948  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:38,949  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:38,950  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:38,950  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:38,950  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T01:13:38,950  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:38,950  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:38,951  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:38,952  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:38,952  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:38,952  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:38,952  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T01:13:38,952  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:38,964  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:38,967  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local249193142_0014_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:38,968  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:38,968  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local249193142_0014_m_000000_0' done.
2024-04-24T01:13:38,968  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local249193142_0014_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=325171
		FILE: Number of bytes written=16637387
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1129840640
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=6405
2024-04-24T01:13:38,968  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local249193142_0014_m_000000_0
2024-04-24T01:13:38,968  INFO [Thread-1283] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:38,969  INFO [Thread-1283] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:38,969  INFO [pool-71-thread-1] mapred.LocalJobRunner: Starting task: attempt_local249193142_0014_r_000000_0
2024-04-24T01:13:38,970  INFO [pool-71-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:38,970  INFO [pool-71-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@18dc9702
2024-04-24T01:13:38,970  WARN [pool-71-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:38,971  INFO [pool-71-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:38,972  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local249193142_0014_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:38,972  INFO [localfetcher#14] reduce.LocalFetcher: localfetcher#14 about to shuffle output of map attempt_local249193142_0014_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-24T01:13:38,973  INFO [localfetcher#14] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local249193142_0014_m_000000_0
2024-04-24T01:13:38,973  INFO [localfetcher#14] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-24T01:13:38,973  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:38,973  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:38,973  INFO [pool-71-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:38,979  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:38,980  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-24T01:13:38,982  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 412 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:38,982  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 1 files, 416 bytes from disk
2024-04-24T01:13:38,982  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:38,982  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:38,982  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-24T01:13:38,983  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T01:13:38,983  INFO [pool-71-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:38,984  INFO [pool-71-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T01:13:38,985  INFO [pool-71-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:38,985  INFO [pool-71-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:38,985  INFO [pool-71-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-24T01:13:38,985  INFO [pool-71-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:38,986  INFO [pool-71-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@48cd5bde, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@1ec7b3f2>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@2c79008>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@3347c4ad, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@547f9294
2024-04-24T01:13:38,986  INFO [pool-71-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-38_368_1278564895811602786-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-38_368_1278564895811602786-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:38,986  INFO [pool-71-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-38_368_1278564895811602786-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-38_368_1278564895811602786-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:38,986  INFO [pool-71-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-38_368_1278564895811602786-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-38_368_1278564895811602786-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:38,994  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:38,994  INFO [pool-71-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:38,994  INFO [pool-71-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:38,994  INFO [pool-71-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:38,994  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T01:13:38,995  INFO [pool-71-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-24T01:13:38,995  INFO [pool-71-thread-1] mapred.Task: Task:attempt_local249193142_0014_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:38,996  INFO [pool-71-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:38,996  INFO [pool-71-thread-1] mapred.Task: Task 'attempt_local249193142_0014_r_000000_0' done.
2024-04-24T01:13:38,996  INFO [pool-71-thread-1] mapred.Task: Final Counters for attempt_local249193142_0014_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=332314
		FILE: Number of bytes written=16638288
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=416
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1129840640
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:38,996  INFO [pool-71-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local249193142_0014_r_000000_0
2024-04-24T01:13:38,996  INFO [Thread-1283] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:39,932 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:39,932  INFO [main] exec.Task: 2024-04-24 01:13:39,932 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local249193142_0014
2024-04-24T01:13:39,933  INFO [main] exec.Task: Ended Job = job_local249193142_0014
2024-04-24T01:13:39,935  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:39,935  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:39,935  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:39,935  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:39,935  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:39,935  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70); Time taken: 1.328 seconds
2024-04-24T01:13:39,935  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011338_2c651749-6bcf-4118-98a9-e2be50934a70
2024-04-24T01:13:39,940  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T01:13:39,946  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:39,948  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T01:13:39,952  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:39,953  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T01:13:39,953  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:2, 
2024-04-24T01:13:39,953  WARN [main] ql.TestTxnAddPartition: addPartitionRename: read data(add partition (p=0)): 
2024-04-24T01:13:39,953  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536936448,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0
{"writeid":1,"bucketid":536936448,"rowid":1}	0	1	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0

2024-04-24T01:13:39,953  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:39,953  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-38_368_1278564895811602786-1
2024-04-24T01:13:39,954  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6aeab11d-3227-4d54-8821-713cb688814b/hive_2024-04-24_01-13-38_368_1278564895811602786-1 on fs with scheme file
2024-04-24T01:13:39,954  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011339_3382067d-bf99-4e79-b7f3-dda7ae9f6697): drop table if exists acidTbl
2024-04-24T01:13:39,964  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-24T01:13:39,964  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T01:13:39,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:39,972  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:39,972  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:39,972  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:39,972  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:39,972  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=9, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:39,972  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011339_3382067d-bf99-4e79-b7f3-dda7ae9f6697); Time taken: 0.018 seconds
2024-04-24T01:13:39,973  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424011339_3382067d-bf99-4e79-b7f3-dda7ae9f6697
2024-04-24T01:13:39,973  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011339_3382067d-bf99-4e79-b7f3-dda7ae9f6697
2024-04-24T01:13:39,988  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011339_3382067d-bf99-4e79-b7f3-dda7ae9f6697 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T01:13:39,988  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:39,988  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011339_3382067d-bf99-4e79-b7f3-dda7ae9f6697): drop table if exists acidTbl
2024-04-24T01:13:39,988  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:39,988  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:39,995  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:39,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:40,003  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:40,106  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,106  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=110}
2024-04-24T01:13:40,106  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011339_3382067d-bf99-4e79-b7f3-dda7ae9f6697); Time taken: 0.118 seconds
2024-04-24T01:13:40,106  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011339_3382067d-bf99-4e79-b7f3-dda7ae9f6697
2024-04-24T01:13:40,111  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T01:13:40,117  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,118  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T01:13:40,118  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:40,119  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_62e29051-8bb3-410a-9814-6f35a2555f11): drop table if exists acidTblPart
2024-04-24T01:13:40,121  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 21
2024-04-24T01:13:40,122  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T01:13:40,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:40,131  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,132  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,132  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,132  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,132  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T01:13:40,132  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_62e29051-8bb3-410a-9814-6f35a2555f11); Time taken: 0.013 seconds
2024-04-24T01:13:40,132  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424011340_62e29051-8bb3-410a-9814-6f35a2555f11
2024-04-24T01:13:40,133  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011340_62e29051-8bb3-410a-9814-6f35a2555f11
2024-04-24T01:13:40,150  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011340_62e29051-8bb3-410a-9814-6f35a2555f11 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T01:13:40,150  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:40,150  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_62e29051-8bb3-410a-9814-6f35a2555f11): drop table if exists acidTblPart
2024-04-24T01:13:40,151  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,152  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:40,164  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,164  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:40,172  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:40,220  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,220  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=55, getTable_(GetTableRequest)=12}
2024-04-24T01:13:40,220  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_62e29051-8bb3-410a-9814-6f35a2555f11); Time taken: 0.07 seconds
2024-04-24T01:13:40,220  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_62e29051-8bb3-410a-9814-6f35a2555f11
2024-04-24T01:13:40,225  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T01:13:40,232  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,232  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T01:13:40,232  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:40,233  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_5310aeb7-14bf-48c6-a240-cdf5c519e198): drop table if exists acidTbl2
2024-04-24T01:13:40,235  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 21
2024-04-24T01:13:40,236  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T01:13:40,237  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,237  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,237  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,237  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3}
2024-04-24T01:13:40,237  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_5310aeb7-14bf-48c6-a240-cdf5c519e198); Time taken: 0.004 seconds
2024-04-24T01:13:40,237  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424011340_5310aeb7-14bf-48c6-a240-cdf5c519e198
2024-04-24T01:13:40,237  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:40,237  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_5310aeb7-14bf-48c6-a240-cdf5c519e198): drop table if exists acidTbl2
2024-04-24T01:13:40,237  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,238  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T01:13:40,238  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,238  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=1}
2024-04-24T01:13:40,238  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_5310aeb7-14bf-48c6-a240-cdf5c519e198); Time taken: 0.001 seconds
2024-04-24T01:13:40,239  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_5310aeb7-14bf-48c6-a240-cdf5c519e198
2024-04-24T01:13:40,244  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T01:13:40,251  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,251  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T01:13:40,252  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:40,252  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_9850348b-68d6-4523-a178-f7e767e509dc): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:40,254  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 21
2024-04-24T01:13:40,255  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T01:13:40,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:40,278  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,279  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,279  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,279  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,279  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=23, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13}
2024-04-24T01:13:40,279  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_9850348b-68d6-4523-a178-f7e767e509dc); Time taken: 0.027 seconds
2024-04-24T01:13:40,279  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424011340_9850348b-68d6-4523-a178-f7e767e509dc
2024-04-24T01:13:40,280  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011340_9850348b-68d6-4523-a178-f7e767e509dc
2024-04-24T01:13:40,295  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011340_9850348b-68d6-4523-a178-f7e767e509dc LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T01:13:40,295  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:40,295  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_9850348b-68d6-4523-a178-f7e767e509dc): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:40,295  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,296  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:40,305  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,305  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:40,315  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,315  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:40,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,415  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=110, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:40,415  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_9850348b-68d6-4523-a178-f7e767e509dc); Time taken: 0.12 seconds
2024-04-24T01:13:40,415  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_9850348b-68d6-4523-a178-f7e767e509dc
2024-04-24T01:13:40,421  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-24T01:13:40,427  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,428  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-24T01:13:40,428  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:40,428  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_68900b1c-1f75-49d7-bc20-465da960e2c7): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:40,431  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 21
2024-04-24T01:13:40,431  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T01:13:40,432  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:40,444  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,444  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,444  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,444  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,444  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=13, flushCache_()=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:40,445  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_68900b1c-1f75-49d7-bc20-465da960e2c7); Time taken: 0.016 seconds
2024-04-24T01:13:40,445  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424011340_68900b1c-1f75-49d7-bc20-465da960e2c7
2024-04-24T01:13:40,446  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011340_68900b1c-1f75-49d7-bc20-465da960e2c7
2024-04-24T01:13:40,468  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011340_68900b1c-1f75-49d7-bc20-465da960e2c7 LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T01:13:40,468  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:40,468  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_68900b1c-1f75-49d7-bc20-465da960e2c7): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:40,468  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:40,480  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,480  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:40,490  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:40,527  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=12, dropTable_(String, String, boolean, boolean, boolean)=47, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:40,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_68900b1c-1f75-49d7-bc20-465da960e2c7); Time taken: 0.059 seconds
2024-04-24T01:13:40,528  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_68900b1c-1f75-49d7-bc20-465da960e2c7
2024-04-24T01:13:40,532  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T01:13:40,539  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,539  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T01:13:40,540  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:40,540  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_4c677a66-1e5e-4413-8641-389572891281): drop table if exists nonAcidNonBucket
2024-04-24T01:13:40,542  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 21
2024-04-24T01:13:40,543  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T01:13:40,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:40,553  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,553  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,553  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,553  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,553  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=10, getValidTxns_(long)=0}
2024-04-24T01:13:40,554  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_4c677a66-1e5e-4413-8641-389572891281); Time taken: 0.013 seconds
2024-04-24T01:13:40,554  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424011340_4c677a66-1e5e-4413-8641-389572891281
2024-04-24T01:13:40,554  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011340_4c677a66-1e5e-4413-8641-389572891281
2024-04-24T01:13:40,572  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011340_4c677a66-1e5e-4413-8641-389572891281 LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T01:13:40,572  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:40,572  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_4c677a66-1e5e-4413-8641-389572891281): drop table if exists nonAcidNonBucket
2024-04-24T01:13:40,572  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:40,582  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:40,592  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:40,592  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:40,624  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,624  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=42, getTable_(GetTableRequest)=10}
2024-04-24T01:13:40,625  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_4c677a66-1e5e-4413-8641-389572891281); Time taken: 0.052 seconds
2024-04-24T01:13:40,625  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_4c677a66-1e5e-4413-8641-389572891281
2024-04-24T01:13:40,629  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T01:13:40,635  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,635  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T01:13:40,636  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T01:13:40,730  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T01:13:40,730  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T01:13:40,730  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T01:13:40,730  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T01:13:40,730  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T01:13:40,730  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T01:13:40,730  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T01:13:40,730  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T01:13:40,731  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T01:13:40,731  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T01:13:40,731  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T01:13:40,734  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 70ec7889-47e1-4d9a-8d66-86b69e179179
2024-04-24T01:13:40,737  INFO [main] SessionState: Hive Session ID = 70ec7889-47e1-4d9a-8d66-86b69e179179
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:40,737  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T01:13:40,743  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/70ec7889-47e1-4d9a-8d66-86b69e179179
2024-04-24T01:13:40,745  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179
2024-04-24T01:13:40,748  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/70ec7889-47e1-4d9a-8d66-86b69e179179/_tmp_space.db
2024-04-24T01:13:40,748  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=70ec7889-47e1-4d9a-8d66-86b69e179179, clientType=HIVECLI]
2024-04-24T01:13:40,748  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:40,749  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_1ac2be17-3cdb-4e3b-bd01-9a79a7ee9981): drop table if exists acidTbl
2024-04-24T01:13:40,760  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T01:13:40,761  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T01:13:40,764  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:40,769  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,769  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,769  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,770  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=12, flushCache_()=0, getValidTxns_(long)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T01:13:40,770  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_1ac2be17-3cdb-4e3b-bd01-9a79a7ee9981); Time taken: 0.02 seconds
2024-04-24T01:13:40,770  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424011340_1ac2be17-3cdb-4e3b-bd01-9a79a7ee9981
2024-04-24T01:13:40,770  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:40,770  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_1ac2be17-3cdb-4e3b-bd01-9a79a7ee9981): drop table if exists acidTbl
2024-04-24T01:13:40,770  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,771  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:40,776  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,776  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:40,776  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_1ac2be17-3cdb-4e3b-bd01-9a79a7ee9981); Time taken: 0.006 seconds
2024-04-24T01:13:40,777  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_1ac2be17-3cdb-4e3b-bd01-9a79a7ee9981
2024-04-24T01:13:40,786  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T01:13:40,796  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,797  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T01:13:40,798  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:40,798  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_f2253dc4-d8ce-476b-9678-7e2d49fa0ef2): drop table if exists acidTblPart
2024-04-24T01:13:40,801  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T01:13:40,801  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T01:13:40,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:40,807  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,807  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,807  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,807  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=20, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:40,808  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_f2253dc4-d8ce-476b-9678-7e2d49fa0ef2); Time taken: 0.009 seconds
2024-04-24T01:13:40,808  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424011340_f2253dc4-d8ce-476b-9678-7e2d49fa0ef2
2024-04-24T01:13:40,808  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:40,808  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_f2253dc4-d8ce-476b-9678-7e2d49fa0ef2): drop table if exists acidTblPart
2024-04-24T01:13:40,808  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:40,814  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,814  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:40,814  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_f2253dc4-d8ce-476b-9678-7e2d49fa0ef2); Time taken: 0.006 seconds
2024-04-24T01:13:40,814  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_f2253dc4-d8ce-476b-9678-7e2d49fa0ef2
2024-04-24T01:13:40,823  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T01:13:40,831  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,831  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T01:13:40,832  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:40,832  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_508020ef-ef05-4cb0-9c00-80762dc14354): drop table if exists acidTbl2
2024-04-24T01:13:40,834  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T01:13:40,834  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T01:13:40,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:40,838  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,838  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,838  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,838  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T01:13:40,839  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_508020ef-ef05-4cb0-9c00-80762dc14354); Time taken: 0.006 seconds
2024-04-24T01:13:40,839  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424011340_508020ef-ef05-4cb0-9c00-80762dc14354
2024-04-24T01:13:40,839  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:40,839  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_508020ef-ef05-4cb0-9c00-80762dc14354): drop table if exists acidTbl2
2024-04-24T01:13:40,839  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T01:13:40,842  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,843  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:40,843  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_508020ef-ef05-4cb0-9c00-80762dc14354); Time taken: 0.003 seconds
2024-04-24T01:13:40,843  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_508020ef-ef05-4cb0-9c00-80762dc14354
2024-04-24T01:13:40,848  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T01:13:40,855  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,855  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T01:13:40,856  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:40,856  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_793d864e-37d1-4573-bd01-fe41ff1046f3): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:40,858  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T01:13:40,858  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T01:13:40,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:40,863  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,863  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,863  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,863  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:40,863  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_793d864e-37d1-4573-bd01-fe41ff1046f3); Time taken: 0.007 seconds
2024-04-24T01:13:40,863  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424011340_793d864e-37d1-4573-bd01-fe41ff1046f3
2024-04-24T01:13:40,863  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:40,863  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_793d864e-37d1-4573-bd01-fe41ff1046f3): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:40,864  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:40,867  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,867  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:40,867  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_793d864e-37d1-4573-bd01-fe41ff1046f3); Time taken: 0.004 seconds
2024-04-24T01:13:40,867  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_793d864e-37d1-4573-bd01-fe41ff1046f3
2024-04-24T01:13:40,873  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T01:13:40,879  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,879  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T01:13:40,880  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:40,880  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_92063f76-ecd0-411a-bd02-2aec8a335672): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:40,882  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T01:13:40,883  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T01:13:40,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:40,887  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,887  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,887  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,887  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=2}
2024-04-24T01:13:40,887  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_92063f76-ecd0-411a-bd02-2aec8a335672); Time taken: 0.007 seconds
2024-04-24T01:13:40,887  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424011340_92063f76-ecd0-411a-bd02-2aec8a335672
2024-04-24T01:13:40,887  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:40,887  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_92063f76-ecd0-411a-bd02-2aec8a335672): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:40,887  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:40,891  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,891  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:40,891  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_92063f76-ecd0-411a-bd02-2aec8a335672); Time taken: 0.004 seconds
2024-04-24T01:13:40,891  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_92063f76-ecd0-411a-bd02-2aec8a335672
2024-04-24T01:13:40,897  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T01:13:40,903  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,903  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T01:13:40,904  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:40,904  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_89d7cfa9-ddc2-41c9-9c1f-4a59a666cc6f): drop table if exists nonAcidNonBucket
2024-04-24T01:13:40,907  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T01:13:40,907  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T01:13:40,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:40,911  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,911  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,911  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,911  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T01:13:40,911  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_89d7cfa9-ddc2-41c9-9c1f-4a59a666cc6f); Time taken: 0.007 seconds
2024-04-24T01:13:40,911  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424011340_89d7cfa9-ddc2-41c9-9c1f-4a59a666cc6f
2024-04-24T01:13:40,911  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:40,911  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_89d7cfa9-ddc2-41c9-9c1f-4a59a666cc6f): drop table if exists nonAcidNonBucket
2024-04-24T01:13:40,911  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,912  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:40,915  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:40,915  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:40,915  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_89d7cfa9-ddc2-41c9-9c1f-4a59a666cc6f); Time taken: 0.004 seconds
2024-04-24T01:13:40,915  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_89d7cfa9-ddc2-41c9-9c1f-4a59a666cc6f
2024-04-24T01:13:40,921  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T01:13:40,927  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:40,927  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T01:13:40,928  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:40,928  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011340_14ffe5f0-0794-4a1d-87c2-88e405f9fdec): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:40,931  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T01:13:40,931  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T01:13:40,932  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:40,932  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:40,938  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T01:13:40,939  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:40,940  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:40,940  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:40,940  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:40,940  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:40,941  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=6, flushCache_()=0}
2024-04-24T01:13:40,941  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011340_14ffe5f0-0794-4a1d-87c2-88e405f9fdec); Time taken: 0.012 seconds
2024-04-24T01:13:40,941  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424011340_14ffe5f0-0794-4a1d-87c2-88e405f9fdec
2024-04-24T01:13:40,941  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011340_14ffe5f0-0794-4a1d-87c2-88e405f9fdec
2024-04-24T01:13:40,961  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011340_14ffe5f0-0794-4a1d-87c2-88e405f9fdec LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T01:13:40,961  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:40,962  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011340_14ffe5f0-0794-4a1d-87c2-88e405f9fdec): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:40,962  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:40,963  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713946420, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFiles=0, numRows=0, numFilesErasureCoded=0, totalSize=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:40,970  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtbl
2024-04-24T01:13:41,014  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,015  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=51, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:41,015  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011340_14ffe5f0-0794-4a1d-87c2-88e405f9fdec); Time taken: 0.052 seconds
2024-04-24T01:13:41,015  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011340_14ffe5f0-0794-4a1d-87c2-88e405f9fdec
2024-04-24T01:13:41,019  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T01:13:41,028  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,028  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T01:13:41,028  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:41,029  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_c03bab63-b1f9-4936-ba89-c2b86b44727a): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:41,031  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T01:13:41,032  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T01:13:41,032  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:41,032  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:41,035  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T01:13:41,035  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:41,037  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:41,037  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,037  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,037  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:41,037  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_c03bab63-b1f9-4936-ba89-c2b86b44727a); Time taken: 0.008 seconds
2024-04-24T01:13:41,037  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424011341_c03bab63-b1f9-4936-ba89-c2b86b44727a
2024-04-24T01:13:41,038  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_c03bab63-b1f9-4936-ba89-c2b86b44727a
2024-04-24T01:13:41,054  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_c03bab63-b1f9-4936-ba89-c2b86b44727a LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T01:13:41,054  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:41,055  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_c03bab63-b1f9-4936-ba89-c2b86b44727a): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:41,055  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,056  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713946421, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:41,062  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/acidtblpart
2024-04-24T01:13:41,080  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:41,080  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_c03bab63-b1f9-4936-ba89-c2b86b44727a); Time taken: 0.024 seconds
2024-04-24T01:13:41,080  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_c03bab63-b1f9-4936-ba89-c2b86b44727a
2024-04-24T01:13:41,084  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T01:13:41,092  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,092  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T01:13:41,093  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,093  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_adea23c8-a9b1-433c-bc9b-8c59bcc6a238): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,095  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T01:13:41,096  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T01:13:41,096  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:41,096  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:41,100  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T01:13:41,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:41,103  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:41,103  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,103  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,103  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,103  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=3, getDatabase_(String)=3, getValidTxns_(long)=0}
2024-04-24T01:13:41,104  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_adea23c8-a9b1-433c-bc9b-8c59bcc6a238); Time taken: 0.01 seconds
2024-04-24T01:13:41,104  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424011341_adea23c8-a9b1-433c-bc9b-8c59bcc6a238
2024-04-24T01:13:41,104  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_adea23c8-a9b1-433c-bc9b-8c59bcc6a238
2024-04-24T01:13:41,128  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_adea23c8-a9b1-433c-bc9b-8c59bcc6a238 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T01:13:41,128  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:41,129  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_adea23c8-a9b1-433c-bc9b-8c59bcc6a238): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,129  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713946421, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, bucketing_version=2, numFiles=0, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:41,136  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl
2024-04-24T01:13:41,154  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,154  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-24T01:13:41,154  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_adea23c8-a9b1-433c-bc9b-8c59bcc6a238); Time taken: 0.025 seconds
2024-04-24T01:13:41,154  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_adea23c8-a9b1-433c-bc9b-8c59bcc6a238
2024-04-24T01:13:41,158  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T01:13:41,165  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,166  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T01:13:41,166  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,167  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_f9cfe154-8aa7-400d-963b-a51be61c6dff): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,169  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T01:13:41,170  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T01:13:41,170  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:41,170  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:41,173  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T01:13:41,173  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:41,175  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:41,175  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,175  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,175  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,175  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=3}
2024-04-24T01:13:41,175  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_f9cfe154-8aa7-400d-963b-a51be61c6dff); Time taken: 0.009 seconds
2024-04-24T01:13:41,175  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424011341_f9cfe154-8aa7-400d-963b-a51be61c6dff
2024-04-24T01:13:41,176  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_f9cfe154-8aa7-400d-963b-a51be61c6dff
2024-04-24T01:13:41,192  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_f9cfe154-8aa7-400d-963b-a51be61c6dff LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T01:13:41,192  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:41,192  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_f9cfe154-8aa7-400d-963b-a51be61c6dff): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,192  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713946421, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numRows=0, numFilesErasureCoded=0, bucketing_version=2, totalSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:41,203  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidorctbl2
2024-04-24T01:13:41,222  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,222  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=29, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:41,222  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_f9cfe154-8aa7-400d-963b-a51be61c6dff); Time taken: 0.03 seconds
2024-04-24T01:13:41,222  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_f9cfe154-8aa7-400d-963b-a51be61c6dff
2024-04-24T01:13:41,226  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T01:13:41,233  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,233  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T01:13:41,233  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:41,234  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_4b1484d0-7efd-43f3-88e0-7375bb5e9326): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:41,236  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T01:13:41,236  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T01:13:41,237  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:41,237  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:41,239  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T01:13:41,239  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:41,241  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:41,241  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,241  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, getValidTxns_(long)=1}
2024-04-24T01:13:41,242  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_4b1484d0-7efd-43f3-88e0-7375bb5e9326); Time taken: 0.008 seconds
2024-04-24T01:13:41,242  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424011341_4b1484d0-7efd-43f3-88e0-7375bb5e9326
2024-04-24T01:13:41,242  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_4b1484d0-7efd-43f3-88e0-7375bb5e9326
2024-04-24T01:13:41,269  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_4b1484d0-7efd-43f3-88e0-7375bb5e9326 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T01:13:41,269  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:41,270  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_4b1484d0-7efd-43f3-88e0-7375bb5e9326): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T01:13:41,270  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,271  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/70ec7889-47e1-4d9a-8d66-86b69e179179/_tmp_space.db/34e51e03-6a7f-4a3b-abc5-275b5c31805f
2024-04-24T01:13:41,274  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,274  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:41,274  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_4b1484d0-7efd-43f3-88e0-7375bb5e9326); Time taken: 0.004 seconds
2024-04-24T01:13:41,274  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_4b1484d0-7efd-43f3-88e0-7375bb5e9326
2024-04-24T01:13:41,278  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T01:13:41,285  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,285  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T01:13:41,285  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,286  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_97835cd4-92b3-4dbb-a281-0d62d06f10d8): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,288  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T01:13:41,288  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T01:13:41,289  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:41,289  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:41,291  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T01:13:41,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:41,293  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:41,293  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,293  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,294  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,294  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:41,294  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_97835cd4-92b3-4dbb-a281-0d62d06f10d8); Time taken: 0.007 seconds
2024-04-24T01:13:41,294  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424011341_97835cd4-92b3-4dbb-a281-0d62d06f10d8
2024-04-24T01:13:41,294  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_97835cd4-92b3-4dbb-a281-0d62d06f10d8
2024-04-24T01:13:41,309  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_97835cd4-92b3-4dbb-a281-0d62d06f10d8 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T01:13:41,309  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:41,310  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_97835cd4-92b3-4dbb-a281-0d62d06f10d8): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T01:13:41,310  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,311  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713946421, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFiles=0, numRows=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:41,317  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/nonacidnonbucket
2024-04-24T01:13:41,332  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,333  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-24T01:13:41,333  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_97835cd4-92b3-4dbb-a281-0d62d06f10d8); Time taken: 0.022 seconds
2024-04-24T01:13:41,333  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_97835cd4-92b3-4dbb-a281-0d62d06f10d8
2024-04-24T01:13:41,337  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T01:13:41,345  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,345  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T01:13:41,345  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T01:13:41,346  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_90d06ae2-77cc-43f9-a9c0-261c01feb0c9): drop table if exists T
2024-04-24T01:13:41,356  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T01:13:41,356  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T01:13:41,357  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:41,378  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:41,378  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,378  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,378  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,378  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=21, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=10, commitTxn_(CommitTxnRequest)=12}
2024-04-24T01:13:41,379  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_90d06ae2-77cc-43f9-a9c0-261c01feb0c9); Time taken: 0.032 seconds
2024-04-24T01:13:41,379  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424011341_90d06ae2-77cc-43f9-a9c0-261c01feb0c9
2024-04-24T01:13:41,379  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_90d06ae2-77cc-43f9-a9c0-261c01feb0c9
2024-04-24T01:13:41,399  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_90d06ae2-77cc-43f9-a9c0-261c01feb0c9 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T01:13:41,399  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:41,399  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_90d06ae2-77cc-43f9-a9c0-261c01feb0c9): drop table if exists T
2024-04-24T01:13:41,399  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:41,407  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:41,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:41,415  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:41,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T01:13:41,587  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t does not exist; Force to delete it.
2024-04-24T01:13:41,588 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:41,588  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,588  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=181, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:41,588  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_90d06ae2-77cc-43f9-a9c0-261c01feb0c9); Time taken: 0.189 seconds
2024-04-24T01:13:41,588  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_90d06ae2-77cc-43f9-a9c0-261c01feb0c9
2024-04-24T01:13:41,593  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T01:13:41,600  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,602  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T01:13:41,602  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T01:13:41,603  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_abdcdb8c-adbd-4823-812f-972456149572): drop table if exists Tstage
2024-04-24T01:13:41,613  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T01:13:41,613  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T01:13:41,614  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:41,642  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:41,642  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,642  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,642  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,642  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=10, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=28, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1}
2024-04-24T01:13:41,643  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_abdcdb8c-adbd-4823-812f-972456149572); Time taken: 0.039 seconds
2024-04-24T01:13:41,643  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424011341_abdcdb8c-adbd-4823-812f-972456149572
2024-04-24T01:13:41,643  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_abdcdb8c-adbd-4823-812f-972456149572
2024-04-24T01:13:41,660  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_abdcdb8c-adbd-4823-812f-972456149572 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T01:13:41,660  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:41,660  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_abdcdb8c-adbd-4823-812f-972456149572): drop table if exists Tstage
2024-04-24T01:13:41,660  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:41,671  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:41,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:41,681  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:41,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T01:13:41,721  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage does not exist; Force to delete it.
2024-04-24T01:13:41,721 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:41,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=50}
2024-04-24T01:13:41,721  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_abdcdb8c-adbd-4823-812f-972456149572); Time taken: 0.061 seconds
2024-04-24T01:13:41,721  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_abdcdb8c-adbd-4823-812f-972456149572
2024-04-24T01:13:41,726  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T01:13:41,734  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,734  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T01:13:41,735  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T01:13:41,735  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_f0b328c9-9d6a-4eed-9f3a-4a93dfdd848c): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T01:13:41,738  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T01:13:41,738  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T01:13:41,738  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:41,738  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:41,745  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T01:13:41,745  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:41,748  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:41,748  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,748  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,748  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,748  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, flushCache_()=0, getValidWriteIds_(List, String)=6}
2024-04-24T01:13:41,748  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_f0b328c9-9d6a-4eed-9f3a-4a93dfdd848c); Time taken: 0.013 seconds
2024-04-24T01:13:41,748  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424011341_f0b328c9-9d6a-4eed-9f3a-4a93dfdd848c
2024-04-24T01:13:41,749  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_f0b328c9-9d6a-4eed-9f3a-4a93dfdd848c
2024-04-24T01:13:41,770  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_f0b328c9-9d6a-4eed-9f3a-4a93dfdd848c LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T01:13:41,770  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:41,771  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_f0b328c9-9d6a-4eed-9f3a-4a93dfdd848c): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T01:13:41,771  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,772  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713946421, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional_properties=insert_only, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T01:13:41,779  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t
2024-04-24T01:13:41,822  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,822  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=51, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:41,822  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_f0b328c9-9d6a-4eed-9f3a-4a93dfdd848c); Time taken: 0.051 seconds
2024-04-24T01:13:41,822  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_f0b328c9-9d6a-4eed-9f3a-4a93dfdd848c
2024-04-24T01:13:41,827  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T01:13:41,836  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,836  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T01:13:41,837  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:41,837  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_53ca0a17-ba30-42e0-b005-77d27528942f): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:41,840  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 4
2024-04-24T01:13:41,840  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T01:13:41,841  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:41,841  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:41,844  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T01:13:41,844  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T01:13:41,846  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:41,846  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:41,846  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:41,846  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:41,846  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, flushCache_()=1, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14}
2024-04-24T01:13:41,847  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_53ca0a17-ba30-42e0-b005-77d27528942f); Time taken: 0.009 seconds
2024-04-24T01:13:41,847  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424011341_53ca0a17-ba30-42e0-b005-77d27528942f
2024-04-24T01:13:41,847  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_53ca0a17-ba30-42e0-b005-77d27528942f
2024-04-24T01:13:41,864  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_53ca0a17-ba30-42e0-b005-77d27528942f LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T01:13:41,864  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T01:13:41,864  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_53ca0a17-ba30-42e0-b005-77d27528942f): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T01:13:41,864  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:41,865  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713946421, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFilesErasureCoded=0, transactional=false, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numRows=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T01:13:41,872  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage
2024-04-24T01:13:41,891  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:41,892  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=26, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:41,892  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_53ca0a17-ba30-42e0-b005-77d27528942f); Time taken: 0.027 seconds
2024-04-24T01:13:41,892  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_53ca0a17-ba30-42e0-b005-77d27528942f
2024-04-24T01:13:41,897  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T01:13:41,905  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:41,905  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T01:13:41,905  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:41,906  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1): insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:41,910  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 7
2024-04-24T01:13:41,910  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T01:13:41,911  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:41,911  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:41,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:41,932  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:41,932  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:41,932  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:41,932  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:41,932  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:41,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:41,945  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:41,945  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:41,945  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T01:13:41,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:42,062  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:42,062  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:42,062  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:42,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T01:13:42,066  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:42,066  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:42,066  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:42,066  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:42,076  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:42,078  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1
2024-04-24T01:13:42,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:42,082  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T01:13:42,084  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:42,089  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:42,089  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:42,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:42,113  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:42,113  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T01:13:42,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:42,125  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:42,126  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:42,126  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T01:13:42,126  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:42,126  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:42,126  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:42,126  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T01:13:42,126  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T01:13:42,127  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:42,127  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:42,127  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:42,127  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T01:13:42,127  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:42,127  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=65, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=1, flushCache_()=1, getAllTableConstraints_(AllTableConstraintsRequest)=37, commitTxn_(CommitTxnRequest)=13, getCheckConstraints_(CheckConstraintsRequest)=2, openTxn_(String, TxnType)=3, getValidTxns_(long)=1}
2024-04-24T01:13:42,128  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1); Time taken: 0.221 seconds
2024-04-24T01:13:42,128  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1
2024-04-24T01:13:42,128  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1
2024-04-24T01:13:42,144  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T01:13:42,144  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:42,144  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1): insert into Tstage values(0,2),(0,4)
2024-04-24T01:13:42,145  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1
2024-04-24T01:13:42,145  INFO [main] ql.Driver: Query ID = alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1
Total jobs = 1
2024-04-24T01:13:42,145  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:42,145  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:42,313  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T01:13:42,313  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T01:13:42,315  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:42,315  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T01:13:42,316  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-41_906_5291060710833979552-1/dummy_path
2024-04-24T01:13:42,325  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:42,326  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,09KB
2024-04-24T01:13:42,327  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:42,331  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-41_906_5291060710833979552-1/-mr-10001
2024-04-24T01:13:42,335  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:42,344  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:42,348  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:42,349  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T01:13:42,349  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T01:13:42,349  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-41_906_5291060710833979552-1/dummy_path
2024-04-24T01:13:42,350  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T01:13:42,369  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T01:13:42,402  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2072414241_0015
2024-04-24T01:13:42,402  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:42,496  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:42,496  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:42,496  INFO [Thread-1370] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:42,496  INFO [Thread-1370] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:42,498  INFO [Thread-1370] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:42,498  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2072414241_0015_m_000000_0
2024-04-24T01:13:42,501  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:42,502  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-41_906_5291060710833979552-1/dummy_path/null:0+1
2024-04-24T01:13:42,504  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:42,505  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,09KB
2024-04-24T01:13:42,506  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T01:13:42,510  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:42,512  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:42,513  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:42,513  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:42,513  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T01:13:42,513  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T01:13:42,513  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:42,513  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T01:13:42,513  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:42,514  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@cbd4f98, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local2072414241_0015/job_local2072414241_0015.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2c386121
2024-04-24T01:13:42,514  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:42,514  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:42,515  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:42,517  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:42,517  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T01:13:42,524  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T01:13:42,524  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:42,524  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:42,524  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:42,525  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T01:13:42,532  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.tstage:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T01:13:42,533  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:42,536  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2072414241_0015_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:42,537  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:42,537  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2072414241_0015_m_000000_0' done.
2024-04-24T01:13:42,537  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2072414241_0015_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=339352
		FILE: Number of bytes written=17820990
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1134034944
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6148
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:42,537  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2072414241_0015_m_000000_0
2024-04-24T01:13:42,537  INFO [Thread-1370] mapred.LocalJobRunner: map task executor complete.
2024-04-24 01:13:43,497 Stage-1 map = 100%,  reduce = 0%
2024-04-24T01:13:43,497  INFO [main] exec.Task: 2024-04-24 01:13:43,497 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local2072414241_0015
2024-04-24T01:13:43,497  INFO [main] exec.Task: Ended Job = job_local2072414241_0015
2024-04-24T01:13:43,499  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T01:13:43,499  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T01:13:43,499  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T01:13:43,499  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T01:13:43,499  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/-ext-10000
2024-04-24T01:13:43,499  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/-ext-10002
2024-04-24T01:13:43,500  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T01:13:43,500  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1/-ext-10000
2024-04-24T01:13:43,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:43,512  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:43,522  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,523  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:43,523  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:43,557  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T01:13:43,558  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:43,569  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,569  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T01:13:43,569  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-41_906_5291060710833979552-1/-mr-10001
2024-04-24T01:13:43,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T01:13:43,580  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,581  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T01:13:43,581  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T01:13:43,581  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T01:13:43,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T01:13:43,614  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T01:13:43,614  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:43,614  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=67, getTable_(GetTableRequest)=43, isCompatibleWith_(Configuration)=1}
MapReduce Jobs Launched: 
2024-04-24T01:13:43,615  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:43,615  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:43,615  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:43,615  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1); Time taken: 1.47 seconds
2024-04-24T01:13:43,615  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011341_756afe8d-0d68-4ea6-b206-5a2cc00967d1
2024-04-24T01:13:43,619  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T01:13:43,626  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:43,626  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T01:13:43,627  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:43,627  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1
2024-04-24T01:13:43,627  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/tstage/.hive-staging_hive_2024-04-24_01-13-41_906_5291060710833979552-1 on fs with scheme file
2024-04-24T01:13:43,628  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-41_906_5291060710833979552-1
2024-04-24T01:13:43,628  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-41_906_5291060710833979552-1 on fs with scheme file
2024-04-24T01:13:43,628  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011343_c7c396b2-c5c0-4414-927f-7dacb40a53ab): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:43,629  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:43,638  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,640  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T01:13:43,641  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T01:13:43,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:43,653  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,653  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:43,653  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:43,654  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:43,654  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:43,654  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:43,654  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:43,654  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:43,654  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=18, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getCurrentNotificationEventId_()=3, openTxn_(String, TxnType)=3}
2024-04-24T01:13:43,654  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011343_c7c396b2-c5c0-4414-927f-7dacb40a53ab); Time taken: 0.026 seconds
2024-04-24T01:13:43,655  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424011343_c7c396b2-c5c0-4414-927f-7dacb40a53ab
2024-04-24T01:13:43,655  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011343_c7c396b2-c5c0-4414-927f-7dacb40a53ab
2024-04-24T01:13:43,671  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011343_c7c396b2-c5c0-4414-927f-7dacb40a53ab LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T01:13:43,671  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:43,671  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011343_c7c396b2-c5c0-4414-927f-7dacb40a53ab): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1'
2024-04-24T01:13:43,671  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:43,671  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:43,671  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:43,671  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:43,671  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1
2024-04-24T01:13:43,681  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:43,686  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:43,686  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:43,687  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011343_c7c396b2-c5c0-4414-927f-7dacb40a53ab); Time taken: 0.015 seconds
2024-04-24T01:13:43,687  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011343_c7c396b2-c5c0-4414-927f-7dacb40a53ab
2024-04-24T01:13:43,691  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T01:13:43,697  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:43,697  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T01:13:43,698  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:43,698  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011343_04257635-9c10-4fa1-b72f-2fc2988e6ddb): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:43,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:43,714  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,716  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T01:13:43,716  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T01:13:43,717  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:43,727  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,728  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:43,728  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:43,728  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:43,728  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:43,728  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:43,728  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:43,728  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:43,728  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getCurrentNotificationEventId_()=0, getTable_(GetTableRequest)=27, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0}
2024-04-24T01:13:43,729  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011343_04257635-9c10-4fa1-b72f-2fc2988e6ddb); Time taken: 0.03 seconds
2024-04-24T01:13:43,729  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424011343_04257635-9c10-4fa1-b72f-2fc2988e6ddb
2024-04-24T01:13:43,729  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011343_04257635-9c10-4fa1-b72f-2fc2988e6ddb
2024-04-24T01:13:43,750  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011343_04257635-9c10-4fa1-b72f-2fc2988e6ddb LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T01:13:43,750  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:43,750  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011343_04257635-9c10-4fa1-b72f-2fc2988e6ddb): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2'
2024-04-24T01:13:43,750  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:43,750  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:43,750  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:43,750  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:43,750  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2
2024-04-24T01:13:43,760  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:43,765  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:43,765  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:43,765  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011343_04257635-9c10-4fa1-b72f-2fc2988e6ddb); Time taken: 0.015 seconds
2024-04-24T01:13:43,765  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011343_04257635-9c10-4fa1-b72f-2fc2988e6ddb
2024-04-24T01:13:43,770  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T01:13:43,777  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:43,777  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T01:13:43,778  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:43,778  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011343_87988db2-2d28-4860-8bf9-60d6ad312c5e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:43,782  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T01:13:43,782  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T01:13:43,783  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:43,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,812  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T01:13:43,813  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-24T01:13:43,816  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:43,816  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:43,816  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:43,816  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, allocateTableWriteId_(long, String, String)=12, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=15, flushCache_()=0}
2024-04-24T01:13:43,816  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011343_87988db2-2d28-4860-8bf9-60d6ad312c5e); Time taken: 0.038 seconds
2024-04-24T01:13:43,817  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424011343_87988db2-2d28-4860-8bf9-60d6ad312c5e
2024-04-24T01:13:43,817  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011343_87988db2-2d28-4860-8bf9-60d6ad312c5e
2024-04-24T01:13:43,833  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011343_87988db2-2d28-4860-8bf9-60d6ad312c5e LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T01:13:43,833  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:43,838  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011343_87988db2-2d28-4860-8bf9-60d6ad312c5e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data' PARTITION (p=2)
2024-04-24T01:13:43,838  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:43,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:43,848  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,848  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:43,865  INFO [HMSHandler #2] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2
2024-04-24T01:13:43,865  INFO [HMSHandler #0] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1
2024-04-24T01:13:43,865  INFO [HMSHandler #14] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:43,899  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T01:13:43,899  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/1/data
2024-04-24T01:13:43,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:43,909  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:43,927  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T01:13:43,927  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:43,928  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:43,938  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:43,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:43,949  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T01:13:43,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:43,952  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T01:13:43,993  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:44,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:44,029  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-24T01:13:44,029  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/2/data
2024-04-24T01:13:44,030  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:44,043  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:44,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:44,055  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T01:13:44,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:44,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:44,066  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:44,067  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:44,081  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-24T01:13:44,086  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:44,086  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T01:13:44,127  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:44,145  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T01:13:44,157  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:44,157  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=73, validatePartitionNameCharacters_(List)=0, add_partitions_(List, boolean, boolean)=51, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=126, getValidWriteIds_(List, String)=1, getTable_(GetTableRequest)=55, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:44,157  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011343_87988db2-2d28-4860-8bf9-60d6ad312c5e); Time taken: 0.319 seconds
2024-04-24T01:13:44,157  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011343_87988db2-2d28-4860-8bf9-60d6ad312c5e
2024-04-24T01:13:44,161  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T01:13:44,170  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:44,171  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T01:13:44,172  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:44,172  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:44,182  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T01:13:44,183  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T01:13:44,183  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:44,183  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:44,189  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:44,189  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:44,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:44,205  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:44,205  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:44,205  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:44,205  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:44,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:44,255  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:44,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:44,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:44,311  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:44,311  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:44,329  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:44,329  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:44,381  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:44,381  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:44,381  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:44,382  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-44_172_6384703907638398546-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-44_172_6384703907638398546-1
2024-04-24T01:13:44,390  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:44,392  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T01:13:44,392  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col3]}
2024-04-24T01:13:44,393  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:44,394  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:44,403  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:44,403  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:44,403  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:44,403  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:44,403  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:44,403  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:44,404  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:44,404  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:44,404  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:44,404  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:44,404  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:44,404  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:44,404  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:44,404  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:44,404  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:44,404  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:44,404  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:44,404  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T01:13:44,405  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T01:13:44,405  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:44,405  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=28, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=7, commitTxn_(CommitTxnRequest)=14, getAggrColStatsFor_(String, String, List, List, String, String)=31, getValidTxns_(long)=0, listPartitions_(String, String, short)=31, openTxn_(String, TxnType)=10}
2024-04-24T01:13:44,406  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3); Time taken: 0.233 seconds
2024-04-24T01:13:44,406  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3
2024-04-24T01:13:44,407  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3
2024-04-24T01:13:44,433  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T01:13:44,433  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:44,434  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:44,435  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3
2024-04-24T01:13:44,435  INFO [main] ql.Driver: Query ID = alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3
Total jobs = 1
2024-04-24T01:13:44,435  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:44,435  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:44,613  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:44,613  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:44,613  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:44,613  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:44,613  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:44,613  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:44,613  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:44,613  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:44,615  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:44,616  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:44,616  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:44,624  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-44_172_6384703907638398546-1/-mr-10004/b065e7d0-0b68-4229-a147-7342ded20b4c (false)
2024-04-24T01:13:44,633  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:44,634  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,90KB
2024-04-24T01:13:44,638  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:44,640  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T01:13:44,641  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:44,649  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:44,659  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:44,664  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:44,666  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:44,666  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:44,666  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:44,676  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:44,676  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: insert_only 
2024-04-24T01:13:44,676  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:44,681  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T01:13:44,681  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 5 ms
2024-04-24T01:13:44,681  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T01:13:44,700  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T01:13:44,718  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local128712004_0016
2024-04-24T01:13:44,718  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:44,778  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:44,779  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:44,779  INFO [Thread-1446] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:44,779  INFO [Thread-1446] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:44,781  INFO [Thread-1446] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:44,781  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local128712004_0016_m_000000_0
2024-04-24T01:13:44,781  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:44,782  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:44,782  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:44,783  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-24T01:13:44,785  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:44,786  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:44,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:44,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:44,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:44,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:44,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:44,792  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:44,792  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:44,794  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:44,794  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:44,794  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:44,794  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T01:13:44,795  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:44,795  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:44,795  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:44,796  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T01:13:44,797  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:44,797  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:44,797  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:44,797  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T01:13:44,797  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:44,807  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:44,810  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local128712004_0016_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:44,811  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:44,811  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local128712004_0016_m_000000_0' done.
2024-04-24T01:13:44,811  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local128712004_0016_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=350361
		FILE: Number of bytes written=19008590
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1134034944
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7034
2024-04-24T01:13:44,811  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local128712004_0016_m_000000_0
2024-04-24T01:13:44,811  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local128712004_0016_m_000001_0
2024-04-24T01:13:44,812  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:44,812  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:44,812  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:44,813  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-24T01:13:44,814  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:44,816  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:44,833  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:44,833  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:44,834  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:44,834  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:44,834  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:44,834  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:44,834  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:44,836  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:44,837  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:44,837  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:44,837  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T01:13:44,837  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:44,837  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:44,837  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:44,837  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:44,837  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:44,838  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T01:13:44,839  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:44,839  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:44,839  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:44,839  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T01:13:44,839  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:44,847  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:44,850  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local128712004_0016_m_000001_0 is done. And is in the process of committing
2024-04-24T01:13:44,851  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:44,851  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local128712004_0016_m_000001_0' done.
2024-04-24T01:13:44,851  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local128712004_0016_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=357950
		FILE: Number of bytes written=19009006
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=12
		Total committed heap usage (bytes)=1134034944
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7034
2024-04-24T01:13:44,851  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local128712004_0016_m_000001_0
2024-04-24T01:13:44,851  INFO [Thread-1446] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:44,852  INFO [Thread-1446] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:44,852  INFO [pool-81-thread-1] mapred.LocalJobRunner: Starting task: attempt_local128712004_0016_r_000000_0
2024-04-24T01:13:44,853  INFO [pool-81-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:44,853  INFO [pool-81-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6026e699
2024-04-24T01:13:44,853  WARN [pool-81-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:44,854  INFO [pool-81-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:44,855  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local128712004_0016_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:44,859  INFO [localfetcher#15] reduce.LocalFetcher: localfetcher#15 about to shuffle output of map attempt_local128712004_0016_m_000000_0 decomp: 380 len: 384 to MEMORY
2024-04-24T01:13:44,860  INFO [localfetcher#15] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local128712004_0016_m_000000_0
2024-04-24T01:13:44,860  INFO [localfetcher#15] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->380
2024-04-24T01:13:44,862  INFO [localfetcher#15] reduce.LocalFetcher: localfetcher#15 about to shuffle output of map attempt_local128712004_0016_m_000001_0 decomp: 380 len: 384 to MEMORY
2024-04-24T01:13:44,862  INFO [localfetcher#15] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local128712004_0016_m_000001_0
2024-04-24T01:13:44,862  INFO [localfetcher#15] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 2, commitMemory -> 380, usedMemory ->760
2024-04-24T01:13:44,862  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:44,863  INFO [pool-81-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T01:13:44,863  INFO [pool-81-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:44,868  INFO [pool-81-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T01:13:44,869  INFO [pool-81-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 714 bytes
2024-04-24T01:13:44,871  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 760 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:44,872  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merging 1 files, 762 bytes from disk
2024-04-24T01:13:44,872  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:44,872  INFO [pool-81-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:44,872  INFO [pool-81-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 735 bytes
2024-04-24T01:13:44,872  INFO [pool-81-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T01:13:44,872  INFO [pool-81-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:44,873  INFO [pool-81-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T01:13:44,874  INFO [pool-81-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:44,874  INFO [pool-81-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:44,874  INFO [pool-81-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<_col0:string>>
2024-04-24T01:13:44,874  INFO [pool-81-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:44,875  INFO [pool-81-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@4bbd4ad3, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@2c79008>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@8490ec4, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@466f497f
2024-04-24T01:13:44,875  INFO [pool-81-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-44_172_6384703907638398546-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-44_172_6384703907638398546-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:44,875  INFO [pool-81-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-44_172_6384703907638398546-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-44_172_6384703907638398546-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:44,875  INFO [pool-81-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-44_172_6384703907638398546-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-44_172_6384703907638398546-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:44,882  INFO [pool-81-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:44,882  INFO [pool-81-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:44,882  INFO [pool-81-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:44,882  INFO [pool-81-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:44,882  INFO [pool-81-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T01:13:44,883  INFO [pool-81-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-24T01:13:44,883  INFO [pool-81-thread-1] mapred.Task: Task:attempt_local128712004_0016_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:44,883  INFO [pool-81-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:44,884  INFO [pool-81-thread-1] mapred.Task: Task 'attempt_local128712004_0016_r_000000_0' done.
2024-04-24T01:13:44,884  INFO [pool-81-thread-1] mapred.Task: Final Counters for attempt_local128712004_0016_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=365493
		FILE: Number of bytes written=19010587
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=768
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1134034944
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:44,884  INFO [pool-81-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local128712004_0016_r_000000_0
2024-04-24T01:13:44,884  INFO [Thread-1446] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:45,780 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:45,780  INFO [main] exec.Task: 2024-04-24 01:13:45,780 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local128712004_0016
2024-04-24T01:13:45,780  INFO [main] exec.Task: Ended Job = job_local128712004_0016
2024-04-24T01:13:45,782  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:45,782  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:45,782  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:45,782  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:45,782  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:45,782  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3); Time taken: 1.348 seconds
2024-04-24T01:13:45,782  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011344_e7aebded-4a53-4cb5-9c7f-53db5252cfd3
2024-04-24T01:13:45,787  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T01:13:45,793  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:45,793  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T01:13:45,798  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:45,799  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T01:13:45,799  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:4, 
2024-04-24T01:13:45,799  WARN [main] ql.TestTxnAddPartition: addPartitionMM: read data(add 2 parts w/data and 1 empty): 
2024-04-24T01:13:45,799  INFO [main] ql.TestTxnAddPartition: 0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0

2024-04-24T01:13:45,800  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:45,800  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-44_172_6384703907638398546-1
2024-04-24T01:13:45,801  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-44_172_6384703907638398546-1 on fs with scheme file
2024-04-24T01:13:45,801  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011345_96310326-f86a-4754-9fa1-6117021c1055): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:45,804  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T01:13:45,805  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T01:13:45,805  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:45,808  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:45,808  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:45,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:45,818  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:45,819  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:45,819  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:45,819  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:45,833  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:45,844  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:45,846  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:45,868  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:45,882  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:45,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:45,896  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:45,896  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:45,947  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:45,947  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:45,947  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:45,949  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:45,952  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2], VALUE._col0=Column[_col3]}
2024-04-24T01:13:45,952  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T01:13:45,953  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:45,969  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:45,980  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:45,980  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:45,980  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:45,980  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:45,980  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:45,980  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:45,980  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:45,981  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:45,981  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:45,981  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:45,981  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:45,981  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:45,981  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:45,981  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:45,981  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:45,981  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:45,981  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T01:13:45,981  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:45,982  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, listPartitions_(String, String, short)=12, getAllTableConstraints_(AllTableConstraintsRequest)=5, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=5, getAggrColStatsFor_(String, String, List, List, String, String)=27, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-24T01:13:45,982  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011345_96310326-f86a-4754-9fa1-6117021c1055); Time taken: 0.18 seconds
2024-04-24T01:13:45,982  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011345_96310326-f86a-4754-9fa1-6117021c1055): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:45,982  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T01:13:45,992  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:45,992  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T01:13:45,992  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011345_96310326-f86a-4754-9fa1-6117021c1055); Time taken: 0.01 seconds
2024-04-24T01:13:45,993  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:45,999  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T01:13:46,007  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:46,007  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T01:13:46,008  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:46,008  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-45_801_1006523354188314207-1
2024-04-24T01:13:46,008  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-45_801_1006523354188314207-1 on fs with scheme file
2024-04-24T01:13:46,009  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011346_a0adc8af-964a-41bb-b643-a4d1750232b1): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:46,009  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:46,020  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,022  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T01:13:46,022  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T01:13:46,026  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T01:13:46,036  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,036  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:46,036  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:46,036  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:46,036  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:46,037  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:46,037  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:46,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:46,037  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, getCurrentNotificationEventId_()=3, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=21}
2024-04-24T01:13:46,037  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011346_a0adc8af-964a-41bb-b643-a4d1750232b1); Time taken: 0.028 seconds
2024-04-24T01:13:46,037  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424011346_a0adc8af-964a-41bb-b643-a4d1750232b1
2024-04-24T01:13:46,038  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011346_a0adc8af-964a-41bb-b643-a4d1750232b1
2024-04-24T01:13:46,054  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011346_a0adc8af-964a-41bb-b643-a4d1750232b1 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T01:13:46,054  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T01:13:46,055  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011346_a0adc8af-964a-41bb-b643-a4d1750232b1): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3'
2024-04-24T01:13:46,055  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T01:13:46,055  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:46,055  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:46,055  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:46,055  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3
2024-04-24T01:13:46,066  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T01:13:46,072  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:46,072  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:46,072  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011346_a0adc8af-964a-41bb-b643-a4d1750232b1); Time taken: 0.017 seconds
2024-04-24T01:13:46,072  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011346_a0adc8af-964a-41bb-b643-a4d1750232b1
2024-04-24T01:13:46,077  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T01:13:46,084  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:46,084  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T01:13:46,085  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011346_2b097060-e4fe-457e-a620-58ce7b43cd0e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:46,088  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T01:13:46,088  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T01:13:46,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:46,100  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,342  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-24T01:13:46,343  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-24T01:13:46,345  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:46,345  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:46,345  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:46,345  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=242, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=11, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-24T01:13:46,346  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011346_2b097060-e4fe-457e-a620-58ce7b43cd0e); Time taken: 0.26 seconds
2024-04-24T01:13:46,346  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424011346_2b097060-e4fe-457e-a620-58ce7b43cd0e
2024-04-24T01:13:46,346  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011346_2b097060-e4fe-457e-a620-58ce7b43cd0e
2024-04-24T01:13:46,376  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011346_2b097060-e4fe-457e-a620-58ce7b43cd0e LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T01:13:46,376  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:46,383  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011346_2b097060-e4fe-457e-a620-58ce7b43cd0e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:46,383  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:46,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:46,402  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:46,438 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T01:13:46,438 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T01:13:46,439 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-24T01:13:46,441 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T01:13:46,443 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T01:13:46,443  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:46,443  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:46,444  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011346_2b097060-e4fe-457e-a620-58ce7b43cd0e); Time taken: 0.06 seconds
2024-04-24T01:13:46,444  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011346_2b097060-e4fe-457e-a620-58ce7b43cd0e
2024-04-24T01:13:46,447  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:46,458  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:46,459  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011346_b52bf412-8ec6-4a0f-a590-fb6fca40737d): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:46,471  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T01:13:46,472  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T01:13:46,473  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T01:13:46,499  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T01:13:46,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-24T01:13:46,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:46,562  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-24T01:13:46,562  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-24T01:13:46,563  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:46,563  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:46,564  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:46,564  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=10, openTxn_(String, TxnType)=12, getTable_(GetTableRequest)=26, flushCache_()=0, getPartitionWithAuthInfo_(String, String, List, String, List)=39, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, rollbackTxn_(long)=14}
2024-04-24T01:13:46,564  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011346_b52bf412-8ec6-4a0f-a590-fb6fca40737d); Time taken: 0.105 seconds
2024-04-24T01:13:46,565  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424011346_b52bf412-8ec6-4a0f-a590-fb6fca40737d
2024-04-24T01:13:46,565  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011346_b52bf412-8ec6-4a0f-a590-fb6fca40737d
2024-04-24T01:13:46,588  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011346_b52bf412-8ec6-4a0f-a590-fb6fca40737d LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T01:13:46,588  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T01:13:46,599  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011346_b52bf412-8ec6-4a0f-a590-fb6fca40737d): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data'
2024-04-24T01:13:46,599  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:46,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:46,616  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T01:13:46,635  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T01:13:46,640  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T01:13:46,642  INFO [HMSHandler #1] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3
2024-04-24T01:13:46,679  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-24T01:13:46,679  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/3/data
2024-04-24T01:13:46,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:46,696  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:46,708  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-24T01:13:46,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T01:13:46,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:46,718  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:46,730  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-24T01:13:46,734  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T01:13:46,734  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-24T01:13:46,775  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T01:13:46,800  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T01:13:46,810  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:46,810  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {add_partitions_(List, boolean, boolean)=61, getPartitionWithAuthInfo_(String, String, List, String, List)=34, validatePartitionNameCharacters_(List)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=43, getValidWriteIds_(List, String)=0, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=66}
2024-04-24T01:13:46,810  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011346_b52bf412-8ec6-4a0f-a590-fb6fca40737d); Time taken: 0.211 seconds
2024-04-24T01:13:46,810  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011346_b52bf412-8ec6-4a0f-a590-fb6fca40737d
2024-04-24T01:13:46,814  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T01:13:46,820  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:46,820  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T01:13:46,821  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:46,821  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:46,824  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 23
2024-04-24T01:13:46,825  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T01:13:46,826  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T01:13:46,826  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:46,832  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:46,832  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:46,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:46,842  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,843  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:46,843  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:46,843  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:46,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:46,892  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:46,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:46,939  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:46,951  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:46,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:46,970  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:46,970  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:47,020  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:47,020  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:47,020  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:47,022  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-46_821_6807720764128561077-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-46_821_6807720764128561077-1
2024-04-24T01:13:47,030  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:47,034  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T01:13:47,034  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T01:13:47,035  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:47,036  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:47,051  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:47,051  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:47,052  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:47,052  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:47,052  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T01:13:47,052  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:47,052  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T01:13:47,054  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T01:13:47,054  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:47,054  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1, getAllTableConstraints_(AllTableConstraintsRequest)=28, getValidWriteIds_(List, String)=7, getAggrColStatsFor_(String, String, List, List, String, String)=31, listPartitions_(String, String, short)=29, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=10}
2024-04-24T01:13:47,055  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c); Time taken: 0.233 seconds
2024-04-24T01:13:47,055  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c
2024-04-24T01:13:47,057  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c
2024-04-24T01:13:47,084  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T01:13:47,085  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T01:13:47,086  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:47,086  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c
2024-04-24T01:13:47,086  INFO [main] ql.Driver: Query ID = alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c
Total jobs = 1
2024-04-24T01:13:47,086  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T01:13:47,086  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T01:13:47,338  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T01:13:47,338  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T01:13:47,338  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T01:13:47,338  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T01:13:47,338  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T01:13:47,338  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T01:13:47,338  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T01:13:47,338  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T01:13:47,340  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T01:13:47,341  INFO [main] exec.Utilities: Processing alias t
2024-04-24T01:13:47,341  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:47,348  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-46_821_6807720764128561077-1/-mr-10004/b9517e35-bbc1-4a2a-b942-7b05ac869706 (false)
2024-04-24T01:13:47,358  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T01:13:47,359  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,25KB
2024-04-24T01:13:47,364  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T01:13:47,366  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T01:13:47,366  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:47,372  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:47,380  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T01:13:47,386  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T01:13:47,387  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T01:13:47,387  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T01:13:47,387  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0
2024-04-24T01:13:47,397  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T01:13:47,397  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: insert_only 
2024-04-24T01:13:47,397  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T01:13:47,403  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-24T01:13:47,403  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 6 ms
2024-04-24T01:13:47,404  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T01:13:47,422  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T01:13:47,441  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1522421278_0017
2024-04-24T01:13:47,441  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T01:13:47,510  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T01:13:47,510  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T01:13:47,510  INFO [Thread-1540] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:47,511  INFO [Thread-1540] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T01:13:47,513  INFO [Thread-1540] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T01:13:47,513  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1522421278_0017_m_000000_0
2024-04-24T01:13:47,514  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:47,514  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:47,515  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:47,516  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-24T01:13:47,518  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:47,519  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:47,525  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:47,525  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:47,525  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:47,525  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:47,525  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:47,525  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:47,526  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:47,528  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:47,529  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:47,529  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:47,529  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T01:13:47,529  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:47,530  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:47,530  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:47,530  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:47,530  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:47,531  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T01:13:47,532  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:47,532  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:47,532  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:47,532  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T01:13:47,532  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:47,543  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:47,546  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1522421278_0017_m_000000_0 is done. And is in the process of committing
2024-04-24T01:13:47,547  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:47,547  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1522421278_0017_m_000000_0' done.
2024-04-24T01:13:47,547  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1522421278_0017_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=380629
		FILE: Number of bytes written=20204876
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1229455360
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-24T01:13:47,547  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1522421278_0017_m_000000_0
2024-04-24T01:13:47,547  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1522421278_0017_m_000001_0
2024-04-24T01:13:47,547  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:47,548  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:47,548  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:47,549  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-24T01:13:47,550  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:47,551  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:47,556  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:47,556  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:47,556  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:47,556  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:47,556  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:47,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:47,557  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:47,559  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:47,560  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:47,560  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:47,560  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T01:13:47,560  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:47,560  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:47,561  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:47,562  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T01:13:47,562  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:47,562  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:47,562  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:47,562  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T01:13:47,562  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:47,571  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:47,574  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1522421278_0017_m_000001_0 is done. And is in the process of committing
2024-04-24T01:13:47,575  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:47,575  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1522421278_0017_m_000001_0' done.
2024-04-24T01:13:47,575  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1522421278_0017_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=389100
		FILE: Number of bytes written=20205292
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1229455360
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-24T01:13:47,575  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1522421278_0017_m_000001_0
2024-04-24T01:13:47,575  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1522421278_0017_m_000002_0
2024-04-24T01:13:47,576  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:47,576  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T01:13:47,577  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T01:13:47,577  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-24T01:13:47,579  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T01:13:47,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T01:13:47,587  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T01:13:47,587  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T01:13:47,587  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T01:13:47,587  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T01:13:47,587  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T01:13:47,588  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T01:13:47,588  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T01:13:47,592  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T01:13:47,593  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T01:13:47,593  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T01:13:47,593  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T01:13:47,593  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T01:13:47,593  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T01:13:47,594  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T01:13:47,594  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T01:13:47,594  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T01:13:47,594  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T01:13:47,594  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T01:13:47,594  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, 
2024-04-24T01:13:47,594  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T01:13:47,595  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T01:13:47,596  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T01:13:47,596  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T01:13:47,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T01:13:47,607  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1522421278_0017_m_000002_0 is done. And is in the process of committing
2024-04-24T01:13:47,608  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T01:13:47,608  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1522421278_0017_m_000002_0' done.
2024-04-24T01:13:47,608  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1522421278_0017_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=397059
		FILE: Number of bytes written=20205708
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1229455360
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-24T01:13:47,608  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1522421278_0017_m_000002_0
2024-04-24T01:13:47,608  INFO [Thread-1540] mapred.LocalJobRunner: map task executor complete.
2024-04-24T01:13:47,609  INFO [Thread-1540] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T01:13:47,609  INFO [pool-86-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1522421278_0017_r_000000_0
2024-04-24T01:13:47,610  INFO [pool-86-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T01:13:47,610  INFO [pool-86-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@35043d1a
2024-04-24T01:13:47,610  WARN [pool-86-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T01:13:47,611  INFO [pool-86-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T01:13:47,611  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1522421278_0017_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T01:13:47,614  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local1522421278_0017_m_000000_0 decomp: 380 len: 384 to MEMORY
2024-04-24T01:13:47,614  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local1522421278_0017_m_000000_0
2024-04-24T01:13:47,614  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->380
2024-04-24T01:13:47,616  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local1522421278_0017_m_000001_0 decomp: 380 len: 384 to MEMORY
2024-04-24T01:13:47,617  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local1522421278_0017_m_000001_0
2024-04-24T01:13:47,617  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 2, commitMemory -> 380, usedMemory ->760
2024-04-24T01:13:47,619  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local1522421278_0017_m_000002_0 decomp: 380 len: 384 to MEMORY
2024-04-24T01:13:47,619  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local1522421278_0017_m_000002_0
2024-04-24T01:13:47,619  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 3, commitMemory -> 760, usedMemory ->1140
2024-04-24T01:13:47,619  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T01:13:47,619  INFO [pool-86-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T01:13:47,619  INFO [pool-86-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T01:13:47,625  INFO [pool-86-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-24T01:13:47,625  INFO [pool-86-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 1071 bytes
2024-04-24T01:13:47,628  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 1140 bytes to disk to satisfy reduce memory limit
2024-04-24T01:13:47,628  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merging 1 files, 1140 bytes from disk
2024-04-24T01:13:47,628  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T01:13:47,628  INFO [pool-86-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T01:13:47,628  INFO [pool-86-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 1113 bytes
2024-04-24T01:13:47,629  INFO [pool-86-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T01:13:47,629  INFO [pool-86-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T01:13:47,630  INFO [pool-86-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T01:13:47,630  INFO [pool-86-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T01:13:47,630  INFO [pool-86-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T01:13:47,630  INFO [pool-86-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<_col0:string>>
2024-04-24T01:13:47,631  INFO [pool-86-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T01:13:47,631  INFO [pool-86-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@332cb98c, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@17d5138,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@2c79008>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@522b2148, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@1a16d5dc
2024-04-24T01:13:47,632  INFO [pool-86-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-46_821_6807720764128561077-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-46_821_6807720764128561077-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:47,632  INFO [pool-86-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-46_821_6807720764128561077-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-46_821_6807720764128561077-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T01:13:47,632  INFO [pool-86-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-46_821_6807720764128561077-1/-mr-10001/.hive-staging_hive_2024-04-24_01-13-46_821_6807720764128561077-1/_tmp.-ext-10002/000000_0
2024-04-24T01:13:47,639  INFO [pool-86-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T01:13:47,640  INFO [pool-86-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T01:13:47,640  INFO [pool-86-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:47,640  INFO [pool-86-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T01:13:47,640  INFO [pool-86-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-24T01:13:47,640  INFO [pool-86-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_0:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:47,641  INFO [pool-86-thread-1] mapred.Task: Task:attempt_local1522421278_0017_r_000000_0 is done. And is in the process of committing
2024-04-24T01:13:47,641  INFO [pool-86-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T01:13:47,641  INFO [pool-86-thread-1] mapred.Task: Task 'attempt_local1522421278_0017_r_000000_0' done.
2024-04-24T01:13:47,641  INFO [pool-86-thread-1] mapred.Task: Final Counters for attempt_local1522421278_0017_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=405396
		FILE: Number of bytes written=20208029
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=1152
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1229455360
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T01:13:47,641  INFO [pool-86-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1522421278_0017_r_000000_0
2024-04-24T01:13:47,641  INFO [Thread-1540] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 01:13:48,512 Stage-1 map = 100%,  reduce = 100%
2024-04-24T01:13:48,512  INFO [main] exec.Task: 2024-04-24 01:13:48,512 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1522421278_0017
2024-04-24T01:13:48,513  INFO [main] exec.Task: Ended Job = job_local1522421278_0017
2024-04-24T01:13:48,515  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:48,515  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T01:13:48,515  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T01:13:48,515  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:48,515  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T01:13:48,515  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c); Time taken: 1.429 seconds
2024-04-24T01:13:48,515  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011346_7d22dfd1-bc0c-499b-8a3d-af02f2f5648c
2024-04-24T01:13:48,519  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T01:13:48,525  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:48,526  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T01:13:48,530  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T01:13:48,531  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T01:13:48,531  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T01:13:48,531  WARN [main] ql.TestTxnAddPartition: addPartitionMM: read data(add 2 existing parts and 1 empty): 
2024-04-24T01:13:48,531  INFO [main] ql.TestTxnAddPartition: 0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
3	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0
3	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713946364196/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0

2024-04-24T01:13:48,531  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:48,531  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-46_821_6807720764128561077-1
2024-04-24T01:13:48,532  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-46_821_6807720764128561077-1 on fs with scheme file
2024-04-24T01:13:48,532  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011348_3625aa4e-8ef6-4cd6-9fdd-f8de1088c07e): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:48,541  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-24T01:13:48,541  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T01:13:48,543  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T01:13:48,546  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T01:13:48,546  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:48,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:48,556  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:48,557  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:48,557  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:48,557  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T01:13:48,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T01:13:48,585  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T01:13:48,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T01:13:48,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T01:13:48,634  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:48,634  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T01:13:48,647  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T01:13:48,647  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T01:13:48,697  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T01:13:48,697  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T01:13:48,697  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T01:13:48,699  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T01:13:48,703  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col3], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T01:13:48,703  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], VALUE._col0=Column[_col3]}
2024-04-24T01:13:48,704  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T01:13:48,727  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T01:13:48,737  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T01:13:48,738  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T01:13:48,738  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:48,738  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T01:13:48,738  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:48,738  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getAllTableConstraints_(AllTableConstraintsRequest)=8, getValidWriteIds_(List, String)=1, listPartitions_(String, String, short)=17, openTxn_(String, TxnType)=8, flushCache_()=0, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=10, getAggrColStatsFor_(String, String, List, List, String, String)=25}
2024-04-24T01:13:48,738  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011348_3625aa4e-8ef6-4cd6-9fdd-f8de1088c07e); Time taken: 0.206 seconds
2024-04-24T01:13:48,739  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011348_3625aa4e-8ef6-4cd6-9fdd-f8de1088c07e): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T01:13:48,739  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T01:13:48,749  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:48,750  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T01:13:48,750  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011348_3625aa4e-8ef6-4cd6-9fdd-f8de1088c07e); Time taken: 0.01 seconds
2024-04-24T01:13:48,750  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T01:13:48,755  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T01:13:48,761  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:48,762  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T01:13:48,763  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T01:13:48,763  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-48_532_3612336165554046180-1
2024-04-24T01:13:48,763  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/70ec7889-47e1-4d9a-8d66-86b69e179179/hive_2024-04-24_01-13-48_532_3612336165554046180-1 on fs with scheme file
2024-04-24T01:13:48,763  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011348_f03c3d94-70f6-4b25-8a8d-0d47e9d95472): drop table if exists acidTbl
2024-04-24T01:13:48,766  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-24T01:13:48,766  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T01:13:48,767  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:48,778  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:48,779  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:48,779  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:48,779  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:48,779  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=12, isCompatibleWith_(Configuration)=1}
2024-04-24T01:13:48,779  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011348_f03c3d94-70f6-4b25-8a8d-0d47e9d95472); Time taken: 0.016 seconds
2024-04-24T01:13:48,779  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424011348_f03c3d94-70f6-4b25-8a8d-0d47e9d95472
2024-04-24T01:13:48,780  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011348_f03c3d94-70f6-4b25-8a8d-0d47e9d95472
2024-04-24T01:13:48,795  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011348_f03c3d94-70f6-4b25-8a8d-0d47e9d95472 LockResponse(lockid:20, state:ACQUIRED)
2024-04-24T01:13:48,795  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:48,795  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011348_f03c3d94-70f6-4b25-8a8d-0d47e9d95472): drop table if exists acidTbl
2024-04-24T01:13:48,795  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:48,796  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:48,803  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:48,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:48,810  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:48,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T01:13:48,924  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:48,925  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=121, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:48,925  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011348_f03c3d94-70f6-4b25-8a8d-0d47e9d95472); Time taken: 0.129 seconds
2024-04-24T01:13:48,925  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011348_f03c3d94-70f6-4b25-8a8d-0d47e9d95472
2024-04-24T01:13:48,929  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T01:13:48,935  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:48,935  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T01:13:48,936  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T01:13:48,936  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011348_4afa28ec-ed10-45dd-8dcc-7915ca01f3ac): drop table if exists acidTblPart
2024-04-24T01:13:48,938  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-24T01:13:48,939  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-24T01:13:48,939  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:48,953  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:48,953  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:48,953  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:48,953  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:48,953  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=14, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:48,954  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011348_4afa28ec-ed10-45dd-8dcc-7915ca01f3ac); Time taken: 0.017 seconds
2024-04-24T01:13:48,954  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240424011348_4afa28ec-ed10-45dd-8dcc-7915ca01f3ac
2024-04-24T01:13:48,954  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011348_4afa28ec-ed10-45dd-8dcc-7915ca01f3ac
2024-04-24T01:13:48,970  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011348_4afa28ec-ed10-45dd-8dcc-7915ca01f3ac LockResponse(lockid:21, state:ACQUIRED)
2024-04-24T01:13:48,970  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:48,970  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011348_4afa28ec-ed10-45dd-8dcc-7915ca01f3ac): drop table if exists acidTblPart
2024-04-24T01:13:48,970  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:48,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:48,978  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:48,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:48,985  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:48,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T01:13:49,042  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:49,042  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=64, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:49,042  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011348_4afa28ec-ed10-45dd-8dcc-7915ca01f3ac); Time taken: 0.072 seconds
2024-04-24T01:13:49,042  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011348_4afa28ec-ed10-45dd-8dcc-7915ca01f3ac
2024-04-24T01:13:49,045  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-24T01:13:49,050  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:49,050  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-24T01:13:49,051  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T01:13:49,051  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011349_b51add7b-3258-48d5-892b-04a62848bc9b): drop table if exists acidTbl2
2024-04-24T01:13:49,053  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-24T01:13:49,054  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-24T01:13:49,054  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:49,054  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:49,054  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:49,055  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:49,055  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011349_b51add7b-3258-48d5-892b-04a62848bc9b); Time taken: 0.003 seconds
2024-04-24T01:13:49,055  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240424011349_b51add7b-3258-48d5-892b-04a62848bc9b
2024-04-24T01:13:49,055  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T01:13:49,055  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011349_b51add7b-3258-48d5-892b-04a62848bc9b): drop table if exists acidTbl2
2024-04-24T01:13:49,055  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:49,056  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T01:13:49,056  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:49,056  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:49,056  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011349_b51add7b-3258-48d5-892b-04a62848bc9b); Time taken: 0.001 seconds
2024-04-24T01:13:49,057  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011349_b51add7b-3258-48d5-892b-04a62848bc9b
2024-04-24T01:13:49,062  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-24T01:13:49,066  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:49,067  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-24T01:13:49,067  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T01:13:49,067  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011349_d8b27e73-8c8b-403d-aed9-0756335824fe): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:49,069  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-24T01:13:49,070  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-24T01:13:49,071  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:49,090  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,091  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:49,091  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:49,091  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:49,091  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=21, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T01:13:49,091  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011349_d8b27e73-8c8b-403d-aed9-0756335824fe); Time taken: 0.024 seconds
2024-04-24T01:13:49,092  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240424011349_d8b27e73-8c8b-403d-aed9-0756335824fe
2024-04-24T01:13:49,092  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011349_d8b27e73-8c8b-403d-aed9-0756335824fe
2024-04-24T01:13:49,109  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011349_d8b27e73-8c8b-403d-aed9-0756335824fe LockResponse(lockid:22, state:ACQUIRED)
2024-04-24T01:13:49,110  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:49,110  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011349_d8b27e73-8c8b-403d-aed9-0756335824fe): drop table if exists nonAcidOrcTbl
2024-04-24T01:13:49,110  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:49,110  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:49,124  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:49,137  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,138  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T01:13:49,219  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:49,219  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=95, getTable_(GetTableRequest)=14}
2024-04-24T01:13:49,220  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011349_d8b27e73-8c8b-403d-aed9-0756335824fe); Time taken: 0.109 seconds
2024-04-24T01:13:49,220  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011349_d8b27e73-8c8b-403d-aed9-0756335824fe
2024-04-24T01:13:49,226  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-24T01:13:49,235  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:49,235  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-24T01:13:49,236  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:49,237  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011349_3436cbab-d960-4e21-8d29-3b75da3f1c7b): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:49,240  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-24T01:13:49,241  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-24T01:13:49,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:49,258  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,259  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:49,259  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:49,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:49,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, getTable_(GetTableRequest)=17, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=16}
2024-04-24T01:13:49,259  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011349_3436cbab-d960-4e21-8d29-3b75da3f1c7b); Time taken: 0.022 seconds
2024-04-24T01:13:49,260  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240424011349_3436cbab-d960-4e21-8d29-3b75da3f1c7b
2024-04-24T01:13:49,261  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011349_3436cbab-d960-4e21-8d29-3b75da3f1c7b
2024-04-24T01:13:49,285  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011349_3436cbab-d960-4e21-8d29-3b75da3f1c7b LockResponse(lockid:23, state:ACQUIRED)
2024-04-24T01:13:49,285  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:49,285  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011349_3436cbab-d960-4e21-8d29-3b75da3f1c7b): drop table if exists nonAcidOrcTbl2
2024-04-24T01:13:49,285  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:49,286  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:49,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:49,317  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,317  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T01:13:49,375  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:49,375  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=74, getTable_(GetTableRequest)=15}
2024-04-24T01:13:49,375  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011349_3436cbab-d960-4e21-8d29-3b75da3f1c7b); Time taken: 0.09 seconds
2024-04-24T01:13:49,375  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011349_3436cbab-d960-4e21-8d29-3b75da3f1c7b
2024-04-24T01:13:49,379  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-24T01:13:49,385  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:49,385  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-24T01:13:49,385  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T01:13:49,385  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424011349_14d38a02-2a77-495b-94ea-fe0cb9ad9771): drop table if exists nonAcidNonBucket
2024-04-24T01:13:49,387  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-24T01:13:49,388  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-24T01:13:49,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:49,398  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,398  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T01:13:49,398  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T01:13:49,398  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T01:13:49,398  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=10}
2024-04-24T01:13:49,398  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424011349_14d38a02-2a77-495b-94ea-fe0cb9ad9771); Time taken: 0.013 seconds
2024-04-24T01:13:49,398  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240424011349_14d38a02-2a77-495b-94ea-fe0cb9ad9771
2024-04-24T01:13:49,399  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424011349_14d38a02-2a77-495b-94ea-fe0cb9ad9771
2024-04-24T01:13:49,411  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424011349_14d38a02-2a77-495b-94ea-fe0cb9ad9771 LockResponse(lockid:24, state:ACQUIRED)
2024-04-24T01:13:49,412  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T01:13:49,412  INFO [main] ql.Driver: Executing command(queryId=alex_20240424011349_14d38a02-2a77-495b-94ea-fe0cb9ad9771): drop table if exists nonAcidNonBucket
2024-04-24T01:13:49,412  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T01:13:49,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:49,421  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:49,430  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T01:13:49,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T01:13:49,466  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T01:13:49,466  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=45, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-24T01:13:49,467  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424011349_14d38a02-2a77-495b-94ea-fe0cb9ad9771); Time taken: 0.054 seconds
2024-04-24T01:13:49,467  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424011349_14d38a02-2a77-495b-94ea-fe0cb9ad9771
2024-04-24T01:13:49,472  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-24T01:13:49,481  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-24T01:13:49,482  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-24T01:13:49,483  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T01:13:49,527  INFO [pool-2-thread-1] lockmgr.DbTxnManager: Shutting down Heartbeater thread pool.
