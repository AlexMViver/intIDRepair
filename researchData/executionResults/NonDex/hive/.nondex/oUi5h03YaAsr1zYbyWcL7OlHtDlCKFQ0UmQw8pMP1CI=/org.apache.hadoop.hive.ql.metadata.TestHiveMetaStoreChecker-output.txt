SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,070162 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@45d84a20]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@45d84a20) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@5e7cd6cc
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@169bb4dd
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,025217 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(footer="null", Configuration(HiveLog4j2Test), alwaysWriteExceptions="null", header="null", Replace=null, disableAnsi="null", noConsoleNoAnsi="null", PatternSelector=null, pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", charset="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(follow="null", target="SYSTEM_ERR", direct="null", immediateFlush="null", bufferSize="null", bufferedIo="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), Configuration(HiveLog4j2Test), ignoreExceptions="null", name="console", ={}, Filter=null)
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(footer="null", alwaysWriteExceptions="null", header="null", disableAnsi="null", Configuration(HiveLog4j2Test), PatternSelector=null, charset="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", Replace=null, noConsoleNoAnsi="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(maxRandomDelay="null", interval="1", modulate="true")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(compressionLevel="null", Configuration(HiveLog4j2Test), tempCompressedFilePattern="null", min="null", fileIndex="null", ={}, stopCustomActionsOnError="null", max="30")
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(append="null", fileGroup="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", filePermissions="null", advertise="null", advertiseURI="null", fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), fileOwner="null", bufferedIo="null", immediateFlush="null", bufferSize="null", Configuration(HiveLog4j2Test), ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="DRFA", Filter=null, ={})
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 1163713418
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-24T02:16:31.736-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/25-00:00:00.000, nextFileTime=2024/04/24-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/24-02:16:33.476, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/25-00:00:00.000, nextFileTime=2024/04/24-00:00:00.000, prevFileTime=2024/04/24-00:00:00.000, current=2024/04/24-02:16:33.477, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@169bb4dd initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@169bb4dd
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@169bb4dd OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@3571b748...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@3571b748 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@555cf22
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@45d84a20
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@45d84a20) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@45d84a20] started OK.
2024-04-24T02:16:33,604  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-24T02:16:33,984  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-24T02:16:34,041  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:16:34,041  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:16:34,042  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:16:34,042  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:16:34,042  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:16:34,042  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:16:34,042  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:16:34,043  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:16:34,043  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:16:34,043  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:16:34,043  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:16:34,807  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:16:34,812  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:16:34,829  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:16:34,830  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:16:34,830  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:16:34,831  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:16:34,832  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:16:34,912  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:35,041  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:35,066  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:35,075  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-24T02:16:35,075  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-24T02:16:35,091  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T02:16:35,096  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-24T02:16:35,688  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T02:16:35,692  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
log4j: Trying to find [log4j.xml] using context classloader sun.misc.Launcher$AppClassLoader@330bedb4.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader sun.misc.Launcher$AppClassLoader@330bedb4.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
log4j:WARN No appenders could be found for logger (DataNucleus.General).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-24T02:16:36,422  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-24T02:16:36,422  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1cdc1bbc, with PersistenceManager: null will be shutdown
2024-04-24T02:16:36,445  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1cdc1bbc, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2be95d31 created in the thread with id: 1
2024-04-24T02:16:38,856  WARN [main] metastore.ObjectStore: Version information not found in metastore. metastore.schema.verification is not enabled so recording the schema version 4.0.0
2024-04-24T02:16:38,856  WARN [main] metastore.ObjectStore: setMetaStoreSchemaVersion called but recording version is disabled: version = 4.0.0, comment = Set by MetaStore alex@127.0.1.1
2024-04-24T02:16:38,856  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1cdc1bbc from thread id: 1
2024-04-24T02:16:39,083  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-24T02:16:39,116  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-24T02:16:39,152  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-24T02:16:39,155  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-24T02:16:39,274  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-24T02:16:39,281  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-24T02:16:39,282  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-24T02:16:39,283  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-24T02:16:39,285  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-24T02:16:39,308  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T02:16:39,310  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-24T02:16:39,312  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T02:16:39,313  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-24T02:16:39,315  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T02:16:39,317  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-24T02:16:39,319  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T02:16:39,319  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-24T02:16:39,324  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-24T02:16:39,325  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-24T02:16:39,328  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:39,454  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:39,501  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_functions	
2024-04-24T02:16:39,551  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:39,551  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:39,552  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1cdc1bbc, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2be95d31 will be shutdown
2024-04-24T02:16:39,553  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1cdc1bbc, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2c8b8de0 created in the thread with id: 1
2024-04-24T02:16:39,570  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
Hive Session ID = edd863e8-2c59-4e08-906c-11d9023e9be0
2024-04-24T02:16:39,573  INFO [main] SessionState: Hive Session ID = edd863e8-2c59-4e08-906c-11d9023e9be0
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:39,575  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:39,618  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/edd863e8-2c59-4e08-906c-11d9023e9be0
2024-04-24T02:16:39,622  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/edd863e8-2c59-4e08-906c-11d9023e9be0
2024-04-24T02:16:39,626  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/edd863e8-2c59-4e08-906c-11d9023e9be0/_tmp_space.db
2024-04-24T02:16:39,630  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:39,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:39,647  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:39,654  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:39,656  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:39,660  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:39,707  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:39,708  INFO [main] metastore.HiveMetaStoreClient: Mestastore configuration metastore.filter.hook changed from org.apache.hadoop.hive.metastore.DefaultMetaStoreFilterHookImpl to org.apache.hadoop.hive.ql.security.authorization.plugin.AuthorizationMetaStoreFilterHook
2024-04-24T02:16:39,710  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:39,710  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1cdc1bbc, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2c8b8de0 will be shutdown
2024-04-24T02:16:39,711  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:39,711  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -1
2024-04-24T02:16:39,713  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:39,714  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:39,714  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:39,716  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2baac4a7, with PersistenceManager: null will be shutdown
2024-04-24T02:16:39,716  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2baac4a7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6bce4140 created in the thread with id: 1
2024-04-24T02:16:39,722  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2baac4a7 from thread id: 1
2024-04-24T02:16:39,722  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:39,723  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:39,744  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:39,744  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:39,745  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2baac4a7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6bce4140 will be shutdown
2024-04-24T02:16:39,745  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2baac4a7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5e9bf744 created in the thread with id: 1
2024-04-24T02:16:39,751  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:39,752  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:39,752  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950199, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:), FieldSchema(name:part3, type:string, comment:), FieldSchema(name:part4, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:39,772  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:39,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:40,000  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:40,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:40,260  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:40,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:40,398  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0/part3=val_0/part4=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1/part3=val_1/part4=val_1, testhivemetastorechecker_table:part1=val_2/part2=val_2/part3=val_2/part4=val_2, testhivemetastorechecker_table:part1=val_3/part2=val_3/part3=val_3/part4=val_3, testhivemetastorechecker_table:part1=val_4/part2=val_4/part3=val_4/part4=val_4, testhivemetastorechecker_table:part1=val_5/part2=val_5/part3=val_5/part4=val_5, testhivemetastorechecker_table:part1=val_6/part2=val_6/part3=val_6/part4=val_6, testhivemetastorechecker_table:part1=val_7/part2=val_7/part3=val_7/part4=val_7, testhivemetastorechecker_table:part1=val_8/part2=val_8/part3=val_8/part4=val_8, testhivemetastorechecker_table:part1=val_9/part2=val_9/part3=val_9/part4=val_9], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:40,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:40,415  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:40,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:40,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:40,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:40,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:40,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:40,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:40,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:40,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:40,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:40,711  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:40,744  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:40,771  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:40,779  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:40,821  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:40,821  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:40,827  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:40,827 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:40,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:40,828  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2baac4a7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5e9bf744 will be shutdown
2024-04-24T02:16:40,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:40,828  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -2
2024-04-24T02:16:40,833  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:40,834  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:40,835  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:40,835  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f402027, with PersistenceManager: null will be shutdown
2024-04-24T02:16:40,835  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f402027, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7c226095 created in the thread with id: 1
2024-04-24T02:16:40,846  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f402027 from thread id: 1
2024-04-24T02:16:40,846  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:40,847  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:40,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:40,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:40,861  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:40,861  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:40,862  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f402027, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7c226095 will be shutdown
2024-04-24T02:16:40,862  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f402027, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@a84338a created in the thread with id: 1
2024-04-24T02:16:40,866  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:40,866  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:40,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:40,869  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:40,870  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:40,872  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:40,876  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:40,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950200, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:40,884  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:40,927  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:40,976  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:40,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:40,996  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-24T02:16:41,030  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,041  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-24T02:16:41,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,074  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:41,074  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,084  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,134  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:41,156  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:41,157  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,209  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:41,209  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,214  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,229  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:41,243  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[testhivemetastorechecker_table:partdate=2008-01-01/partcity=london], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:41,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,257  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:41,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,466  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950200, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), rewriteEnabled:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:16:41,475  WARN [main] metastore.HMSHandler: Location: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table specified for non-external table:testhivemetastorechecker_table
2024-04-24T02:16:41,475  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:41,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-24T02:16:41,516  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
Test completed - partition check
2024-04-24T02:16:41,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,557  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:41,557  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,616  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:41,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:41,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:41,627  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:41,632  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:41,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:41,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:41,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:41,645  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:41,650  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:41,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:41,658  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:41,672  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:41,672  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:41,679  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:41,679 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:41,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:41,679  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f402027, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@a84338a will be shutdown
2024-04-24T02:16:41,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:41,680  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -3
2024-04-24T02:16:41,682  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:41,684  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:41,684  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:41,685  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@51df2a41, with PersistenceManager: null will be shutdown
2024-04-24T02:16:41,685  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@51df2a41, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7c0b0bd9 created in the thread with id: 1
2024-04-24T02:16:41,719  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@51df2a41 from thread id: 1
2024-04-24T02:16:41,719  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:41,720  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:41,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:41,730  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:41,730  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:41,731  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@51df2a41, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7c0b0bd9 will be shutdown
2024-04-24T02:16:41,731  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@51df2a41, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@148fca83 created in the thread with id: 1
2024-04-24T02:16:41,736  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:41,736  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:41,736  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:41,742  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:41,743  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:41,745  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:41,749  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:41,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950201, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:41,757  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:41,780  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,794  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:41,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:41,983  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:41,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,064  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1, testhivemetastorechecker_table:part1=val_2/part2=val_2, testhivemetastorechecker_table:part1=val_3/part2=val_3, testhivemetastorechecker_table:part1=val_4/part2=val_4, testhivemetastorechecker_table:part1=val_5/part2=val_5, testhivemetastorechecker_table:part1=val_6/part2=val_6, testhivemetastorechecker_table:part1=val_7/part2=val_7, testhivemetastorechecker_table:part1=val_8/part2=val_8, testhivemetastorechecker_table:part1=val_9/part2=val_9], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:42,064  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,076  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:42,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,126  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:42,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:42,133  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:42,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:42,136  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,138  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:42,144  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:42,144  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:42,148  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:42,148 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,149  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:42,149  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@51df2a41, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@148fca83 will be shutdown
2024-04-24T02:16:42,149  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:42,149  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -4
2024-04-24T02:16:42,151  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:42,152  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:42,152  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:42,152  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1d008e61, with PersistenceManager: null will be shutdown
2024-04-24T02:16:42,153  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1d008e61, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5de243bb created in the thread with id: 1
2024-04-24T02:16:42,156  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1d008e61 from thread id: 1
2024-04-24T02:16:42,156  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:42,157  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:42,161  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,163  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:42,165  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:42,165  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:42,166  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1d008e61, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5de243bb will be shutdown
2024-04-24T02:16:42,166  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1d008e61, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4e80960a created in the thread with id: 1
2024-04-24T02:16:42,170  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:42,171  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:42,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:42,174  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,174  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,176  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,178  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:42,179  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950202, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:42,185  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:42,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,213  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,275  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,286  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,286  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,301  WARN [MSCK-GetPaths-0] metastore.HiveMetaStoreChecker: Unexpected partition key part2 found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/part2=val_1
2024-04-24T02:16:42,301  WARN [MSCK-GetPaths-0] metastore.HiveMetaStoreChecker: Unexpected partition key part2 found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/part2=val_0
2024-04-24T02:16:42,306  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:42,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,317  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,318  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,357  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:42,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,359  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:42,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:42,368  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:42,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:42,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,373  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:42,378  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:42,378  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:42,383  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:42,383 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:42,383  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1d008e61, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4e80960a will be shutdown
2024-04-24T02:16:42,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:42,384  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -5
2024-04-24T02:16:42,385  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:42,386  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:42,386  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:42,387  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d483ebe, with PersistenceManager: null will be shutdown
2024-04-24T02:16:42,387  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d483ebe, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5d98364c created in the thread with id: 1
2024-04-24T02:16:42,390  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d483ebe from thread id: 1
2024-04-24T02:16:42,390  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:42,390  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:42,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:42,398  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:42,398  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:42,399  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d483ebe, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5d98364c will be shutdown
2024-04-24T02:16:42,399  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d483ebe, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4f98ac31 created in the thread with id: 1
2024-04-24T02:16:42,402  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:42,402  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:42,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:42,405  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,405  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,407  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,410  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:42,410  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950202, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:42,416  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:42,434  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,445  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,455  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,466  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,467  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,511  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:42,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,514  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:42,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:42,519  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:42,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,523  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:42,528  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:42,528  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:42,533  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:42,533 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,534  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,537  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:42,538  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:42,538  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d483ebe, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4f98ac31 will be shutdown
2024-04-24T02:16:42,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:42,539  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -6
2024-04-24T02:16:42,540  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:42,541  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:42,541  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:42,541  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49741274, with PersistenceManager: null will be shutdown
2024-04-24T02:16:42,542  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49741274, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3e5b2630 created in the thread with id: 1
2024-04-24T02:16:42,544  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49741274 from thread id: 1
2024-04-24T02:16:42,544  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:42,545  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:42,549  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,551  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:42,553  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:42,553  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:42,553  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49741274, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3e5b2630 will be shutdown
2024-04-24T02:16:42,554  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49741274, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@12765ebd created in the thread with id: 1
2024-04-24T02:16:42,556  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:42,557  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:42,557  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:42,559  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,559  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,562  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:42,564  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:42,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950202, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:42,571  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:42,588  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,600  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,601  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,615  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-24T02:16:42,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,649  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-24T02:16:42,668  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,750  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,755  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,790  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,812  WARN [MSCK-GetPaths-0] metastore.HiveMetaStoreChecker: Unexpected partition key fakedate found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/fakedate=2009-01-01
2024-04-24T02:16:42,818  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=val_0/partcity=val_0, testhivemetastorechecker_table:partdate=val_1/partcity=val_1], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:42,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,828  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:42,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:42,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:42,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:42,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:42,985  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:42,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:42,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:42,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:42,998  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:43,012  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:43,012  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:43,017  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:43,017 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:43,017  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:43,018  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49741274, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@12765ebd will be shutdown
2024-04-24T02:16:43,018  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:43,018  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -7
2024-04-24T02:16:43,019  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:43,020  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:43,020  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:43,020  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b75f3f4, with PersistenceManager: null will be shutdown
2024-04-24T02:16:43,021  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b75f3f4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5570dc21 created in the thread with id: 1
2024-04-24T02:16:43,040  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b75f3f4 from thread id: 1
2024-04-24T02:16:43,041  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:43,041  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:43,045  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,047  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:43,048  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:43,049  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:43,049  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b75f3f4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5570dc21 will be shutdown
2024-04-24T02:16:43,049  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b75f3f4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@52463255 created in the thread with id: 1
2024-04-24T02:16:43,052  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:43,052  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:43,053  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:43,056  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:43,057  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:43,059  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:43,063  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:43,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950203, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:43,069  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:43,106  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,143  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:43,144  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,235  INFO [Finalizer] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:43,236  INFO [Finalizer] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -8
2024-04-24T02:16:43,237  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-24T02:16:43,261  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,269  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-24T02:16:43,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,332  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:43,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,375  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:43,394 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key fakedate found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/fakedate=2009-01-01
	at java.util.concurrent.FutureTask.report(FutureTask.java:122) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.get(FutureTask.java:192) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testInvalidPartitionKeyName(TestHiveMetaStoreChecker.java:243) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.ExpectException.evaluate(ExpectException.java:19) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key fakedate found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/fakedate=2009-01-01
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-24T02:16:43,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,407  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:43,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,551  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:43,553  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:43,553  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:43,558  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:43,563  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:43,563  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:43,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:43,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:43,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:43,573  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:43,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:43,579  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:43,594  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:43,594  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:43,600  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:43,600 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:43,600  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:43,600  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b75f3f4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@52463255 will be shutdown
2024-04-24T02:16:43,600  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:43,600  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -9
2024-04-24T02:16:43,601  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:43,602  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:43,602  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:43,603  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4db45d, with PersistenceManager: null will be shutdown
2024-04-24T02:16:43,603  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4db45d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5c7d675c created in the thread with id: 1
2024-04-24T02:16:43,626  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4db45d from thread id: 1
2024-04-24T02:16:43,626  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:43,627  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:43,631  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:43,637  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:43,637  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:43,637  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4db45d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5c7d675c will be shutdown
2024-04-24T02:16:43,638  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4db45d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@14b4b25e created in the thread with id: 1
2024-04-24T02:16:43,640  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:43,640  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:43,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:43,644  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:43,644  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:43,647  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:43,650  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:43,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950203, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-24T02:16:43,663  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:43,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,718  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:43,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,729  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-24T02:16:43,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,767  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-24T02:16:43,783  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,840  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,848  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:43,848  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,892  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:43,925  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:43,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:43,933  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:43,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,074  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:44,074  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:44,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:44,083  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:44,083  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:44,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:44,093  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:44,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:44,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:44,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:44,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:44,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:44,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:44,109  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:44,124  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:44,124  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:44,129  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:44,129 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:44,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:44,129  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4db45d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@14b4b25e will be shutdown
2024-04-24T02:16:44,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:44,130  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -10
2024-04-24T02:16:44,131  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:44,131  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:44,132  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:44,132  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26398f67, with PersistenceManager: null will be shutdown
2024-04-24T02:16:44,132  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26398f67, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@401b7226 created in the thread with id: 1
2024-04-24T02:16:44,154  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26398f67 from thread id: 1
2024-04-24T02:16:44,154  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:44,154  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:44,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,161  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:44,162  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:44,162  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:44,163  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26398f67, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@401b7226 will be shutdown
2024-04-24T02:16:44,163  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26398f67, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@53cba89f created in the thread with id: 1
2024-04-24T02:16:44,166  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:44,166  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:44,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:44,170  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:44,171  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:44,173  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:44,176  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:44,177  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950204, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-24T02:16:44,184  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:44,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,236  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:44,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,246  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-24T02:16:44,275  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,282  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-24T02:16:44,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,365  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:44,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,373  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,403  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:44,436  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:44,436  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,446  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:44,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,610  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:44,610  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:44,616  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:44,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:44,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:44,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:44,631  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:44,631  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:44,632  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:44,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:44,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:44,641  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:44,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:44,646  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:44,662  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:44,662  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:44,667  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:44,667 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:44,668  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:44,668  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26398f67, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@53cba89f will be shutdown
2024-04-24T02:16:44,668  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:44,668  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -11
2024-04-24T02:16:44,669  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:44,670  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:44,670  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:44,671  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a10e65b, with PersistenceManager: null will be shutdown
2024-04-24T02:16:44,671  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a10e65b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7a791e8b created in the thread with id: 1
2024-04-24T02:16:44,698  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a10e65b from thread id: 1
2024-04-24T02:16:44,698  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:44,699  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:44,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:44,708  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:44,709  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:44,709  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a10e65b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7a791e8b will be shutdown
2024-04-24T02:16:44,709  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a10e65b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@586a9fe1 created in the thread with id: 1
2024-04-24T02:16:44,712  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:44,713  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:44,713  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:44,718  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:44,718  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:44,721  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:44,732  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:44,733  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950204, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-24T02:16:44,743  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:44,789  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,808  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:44,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,820  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-24T02:16:44,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,858  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-24T02:16:44,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,930  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,939  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:44,939  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,947  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:44,982  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,013  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:45,013  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,020  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,153  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:45,153  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:45,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:45,161  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,161  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:45,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,173  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,173  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:45,178  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:45,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:45,184  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,186  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:45,198  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:45,198  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:45,203  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:45,203 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:45,203  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:45,203  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a10e65b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@586a9fe1 will be shutdown
2024-04-24T02:16:45,204  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:45,204  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -12
2024-04-24T02:16:45,205  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:45,206  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:45,206  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:45,206  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b257072, with PersistenceManager: null will be shutdown
2024-04-24T02:16:45,206  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b257072, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b513ce8 created in the thread with id: 1
2024-04-24T02:16:45,225  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b257072 from thread id: 1
2024-04-24T02:16:45,225  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:45,226  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:45,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,232  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:45,233  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:45,233  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:45,234  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b257072, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b513ce8 will be shutdown
2024-04-24T02:16:45,234  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b257072, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@688884e created in the thread with id: 1
2024-04-24T02:16:45,236  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:45,237  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:45,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:45,241  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:45,241  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:45,243  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:45,247  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:45,247  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950205, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:45,253  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:45,286  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,309  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,482  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,532  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1, testhivemetastorechecker_table:part1=val_2/part2=val_2, testhivemetastorechecker_table:part1=val_3/part2=val_3, testhivemetastorechecker_table:part1=val_4/part2=val_4, testhivemetastorechecker_table:part1=val_5/part2=val_5, testhivemetastorechecker_table:part1=val_6/part2=val_6, testhivemetastorechecker_table:part1=val_7/part2=val_7, testhivemetastorechecker_table:part1=val_8/part2=val_8, testhivemetastorechecker_table:part1=val_9/part2=val_9], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:45,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,544  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:45,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:45,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,592  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:45,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:45,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:45,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,600  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:45,605  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:45,605  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:45,610  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:45,610 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:45,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:45,610  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@b257072, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@688884e will be shutdown
2024-04-24T02:16:45,611  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:45,611  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -13
2024-04-24T02:16:45,612  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:45,612  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:45,612  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:45,613  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20072ff1, with PersistenceManager: null will be shutdown
2024-04-24T02:16:45,613  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20072ff1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@38ed9fb2 created in the thread with id: 1
2024-04-24T02:16:45,615  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20072ff1 from thread id: 1
2024-04-24T02:16:45,615  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:45,616  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:45,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:45,622  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:45,622  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:45,623  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20072ff1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@38ed9fb2 will be shutdown
2024-04-24T02:16:45,623  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20072ff1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@388b9799 created in the thread with id: 1
2024-04-24T02:16:45,625  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:45,625  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:45,625  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:45,628  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:45,628  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:45,630  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:45,632  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:45,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950205, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-24T02:16:45,638  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:45,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,664  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,664  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,672  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-24T02:16:45,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,697  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-24T02:16:45,712  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,767  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,767  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,771  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,799  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,830  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:45,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,837  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:45,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:45,958  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:45,958  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:45,964  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:45,966  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,966  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:45,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:45,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:45,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:45,989  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:45,992  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:45,994  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:46,006  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:46,006  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:46,011  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:46,011 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,011  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:46,012  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20072ff1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@388b9799 will be shutdown
2024-04-24T02:16:46,012  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:46,012  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -14
2024-04-24T02:16:46,013  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:46,014  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:46,014  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:46,014  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@33c5d3e, with PersistenceManager: null will be shutdown
2024-04-24T02:16:46,015  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@33c5d3e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@376b6d7d created in the thread with id: 1
2024-04-24T02:16:46,028  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@33c5d3e from thread id: 1
2024-04-24T02:16:46,028  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:46,028  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:46,032  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,034  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:46,036  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:46,036  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:46,036  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@33c5d3e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@376b6d7d will be shutdown
2024-04-24T02:16:46,037  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@33c5d3e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b13e4fb created in the thread with id: 1
2024-04-24T02:16:46,039  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:46,039  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:46,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:46,043  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,043  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,046  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,049  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:46,050  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950206, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:46,056  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:46,088  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,114  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:46,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:46,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,336 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at java.util.concurrent.FutureTask.report(FutureTask.java:122) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.get(FutureTask.java:192) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testErrorForMissingPartitionColumn(TestHiveMetaStoreChecker.java:560) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-24T02:16:46,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,352  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:46,353  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,384 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at java.util.concurrent.FutureTask.report(FutureTask.java:122) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.get(FutureTask.java:192) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testErrorForMissingPartitionColumn(TestHiveMetaStoreChecker.java:568) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-24T02:16:46,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,393  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:46,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:46,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:46,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:46,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:46,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:46,445  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:46,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:46,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:46,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:46,450  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:46,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:46,453  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:46,458  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:46,458  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:46,463  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:46,463 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:46,463  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@33c5d3e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b13e4fb will be shutdown
2024-04-24T02:16:46,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:46,464  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -15
2024-04-24T02:16:46,465  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:46,465  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:46,465  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:46,466  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6adee80f, with PersistenceManager: null will be shutdown
2024-04-24T02:16:46,466  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6adee80f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2670435 created in the thread with id: 1
2024-04-24T02:16:46,468  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6adee80f from thread id: 1
2024-04-24T02:16:46,468  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:46,469  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:46,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:46,475  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:46,475  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:46,475  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6adee80f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2670435 will be shutdown
2024-04-24T02:16:46,476  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6adee80f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@795ef208 created in the thread with id: 1
2024-04-24T02:16:46,477  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:46,478  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:46,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:46,480  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,480  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,482  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,484  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:46,485  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950206, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:), FieldSchema(name:part3, type:string, comment:), FieldSchema(name:part4, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:46,490  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:46,504  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,513  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:46,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,720  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:46,721  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,801  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0/part3=val_0/part4=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1/part3=val_1/part4=val_1, testhivemetastorechecker_table:part1=val_2/part2=val_2/part3=val_2/part4=val_2, testhivemetastorechecker_table:part1=val_3/part2=val_3/part3=val_3/part4=val_3, testhivemetastorechecker_table:part1=val_4/part2=val_4/part3=val_4/part4=val_4, testhivemetastorechecker_table:part1=val_5/part2=val_5/part3=val_5/part4=val_5, testhivemetastorechecker_table:part1=val_6/part2=val_6/part3=val_6/part4=val_6, testhivemetastorechecker_table:part1=val_7/part2=val_7/part3=val_7/part4=val_7, testhivemetastorechecker_table:part1=val_8/part2=val_8/part3=val_8/part4=val_8, testhivemetastorechecker_table:part1=val_9/part2=val_9/part3=val_9/part4=val_9], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:46,801  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,811  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:46,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,849  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:46,850  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:46,850  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:46,853  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:46,855  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:46,855  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:46,856  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:46,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:46,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:46,860  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:46,861  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:46,863  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:46,867  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:46,867  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:46,871  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:46,871 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,872  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:46,872  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6adee80f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@795ef208 will be shutdown
2024-04-24T02:16:46,872  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:46,872  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -16
2024-04-24T02:16:46,873  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:46,874  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:46,874  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:46,875  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56313529, with PersistenceManager: null will be shutdown
2024-04-24T02:16:46,875  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56313529, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6be93728 created in the thread with id: 1
2024-04-24T02:16:46,877  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56313529 from thread id: 1
2024-04-24T02:16:46,877  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:46,878  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:46,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:46,885  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:46,886  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:46,886  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56313529, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6be93728 will be shutdown
2024-04-24T02:16:46,886  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56313529, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@70c741be created in the thread with id: 1
2024-04-24T02:16:46,888  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:46,888  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:46,888  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:46,890  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,891  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,893  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:46,895  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:46,897  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950206, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:46,902  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:46,921  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:46,931  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,104  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,134 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key part2 found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/part2=val_8
	at java.util.concurrent.FutureTask.report(FutureTask.java:122) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.get(FutureTask.java:192) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testInvalidOrderForPartitionKeysOnFS(TestHiveMetaStoreChecker.java:586) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.ExpectException.evaluate(ExpectException.java:19) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key part2 found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/part2=val_8
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-24T02:16:47,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,143  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,144  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,179  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:47,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,183  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:47,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,186  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,187  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:47,189  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:47,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:47,191  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,192  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:47,197  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:47,197  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:47,201  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:47,201 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:47,201  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56313529, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@70c741be will be shutdown
2024-04-24T02:16:47,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:47,202  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -17
2024-04-24T02:16:47,203  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:47,204  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:47,204  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:47,204  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f21c18f, with PersistenceManager: null will be shutdown
2024-04-24T02:16:47,205  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f21c18f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@54c3b0dd created in the thread with id: 1
2024-04-24T02:16:47,206  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f21c18f from thread id: 1
2024-04-24T02:16:47,206  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:47,207  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:47,211  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:47,213  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:47,213  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:47,214  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f21c18f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@54c3b0dd will be shutdown
2024-04-24T02:16:47,214  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f21c18f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4d8af13c created in the thread with id: 1
2024-04-24T02:16:47,216  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:47,216  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:47,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:47,218  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,219  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,221  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,223  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:47,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950207, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-24T02:16:47,229  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:47,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,251  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,271  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,277  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,290  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:47,291  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,298  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,298  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,333  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:47,333  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:47,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:47,339  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,339  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:47,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:47,349  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:47,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:47,352  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,354  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:47,359  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:47,359  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:47,363  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:47,363 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:47,363  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f21c18f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4d8af13c will be shutdown
2024-04-24T02:16:47,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:47,364  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -18
2024-04-24T02:16:47,365  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:47,365  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:47,366  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:47,366  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c057419, with PersistenceManager: null will be shutdown
2024-04-24T02:16:47,366  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c057419, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4e4d6172 created in the thread with id: 1
2024-04-24T02:16:47,368  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c057419 from thread id: 1
2024-04-24T02:16:47,368  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:47,369  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:47,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,374  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:47,375  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:47,376  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:47,376  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c057419, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4e4d6172 will be shutdown
2024-04-24T02:16:47,376  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c057419, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1828069a created in the thread with id: 1
2024-04-24T02:16:47,378  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:47,378  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:47,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:47,380  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,380  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,383  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,385  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:47,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950207, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:47,390  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:47,405  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,414  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,594  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,594  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,626 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at com.google.common.util.concurrent.AbstractFuture.getDoneValue(AbstractFuture.java:476) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractFuture.get(AbstractFuture.java:435) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractFuture$TrustedFuture.get(AbstractFuture.java:79) ~[guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testErrorForMissingPartitionsSingleThreaded(TestHiveMetaStoreChecker.java:630) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.MoreExecutors$DirectExecutorService.execute(MoreExecutors.java:310) ~[guava-19.0.jar:?]
	at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:134) ~[?:1.8.0_402]
	at com.google.common.util.concurrent.AbstractListeningExecutorService.submit(AbstractListeningExecutorService.java:61) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractListeningExecutorService.submit(AbstractListeningExecutorService.java:38) ~[guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:668) ~[classes/:?]
	... 54 more
2024-04-24T02:16:47,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,646  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,677 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at com.google.common.util.concurrent.AbstractFuture.getDoneValue(AbstractFuture.java:476) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractFuture.get(AbstractFuture.java:435) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractFuture$TrustedFuture.get(AbstractFuture.java:79) ~[guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testErrorForMissingPartitionsSingleThreaded(TestHiveMetaStoreChecker.java:638) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.MoreExecutors$DirectExecutorService.execute(MoreExecutors.java:310) ~[guava-19.0.jar:?]
	at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:134) ~[?:1.8.0_402]
	at com.google.common.util.concurrent.AbstractListeningExecutorService.submit(AbstractListeningExecutorService.java:61) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractListeningExecutorService.submit(AbstractListeningExecutorService.java:38) ~[guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:668) ~[classes/:?]
	... 54 more
2024-04-24T02:16:47,677  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,686  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,722  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:47,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:47,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,730  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:47,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:47,733  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:47,734  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:47,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:47,737  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:47,746  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:47,746  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:47,750  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:47,750 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:47,751  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c057419, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1828069a will be shutdown
2024-04-24T02:16:47,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:47,751  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -19
2024-04-24T02:16:47,752  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:47,753  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:47,753  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:47,753  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29701f1f, with PersistenceManager: null will be shutdown
2024-04-24T02:16:47,753  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29701f1f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3a273e53 created in the thread with id: 1
2024-04-24T02:16:47,755  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29701f1f from thread id: 1
2024-04-24T02:16:47,755  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:47,756  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:47,759  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:47,762  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:47,762  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:47,763  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29701f1f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3a273e53 will be shutdown
2024-04-24T02:16:47,763  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29701f1f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@639f6a0d created in the thread with id: 1
2024-04-24T02:16:47,766  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:47,766  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:47,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:47,768  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,768  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,771  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:47,772  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:47,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950207, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:47,778  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:47,792  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,801  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,811  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-24T02:16:47,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,840  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-24T02:16:47,855  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,886  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,894  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,899  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,924  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,944  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:47,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:47,953  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:47,953  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:48,065  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:48,067  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:48,067  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:48,072  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:48,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:48,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:48,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:48,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:48,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:48,083  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:48,086  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:48,088  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:48,103  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:48,103  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:48,107  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:48,107 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:48,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:48,107  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29701f1f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@639f6a0d will be shutdown
2024-04-24T02:16:48,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:48,107  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -20
2024-04-24T02:16:48,108  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:48,109  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:16:48,109  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:48,109  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a5e1a3a, with PersistenceManager: null will be shutdown
2024-04-24T02:16:48,109  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a5e1a3a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@dd3586e created in the thread with id: 1
2024-04-24T02:16:48,124  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a5e1a3a from thread id: 1
2024-04-24T02:16:48,124  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:48,125  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:16:48,128  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:48,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:48,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-24T02:16:48,137 ERROR [main] metastore.RetryingHMSHandler: UnknownDBException(message:Could not find database hive.testhivemetastorechecker_db: database hive.testhivemetastorechecker_db)
	at org.apache.hadoop.hive.metastore.ObjectStore.getTableObjectsByName(ObjectStore.java:2171)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy41.getTableObjectsByName(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.getTableObjectsInternal(HMSHandler.java:3825)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_table_objects_by_name_req(HMSHandler.java:3758)
	at sun.reflect.GeneratedMethodAccessor42.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy44.get_table_objects_by_name_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getTables(HiveMetaStoreClient.java:2724)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:143)
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testTableCheck(TestHiveMetaStoreChecker.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:16:48,137  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:48,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:48,139  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[testhivemetastorechecker_table], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:48,139  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-24T02:16:48,142  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:48,142  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:48,144  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:48,147  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=edd863e8-2c59-4e08-906c-11d9023e9be0, clientType=HIVECLI]
2024-04-24T02:16:48,148  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:16:48,148  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:16:48,148  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a5e1a3a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@dd3586e will be shutdown
2024-04-24T02:16:48,149  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a5e1a3a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4b91ac30 created in the thread with id: 1
2024-04-24T02:16:48,151  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:16:48,151  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:16:48,151  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713950208, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-24T02:16:48,155  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-24T02:16:48,180  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-24T02:16:48,183  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:48,184  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:48,213  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:48,216  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:48,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:48,225  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:48,225  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[testhivemetastorechecker_table], expiredPartitions=[]
2024-04-24T02:16:48,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-24T02:16:48,237  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-24T02:16:48,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:48,245  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:16:48,245  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-24T02:16:48,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-24T02:16:48,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:48,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:48,288  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:48,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-24T02:16:48,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-24T02:16:48,291  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-24T02:16:48,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-24T02:16:48,294  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-24T02:16:48,295  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-24T02:16:48,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-24T02:16:48,298  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-24T02:16:48,309  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-24T02:16:48,309  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-24T02:16:48,314  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-24T02:16:48,314 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-24T02:16:48,314  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:16:48,314  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a5e1a3a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4b91ac30 will be shutdown
2024-04-24T02:16:48,314  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:16:48,314  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -21
