<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.hadoop.hive.ql.TestTxnCommands" time="244.189" tests="49" errors="18" skipped="2" failures="0">
  <properties>
    <property name="build.test.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="test.tmp.dir.uri" value="file:///home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="qfile" value=""/>
    <property name="test.warehouse.dir" value="pfile:///home/alex/Repositories/hive/ql/target/warehouse"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="run_disabled" value=""/>
    <property name="nondexPrintstack" value="false"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="http://java.oracle.com/"/>
    <property name="user.country.format" value="PT"/>
    <property name="test.tmp.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/alex/Repositories/hive/ql/target/surefire/surefirebooter7888034650970064230.jar /home/alex/Repositories/hive/ql/target/surefire 2024-04-23T21-59-46_173-jvmRun1 surefire709516198637382181tmp surefire_25754587711829231517991tmp"/>
    <property name="nondexExecid" value="oUi5h03YaAsr1zYbyWcL7OlHtDlCKFQ0UmQw8pMP1CI="/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/java-8-openjdk-amd64/jre"/>
    <property name="basedir" value="/home/alex/Repositories/hive/ql"/>
    <property name="file.separator" value="/"/>
    <property name="line.separator" value="&#10;"/>
    <property name="nondexEnd" value="9223372036854775807"/>
    <property name="derby.stream.error.file" value="/home/alex/Repositories/hive/ql/target/tmp/derby.log"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="log4j.debug" value="true"/>
    <property name="sun.boot.class.path" value="/home/alex/Repositories/hive/ql/.nondex/nondex-instr.jar:/home/alex/.m2/repository/edu/illinois/nondex-common/2.1.7/nondex-common-2.1.7.jar:/home/alex/.m2/repository/edu/illinois/nondex-annotations/2.1.7/nondex-annotations-2.1.7.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="spark.home" value=""/>
    <property name="java.runtime.version" value="1.8.0_402-8u402-ga-2ubuntu1~22.04-b06"/>
    <property name="user.name" value="alex"/>
    <property name="test.src.tables" value=""/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="qfile_regex" value=""/>
    <property name="hadoop.bin.path" value="/home/alex/Repositories/hive/ql/../testutils/hadoop"/>
    <property name="localRepository" value="/home/alex/.m2/repository"/>
    <property name="build.dir" value="/home/alex/Repositories/hive/ql/target"/>
    <property name="nondexDir" value="/home/alex/Repositories/hive/ql/.nondex"/>
    <property name="mapred.job.tracker" value="local"/>
    <property name="nondexJarDir" value="/home/alex/Repositories/hive/ql/.nondex"/>
    <property name="java.io.tmpdir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="com.zaxxer.hikari.pool_number" value="3"/>
    <property name="java.version" value="1.8.0_402"/>
    <property name="hive.version" value="4.0.0-SNAPSHOT"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib"/>
    <property name="test.data.dir" value="/home/alex/Repositories/hive/ql/../data/files"/>
    <property name="java.vendor" value="Private Build"/>
    <property name="java.specification.maintenance.version" value="5"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="initScript" value=""/>
    <property name="sun.desktop" value="gnome"/>
    <property name="calcite.enable.rexnode.digest.normalize" value="false"/>
    <property name="nondexStart" value="0"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="log4j.configurationFile" value="file:///home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties"/>
    <property name="java.class.path" value="/home/alex/Repositories/hive/ql/target/test-classes:/home/alex/Repositories/hive/ql/target/classes:/home/alex/.m2/repository/org/apache/atlas/atlas-client-v2/2.1.0/atlas-client-v2-2.1.0.jar:/home/alex/.m2/repository/cglib/cglib/2.2.2/cglib-2.2.2.jar:/home/alex/.m2/repository/asm/asm/3.3.1/asm-3.3.1.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-client-common/2.1.0/atlas-client-common-2.1.0.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-intg/2.1.0/atlas-intg-2.1.0.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/alex/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/org/springframework/spring-context/4.3.20.RELEASE/spring-context-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-aop/4.3.20.RELEASE/spring-aop-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-beans/4.3.20.RELEASE/spring-beans-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-core/4.3.20.RELEASE/spring-core-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-expression/4.3.20.RELEASE/spring-expression-4.3.20.RELEASE.jar:/home/alex/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/alex/Repositories/hive/vector-code-gen/target/classes:/home/alex/.m2/repository/org/apache/velocity/velocity/1.5/velocity-1.5.jar:/home/alex/Repositories/hive/common/target/classes:/home/alex/Repositories/hive/classification/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/commons-cli/commons-cli/1.4/commons-cli-1.4.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.27.v20190418/jetty-http-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-rewrite/9.3.27.v20190418/jetty-rewrite-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-client/9.3.27.v20190418/jetty-client-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.27.v20190418/jetty-server-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.27.v20190418/jetty-io-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.27.v20190418/jetty-servlet-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.27.v20190418/jetty-security-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.27.v20190418/jetty-webapp-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.27.v20190418/jetty-xml-9.3.27.v20190418.jar:/home/alex/.m2/repository/joda-time/joda-time/2.9.9/joda-time-2.9.9.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-web/2.13.2/log4j-web-2.13.2.jar:/home/alex/.m2/repository/net/sf/jpam/jpam/1.1/jpam-1.1.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/Repositories/hive/metastore/target/classes:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/Repositories/hive/serde/target/classes:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-vector/0.15.1/arrow-vector-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-format/0.15.1/arrow-format-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-memory/0.15.1/arrow-memory-0.15.1.jar:/home/alex/.m2/repository/com/google/flatbuffers/flatbuffers-java/1.9.0/flatbuffers-java-1.9.0.jar:/home/alex/.m2/repository/com/carrotsearch/hppc/0.7.2/hppc-0.7.2.jar:/home/alex/.m2/repository/com/github/davidmoten/flatbuffers-java/1.6.0.1/flatbuffers-java-1.6.0.1.jar:/home/alex/Repositories/hive/parser/target/classes:/home/alex/Repositories/hive/udf/target/classes:/home/alex/Repositories/hive/service-rpc/target/classes:/home/alex/Repositories/hive/llap-client/target/classes:/home/alex/Repositories/hive/llap-common/target/classes:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-api/0.10.5/jjwt-api-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-impl/0.10.5/jjwt-impl-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.10.5/jjwt-jackson-0.10.5.jar:/home/alex/Repositories/hive/llap-tez/target/classes:/home/alex/Repositories/hive/shims/aggregator/target/classes:/home/alex/Repositories/hive/shims/common/target/classes:/home/alex/Repositories/hive/shims/0.23/target/classes:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-resourcemanager/3.1.0/hadoop-yarn-server-resourcemanager-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-applicationhistoryservice/3.1.0/hadoop-yarn-server-applicationhistoryservice-3.1.0.jar:/home/alex/.m2/repository/de/ruedigermoeller/fst/2.50/fst-2.50.jar:/home/alex/.m2/repository/com/cedarsoftware/java-util/1.9.0/java-util-1.9.0.jar:/home/alex/.m2/repository/com/cedarsoftware/json-io/2.5.1/json-io-2.5.1.jar:/home/alex/Repositories/hive/shims/scheduler/target/classes:/home/alex/Repositories/hive/spark-client/target/classes:/home/alex/.m2/repository/io/netty/netty-all/4.1.65.Final/netty-all-4.1.65.Final.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-scala_2.12/2.12.0/jackson-module-scala_2.12-2.12.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-yarn_2.12/2.4.5/spark-yarn_2.12-2.4.5.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/com/amazonaws/aws-java-sdk-bundle/1.11.901/aws-java-sdk-bundle-1.11.901.jar:/home/alex/.m2/repository/com/amazonaws/secretsmanager/aws-secretsmanager-caching-java/1.0.1/aws-secretsmanager-caching-java-1.0.1.jar:/home/alex/.m2/repository/com/esotericsoftware/kryo/5.0.3/kryo-5.0.3.jar:/home/alex/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/minlog/1.3.1/minlog-1.3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/reflectasm/1.11.9/reflectasm-1.11.9.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/alex/.m2/repository/org/apache/hbase/hbase-common/2.0.0-alpha4/hbase-common-2.0.0-alpha4.jar:/home/alex/.m2/repository/org/apache/hbase/thirdparty/hbase-shaded-miscellaneous/1.0.1/hbase-shaded-miscellaneous-1.0.1.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core/3.2.0-incubating/htrace-core-3.2.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-crypto/1.0.0/commons-crypto-1.0.0.jar:/home/alex/.m2/repository/com/github/stephenc/findbugs/findbugs-annotations/1.3.9-1/findbugs-annotations-1.3.9-1.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-hadoop-bundle/1.11.1/parquet-hadoop-bundle-1.11.1.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/alex/.m2/repository/commons-io/commons-io/2.6/commons-io-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-collections4/4.1/commons-collections4-4.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/commons/commons-text/1.8/commons-text-1.8.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.8.2/avro-1.8.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.8/paranamer-2.8.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.1.4/snappy-java-1.1.4.jar:/home/alex/.m2/repository/org/tukaani/xz/1.5/xz-1.5.jar:/home/alex/.m2/repository/org/apache/avro/avro-mapred/1.8.2/avro-mapred-1.8.2-hadoop2.jar:/home/alex/.m2/repository/org/apache/avro/avro-ipc/1.8.2/avro-ipc-1.8.2.jar:/home/alex/.m2/repository/org/mortbay/jetty/jetty/6.1.26/jetty-6.1.26.jar:/home/alex/.m2/repository/org/apache/ant/ant/1.9.1/ant-1.9.1.jar:/home/alex/.m2/repository/org/apache/ant/ant-launcher/1.9.1/ant-launcher-1.9.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.27.v20190418/jetty-util-9.3.27.v20190418.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-archives/3.1.0/hadoop-archives-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-registry/3.1.0/hadoop-yarn-registry-3.1.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-common/3.1.0/hadoop-mapreduce-client-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/orc/orc-tools/1.6.9/orc-tools-1.6.9.jar:/home/alex/.m2/repository/com/opencsv/opencsv/3.9/opencsv-3.9.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/org/threeten/threetenbp/1.3.5/threetenbp-1.3.5.jar:/home/alex/.m2/repository/org/apache/ivy/ivy/2.4.0/ivy-2.4.0.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.13/httpcore-4.4.13.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-hive/1.1.0-incubating/datasketches-hive-1.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-java/1.3.0-incubating/datasketches-java-1.3.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-memory/1.2.0-incubating/datasketches-memory-1.2.0-incubating.jar:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar:/home/alex/.m2/repository/com/lmax/disruptor/3.3.7/disruptor-3.3.7.jar:/home/alex/.m2/repository/org/codehaus/groovy/groovy-all/2.4.11/groovy-all-2.4.11.jar:/home/alex/.m2/repository/org/jodd/jodd-util/6.0.0/jodd-util-6.0.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.12.0/jackson-dataformat-yaml-2.12.0.jar:/home/alex/.m2/repository/org/yaml/snakeyaml/1.27/snakeyaml-1.27.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-core/1.25.0/calcite-core-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-linq4j/1.25.0/calcite-linq4j-1.25.0.jar:/home/alex/.m2/repository/org/apiguardian/apiguardian-api/1.1.0/apiguardian-api-1.1.0.jar:/home/alex/.m2/repository/com/esri/geometry/esri-geometry-api/2.2.0/esri-geometry-api-2.2.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/sketches-core/0.9.0/sketches-core-0.9.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/memory/0.9.0/memory-0.9.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-druid/1.25.0/calcite-druid-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/avatica/avatica/1.12.0/avatica-1.12.0.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/googlecode/javaewah/JavaEWAH/0.3.2/JavaEWAH-0.3.2.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/com/tdunning/json/1.8/json-1.8.jar:/home/alex/.m2/repository/stax/stax-api/1.0.1/stax-api-1.0.1.jar:/home/alex/.m2/repository/net/sf/opencsv/opencsv/2.3/opencsv-2.3.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/Repositories/hive/common/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/test-classes:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/.m2/repository/org/apache/parquet/parquet-column/1.11.1/parquet-column-1.11.1-tests.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-common/1.11.1/parquet-common-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-format-structures/1.11.1/parquet-format-structures-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-encoding/1.11.1/parquet-encoding-1.11.1.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.6.2/junit-jupiter-engine-5.6.2.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-engine/1.6.2/junit-platform-engine-1.6.2.jar:/home/alex/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-commons/1.6.2/junit-platform-commons-1.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.6.2/junit-jupiter-api-5.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.6.2/junit-jupiter-params-5.6.2.jar:/home/alex/.m2/repository/org/junit/vintage/junit-vintage-engine/5.6.2/junit-vintage-engine-5.6.2.jar:/home/alex/.m2/repository/org/apache/tez/tez-api/0.10.1/tez-api-0.10.1.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-library/0.10.1/tez-runtime-library-0.10.1.jar:/home/alex/.m2/repository/org/roaringbitmap/RoaringBitmap/0.5.21/RoaringBitmap-0.5.21.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/alex/.m2/repository/io/netty/netty-buffer/4.1.48.Final/netty-buffer-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-http/4.1.48.Final/netty-codec-http-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-common/4.1.48.Final/netty-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport/4.1.48.Final/netty-transport-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec/4.1.48.Final/netty-codec-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler/4.1.48.Final/netty-handler-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-resolver/4.1.48.Final/netty-resolver-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-socks/4.1.48.Final/netty-codec-socks-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler-proxy/4.1.48.Final/netty-handler-proxy-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-epoll/4.1.48.Final/netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.48.Final/netty-transport-native-unix-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-kqueue/4.1.48.Final/netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/alex/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/alex/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.4/netty-reactive-streams-2.0.4.jar:/home/alex/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/alex/.m2/repository/org/apache/tez/tez-common/0.10.1/tez-common-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-internals/0.10.1/tez-runtime-internals-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/hadoop-shim/0.10.1/hadoop-shim-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-mapreduce/0.10.1/tez-mapreduce-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-dag/0.10.1/tez-dag-0.10.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-web-proxy/3.1.0/hadoop-yarn-server-web-proxy-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-common/3.1.0/hadoop-yarn-server-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/geronimo/specs/geronimo-jcache_1.0_spec/1.0-alpha-1/geronimo-jcache_1.0_spec-1.0-alpha-1.jar:/home/alex/.m2/repository/org/ehcache/ehcache/3.3.1/ehcache-3.3.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP-java7/2.4.12/HikariCP-java7-2.4.12.jar:/home/alex/.m2/repository/org/apache/spark/spark-core_2.12/2.4.5/spark-core_2.12-2.4.5.jar:/home/alex/.m2/repository/com/twitter/chill_2.12/0.9.3/chill_2.12-0.9.3.jar:/home/alex/.m2/repository/com/twitter/chill-java/0.9.3/chill-java-0.9.3.jar:/home/alex/.m2/repository/org/apache/xbean/xbean-asm6-shaded/4.8/xbean-asm6-shaded-4.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-client/3.1.0/hadoop-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-jobclient/3.1.0/hadoop-mapreduce-client-jobclient-3.1.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-launcher_2.12/2.4.5/spark-launcher_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-kvstore_2.12/2.4.5/spark-kvstore_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-common_2.12/2.4.5/spark-network-common_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-shuffle_2.12/2.4.5/spark-network-shuffle_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-unsafe_2.12/2.4.5/spark-unsafe_2.12-2.4.5.jar:/home/alex/.m2/repository/javax/activation/activation/1.1.1/activation-1.1.1.jar:/home/alex/.m2/repository/org/slf4j/jul-to-slf4j/1.7.16/jul-to-slf4j-1.7.16.jar:/home/alex/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.16/jcl-over-slf4j-1.7.16.jar:/home/alex/.m2/repository/com/ning/compress-lzf/1.0.3/compress-lzf-1.0.3.jar:/home/alex/.m2/repository/org/lz4/lz4-java/1.4.0/lz4-java-1.4.0.jar:/home/alex/.m2/repository/com/github/luben/zstd-jni/1.3.2-2/zstd-jni-1.3.2-2.jar:/home/alex/.m2/repository/org/scala-lang/scala-library/2.12.10/scala-library-2.12.10.jar:/home/alex/.m2/repository/org/json4s/json4s-jackson_2.12/3.5.3/json4s-jackson_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-core_2.12/3.5.3/json4s-core_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-ast_2.12/3.5.3/json4s-ast_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-scalap_2.12/3.5.3/json4s-scalap_2.12-3.5.3.jar:/home/alex/.m2/repository/org/scala-lang/modules/scala-xml_2.12/1.0.6/scala-xml_2.12-1.0.6.jar:/home/alex/.m2/repository/com/clearspring/analytics/stream/2.7.0/stream-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-graphite/3.1.5/metrics-graphite-3.1.5.jar:/home/alex/.m2/repository/oro/oro/2.0.8/oro-2.0.8.jar:/home/alex/.m2/repository/net/razorvine/pyrolite/4.13/pyrolite-4.13.jar:/home/alex/.m2/repository/net/sf/py4j/py4j/0.10.7/py4j-0.10.7.jar:/home/alex/.m2/repository/org/apache/spark/spark-tags_2.12/2.4.5/spark-tags_2.12-2.4.5.jar:/home/alex/.m2/repository/org/spark-project/spark/unused/1.0.0/unused-1.0.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-server/2.22.2/jersey-server-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-common/2.22.2/jersey-common-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/bundles/repackaged/jersey-guava/2.22.2/jersey-guava-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.1/osgi-resource-locator-1.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-client/2.22.2/jersey-client-2.22.2.jar:/home/alex/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.22.2/jersey-media-jaxb-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-api/2.4.0-b34/hk2-api-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-utils/2.4.0-b34/hk2-utils-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.4.0-b34/aopalliance-repackaged-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/javax.inject/2.4.0-b34/javax.inject-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-locator/2.4.0-b34/hk2-locator-2.4.0-b34.jar:/home/alex/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/alex/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.22.2/jersey-container-servlet-core-2.22.2.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4/2.0.2/powermock-module-junit4-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4-common/2.0.2/powermock-module-junit4-common-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-reflect/2.0.2/powermock-reflect-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-core/2.0.2/powermock-core-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-mockito2/2.0.2/powermock-api-mockito2-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-support/2.0.2/powermock-api-support-2.0.2.jar:/home/alex/.m2/repository/com/google/guava/guava-testlib/19.0/guava-testlib-19.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.0.2/error_prone_annotations-2.0.2.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.2/re2j-1.2.jar:/home/alex/.m2/repository/org/reflections/reflections/0.9.10/reflections-0.9.10.jar:/home/alex/.m2/repository/org/javassist/javassist/3.19.0-GA/javassist-3.19.0-GA.jar:/home/alex/.m2/repository/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/org/codehaus/janino/commons-compiler/3.0.11/commons-compiler-3.0.11.jar:/home/alex/.m2/repository/org/codehaus/janino/janino/3.0.11/janino-3.0.11.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-multipart/1.19/jersey-multipart-1.19.jar:/home/alex/.m2/repository/org/jvnet/mimepull/mimepull/1.9.3/mimepull-1.9.3.jar:/home/alex/.m2/repository/org/apache/kafka/kafka-clients/2.5.0/kafka-clients-2.5.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.4.4/mockito-core-3.4.4.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.13/byte-buddy-1.10.13.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.13/byte-buddy-agent-1.10.13.jar:/home/alex/Repositories/hive/ql/target/testconf:/home/alex/Repositories/hive/ql/../conf:"/>
    <property name="java.vm.vendor" value="Private Build"/>
    <property name="hadoop.version" value="3.1.0"/>
    <property name="user.timezone" value="US/Pacific"/>
    <property name="test.local.warehouse.dir" value="pfile:///home/alex/Repositories/hive/ql/target/localfs/warehouse"/>
    <property name="os.name" value="Linux"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="clustermode" value=""/>
    <property name="test.build.data" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="user.country" value="US"/>
    <property name="test.data.files" value="/home/alex/Repositories/hive/ql/../data/files"/>
    <property name="nondexLogging" value="CONFIG"/>
    <property name="surefire.test.class.path" value="/home/alex/Repositories/hive/ql/target/test-classes:/home/alex/Repositories/hive/ql/target/classes:/home/alex/.m2/repository/org/apache/atlas/atlas-client-v2/2.1.0/atlas-client-v2-2.1.0.jar:/home/alex/.m2/repository/cglib/cglib/2.2.2/cglib-2.2.2.jar:/home/alex/.m2/repository/asm/asm/3.3.1/asm-3.3.1.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-client-common/2.1.0/atlas-client-common-2.1.0.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-intg/2.1.0/atlas-intg-2.1.0.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/alex/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/org/springframework/spring-context/4.3.20.RELEASE/spring-context-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-aop/4.3.20.RELEASE/spring-aop-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-beans/4.3.20.RELEASE/spring-beans-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-core/4.3.20.RELEASE/spring-core-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-expression/4.3.20.RELEASE/spring-expression-4.3.20.RELEASE.jar:/home/alex/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/alex/Repositories/hive/vector-code-gen/target/classes:/home/alex/.m2/repository/org/apache/velocity/velocity/1.5/velocity-1.5.jar:/home/alex/Repositories/hive/common/target/classes:/home/alex/Repositories/hive/classification/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/commons-cli/commons-cli/1.4/commons-cli-1.4.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.27.v20190418/jetty-http-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-rewrite/9.3.27.v20190418/jetty-rewrite-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-client/9.3.27.v20190418/jetty-client-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.27.v20190418/jetty-server-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.27.v20190418/jetty-io-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.27.v20190418/jetty-servlet-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.27.v20190418/jetty-security-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.27.v20190418/jetty-webapp-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.27.v20190418/jetty-xml-9.3.27.v20190418.jar:/home/alex/.m2/repository/joda-time/joda-time/2.9.9/joda-time-2.9.9.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-web/2.13.2/log4j-web-2.13.2.jar:/home/alex/.m2/repository/net/sf/jpam/jpam/1.1/jpam-1.1.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/Repositories/hive/metastore/target/classes:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/Repositories/hive/serde/target/classes:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-vector/0.15.1/arrow-vector-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-format/0.15.1/arrow-format-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-memory/0.15.1/arrow-memory-0.15.1.jar:/home/alex/.m2/repository/com/google/flatbuffers/flatbuffers-java/1.9.0/flatbuffers-java-1.9.0.jar:/home/alex/.m2/repository/com/carrotsearch/hppc/0.7.2/hppc-0.7.2.jar:/home/alex/.m2/repository/com/github/davidmoten/flatbuffers-java/1.6.0.1/flatbuffers-java-1.6.0.1.jar:/home/alex/Repositories/hive/parser/target/classes:/home/alex/Repositories/hive/udf/target/classes:/home/alex/Repositories/hive/service-rpc/target/classes:/home/alex/Repositories/hive/llap-client/target/classes:/home/alex/Repositories/hive/llap-common/target/classes:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-api/0.10.5/jjwt-api-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-impl/0.10.5/jjwt-impl-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.10.5/jjwt-jackson-0.10.5.jar:/home/alex/Repositories/hive/llap-tez/target/classes:/home/alex/Repositories/hive/shims/aggregator/target/classes:/home/alex/Repositories/hive/shims/common/target/classes:/home/alex/Repositories/hive/shims/0.23/target/classes:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-resourcemanager/3.1.0/hadoop-yarn-server-resourcemanager-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-applicationhistoryservice/3.1.0/hadoop-yarn-server-applicationhistoryservice-3.1.0.jar:/home/alex/.m2/repository/de/ruedigermoeller/fst/2.50/fst-2.50.jar:/home/alex/.m2/repository/com/cedarsoftware/java-util/1.9.0/java-util-1.9.0.jar:/home/alex/.m2/repository/com/cedarsoftware/json-io/2.5.1/json-io-2.5.1.jar:/home/alex/Repositories/hive/shims/scheduler/target/classes:/home/alex/Repositories/hive/spark-client/target/classes:/home/alex/.m2/repository/io/netty/netty-all/4.1.65.Final/netty-all-4.1.65.Final.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-scala_2.12/2.12.0/jackson-module-scala_2.12-2.12.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-yarn_2.12/2.4.5/spark-yarn_2.12-2.4.5.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/com/amazonaws/aws-java-sdk-bundle/1.11.901/aws-java-sdk-bundle-1.11.901.jar:/home/alex/.m2/repository/com/amazonaws/secretsmanager/aws-secretsmanager-caching-java/1.0.1/aws-secretsmanager-caching-java-1.0.1.jar:/home/alex/.m2/repository/com/esotericsoftware/kryo/5.0.3/kryo-5.0.3.jar:/home/alex/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/minlog/1.3.1/minlog-1.3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/reflectasm/1.11.9/reflectasm-1.11.9.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/alex/.m2/repository/org/apache/hbase/hbase-common/2.0.0-alpha4/hbase-common-2.0.0-alpha4.jar:/home/alex/.m2/repository/org/apache/hbase/thirdparty/hbase-shaded-miscellaneous/1.0.1/hbase-shaded-miscellaneous-1.0.1.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core/3.2.0-incubating/htrace-core-3.2.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-crypto/1.0.0/commons-crypto-1.0.0.jar:/home/alex/.m2/repository/com/github/stephenc/findbugs/findbugs-annotations/1.3.9-1/findbugs-annotations-1.3.9-1.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-hadoop-bundle/1.11.1/parquet-hadoop-bundle-1.11.1.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/alex/.m2/repository/commons-io/commons-io/2.6/commons-io-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-collections4/4.1/commons-collections4-4.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/commons/commons-text/1.8/commons-text-1.8.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.8.2/avro-1.8.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.8/paranamer-2.8.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.1.4/snappy-java-1.1.4.jar:/home/alex/.m2/repository/org/tukaani/xz/1.5/xz-1.5.jar:/home/alex/.m2/repository/org/apache/avro/avro-mapred/1.8.2/avro-mapred-1.8.2-hadoop2.jar:/home/alex/.m2/repository/org/apache/avro/avro-ipc/1.8.2/avro-ipc-1.8.2.jar:/home/alex/.m2/repository/org/mortbay/jetty/jetty/6.1.26/jetty-6.1.26.jar:/home/alex/.m2/repository/org/apache/ant/ant/1.9.1/ant-1.9.1.jar:/home/alex/.m2/repository/org/apache/ant/ant-launcher/1.9.1/ant-launcher-1.9.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.27.v20190418/jetty-util-9.3.27.v20190418.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-archives/3.1.0/hadoop-archives-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-registry/3.1.0/hadoop-yarn-registry-3.1.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-common/3.1.0/hadoop-mapreduce-client-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/orc/orc-tools/1.6.9/orc-tools-1.6.9.jar:/home/alex/.m2/repository/com/opencsv/opencsv/3.9/opencsv-3.9.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/org/threeten/threetenbp/1.3.5/threetenbp-1.3.5.jar:/home/alex/.m2/repository/org/apache/ivy/ivy/2.4.0/ivy-2.4.0.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.13/httpcore-4.4.13.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-hive/1.1.0-incubating/datasketches-hive-1.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-java/1.3.0-incubating/datasketches-java-1.3.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-memory/1.2.0-incubating/datasketches-memory-1.2.0-incubating.jar:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar:/home/alex/.m2/repository/com/lmax/disruptor/3.3.7/disruptor-3.3.7.jar:/home/alex/.m2/repository/org/codehaus/groovy/groovy-all/2.4.11/groovy-all-2.4.11.jar:/home/alex/.m2/repository/org/jodd/jodd-util/6.0.0/jodd-util-6.0.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.12.0/jackson-dataformat-yaml-2.12.0.jar:/home/alex/.m2/repository/org/yaml/snakeyaml/1.27/snakeyaml-1.27.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-core/1.25.0/calcite-core-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-linq4j/1.25.0/calcite-linq4j-1.25.0.jar:/home/alex/.m2/repository/org/apiguardian/apiguardian-api/1.1.0/apiguardian-api-1.1.0.jar:/home/alex/.m2/repository/com/esri/geometry/esri-geometry-api/2.2.0/esri-geometry-api-2.2.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/sketches-core/0.9.0/sketches-core-0.9.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/memory/0.9.0/memory-0.9.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-druid/1.25.0/calcite-druid-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/avatica/avatica/1.12.0/avatica-1.12.0.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/googlecode/javaewah/JavaEWAH/0.3.2/JavaEWAH-0.3.2.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/com/tdunning/json/1.8/json-1.8.jar:/home/alex/.m2/repository/stax/stax-api/1.0.1/stax-api-1.0.1.jar:/home/alex/.m2/repository/net/sf/opencsv/opencsv/2.3/opencsv-2.3.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/Repositories/hive/common/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/test-classes:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/.m2/repository/org/apache/parquet/parquet-column/1.11.1/parquet-column-1.11.1-tests.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-common/1.11.1/parquet-common-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-format-structures/1.11.1/parquet-format-structures-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-encoding/1.11.1/parquet-encoding-1.11.1.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.6.2/junit-jupiter-engine-5.6.2.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-engine/1.6.2/junit-platform-engine-1.6.2.jar:/home/alex/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-commons/1.6.2/junit-platform-commons-1.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.6.2/junit-jupiter-api-5.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.6.2/junit-jupiter-params-5.6.2.jar:/home/alex/.m2/repository/org/junit/vintage/junit-vintage-engine/5.6.2/junit-vintage-engine-5.6.2.jar:/home/alex/.m2/repository/org/apache/tez/tez-api/0.10.1/tez-api-0.10.1.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-library/0.10.1/tez-runtime-library-0.10.1.jar:/home/alex/.m2/repository/org/roaringbitmap/RoaringBitmap/0.5.21/RoaringBitmap-0.5.21.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/alex/.m2/repository/io/netty/netty-buffer/4.1.48.Final/netty-buffer-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-http/4.1.48.Final/netty-codec-http-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-common/4.1.48.Final/netty-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport/4.1.48.Final/netty-transport-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec/4.1.48.Final/netty-codec-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler/4.1.48.Final/netty-handler-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-resolver/4.1.48.Final/netty-resolver-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-socks/4.1.48.Final/netty-codec-socks-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler-proxy/4.1.48.Final/netty-handler-proxy-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-epoll/4.1.48.Final/netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.48.Final/netty-transport-native-unix-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-kqueue/4.1.48.Final/netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/alex/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/alex/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.4/netty-reactive-streams-2.0.4.jar:/home/alex/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/alex/.m2/repository/org/apache/tez/tez-common/0.10.1/tez-common-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-internals/0.10.1/tez-runtime-internals-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/hadoop-shim/0.10.1/hadoop-shim-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-mapreduce/0.10.1/tez-mapreduce-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-dag/0.10.1/tez-dag-0.10.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-web-proxy/3.1.0/hadoop-yarn-server-web-proxy-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-common/3.1.0/hadoop-yarn-server-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/geronimo/specs/geronimo-jcache_1.0_spec/1.0-alpha-1/geronimo-jcache_1.0_spec-1.0-alpha-1.jar:/home/alex/.m2/repository/org/ehcache/ehcache/3.3.1/ehcache-3.3.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP-java7/2.4.12/HikariCP-java7-2.4.12.jar:/home/alex/.m2/repository/org/apache/spark/spark-core_2.12/2.4.5/spark-core_2.12-2.4.5.jar:/home/alex/.m2/repository/com/twitter/chill_2.12/0.9.3/chill_2.12-0.9.3.jar:/home/alex/.m2/repository/com/twitter/chill-java/0.9.3/chill-java-0.9.3.jar:/home/alex/.m2/repository/org/apache/xbean/xbean-asm6-shaded/4.8/xbean-asm6-shaded-4.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-client/3.1.0/hadoop-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-jobclient/3.1.0/hadoop-mapreduce-client-jobclient-3.1.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-launcher_2.12/2.4.5/spark-launcher_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-kvstore_2.12/2.4.5/spark-kvstore_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-common_2.12/2.4.5/spark-network-common_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-shuffle_2.12/2.4.5/spark-network-shuffle_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-unsafe_2.12/2.4.5/spark-unsafe_2.12-2.4.5.jar:/home/alex/.m2/repository/javax/activation/activation/1.1.1/activation-1.1.1.jar:/home/alex/.m2/repository/org/slf4j/jul-to-slf4j/1.7.16/jul-to-slf4j-1.7.16.jar:/home/alex/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.16/jcl-over-slf4j-1.7.16.jar:/home/alex/.m2/repository/com/ning/compress-lzf/1.0.3/compress-lzf-1.0.3.jar:/home/alex/.m2/repository/org/lz4/lz4-java/1.4.0/lz4-java-1.4.0.jar:/home/alex/.m2/repository/com/github/luben/zstd-jni/1.3.2-2/zstd-jni-1.3.2-2.jar:/home/alex/.m2/repository/org/scala-lang/scala-library/2.12.10/scala-library-2.12.10.jar:/home/alex/.m2/repository/org/json4s/json4s-jackson_2.12/3.5.3/json4s-jackson_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-core_2.12/3.5.3/json4s-core_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-ast_2.12/3.5.3/json4s-ast_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-scalap_2.12/3.5.3/json4s-scalap_2.12-3.5.3.jar:/home/alex/.m2/repository/org/scala-lang/modules/scala-xml_2.12/1.0.6/scala-xml_2.12-1.0.6.jar:/home/alex/.m2/repository/com/clearspring/analytics/stream/2.7.0/stream-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-graphite/3.1.5/metrics-graphite-3.1.5.jar:/home/alex/.m2/repository/oro/oro/2.0.8/oro-2.0.8.jar:/home/alex/.m2/repository/net/razorvine/pyrolite/4.13/pyrolite-4.13.jar:/home/alex/.m2/repository/net/sf/py4j/py4j/0.10.7/py4j-0.10.7.jar:/home/alex/.m2/repository/org/apache/spark/spark-tags_2.12/2.4.5/spark-tags_2.12-2.4.5.jar:/home/alex/.m2/repository/org/spark-project/spark/unused/1.0.0/unused-1.0.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-server/2.22.2/jersey-server-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-common/2.22.2/jersey-common-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/bundles/repackaged/jersey-guava/2.22.2/jersey-guava-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.1/osgi-resource-locator-1.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-client/2.22.2/jersey-client-2.22.2.jar:/home/alex/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.22.2/jersey-media-jaxb-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-api/2.4.0-b34/hk2-api-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-utils/2.4.0-b34/hk2-utils-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.4.0-b34/aopalliance-repackaged-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/javax.inject/2.4.0-b34/javax.inject-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-locator/2.4.0-b34/hk2-locator-2.4.0-b34.jar:/home/alex/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/alex/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.22.2/jersey-container-servlet-core-2.22.2.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4/2.0.2/powermock-module-junit4-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4-common/2.0.2/powermock-module-junit4-common-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-reflect/2.0.2/powermock-reflect-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-core/2.0.2/powermock-core-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-mockito2/2.0.2/powermock-api-mockito2-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-support/2.0.2/powermock-api-support-2.0.2.jar:/home/alex/.m2/repository/com/google/guava/guava-testlib/19.0/guava-testlib-19.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.0.2/error_prone_annotations-2.0.2.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.2/re2j-1.2.jar:/home/alex/.m2/repository/org/reflections/reflections/0.9.10/reflections-0.9.10.jar:/home/alex/.m2/repository/org/javassist/javassist/3.19.0-GA/javassist-3.19.0-GA.jar:/home/alex/.m2/repository/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/org/codehaus/janino/commons-compiler/3.0.11/commons-compiler-3.0.11.jar:/home/alex/.m2/repository/org/codehaus/janino/janino/3.0.11/janino-3.0.11.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-multipart/1.19/jersey-multipart-1.19.jar:/home/alex/.m2/repository/org/jvnet/mimepull/mimepull/1.9.3/mimepull-1.9.3.jar:/home/alex/.m2/repository/org/apache/kafka/kafka-clients/2.5.0/kafka-clients-2.5.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.4.4/mockito-core-3.4.4.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.13/byte-buddy-1.10.13.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.13/byte-buddy-agent-1.10.13.jar:/home/alex/Repositories/hive/ql/target/testconf:/home/alex/Repositories/hive/ql/../conf:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/alex"/>
    <property name="user.language" value="en"/>
    <property name="java.security.krb5.conf" value="/home/alex/Repositories/hive/ql/target/testconf/krb5.conf"/>
    <property name="test.dfs.mkdir" value=""/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="nondexFilter" value=".*"/>
    <property name="nondexSeed" value="974622"/>
    <property name="surefire.real.class.path" value="/home/alex/Repositories/hive/ql/target/surefire/surefirebooter7888034650970064230.jar"/>
    <property name="hadoop.log.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="6.5.0-28-generic"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="hive.test.console.log.level" value="INFO"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="java.vendor.url.bug" value="http://bugreport.sun.com/bugreport/"/>
    <property name="maven.local.repository" value="/home/alex/.m2/repository"/>
    <property name="user.dir" value="/home/alex/Repositories/hive/ql"/>
    <property name="os.arch" value="amd64"/>
    <property name="nondexMode" value="FULL"/>
    <property name="user.language.format" value="pt"/>
    <property name="antlr.version" value="3.5.2"/>
    <property name="derby.version" value="10.14.1.0"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vm.version" value="25.402-b06"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="test.output.overwrite" value=""/>
    <property name="java.class.version" value="52.0"/>
    <property name="hive.root" value="/home/alex/Repositories/hive/ql/../"/>
  </properties>
  <testcase name="testMergeUpdateDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="17.301">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-out><![CDATA[log4j: Trying to find [log4j.xml] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@47b67fcb.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@47b67fcb.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
]]></system-out>
    <system-err><![CDATA[SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,069221 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@433defed]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@433defed) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@72c8e7b
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@7fb4f2a9
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,018942 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(alwaysWriteExceptions="null", Replace=null, footer="null", charset="null", noConsoleNoAnsi="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", Configuration(HiveLog4j2Test), header="null", disableAnsi="null", PatternSelector=null)
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(follow="null", direct="null", target="SYSTEM_ERR", immediateFlush="null", bufferedIo="null", bufferSize="null", ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="console", Configuration(HiveLog4j2Test), Filter=null, ={})
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(disableAnsi="null", charset="null", PatternSelector=null, pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", header="null", noConsoleNoAnsi="null", alwaysWriteExceptions="null", Replace=null, footer="null", Configuration(HiveLog4j2Test))
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(interval="1", modulate="true", maxRandomDelay="null")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(max="30", tempCompressedFilePattern="null", Configuration(HiveLog4j2Test), fileIndex="null", stopCustomActionsOnError="null", compressionLevel="null", ={}, min="null")
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(fileGroup="null", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", fileOwner="null", append="null", advertise="null", advertiseURI="null", filePermissions="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", bufferSize="null", bufferedIo="null", immediateFlush="null", Configuration(HiveLog4j2Test), PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ignoreExceptions="null", name="DRFA", Filter=null, ={})
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 1276421398
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-24T02:30:33.184-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/25-00:00:00.000, nextFileTime=2024/04/24-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/24-02:30:34.950, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/25-00:00:00.000, nextFileTime=2024/04/24-00:00:00.000, prevFileTime=2024/04/24-00:00:00.000, current=2024/04/24-02:30:34.950, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@7fb4f2a9 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@7fb4f2a9
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@7fb4f2a9 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@394a2528...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@394a2528 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@3401a114
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@433defed
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@433defed) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@433defed] started OK.
2024-04-24T02:30:35,051  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-24T02:30:35,422  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-24T02:30:35,481  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:30:35,482  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:30:35,482  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:30:35,482  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:30:35,483  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:30:35,483  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:30:35,484  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:30:35,484  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:30:35,485  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:30:35,485  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:30:35,485  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:30:35,579  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T02:30:35,584  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-24T02:30:36,133  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T02:30:36,138  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
2024-04-24T02:30:36,141  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T02:30:36,145  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-24T02:30:36,149  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T02:30:36,150  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-24T02:30:36,331  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
2024-04-24T02:30:36,339  INFO [main] utils.TestTxnDbUtil: Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/ql/target/tmp/junit_metastore_db;create=true
Hive Session ID = c957374a-3634-482b-9d4c-cc520876e634
2024-04-24T02:30:37,237  INFO [main] SessionState: Hive Session ID = c957374a-3634-482b-9d4c-cc520876e634
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:30:37,248  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
log4j:WARN No appenders could be found for logger (org.apache.htrace.core.Tracer).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-24T02:30:37,624  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c957374a-3634-482b-9d4c-cc520876e634
2024-04-24T02:30:37,627  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634
2024-04-24T02:30:37,629  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c957374a-3634-482b-9d4c-cc520876e634/_tmp_space.db
2024-04-24T02:30:37,653  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=c957374a-3634-482b-9d4c-cc520876e634, clientType=HIVECLI]
2024-04-24T02:30:37,699  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:30:37,824  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:30:37,856  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:30:37,859  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-24T02:30:37,859  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-24T02:30:37,861  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T02:30:37,864  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-24T02:30:37,866  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T02:30:37,866  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-24T02:30:38,324  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-24T02:30:38,324  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4eb9f2af, with PersistenceManager: null will be shutdown
2024-04-24T02:30:38,359  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4eb9f2af, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1668919e created in the thread with id: 1
2024-04-24T02:30:40,401  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4eb9f2af from thread id: 1
2024-04-24T02:30:40,415  INFO [main] metastore.HMSHandler: Setting location of default catalog, as it hasn't been done after upgrade
2024-04-24T02:30:40,441  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-24T02:30:40,486  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-24T02:30:40,507  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-24T02:30:40,510  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-24T02:30:40,584  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-24T02:30:40,589  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-24T02:30:40,594  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-24T02:30:40,596  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-24T02:30:40,597  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-24T02:30:40,598  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-24T02:30:40,599  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-24T02:30:40,602  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:30:40,724  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:30:40,768  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:30:40,797  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023040_81e07e26-2dc9-422a-8f3f-6de9476cb399): drop table if exists acidTbl
2024-04-24T02:30:41,654  INFO [main] reflections.Reflections: Reflections took 201 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T02:30:41,818  INFO [main] reflections.Reflections: Reflections took 135 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T02:30:41,959  INFO [main] reflections.Reflections: Reflections took 134 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T02:30:41,990  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:30:42,003  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:30:42,013  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:42,161  INFO [main] reflections.Reflections: Reflections took 128 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T02:30:42,197  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:42,198  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:42,201  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:42,201  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=8, openTxn_(String, TxnType)=34, flushCache_()=0}
2024-04-24T02:30:42,202  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023040_81e07e26-2dc9-422a-8f3f-6de9476cb399); Time taken: 1.406 seconds
2024-04-24T02:30:42,204  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023040_81e07e26-2dc9-422a-8f3f-6de9476cb399
2024-04-24T02:30:42,204  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:30:42,207  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023040_81e07e26-2dc9-422a-8f3f-6de9476cb399): drop table if exists acidTbl
2024-04-24T02:30:42,209  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:42,211  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:42,228  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:42,228  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:42,228  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023040_81e07e26-2dc9-422a-8f3f-6de9476cb399); Time taken: 0.02 seconds
2024-04-24T02:30:42,228  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023040_81e07e26-2dc9-422a-8f3f-6de9476cb399
2024-04-24T02:30:42,239  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:30:42,254  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:42,257  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:30:42,258  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:30:42,259  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023042_6d43cf46-c462-4ea9-a87e-543951eea94c): drop table if exists acidTblPart
2024-04-24T02:30:42,263  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:30:42,264  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:30:42,266  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:30:42,270  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:42,271  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:42,271  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:42,271  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=29, isCompatibleWith_(Configuration)=2, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-24T02:30:42,271  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023042_6d43cf46-c462-4ea9-a87e-543951eea94c); Time taken: 0.012 seconds
2024-04-24T02:30:42,272  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023042_6d43cf46-c462-4ea9-a87e-543951eea94c
2024-04-24T02:30:42,272  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:30:42,272  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023042_6d43cf46-c462-4ea9-a87e-543951eea94c): drop table if exists acidTblPart
2024-04-24T02:30:42,272  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:42,273  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:30:42,277  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:42,277  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:42,278  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023042_6d43cf46-c462-4ea9-a87e-543951eea94c); Time taken: 0.005 seconds
2024-04-24T02:30:42,278  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023042_6d43cf46-c462-4ea9-a87e-543951eea94c
2024-04-24T02:30:42,286  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:30:42,295  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:42,295  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:30:42,296  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:30:42,297  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023042_81f7f27b-a7e4-4984-ad44-a5ded17cb163): drop table if exists acidTbl2
2024-04-24T02:30:42,301  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:30:42,302  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:30:42,304  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:30:42,308  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:42,308  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:42,308  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:42,309  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=18}
2024-04-24T02:30:42,309  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023042_81f7f27b-a7e4-4984-ad44-a5ded17cb163); Time taken: 0.011 seconds
2024-04-24T02:30:42,309  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023042_81f7f27b-a7e4-4984-ad44-a5ded17cb163
2024-04-24T02:30:42,309  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:30:42,309  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023042_81f7f27b-a7e4-4984-ad44-a5ded17cb163): drop table if exists acidTbl2
2024-04-24T02:30:42,310  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:42,310  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:30:42,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:42,315  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:42,315  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023042_81f7f27b-a7e4-4984-ad44-a5ded17cb163); Time taken: 0.006 seconds
2024-04-24T02:30:42,315  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023042_81f7f27b-a7e4-4984-ad44-a5ded17cb163
2024-04-24T02:30:42,323  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:30:42,332  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:42,333  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:30:42,334  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:30:42,335  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023042_f3604fd6-5f06-4e88-8bfc-2332d559ed9c): drop table if exists nonAcidOrcTbl
2024-04-24T02:30:42,339  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:30:42,339  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:30:42,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:42,346  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:42,346  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:42,346  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:42,346  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=18, openTxn_(String, TxnType)=3}
2024-04-24T02:30:42,347  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023042_f3604fd6-5f06-4e88-8bfc-2332d559ed9c); Time taken: 0.012 seconds
2024-04-24T02:30:42,347  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023042_f3604fd6-5f06-4e88-8bfc-2332d559ed9c
2024-04-24T02:30:42,347  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:30:42,347  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023042_f3604fd6-5f06-4e88-8bfc-2332d559ed9c): drop table if exists nonAcidOrcTbl
2024-04-24T02:30:42,348  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:42,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:42,354  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:42,354  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:42,354  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023042_f3604fd6-5f06-4e88-8bfc-2332d559ed9c); Time taken: 0.007 seconds
2024-04-24T02:30:42,354  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023042_f3604fd6-5f06-4e88-8bfc-2332d559ed9c
2024-04-24T02:30:42,363  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:30:42,373  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:42,373  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:30:42,375  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:30:42,375  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023042_f896f88b-3765-4e75-bef3-9eb6dff46839): drop table if exists nonAcidOrcTbl2
2024-04-24T02:30:42,380  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:30:42,381  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:30:42,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:30:42,388  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:42,388  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:42,388  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:42,388  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=19}
2024-04-24T02:30:42,389  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023042_f896f88b-3765-4e75-bef3-9eb6dff46839); Time taken: 0.013 seconds
2024-04-24T02:30:42,389  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023042_f896f88b-3765-4e75-bef3-9eb6dff46839
2024-04-24T02:30:42,389  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:30:42,389  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023042_f896f88b-3765-4e75-bef3-9eb6dff46839): drop table if exists nonAcidOrcTbl2
2024-04-24T02:30:42,390  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:42,390  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:30:42,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:42,395  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:42,395  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023042_f896f88b-3765-4e75-bef3-9eb6dff46839); Time taken: 0.006 seconds
2024-04-24T02:30:42,395  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023042_f896f88b-3765-4e75-bef3-9eb6dff46839
2024-04-24T02:30:42,405  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:30:42,414  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:42,414  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:30:42,415  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:30:42,416  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023042_de6735a5-d832-4bc3-9152-1e2ace5de186): drop table if exists nonAcidNonBucket
2024-04-24T02:30:42,420  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:30:42,421  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:30:42,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:30:42,427  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:42,427  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:42,427  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:42,427  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=19, isCompatibleWith_(Configuration)=1}
2024-04-24T02:30:42,427  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023042_de6735a5-d832-4bc3-9152-1e2ace5de186); Time taken: 0.011 seconds
2024-04-24T02:30:42,428  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023042_de6735a5-d832-4bc3-9152-1e2ace5de186
2024-04-24T02:30:42,428  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:30:42,428  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023042_de6735a5-d832-4bc3-9152-1e2ace5de186): drop table if exists nonAcidNonBucket
2024-04-24T02:30:42,428  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:42,429  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:30:42,433  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:42,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:30:42,434  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023042_de6735a5-d832-4bc3-9152-1e2ace5de186); Time taken: 0.005 seconds
2024-04-24T02:30:42,434  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023042_de6735a5-d832-4bc3-9152-1e2ace5de186
2024-04-24T02:30:42,441  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:30:42,450  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:42,451  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:30:42,451  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:42,452  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023042_b7c87bdd-779b-426c-888b-1777f726d9af): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:42,524  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:30:42,524  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:30:42,526  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:30:42,528  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:30:42,544  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:30:42,584  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:30:42,595  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:30:42,595  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:42,596  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:42,596  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:42,596  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=17, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=10, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, getDatabase_(String)=4}
2024-04-24T02:30:42,596  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023042_b7c87bdd-779b-426c-888b-1777f726d9af); Time taken: 0.144 seconds
2024-04-24T02:30:42,596  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023042_b7c87bdd-779b-426c-888b-1777f726d9af
2024-04-24T02:30:42,603  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023042_b7c87bdd-779b-426c-888b-1777f726d9af
2024-04-24T02:30:42,651  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023042_b7c87bdd-779b-426c-888b-1777f726d9af LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:30:42,651  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:30:42,654  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023042_b7c87bdd-779b-426c-888b-1777f726d9af): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:42,654  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:42,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951042, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, bucketing_version=2, numRows=0, numFiles=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:30:42,781  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:30:42,890  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:42,890  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=121}
2024-04-24T02:30:42,890  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023042_b7c87bdd-779b-426c-888b-1777f726d9af); Time taken: 0.236 seconds
2024-04-24T02:30:42,890  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023042_b7c87bdd-779b-426c-888b-1777f726d9af
2024-04-24T02:30:42,896  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:30:42,905  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:42,905  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:30:42,906  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:42,907  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023042_3226c00e-c0b7-4a8f-bd33-d19208dbfb06): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:42,912  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:30:42,912  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:30:42,913  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:30:42,914  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:30:42,917  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:30:42,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:30:42,920  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:30:42,920  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:42,920  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:42,920  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:42,920  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3}
2024-04-24T02:30:42,921  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023042_3226c00e-c0b7-4a8f-bd33-d19208dbfb06); Time taken: 0.013 seconds
2024-04-24T02:30:42,921  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023042_3226c00e-c0b7-4a8f-bd33-d19208dbfb06
2024-04-24T02:30:42,921  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023042_3226c00e-c0b7-4a8f-bd33-d19208dbfb06
2024-04-24T02:30:42,948  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023042_3226c00e-c0b7-4a8f-bd33-d19208dbfb06 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:30:42,948  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:30:42,949  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023042_3226c00e-c0b7-4a8f-bd33-d19208dbfb06): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:42,949  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:42,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951042, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:30:42,960  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:30:42,989  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:42,989  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=39}
2024-04-24T02:30:42,989  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023042_3226c00e-c0b7-4a8f-bd33-d19208dbfb06); Time taken: 0.04 seconds
2024-04-24T02:30:42,989  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023042_3226c00e-c0b7-4a8f-bd33-d19208dbfb06
2024-04-24T02:30:42,995  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:30:43,004  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:43,006  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:30:43,007  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,008  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023043_18f57791-287a-451b-84f5-aa36daec91a3): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,012  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 2
2024-04-24T02:30:43,012  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:30:43,013  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:30:43,014  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:30:43,017  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:30:43,017  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:30:43,020  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:30:43,020  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:43,020  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:43,020  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:43,020  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, getDatabase_(String)=3, getValidWriteIds_(List, String)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=3}
2024-04-24T02:30:43,020  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023043_18f57791-287a-451b-84f5-aa36daec91a3); Time taken: 0.013 seconds
2024-04-24T02:30:43,020  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023043_18f57791-287a-451b-84f5-aa36daec91a3
2024-04-24T02:30:43,021  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023043_18f57791-287a-451b-84f5-aa36daec91a3
2024-04-24T02:30:43,045  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023043_18f57791-287a-451b-84f5-aa36daec91a3 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:30:43,046  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:30:43,046  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023043_18f57791-287a-451b-84f5-aa36daec91a3): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,046  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:43,047  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951043, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, bucketing_version=2, numFiles=0, numRows=0, transactional=false, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:30:43,056  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:30:43,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:43,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=38, isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:43,086  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023043_18f57791-287a-451b-84f5-aa36daec91a3); Time taken: 0.039 seconds
2024-04-24T02:30:43,086  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023043_18f57791-287a-451b-84f5-aa36daec91a3
2024-04-24T02:30:43,091  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:30:43,099  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:43,099  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:30:43,100  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,100  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023043_d24ab8aa-40dd-4346-acf6-a3b0a9cfdd46): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,104  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 2
2024-04-24T02:30:43,104  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:30:43,105  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:30:43,105  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:30:43,109  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:30:43,109  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:30:43,111  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:30:43,111  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:43,112  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:43,112  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:43,112  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=1}
2024-04-24T02:30:43,112  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023043_d24ab8aa-40dd-4346-acf6-a3b0a9cfdd46); Time taken: 0.012 seconds
2024-04-24T02:30:43,112  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023043_d24ab8aa-40dd-4346-acf6-a3b0a9cfdd46
2024-04-24T02:30:43,113  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023043_d24ab8aa-40dd-4346-acf6-a3b0a9cfdd46
2024-04-24T02:30:43,136  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023043_d24ab8aa-40dd-4346-acf6-a3b0a9cfdd46 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:30:43,136  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:30:43,136  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023043_d24ab8aa-40dd-4346-acf6-a3b0a9cfdd46): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,136  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:43,138  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951043, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, totalSize=0, numFiles=0, transactional=false, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:30:43,145  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:30:43,171  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:43,171  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=34, isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:43,171  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023043_d24ab8aa-40dd-4346-acf6-a3b0a9cfdd46); Time taken: 0.035 seconds
2024-04-24T02:30:43,172  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023043_d24ab8aa-40dd-4346-acf6-a3b0a9cfdd46
2024-04-24T02:30:43,177  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:30:43,186  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:43,186  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:30:43,187  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:43,187  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023043_ec7ab395-b00d-42e8-9552-fbdaf6898b9e): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:43,191  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 2
2024-04-24T02:30:43,192  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:30:43,193  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:30:43,193  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:30:43,197  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:30:43,197  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:30:43,200  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:30:43,200  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:43,200  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:43,200  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:43,200  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=3, getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=4}
2024-04-24T02:30:43,200  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023043_ec7ab395-b00d-42e8-9552-fbdaf6898b9e); Time taken: 0.013 seconds
2024-04-24T02:30:43,200  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023043_ec7ab395-b00d-42e8-9552-fbdaf6898b9e
2024-04-24T02:30:43,201  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023043_ec7ab395-b00d-42e8-9552-fbdaf6898b9e
2024-04-24T02:30:43,224  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023043_ec7ab395-b00d-42e8-9552-fbdaf6898b9e LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:30:43,224  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:30:43,225  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023043_ec7ab395-b00d-42e8-9552-fbdaf6898b9e): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:30:43,225  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:43,227  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c957374a-3634-482b-9d4c-cc520876e634/_tmp_space.db/6b758ec9-eb64-4c45-b319-6292ab9c02ee
2024-04-24T02:30:43,232  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:43,232  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=4}
2024-04-24T02:30:43,232  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023043_ec7ab395-b00d-42e8-9552-fbdaf6898b9e); Time taken: 0.007 seconds
2024-04-24T02:30:43,232  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023043_ec7ab395-b00d-42e8-9552-fbdaf6898b9e
2024-04-24T02:30:43,237  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:30:43,245  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:43,245  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:30:43,247  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,247  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023043_1df5aaca-8522-4814-af47-67493bd0d7bc): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,252  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 2
2024-04-24T02:30:43,253  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:30:43,254  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:30:43,254  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:30:43,259  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:30:43,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:30:43,263  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:30:43,263  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:43,263  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:43,263  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:43,263  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=5, flushCache_()=0, getDatabase_(String)=4}
2024-04-24T02:30:43,264  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023043_1df5aaca-8522-4814-af47-67493bd0d7bc); Time taken: 0.016 seconds
2024-04-24T02:30:43,264  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023043_1df5aaca-8522-4814-af47-67493bd0d7bc
2024-04-24T02:30:43,264  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023043_1df5aaca-8522-4814-af47-67493bd0d7bc
2024-04-24T02:30:43,298  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023043_1df5aaca-8522-4814-af47-67493bd0d7bc LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:30:43,298  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:30:43,298  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023043_1df5aaca-8522-4814-af47-67493bd0d7bc): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:30:43,298  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:43,300  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951043, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, bucketing_version=2, rawDataSize=0, totalSize=0, numFiles=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:30:43,313  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:30:43,344  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:43,344  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=44}
2024-04-24T02:30:43,345  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023043_1df5aaca-8522-4814-af47-67493bd0d7bc); Time taken: 0.046 seconds
2024-04-24T02:30:43,345  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023043_1df5aaca-8522-4814-af47-67493bd0d7bc
2024-04-24T02:30:43,351  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:30:43,361  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:43,361  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:30:43,362  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Initializing local cache in HiveMetaStoreClient...
2024-04-24T02:30:43,385  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Local cache initialized in HiveMetaStoreClient: com.github.benmanes.caffeine.cache.BoundedLocalCache$BoundedLocalManualCache@d13379e
2024-04-24T02:30:43,390  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:30:43,391  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:30:43,397  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 6
2024-04-24T02:30:43,398  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:30:43,399  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:30:43,399  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:30:43,924  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:30:43,929  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:30:43,930  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:30:43,930  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:30:43,930  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:30:43,931  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:30:43,933  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T02:30:43,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:44,055  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:44,056  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:30:44,056  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:30:44,056  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:30:44,056  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:30:44,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:44,074  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:44,075  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:30:44,075  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:30:45,177  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:30:45,793  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:30:45,793  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:30:45,793  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:30:45,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:30:45,797  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:30:45,798  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:30:45,800  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:30:45,800  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:45,816  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:45,847  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1
2024-04-24T02:30:45,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:45,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:45,868  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:30:45,918  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:30:45,918  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:30:45,926  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:30:45,937  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:30:45,967  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:45,984  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:45,993  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:30:45,993  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:30:45,993  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:45,993  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:30:45,993  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:45,994  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, getAllTableConstraints_(AllTableConstraintsRequest)=51, getTable_(GetTableRequest)=123, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=3, getNotNullConstraints_(NotNullConstraintsRequest)=3, commitTxn_(CommitTxnRequest)=17, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T02:30:45,994  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f); Time taken: 2.602 seconds
2024-04-24T02:30:45,994  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f
2024-04-24T02:30:45,995  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f
2024-04-24T02:30:46,018  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:30:46,018  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:30:46,019  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:30:46,019  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f
2024-04-24T02:30:46,019  INFO [main] ql.Driver: Query ID = alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f
Total jobs = 1
2024-04-24T02:30:46,019  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:30:46,019  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:30:46,181  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:30:46,181  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:30:46,181  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:30:46,181  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:30:46,181  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:30:46,181  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:30:46,181  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:30:46,181  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:30:46,189  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:30:46,193  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:30:46,193  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-43_390_4667725373370145404-1/dummy_path
2024-04-24T02:30:46,264  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:30:46,287  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,00KB
2024-04-24T02:30:46,295  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:30:46,302  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:30:46,406  INFO [main] beanutils.FluentPropertyBeanIntrospector: Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2024-04-24T02:30:46,420  WARN [main] impl.MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-jobtracker.properties,hadoop-metrics2.properties
2024-04-24T02:30:46,435  INFO [main] impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-04-24T02:30:46,436  INFO [main] impl.MetricsSystemImpl: JobTracker metrics system started
2024-04-24T02:30:46,448  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-43_390_4667725373370145404-1/-mr-10001
2024-04-24T02:30:46,464  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:30:46,506  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:30:46,513  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:30:46,518  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:30:46,518  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:30:46,518  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-43_390_4667725373370145404-1/dummy_path
2024-04-24T02:30:46,518  INFO [main] io.NullRowsInputFormat$NullRowsRecordReader: Using null rows input format
2024-04-24T02:30:46,523  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:30:46,553  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:30:46,632  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local143829506_0001
2024-04-24T02:30:46,632  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:30:46,767  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:30:46,769  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:30:46,769  INFO [Thread-74] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:30:46,771  INFO [Thread-74] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:30:46,783  INFO [Thread-74] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:30:46,787  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local143829506_0001_m_000000_0
2024-04-24T02:30:46,823  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:30:46,830  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-43_390_4667725373370145404-1/dummy_path/null:0+1
2024-04-24T02:30:46,837  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:30:46,858  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,00KB
2024-04-24T02:30:46,866  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:30:46,881  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:30:46,881  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:30:46,881  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:30:46,881  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:30:46,881  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:30:46,883  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:30:46,888  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:30:46,890  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:30:46,892  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:30:46,892  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:30:46,895  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:30:46,896  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:30:46,896  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:30:46,896  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:30:46,896  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:30:46,897  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:30:46,919  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:30:46,920  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:30:46,921  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:30:46,921  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:30:46,921  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-24T02:30:46,922  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-24T02:30:46,928  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:30:46,928  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:30:46,928  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:30:46,928  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-24T02:30:46,928  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-24T02:30:46,946  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:30:46,957  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local143829506_0001_m_000000_0 is done. And is in the process of committing
2024-04-24T02:30:46,959  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:30:46,959  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local143829506_0001_m_000000_0' done.
2024-04-24T02:30:46,961  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local143829506_0001_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=5458
		FILE: Number of bytes written=1174885
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=883949568
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5053
2024-04-24T02:30:46,961  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local143829506_0001_m_000000_0
2024-04-24T02:30:46,961  INFO [Thread-74] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:30:46,966  INFO [Thread-74] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:30:46,966  INFO [pool-8-thread-1] mapred.LocalJobRunner: Starting task: attempt_local143829506_0001_r_000000_0
2024-04-24T02:30:46,975  INFO [pool-8-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:30:46,978  INFO [pool-8-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@aa8a7ac
2024-04-24T02:30:46,980  WARN [pool-8-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:30:46,998  INFO [pool-8-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:30:47,000  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local143829506_0001_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:30:47,042  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local143829506_0001_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:30:47,044  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local143829506_0001_m_000000_0
2024-04-24T02:30:47,047  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:30:47,048  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:30:47,048  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:30:47,049  INFO [pool-8-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:30:47,060  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:30:47,061  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:30:47,064  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:30:47,064  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:30:47,065  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:30:47,065  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:30:47,065  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:30:47,065  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:30:47,067  INFO [pool-8-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:30:47,070  INFO [pool-8-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:30:47,072  INFO [pool-8-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:30:47,072  INFO [pool-8-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:30:47,072  INFO [pool-8-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:30:47,072  INFO [pool-8-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:30:47,073  INFO [pool-8-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local143829506_0001/job_local143829506_0001.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@b2607f8
2024-04-24T02:30:47,077  INFO [pool-8-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_tmp.-ext-10000/000000_0
2024-04-24T02:30:47,077  INFO [pool-8-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-24T02:30:47,077  INFO [pool-8-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_tmp.-ext-10000/000000_0
2024-04-24T02:30:47,089  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:30:47,101  INFO [pool-8-thread-1] impl.HadoopShimsPre2_7: Can't get KeyProvider for ORC encryption from hadoop.security.key.provider.path.
2024-04-24T02:30:47,105  INFO [pool-8-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T02:30:47,164  INFO [pool-8-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T02:30:47,169  INFO [pool-8-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:30:47,170  INFO [pool-8-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:47,170  INFO [pool-8-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:30:47,170  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:30:47,211  INFO [pool-8-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.nonacidorctbl:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-24T02:30:47,212  INFO [pool-8-thread-1] mapred.Task: Task:attempt_local143829506_0001_r_000000_0 is done. And is in the process of committing
2024-04-24T02:30:47,213  INFO [pool-8-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:30:47,213  INFO [pool-8-thread-1] mapred.Task: Task 'attempt_local143829506_0001_r_000000_0' done.
2024-04-24T02:30:47,213  INFO [pool-8-thread-1] mapred.Task: Final Counters for attempt_local143829506_0001_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=12034
		FILE: Number of bytes written=1175251
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=12
		Total committed heap usage (bytes)=884998144
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:30:47,213  INFO [pool-8-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local143829506_0001_r_000000_0
2024-04-24T02:30:47,213  INFO [pool-8-thread-1] mapred.LocalJobRunner: Starting task: attempt_local143829506_0001_r_000001_0
2024-04-24T02:30:47,214  INFO [pool-8-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:30:47,214  INFO [pool-8-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2bfaf9b3
2024-04-24T02:30:47,215  WARN [pool-8-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:30:47,216  INFO [pool-8-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:30:47,216  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local143829506_0001_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:30:47,219  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local143829506_0001_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-24T02:30:47,220  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local143829506_0001_m_000000_0
2024-04-24T02:30:47,220  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-24T02:30:47,220  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:30:47,221  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:30:47,221  INFO [pool-8-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:30:47,227  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:30:47,227  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-24T02:30:47,230  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-24T02:30:47,230  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-24T02:30:47,230  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:30:47,230  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:30:47,231  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-24T02:30:47,231  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:30:47,232  INFO [pool-8-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:30:47,235  INFO [pool-8-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:30:47,237  INFO [pool-8-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:30:47,237  INFO [pool-8-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:30:47,237  INFO [pool-8-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:30:47,237  INFO [pool-8-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:30:47,238  INFO [pool-8-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local143829506_0001/job_local143829506_0001.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@16093b6c
2024-04-24T02:30:47,238  INFO [pool-8-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_tmp.-ext-10000/000001_0
2024-04-24T02:30:47,238  INFO [pool-8-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-24T02:30:47,239  INFO [pool-8-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_tmp.-ext-10000/000001_0
2024-04-24T02:30:47,239  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:30:47,239  INFO [pool-8-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T02:30:47,245  INFO [pool-8-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T02:30:47,245  INFO [pool-8-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:30:47,245  INFO [pool-8-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:47,245  INFO [pool-8-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:30:47,245  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-24T02:30:47,254  INFO [pool-8-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.nonacidorctbl:3, TOTAL_TABLE_ROWS_WRITTEN:3, RECORDS_OUT_OPERATOR_FS_6:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:47,254  INFO [pool-8-thread-1] mapred.Task: Task:attempt_local143829506_0001_r_000001_0 is done. And is in the process of committing
2024-04-24T02:30:47,255  INFO [pool-8-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:30:47,255  INFO [pool-8-thread-1] mapred.Task: Task 'attempt_local143829506_0001_r_000001_0' done.
2024-04-24T02:30:47,255  INFO [pool-8-thread-1] mapred.Task: Final Counters for attempt_local143829506_0001_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=18622
		FILE: Number of bytes written=1175670
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=884998144
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:30:47,255  INFO [pool-8-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local143829506_0001_r_000001_0
2024-04-24T02:30:47,256  INFO [Thread-74] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24T02:30:47,326  INFO [Heartbeater-3] lockmgr.DbTxnManager: Sending heartbeat for txnid:13 and lockid:0 queryId=null txnid:0
2024-04-24T02:30:47,328  INFO [Heartbeater-3] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:30:47,330  INFO [Heartbeater-3] metastore.HMSHandler: 1: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:30:47,330  INFO [Heartbeater-3] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:30:47,330  INFO [Heartbeater-3] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56c99e22, with PersistenceManager: null will be shutdown
2024-04-24T02:30:47,331  INFO [Heartbeater-3] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56c99e22, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@35b62e5c created in the thread with id: 55
2024-04-24T02:30:47,366  INFO [Heartbeater-3] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56c99e22 from thread id: 55
2024-04-24T02:30:47,366  INFO [Heartbeater-3] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:30:47,366  INFO [Heartbeater-3] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:30:47,369  INFO [Heartbeater-3] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_functions	
2024-04-24 02:30:47,786 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:30:47,786  INFO [main] exec.Task: 2024-04-24 02:30:47,786 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local143829506_0001
2024-04-24T02:30:47,789  INFO [main] exec.Task: Ended Job = job_local143829506_0001
2024-04-24T02:30:47,828  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-24T02:30:47,829  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1/-ext-10000
2024-04-24T02:30:47,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:47,850  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:47,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:47,866  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:47,875  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-24T02:30:47,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-24T02:30:47,932  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:30:47,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:47,947  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:47,947  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:30:47,947  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-43_390_4667725373370145404-1/-mr-10001
2024-04-24T02:30:47,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:47,966  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:47,968  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-24T02:30:47,968  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-24T02:30:47,969  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-24T02:30:47,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-24T02:30:48,012  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-24T02:30:48,013  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:48,013  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=97, getTable_(GetTableRequest)=67, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:30:48,013  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:30:48,020  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:30:48,020  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:30:48,020  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f); Time taken: 1.995 seconds
2024-04-24T02:30:48,020  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023043_0f98d0cb-c82d-4a8c-a703-6445d992ab8f
2024-04-24T02:30:48,025  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:30:48,033  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:48,035  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:30:48,036  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:30:48,036  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-43_390_4667725373370145404-1
2024-04-24T02:30:48,037  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-43_390_4667725373370145404-1 on fs with scheme file
2024-04-24T02:30:48,037  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1
2024-04-24T02:30:48,037  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-30-43_390_4667725373370145404-1 on fs with scheme file
2024-04-24T02:30:48,038  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:30:48,050  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:30:48,051  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:30:48,055  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:30:48,055  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:30:48,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:48,069  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:48,070  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:30:48,070  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:30:48,070  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:30:48,070  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:30:48,070  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:48,080  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:48,080  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:30:48,080  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:30:48,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:30:48,210  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:30:48,210  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:30:48,210  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:30:48,211  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:30:48,215  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:30:48,215  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:30:48,215  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:30:48,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:48,225  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:48,229  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:30:48,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:30:48,243  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-24T02:30:48,244  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-24T02:30:48,246  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:30:48,250  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:30:48,251  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:30:48,252  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:30:48,253  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:30:48,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:30:48,276  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:48,276  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:30:48,276  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:30:48,276  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:48,276  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:30:48,277  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:48,277  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=6, getNotNullConstraints_(NotNullConstraintsRequest)=1, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=8, flushCache_()=0, getCheckConstraints_(CheckConstraintsRequest)=2, getTable_(GetTableRequest)=43, allocateTableWriteId_(long, String, String)=12, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=4, openTxn_(String, TxnType)=12}
2024-04-24T02:30:48,277  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c); Time taken: 0.239 seconds
2024-04-24T02:30:48,278  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c
2024-04-24T02:30:48,278  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c
2024-04-24T02:30:48,301  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:30:48,301  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:30:48,304  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:30:48,305  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c
2024-04-24T02:30:48,305  INFO [main] ql.Driver: Query ID = alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c
Total jobs = 1
2024-04-24T02:30:48,305  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:30:48,305  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:30:48,454  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:30:48,454  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:30:48,454  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:30:48,454  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:30:48,454  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:30:48,454  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:30:48,454  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:30:48,454  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:30:48,456  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:30:48,457  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:30:48,457  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-48_038_2483141460383842398-1/dummy_path
2024-04-24T02:30:48,467  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:30:48,469  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,03KB
2024-04-24T02:30:48,474  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:30:48,485  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:30:48,486  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:30:48,490  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-48_038_2483141460383842398-1/-mr-10000
2024-04-24T02:30:48,493  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:30:48,501  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:30:48,505  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:30:48,506  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:30:48,506  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:30:48,506  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-48_038_2483141460383842398-1/dummy_path
2024-04-24T02:30:48,507  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:30:48,526  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:30:48,548  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1616224185_0002
2024-04-24T02:30:48,548  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:30:48,627  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:30:48,627  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:30:48,628  INFO [Thread-139] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:30:48,628  INFO [Thread-139] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:30:48,629  INFO [Thread-139] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:30:48,630  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1616224185_0002_m_000000_0
2024-04-24T02:30:48,630  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:30:48,631  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-48_038_2483141460383842398-1/dummy_path/null:0+1
2024-04-24T02:30:48,632  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:30:48,633  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,03KB
2024-04-24T02:30:48,634  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:30:48,638  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:30:48,638  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:30:48,638  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:30:48,638  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:30:48,638  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:30:48,639  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:30:48,640  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:30:48,640  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:30:48,641  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:30:48,641  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:30:48,641  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:30:48,642  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:30:48,642  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:30:48,642  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:30:48,642  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:30:48,642  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:48,643  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:30:48,644  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:48,644  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:30:48,644  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-24T02:30:48,644  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:30:48,644  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-24T02:30:48,644  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-24T02:30:48,645  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:30:48,645  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:30:48,645  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:30:48,645  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-24T02:30:48,645  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-24T02:30:48,657  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:30:48,660  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1616224185_0002_m_000000_0 is done. And is in the process of committing
2024-04-24T02:30:48,661  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:30:48,661  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1616224185_0002_m_000000_0' done.
2024-04-24T02:30:48,661  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1616224185_0002_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=24291
		FILE: Number of bytes written=2356286
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=884998144
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5078
2024-04-24T02:30:48,662  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1616224185_0002_m_000000_0
2024-04-24T02:30:48,662  INFO [Thread-139] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:30:48,663  INFO [Thread-139] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:30:48,663  INFO [pool-14-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1616224185_0002_r_000000_0
2024-04-24T02:30:48,664  INFO [pool-14-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:30:48,664  INFO [pool-14-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1483e043
2024-04-24T02:30:48,664  WARN [pool-14-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:30:48,665  INFO [pool-14-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:30:48,666  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1616224185_0002_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:30:48,667  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local1616224185_0002_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:30:48,667  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1616224185_0002_m_000000_0
2024-04-24T02:30:48,667  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:30:48,668  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:30:48,668  INFO [pool-14-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:30:48,668  INFO [pool-14-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:30:48,674  INFO [pool-14-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:30:48,674  INFO [pool-14-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:30:48,677  INFO [pool-14-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:30:48,677  INFO [pool-14-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:30:48,677  INFO [pool-14-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:30:48,677  INFO [pool-14-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:30:48,677  INFO [pool-14-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:30:48,677  INFO [pool-14-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:30:48,678  INFO [pool-14-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:30:48,681  INFO [pool-14-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:30:48,682  INFO [pool-14-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:30:48,682  INFO [pool-14-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:30:48,682  INFO [pool-14-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:30:48,682  INFO [pool-14-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:30:48,683  INFO [pool-14-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1616224185_0002/job_local1616224185_0002.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3993974b
2024-04-24T02:30:48,684  INFO [pool-14-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:30:48,684  INFO [pool-14-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:30:48,684  INFO [pool-14-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:30:48,689  INFO [pool-14-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:30:48,689  INFO [pool-14-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:30:48,697  INFO [pool-14-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:30:48,703  INFO [pool-14-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:30:48,703  INFO [pool-14-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:48,703  INFO [pool-14-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:30:48,703  INFO [pool-14-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:30:48,708  INFO [pool-14-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:30:48,720  INFO [pool-14-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:30:48,721  INFO [pool-14-thread-1] mapred.Task: Task:attempt_local1616224185_0002_r_000000_0 is done. And is in the process of committing
2024-04-24T02:30:48,722  INFO [pool-14-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:30:48,722  INFO [pool-14-thread-1] mapred.Task: Task 'attempt_local1616224185_0002_r_000000_0' done.
2024-04-24T02:30:48,722  INFO [pool-14-thread-1] mapred.Task: Final Counters for attempt_local1616224185_0002_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=30493
		FILE: Number of bytes written=2357355
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=884998144
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:30:48,722  INFO [pool-14-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1616224185_0002_r_000000_0
2024-04-24T02:30:48,722  INFO [pool-14-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1616224185_0002_r_000001_0
2024-04-24T02:30:48,734  INFO [pool-14-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:30:48,735  INFO [pool-14-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4243a472
2024-04-24T02:30:48,737  WARN [pool-14-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:30:48,738  INFO [pool-14-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:30:48,738  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1616224185_0002_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:30:48,742  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local1616224185_0002_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:30:48,742  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1616224185_0002_m_000000_0
2024-04-24T02:30:48,742  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:30:48,742  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:30:48,743  INFO [pool-14-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:30:48,743  INFO [pool-14-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:30:48,749  INFO [pool-14-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:30:48,749  INFO [pool-14-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:30:48,752  INFO [pool-14-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:30:48,752  INFO [pool-14-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:30:48,752  INFO [pool-14-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:30:48,752  INFO [pool-14-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:30:48,752  INFO [pool-14-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:30:48,752  INFO [pool-14-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:30:48,753  INFO [pool-14-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:30:48,754  INFO [pool-14-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:30:48,755  INFO [pool-14-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:30:48,755  INFO [pool-14-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:30:48,755  INFO [pool-14-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:30:48,755  INFO [pool-14-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:30:48,755  INFO [pool-14-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1616224185_0002/job_local1616224185_0002.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@768f627c
2024-04-24T02:30:48,757  INFO [pool-14-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:30:48,757  INFO [pool-14-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:30:48,757  INFO [pool-14-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:30:48,757  INFO [pool-14-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:30:48,757  INFO [pool-14-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:30:48,763  INFO [pool-14-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:30:48,763  INFO [pool-14-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:30:48,763  INFO [pool-14-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T02:30:48,764  INFO [pool-14-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:30:48,764  INFO [pool-14-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:30:48,766  INFO [pool-14-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:30:48,776  INFO [pool-14-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T02:30:48,776  INFO [pool-14-thread-1] mapred.Task: Task:attempt_local1616224185_0002_r_000001_0 is done. And is in the process of committing
2024-04-24T02:30:48,777  INFO [pool-14-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:30:48,777  INFO [pool-14-thread-1] mapred.Task: Task 'attempt_local1616224185_0002_r_000001_0' done.
2024-04-24T02:30:48,777  INFO [pool-14-thread-1] mapred.Task: Final Counters for attempt_local1616224185_0002_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=36653
		FILE: Number of bytes written=2358425
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=10
		Total committed heap usage (bytes)=942145536
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:30:48,777  INFO [pool-14-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1616224185_0002_r_000001_0
2024-04-24T02:30:48,777  INFO [Thread-139] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:30:49,645 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:30:49,645  INFO [main] exec.Task: 2024-04-24 02:30:49,645 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1616224185_0002
2024-04-24T02:30:49,651  INFO [main] exec.Task: Ended Job = job_local1616224185_0002
2024-04-24T02:30:49,652  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:30:49,652  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:30:49,653  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:30:49,654  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:30:49,654  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:30:49,657  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:30:49,657  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:30:49,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:30:49,667  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,667  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:30:49,678  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:30:49,728  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:30:49,728  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:30:49,739  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,739  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:30:49,739  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-48_038_2483141460383842398-1/-mr-10000
2024-04-24T02:30:49,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:30:49,751  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,769  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:30:49,769  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-24T02:30:49,769  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:30:49,770  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:30:49,801  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-24T02:30:49,801  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:30:49,801  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:30:49,804  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:30:49,804  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:49,805  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, getTable_(GetTableRequest)=42, alter_table_(String, String, String, Table, EnvironmentContext, String)=79, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:30:49,805  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:30:49,805  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:30:49,805  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:30:49,805  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c); Time taken: 1.5 seconds
2024-04-24T02:30:49,805  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023048_6991159d-b5d5-43e4-b800-7794588ccc0c
2024-04-24T02:30:49,821  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:49,821  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:30:49,822  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-24T02:30:49,822  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-48_038_2483141460383842398-1
2024-04-24T02:30:49,823  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-48_038_2483141460383842398-1 on fs with scheme file
2024-04-24T02:30:49,823  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023049_a137981d-52b8-4b72-aeaa-d63dac6f3486): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-24T02:30:49,834  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-24T02:30:49,835  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:30:49,836  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:30:49,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:49,853  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-24T02:30:49,882  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c957374a-3634-482b-9d4c-cc520876e634/_tmp_space.db/merge_tmp_table
2024-04-24T02:30:49,885  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `t`.`a` > 3 and `t`.`a` < 5 AND NOT(`s`.`a` < 3)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-24T02:30:49,891  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:30:49,897  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:30:49,897  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:30:49,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:30:49,908  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:49,922  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,923  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:30:49,923  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:30:49,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:49,932  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,933  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:49,943  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:49,953  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,953  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:49,963  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:49,963  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:30:49,963  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:30:49,966  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:30:49,966  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:30:49,966  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:30:49,981  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:30:49,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:50,170  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:30:50,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:30:50,187  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,188  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:30:50,201  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:30:50,223  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-24T02:30:50,223  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-24T02:30:50,223  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:30:50,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:50,239  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:30:50,255  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-24T02:30:50,272  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: a, b
No Stats for default@nonacidorctbl, Columns: a, b
2024-04-24T02:30:50,272  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: a, b
2024-04-24T02:30:50,546  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:30:50,546  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:30:50,546  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:30:50,546  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:30:50,546  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:30:50,547  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:30:50,547  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:30:50,547  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:30:50,547  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:30:50,547  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:30:50,547  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:30:50,547  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:30:50,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:50,561  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,562  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:50,574  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,575  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:50,586  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:50,598  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,620 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:30:50,622 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:30:50,622  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:30:50,623 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:30:50,624  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:50,624  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=94, getTable_(GetTableRequest)=130, flushCache_()=0, createTable_(Table)=3, getAllTableConstraints_(AllTableConstraintsRequest)=14, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=7, openTxn_(String, TxnType)=4}
2024-04-24T02:30:50,624  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023049_a137981d-52b8-4b72-aeaa-d63dac6f3486); Time taken: 0.801 seconds
2024-04-24T02:30:50,625  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:30:50,630  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:50,640  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:30:50,640  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c957374a-3634-482b-9d4c-cc520876e634/hive_2024-04-24_02-30-49_885_6335851660951429414-1
2024-04-24T02:30:50,641  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023050_cd42a24a-e471-43cc-9470-e3a2539198bb): drop table if exists acidTbl
2024-04-24T02:30:50,646  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-24T02:30:50,646  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:30:50,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:50,659  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,660  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:50,660  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:50,660  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:50,660  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, getValidTxns_(long)=1, rollbackTxn_(long)=14, getTable_(GetTableRequest)=11, flushCache_()=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:50,660  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023050_cd42a24a-e471-43cc-9470-e3a2539198bb); Time taken: 0.019 seconds
2024-04-24T02:30:50,660  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023050_cd42a24a-e471-43cc-9470-e3a2539198bb
2024-04-24T02:30:50,661  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023050_cd42a24a-e471-43cc-9470-e3a2539198bb
2024-04-24T02:30:50,685  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023050_cd42a24a-e471-43cc-9470-e3a2539198bb LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:30:50,685  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:30:50,685  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023050_cd42a24a-e471-43cc-9470-e3a2539198bb): drop table if exists acidTbl
2024-04-24T02:30:50,685  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:50,685  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:50,698  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:50,708  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:30:50,934  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:50,934  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=13, dropTable_(String, String, boolean, boolean, boolean)=235}
2024-04-24T02:30:50,934  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023050_cd42a24a-e471-43cc-9470-e3a2539198bb); Time taken: 0.249 seconds
2024-04-24T02:30:50,934  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023050_cd42a24a-e471-43cc-9470-e3a2539198bb
2024-04-24T02:30:50,940  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:30:50,951  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:50,953  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:30:50,953  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:30:50,954  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023050_e2f5988b-94ef-49b3-bd0b-ef59bb8e4d8f): drop table if exists acidTblPart
2024-04-24T02:30:50,957  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-24T02:30:50,958  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:30:50,959  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:30:50,976  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:50,976  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:50,977  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:50,977  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:50,977  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=18, getTable_(GetTableRequest)=17, flushCache_()=0, isCompatibleWith_(Configuration)=2}
2024-04-24T02:30:50,977  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023050_e2f5988b-94ef-49b3-bd0b-ef59bb8e4d8f); Time taken: 0.023 seconds
2024-04-24T02:30:50,978  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023050_e2f5988b-94ef-49b3-bd0b-ef59bb8e4d8f
2024-04-24T02:30:50,979  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023050_e2f5988b-94ef-49b3-bd0b-ef59bb8e4d8f
2024-04-24T02:30:51,003  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023050_e2f5988b-94ef-49b3-bd0b-ef59bb8e4d8f LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:30:51,003  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:30:51,003  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023050_e2f5988b-94ef-49b3-bd0b-ef59bb8e4d8f): drop table if exists acidTblPart
2024-04-24T02:30:51,003  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:51,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:30:51,013  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,013  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:30:51,024  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,025  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:30:51,090  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:51,091  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=77, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9}
2024-04-24T02:30:51,091  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023050_e2f5988b-94ef-49b3-bd0b-ef59bb8e4d8f); Time taken: 0.087 seconds
2024-04-24T02:30:51,091  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023050_e2f5988b-94ef-49b3-bd0b-ef59bb8e4d8f
2024-04-24T02:30:51,097  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:30:51,104  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:51,104  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:30:51,105  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:30:51,106  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023051_14acb927-f4a0-4bb5-9736-4ac426f877d4): drop table if exists acidTbl2
2024-04-24T02:30:51,110  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-24T02:30:51,110  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:30:51,112  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:51,112  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:51,112  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:51,113  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0}
2024-04-24T02:30:51,113  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023051_14acb927-f4a0-4bb5-9736-4ac426f877d4); Time taken: 0.006 seconds
2024-04-24T02:30:51,113  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023051_14acb927-f4a0-4bb5-9736-4ac426f877d4
2024-04-24T02:30:51,114  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:30:51,114  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023051_14acb927-f4a0-4bb5-9736-4ac426f877d4): drop table if exists acidTbl2
2024-04-24T02:30:51,114  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:51,115  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:30:51,116  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:51,116  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:51,116  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023051_14acb927-f4a0-4bb5-9736-4ac426f877d4); Time taken: 0.002 seconds
2024-04-24T02:30:51,116  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023051_14acb927-f4a0-4bb5-9736-4ac426f877d4
2024-04-24T02:30:51,123  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:30:51,132  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:51,132  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:30:51,133  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:30:51,133  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023051_c99c3f34-a7f6-49a7-bba2-e85e681e1e1a): drop table if exists nonAcidOrcTbl
2024-04-24T02:30:51,137  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-24T02:30:51,138  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:30:51,139  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:51,169  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,169  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:51,169  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:51,169  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:51,170  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=16, getTable_(GetTableRequest)=30}
2024-04-24T02:30:51,170  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023051_c99c3f34-a7f6-49a7-bba2-e85e681e1e1a); Time taken: 0.036 seconds
2024-04-24T02:30:51,170  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023051_c99c3f34-a7f6-49a7-bba2-e85e681e1e1a
2024-04-24T02:30:51,171  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023051_c99c3f34-a7f6-49a7-bba2-e85e681e1e1a
2024-04-24T02:30:51,192  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023051_c99c3f34-a7f6-49a7-bba2-e85e681e1e1a LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:30:51,192  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:30:51,192  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023051_c99c3f34-a7f6-49a7-bba2-e85e681e1e1a): drop table if exists nonAcidOrcTbl
2024-04-24T02:30:51,192  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:51,192  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:51,206  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:51,221  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:30:51,357  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:51,357  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, dropTable_(String, String, boolean, boolean, boolean)=149, isCompatibleWith_(Configuration)=0}
2024-04-24T02:30:51,357  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023051_c99c3f34-a7f6-49a7-bba2-e85e681e1e1a); Time taken: 0.165 seconds
2024-04-24T02:30:51,357  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023051_c99c3f34-a7f6-49a7-bba2-e85e681e1e1a
2024-04-24T02:30:51,362  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:30:51,370  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:51,370  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:30:51,371  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:30:51,372  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023051_c50212e5-0649-49eb-b725-4bbc731902d9): drop table if exists nonAcidOrcTbl2
2024-04-24T02:30:51,382  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-24T02:30:51,382  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:30:51,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:30:51,398  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,399  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:51,399  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:51,399  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:51,399  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=9, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14}
2024-04-24T02:30:51,399  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023051_c50212e5-0649-49eb-b725-4bbc731902d9); Time taken: 0.027 seconds
2024-04-24T02:30:51,400  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023051_c50212e5-0649-49eb-b725-4bbc731902d9
2024-04-24T02:30:51,400  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023051_c50212e5-0649-49eb-b725-4bbc731902d9
2024-04-24T02:30:51,421  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023051_c50212e5-0649-49eb-b725-4bbc731902d9 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:30:51,421  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:30:51,421  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023051_c50212e5-0649-49eb-b725-4bbc731902d9): drop table if exists nonAcidOrcTbl2
2024-04-24T02:30:51,422  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:51,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:30:51,439  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:30:51,451  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:30:51,494  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:51,494  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=17, dropTable_(String, String, boolean, boolean, boolean)=55}
2024-04-24T02:30:51,494  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023051_c50212e5-0649-49eb-b725-4bbc731902d9); Time taken: 0.073 seconds
2024-04-24T02:30:51,494  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023051_c50212e5-0649-49eb-b725-4bbc731902d9
2024-04-24T02:30:51,499  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:30:51,506  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:51,506  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:30:51,507  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:30:51,507  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023051_fbc3d66d-e951-4532-a233-fa88394777e7): drop table if exists nonAcidNonBucket
2024-04-24T02:30:51,510  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-24T02:30:51,511  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:30:51,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:30:51,524  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,524  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:30:51,524  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:30:51,524  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:30:51,524  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=12, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1}
2024-04-24T02:30:51,525  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023051_fbc3d66d-e951-4532-a233-fa88394777e7); Time taken: 0.017 seconds
2024-04-24T02:30:51,525  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023051_fbc3d66d-e951-4532-a233-fa88394777e7
2024-04-24T02:30:51,525  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023051_fbc3d66d-e951-4532-a233-fa88394777e7
2024-04-24T02:30:51,544  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023051_fbc3d66d-e951-4532-a233-fa88394777e7 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:30:51,544  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:30:51,545  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023051_fbc3d66d-e951-4532-a233-fa88394777e7): drop table if exists nonAcidNonBucket
2024-04-24T02:30:51,545  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:30:51,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:30:51,559  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,559  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:30:51,572  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:30:51,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:30:51,622  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:30:51,623  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=14, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=63}
2024-04-24T02:30:51,623  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023051_fbc3d66d-e951-4532-a233-fa88394777e7); Time taken: 0.077 seconds
2024-04-24T02:30:51,623  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023051_fbc3d66d-e951-4532-a233-fa88394777e7
2024-04-24T02:30:51,628  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:30:51,636  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:30:51,637  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:30:51,637  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeCase" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.186"/>
  <testcase name="testSetClauseFakeColumn" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.687"/>
  <testcase name="testBadOnClause" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.339"/>
  <testcase name="testSimpleAcidInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="9.1"/>
  <testcase name="testTxnStatsOnOff" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="6.614"/>
  <testcase name="testMergeUpdateDeleteNoCardCheck" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.892">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:31:15,659  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:31:15,659  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:31:15,659  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:31:15,659  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:31:15,659  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:31:15,659  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:31:15,660  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:31:15,660  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:31:15,660  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:31:15,660  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:31:15,660  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:31:15,662  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 80bc0b93-cfda-4cef-aa7b-2d88e2277a11
2024-04-24T02:31:15,665  INFO [main] SessionState: Hive Session ID = 80bc0b93-cfda-4cef-aa7b-2d88e2277a11
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:31:15,665  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:31:15,671  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/80bc0b93-cfda-4cef-aa7b-2d88e2277a11
2024-04-24T02:31:15,673  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11
2024-04-24T02:31:15,675  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/_tmp_space.db
2024-04-24T02:31:15,676  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=80bc0b93-cfda-4cef-aa7b-2d88e2277a11, clientType=HIVECLI]
2024-04-24T02:31:15,676  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:31:15,676  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_492ff834-cecf-48a5-ac42-02dc037d44c8): drop table if exists acidTbl
2024-04-24T02:31:15,685  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:31:15,685  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:31:15,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:15,691  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,691  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=2}
2024-04-24T02:31:15,691  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_492ff834-cecf-48a5-ac42-02dc037d44c8); Time taken: 0.015 seconds
2024-04-24T02:31:15,691  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023115_492ff834-cecf-48a5-ac42-02dc037d44c8
2024-04-24T02:31:15,692  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:15,692  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_492ff834-cecf-48a5-ac42-02dc037d44c8): drop table if exists acidTbl
2024-04-24T02:31:15,692  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,692  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:15,695  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:15,695  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:15,695  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_492ff834-cecf-48a5-ac42-02dc037d44c8); Time taken: 0.003 seconds
2024-04-24T02:31:15,696  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_492ff834-cecf-48a5-ac42-02dc037d44c8
2024-04-24T02:31:15,702  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:31:15,708  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:15,708  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:31:15,709  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:31:15,710  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_d126574e-77a9-424c-8a5c-ba3ed8bb890d): drop table if exists acidTblPart
2024-04-24T02:31:15,713  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:31:15,713  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:31:15,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:15,717  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,717  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,717  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,717  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3}
2024-04-24T02:31:15,718  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_d126574e-77a9-424c-8a5c-ba3ed8bb890d); Time taken: 0.007 seconds
2024-04-24T02:31:15,718  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023115_d126574e-77a9-424c-8a5c-ba3ed8bb890d
2024-04-24T02:31:15,718  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:15,718  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_d126574e-77a9-424c-8a5c-ba3ed8bb890d): drop table if exists acidTblPart
2024-04-24T02:31:15,718  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:15,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:15,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:15,722  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_d126574e-77a9-424c-8a5c-ba3ed8bb890d); Time taken: 0.003 seconds
2024-04-24T02:31:15,722  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_d126574e-77a9-424c-8a5c-ba3ed8bb890d
2024-04-24T02:31:15,727  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:31:15,733  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:15,733  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:31:15,734  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:31:15,734  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_91b9d512-73ff-42a7-8bcd-f9496b864d0d): drop table if exists acidTbl2
2024-04-24T02:31:15,736  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:31:15,737  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:31:15,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:31:15,740  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,741  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,741  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,741  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:31:15,741  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_91b9d512-73ff-42a7-8bcd-f9496b864d0d); Time taken: 0.007 seconds
2024-04-24T02:31:15,741  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023115_91b9d512-73ff-42a7-8bcd-f9496b864d0d
2024-04-24T02:31:15,741  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:15,741  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_91b9d512-73ff-42a7-8bcd-f9496b864d0d): drop table if exists acidTbl2
2024-04-24T02:31:15,742  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:31:15,745  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:15,745  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:15,746  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_91b9d512-73ff-42a7-8bcd-f9496b864d0d); Time taken: 0.004 seconds
2024-04-24T02:31:15,746  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_91b9d512-73ff-42a7-8bcd-f9496b864d0d
2024-04-24T02:31:15,751  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:31:15,756  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:15,756  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:31:15,757  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:31:15,757  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_2f6334b3-3bb6-4d65-9761-b3d9e2737cc4): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:15,759  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:31:15,759  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:31:15,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:15,763  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,763  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,763  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,764  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:15,764  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_2f6334b3-3bb6-4d65-9761-b3d9e2737cc4); Time taken: 0.006 seconds
2024-04-24T02:31:15,764  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023115_2f6334b3-3bb6-4d65-9761-b3d9e2737cc4
2024-04-24T02:31:15,764  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:15,764  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_2f6334b3-3bb6-4d65-9761-b3d9e2737cc4): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:15,764  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,765  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:15,768  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:15,768  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:15,768  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_2f6334b3-3bb6-4d65-9761-b3d9e2737cc4); Time taken: 0.004 seconds
2024-04-24T02:31:15,768  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_2f6334b3-3bb6-4d65-9761-b3d9e2737cc4
2024-04-24T02:31:15,773  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:31:15,779  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:15,779  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:31:15,779  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:15,780  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_45cb4915-95dd-43bf-92a6-01b151519c62): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:15,782  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:31:15,782  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:31:15,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:15,785  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,785  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,785  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,786  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2}
2024-04-24T02:31:15,786  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_45cb4915-95dd-43bf-92a6-01b151519c62); Time taken: 0.005 seconds
2024-04-24T02:31:15,786  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023115_45cb4915-95dd-43bf-92a6-01b151519c62
2024-04-24T02:31:15,786  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:15,786  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_45cb4915-95dd-43bf-92a6-01b151519c62): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:15,786  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,787  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:15,789  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:15,790  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:15,790  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_45cb4915-95dd-43bf-92a6-01b151519c62); Time taken: 0.003 seconds
2024-04-24T02:31:15,790  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_45cb4915-95dd-43bf-92a6-01b151519c62
2024-04-24T02:31:15,795  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:31:15,800  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:15,800  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:31:15,801  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:31:15,801  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_6c7915ab-a6ef-4e05-8d1b-c72f0c795140): drop table if exists nonAcidNonBucket
2024-04-24T02:31:15,803  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:31:15,803  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:31:15,804  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:15,807  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,807  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,807  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,807  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:31:15,808  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_6c7915ab-a6ef-4e05-8d1b-c72f0c795140); Time taken: 0.006 seconds
2024-04-24T02:31:15,808  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023115_6c7915ab-a6ef-4e05-8d1b-c72f0c795140
2024-04-24T02:31:15,808  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:15,808  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_6c7915ab-a6ef-4e05-8d1b-c72f0c795140): drop table if exists nonAcidNonBucket
2024-04-24T02:31:15,808  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:15,811  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:15,812  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:15,812  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_6c7915ab-a6ef-4e05-8d1b-c72f0c795140); Time taken: 0.003 seconds
2024-04-24T02:31:15,812  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_6c7915ab-a6ef-4e05-8d1b-c72f0c795140
2024-04-24T02:31:15,817  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:31:15,822  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:15,822  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:31:15,823  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:15,823  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_dcf4fff1-b91d-4602-9749-9a20c12bf718): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:15,826  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:31:15,826  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:31:15,826  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:15,826  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:15,831  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:31:15,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:15,833  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:15,833  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,833  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,834  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,834  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getDatabase_(String)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:31:15,834  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_dcf4fff1-b91d-4602-9749-9a20c12bf718); Time taken: 0.011 seconds
2024-04-24T02:31:15,834  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023115_dcf4fff1-b91d-4602-9749-9a20c12bf718
2024-04-24T02:31:15,834  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023115_dcf4fff1-b91d-4602-9749-9a20c12bf718
2024-04-24T02:31:15,852  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023115_dcf4fff1-b91d-4602-9749-9a20c12bf718 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:31:15,852  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:15,852  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_dcf4fff1-b91d-4602-9749-9a20c12bf718): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:15,853  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951075, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, totalSize=0, rawDataSize=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:15,860  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:15,897  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:15,897  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=44}
2024-04-24T02:31:15,898  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_dcf4fff1-b91d-4602-9749-9a20c12bf718); Time taken: 0.045 seconds
2024-04-24T02:31:15,898  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_dcf4fff1-b91d-4602-9749-9a20c12bf718
2024-04-24T02:31:15,902  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:31:15,908  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:15,908  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:31:15,909  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:15,909  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_42d42e01-cb83-4444-bfa4-44a82542eb2c): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:15,911  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:31:15,911  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:31:15,912  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:15,912  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:15,915  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:31:15,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:15,917  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:15,917  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,918  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,918  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,918  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:15,918  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_42d42e01-cb83-4444-bfa4-44a82542eb2c); Time taken: 0.009 seconds
2024-04-24T02:31:15,918  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023115_42d42e01-cb83-4444-bfa4-44a82542eb2c
2024-04-24T02:31:15,919  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023115_42d42e01-cb83-4444-bfa4-44a82542eb2c
2024-04-24T02:31:15,933  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023115_42d42e01-cb83-4444-bfa4-44a82542eb2c LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:31:15,933  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:15,933  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_42d42e01-cb83-4444-bfa4-44a82542eb2c): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:15,933  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951075, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:15,940  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:31:15,956  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:15,956  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:15,956  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_42d42e01-cb83-4444-bfa4-44a82542eb2c); Time taken: 0.023 seconds
2024-04-24T02:31:15,956  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_42d42e01-cb83-4444-bfa4-44a82542eb2c
2024-04-24T02:31:15,960  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:31:15,965  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:15,966  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:31:15,966  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:15,966  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023115_d2731b58-9701-4a91-b32c-0a8de39ee4e0): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:15,968  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:31:15,969  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:31:15,969  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:15,969  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:15,972  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:31:15,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:15,974  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:15,974  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:15,974  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:15,974  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:15,974  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:15,974  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023115_d2731b58-9701-4a91-b32c-0a8de39ee4e0); Time taken: 0.008 seconds
2024-04-24T02:31:15,974  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023115_d2731b58-9701-4a91-b32c-0a8de39ee4e0
2024-04-24T02:31:15,975  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023115_d2731b58-9701-4a91-b32c-0a8de39ee4e0
2024-04-24T02:31:15,994  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023115_d2731b58-9701-4a91-b32c-0a8de39ee4e0 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:31:15,994  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:15,994  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023115_d2731b58-9701-4a91-b32c-0a8de39ee4e0): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:15,994  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:15,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951075, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0, bucketing_version=2, rawDataSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:16,005  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:31:16,029  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:16,030  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=34}
2024-04-24T02:31:16,030  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023115_d2731b58-9701-4a91-b32c-0a8de39ee4e0); Time taken: 0.035 seconds
2024-04-24T02:31:16,030  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023115_d2731b58-9701-4a91-b32c-0a8de39ee4e0
2024-04-24T02:31:16,035  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:31:16,041  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:16,041  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:31:16,042  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:16,042  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_a9c16fa3-0dbb-4676-bbec-e7966f708dec): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:16,045  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:31:16,045  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:31:16,046  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:16,046  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:16,048  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:31:16,048  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:16,050  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:16,050  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:16,050  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:16,050  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:16,050  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:16,051  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_a9c16fa3-0dbb-4676-bbec-e7966f708dec); Time taken: 0.008 seconds
2024-04-24T02:31:16,051  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023116_a9c16fa3-0dbb-4676-bbec-e7966f708dec
2024-04-24T02:31:16,051  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_a9c16fa3-0dbb-4676-bbec-e7966f708dec
2024-04-24T02:31:16,066  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_a9c16fa3-0dbb-4676-bbec-e7966f708dec LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:31:16,066  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:16,066  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_a9c16fa3-0dbb-4676-bbec-e7966f708dec): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:16,067  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:16,068  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951076, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFiles=0, numFilesErasureCoded=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:16,074  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:31:16,090  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:16,090  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-24T02:31:16,090  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_a9c16fa3-0dbb-4676-bbec-e7966f708dec); Time taken: 0.024 seconds
2024-04-24T02:31:16,091  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_a9c16fa3-0dbb-4676-bbec-e7966f708dec
2024-04-24T02:31:16,095  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:31:16,101  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:16,101  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:31:16,102  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:16,102  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_e38ee8d7-f27a-4557-998b-6cc9982acb62): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:16,105  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:31:16,105  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:31:16,105  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:16,105  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:16,108  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:31:16,108  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:16,110  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:16,110  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:16,110  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:16,110  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:16,110  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2}
2024-04-24T02:31:16,110  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_e38ee8d7-f27a-4557-998b-6cc9982acb62); Time taken: 0.008 seconds
2024-04-24T02:31:16,111  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023116_e38ee8d7-f27a-4557-998b-6cc9982acb62
2024-04-24T02:31:16,111  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_e38ee8d7-f27a-4557-998b-6cc9982acb62
2024-04-24T02:31:16,126  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_e38ee8d7-f27a-4557-998b-6cc9982acb62 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:31:16,126  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:16,126  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_e38ee8d7-f27a-4557-998b-6cc9982acb62): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:16,127  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:16,128  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/_tmp_space.db/90d058da-898e-4390-988c-a06bcaa16737
2024-04-24T02:31:16,131  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:16,131  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:16,131  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_e38ee8d7-f27a-4557-998b-6cc9982acb62); Time taken: 0.005 seconds
2024-04-24T02:31:16,131  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_e38ee8d7-f27a-4557-998b-6cc9982acb62
2024-04-24T02:31:16,135  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:31:16,142  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:16,142  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:31:16,143  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:16,143  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_f3240273-6978-4f39-a015-462b0b631ed3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:16,145  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:31:16,146  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:31:16,146  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:16,146  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:16,149  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:31:16,149  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:16,151  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:16,151  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:16,151  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:16,151  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:16,151  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3}
2024-04-24T02:31:16,152  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_f3240273-6978-4f39-a015-462b0b631ed3); Time taken: 0.008 seconds
2024-04-24T02:31:16,152  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023116_f3240273-6978-4f39-a015-462b0b631ed3
2024-04-24T02:31:16,152  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_f3240273-6978-4f39-a015-462b0b631ed3
2024-04-24T02:31:16,168  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_f3240273-6978-4f39-a015-462b0b631ed3 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:31:16,168  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:16,169  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_f3240273-6978-4f39-a015-462b0b631ed3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:16,169  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:16,170  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951076, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, totalSize=0, rawDataSize=0, transactional=false, numRows=0, bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:16,176  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:31:16,192  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:16,192  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:16,192  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_f3240273-6978-4f39-a015-462b0b631ed3); Time taken: 0.023 seconds
2024-04-24T02:31:16,192  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_f3240273-6978-4f39-a015-462b0b631ed3
2024-04-24T02:31:16,197  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:31:16,204  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:16,204  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:31:16,206  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:31:16,206  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:31:16,209  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:31:16,209  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:31:16,210  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:16,210  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:16,214  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:16,254  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:16,254  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:16,254  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:16,254  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:16,254  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:16,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:16,264  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:16,265  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:16,265  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:31:16,287  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:16,365  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:16,365  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:16,366  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:16,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:16,370  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:16,370  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:16,370  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:16,373  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1
2024-04-24T02:31:16,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:16,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:16,382  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:31:16,387  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:31:16,388  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:31:16,388  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:31:16,389  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:31:16,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:16,409  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:16,410  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:31:16,410  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:16,410  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:16,410  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:31:16,410  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:16,410  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, getAllTableConstraints_(AllTableConstraintsRequest)=29, getTable_(GetTableRequest)=62, getCheckConstraints_(CheckConstraintsRequest)=2, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:31:16,410  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.204 seconds
2024-04-24T02:31:16,410  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:16,411  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:16,432  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:31:16,432  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:31:16,432  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:31:16,432  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:16,432  INFO [main] ql.Driver: Query ID = alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
Total jobs = 1
2024-04-24T02:31:16,432  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:31:16,432  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:31:16,585  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:31:16,585  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:31:16,585  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:31:16,585  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:31:16,585  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:31:16,585  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:31:16,585  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:31:16,585  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:31:16,587  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:31:16,588  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:31:16,588  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-16_206_6276495094801365740-1/dummy_path
2024-04-24T02:31:16,597  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:31:16,598  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,01KB
2024-04-24T02:31:16,603  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:31:16,604  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:31:16,605  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:16,609  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-16_206_6276495094801365740-1/-mr-10001
2024-04-24T02:31:16,614  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:16,622  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:31:16,626  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:31:16,628  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:31:16,628  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:31:16,628  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-16_206_6276495094801365740-1/dummy_path
2024-04-24T02:31:16,628  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:31:16,647  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:31:16,667  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1157526488_0013
2024-04-24T02:31:16,667  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:31:16,754  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:31:16,754  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:31:16,755  INFO [Thread-1078] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:16,755  INFO [Thread-1078] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:16,757  INFO [Thread-1078] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:31:16,757  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1157526488_0013_m_000000_0
2024-04-24T02:31:16,759  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:16,760  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-16_206_6276495094801365740-1/dummy_path/null:0+1
2024-04-24T02:31:16,762  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:31:16,762  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,01KB
2024-04-24T02:31:16,763  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:31:16,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:31:16,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:31:16,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:31:16,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:31:16,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:31:16,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:31:16,768  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:31:16,768  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:31:16,769  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:31:16,769  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:31:16,769  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:31:16,769  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:31:16,769  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:31:16,769  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:31:16,769  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:31:16,769  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:31:16,770  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:31:16,770  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:31:16,770  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:31:16,770  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:31:16,770  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:31:16,770  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-24T02:31:16,770  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-24T02:31:16,771  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-24T02:31:16,773  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:31:16,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:31:16,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:31:16,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-24T02:31:16,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-24T02:31:16,784  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:31:16,788  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1157526488_0013_m_000000_0 is done. And is in the process of committing
2024-04-24T02:31:16,789  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:31:16,789  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1157526488_0013_m_000000_0' done.
2024-04-24T02:31:16,789  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1157526488_0013_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=292923
		FILE: Number of bytes written=15327813
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1160773632
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5058
2024-04-24T02:31:16,789  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1157526488_0013_m_000000_0
2024-04-24T02:31:16,789  INFO [Thread-1078] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:31:16,790  INFO [Thread-1078] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:31:16,790  INFO [pool-69-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1157526488_0013_r_000000_0
2024-04-24T02:31:16,792  INFO [pool-69-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:16,792  INFO [pool-69-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@334141e2
2024-04-24T02:31:16,792  WARN [pool-69-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:16,793  INFO [pool-69-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:16,794  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1157526488_0013_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:16,796  INFO [localfetcher#18] reduce.LocalFetcher: localfetcher#18 about to shuffle output of map attempt_local1157526488_0013_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:31:16,796  INFO [localfetcher#18] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1157526488_0013_m_000000_0
2024-04-24T02:31:16,796  INFO [localfetcher#18] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:31:16,796  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:16,797  INFO [pool-69-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:16,797  INFO [pool-69-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:16,803  INFO [pool-69-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:16,803  INFO [pool-69-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:31:16,805  INFO [pool-69-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:16,805  INFO [pool-69-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:31:16,805  INFO [pool-69-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:16,805  INFO [pool-69-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:16,805  INFO [pool-69-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:31:16,806  INFO [pool-69-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:16,806  INFO [pool-69-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:16,806  INFO [pool-69-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:31:16,807  INFO [pool-69-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:16,807  INFO [pool-69-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:16,807  INFO [pool-69-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:16,807  INFO [pool-69-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:16,808  INFO [pool-69-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1157526488_0013/job_local1157526488_0013.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7652d0b8
2024-04-24T02:31:16,808  INFO [pool-69-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_tmp.-ext-10000/000000_0
2024-04-24T02:31:16,808  INFO [pool-69-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-24T02:31:16,808  INFO [pool-69-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_tmp.-ext-10000/000000_0
2024-04-24T02:31:16,808  INFO [pool-69-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:16,809  INFO [pool-69-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T02:31:16,815  INFO [pool-69-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T02:31:16,815  INFO [pool-69-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:16,815  INFO [pool-69-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:16,815  INFO [pool-69-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:16,815  INFO [pool-69-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:16,822  INFO [pool-69-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.nonacidorctbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-24T02:31:16,822  INFO [pool-69-thread-1] mapred.Task: Task:attempt_local1157526488_0013_r_000000_0 is done. And is in the process of committing
2024-04-24T02:31:16,822  INFO [pool-69-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:16,822  INFO [pool-69-thread-1] mapred.Task: Task 'attempt_local1157526488_0013_r_000000_0' done.
2024-04-24T02:31:16,822  INFO [pool-69-thread-1] mapred.Task: Final Counters for attempt_local1157526488_0013_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=299504
		FILE: Number of bytes written=15328179
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1160773632
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:16,823  INFO [pool-69-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1157526488_0013_r_000000_0
2024-04-24T02:31:16,823  INFO [pool-69-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1157526488_0013_r_000001_0
2024-04-24T02:31:16,823  INFO [pool-69-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:16,823  INFO [pool-69-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@dffee1d
2024-04-24T02:31:16,823  WARN [pool-69-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:16,824  INFO [pool-69-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:16,825  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1157526488_0013_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:16,827  INFO [localfetcher#19] reduce.LocalFetcher: localfetcher#19 about to shuffle output of map attempt_local1157526488_0013_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-24T02:31:16,827  INFO [localfetcher#19] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local1157526488_0013_m_000000_0
2024-04-24T02:31:16,827  INFO [localfetcher#19] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-24T02:31:16,828  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:16,828  INFO [pool-69-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:16,828  INFO [pool-69-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:16,834  INFO [pool-69-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:16,834  INFO [pool-69-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-24T02:31:16,836  INFO [pool-69-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:16,837  INFO [pool-69-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-24T02:31:16,837  INFO [pool-69-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:16,837  INFO [pool-69-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:16,837  INFO [pool-69-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-24T02:31:16,837  INFO [pool-69-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:16,837  INFO [pool-69-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:16,838  INFO [pool-69-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:31:16,839  INFO [pool-69-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:16,839  INFO [pool-69-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:16,839  INFO [pool-69-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:16,839  INFO [pool-69-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:16,839  INFO [pool-69-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1157526488_0013/job_local1157526488_0013.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@60d511ba
2024-04-24T02:31:16,840  INFO [pool-69-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_tmp.-ext-10000/000001_0
2024-04-24T02:31:16,840  INFO [pool-69-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-24T02:31:16,840  INFO [pool-69-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_tmp.-ext-10000/000001_0
2024-04-24T02:31:16,840  INFO [pool-69-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:16,840  INFO [pool-69-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T02:31:16,845  INFO [pool-69-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T02:31:16,846  INFO [pool-69-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:16,846  INFO [pool-69-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:3, 
2024-04-24T02:31:16,846  INFO [pool-69-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:16,846  INFO [pool-69-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-24T02:31:16,852  INFO [pool-69-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:3, RECORDS_OUT_OPERATOR_FS_6:3, RECORDS_OUT_1_default.nonacidorctbl:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:16,853  INFO [pool-69-thread-1] mapred.Task: Task:attempt_local1157526488_0013_r_000001_0 is done. And is in the process of committing
2024-04-24T02:31:16,853  INFO [pool-69-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:16,853  INFO [pool-69-thread-1] mapred.Task: Task 'attempt_local1157526488_0013_r_000001_0' done.
2024-04-24T02:31:16,853  INFO [pool-69-thread-1] mapred.Task: Final Counters for attempt_local1157526488_0013_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=306097
		FILE: Number of bytes written=15328598
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1160773632
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:16,853  INFO [pool-69-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1157526488_0013_r_000001_0
2024-04-24T02:31:16,853  INFO [Thread-1078] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:31:17,759 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:31:17,759  INFO [main] exec.Task: 2024-04-24 02:31:17,759 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1157526488_0013
2024-04-24T02:31:17,761  INFO [main] exec.Task: Ended Job = job_local1157526488_0013
2024-04-24T02:31:17,763  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-24T02:31:17,763  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1/-ext-10000
2024-04-24T02:31:17,763  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:17,773  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:17,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:17,783  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:17,785  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-24T02:31:17,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-24T02:31:17,817  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:31:17,817  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:17,826  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:17,826  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:31:17,826  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-16_206_6276495094801365740-1/-mr-10001
2024-04-24T02:31:17,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:17,838  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:17,838  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-24T02:31:17,838  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-24T02:31:17,839  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-24T02:31:17,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-24T02:31:17,865  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-24T02:31:17,865  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:17,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=57, getTable_(GetTableRequest)=39, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:31:17,866  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:31:17,866  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:17,866  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:17,866  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 1.433 seconds
2024-04-24T02:31:17,866  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:17,870  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:31:17,875  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:17,875  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:31:17,876  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:31:17,876  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-16_206_6276495094801365740-1
2024-04-24T02:31:17,877  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-16_206_6276495094801365740-1 on fs with scheme file
2024-04-24T02:31:17,877  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1
2024-04-24T02:31:17,877  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-16_206_6276495094801365740-1 on fs with scheme file
2024-04-24T02:31:17,877  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:31:17,879  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:31:17,880  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:31:17,880  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:17,880  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:17,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:17,889  INFO [main] metastore.ObjectStore: Removed COLUMN_STATS_ACCURATE from Table's parameters.
2024-04-24T02:31:17,891  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:17,891  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:17,891  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:17,891  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:17,891  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:17,891  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:17,900  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:17,900  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:17,901  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:31:17,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:17,973  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:17,973  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:17,973  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:17,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:17,975  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:17,975  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:17,976  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:17,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:17,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:17,986  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-24T02:31:17,987  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-24T02:31:17,988  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:31:17,991  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:31:17,992  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:31:17,993  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:31:17,993  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:31:18,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:18,010  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:18,010  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:31:18,010  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:18,010  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:18,010  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:31:18,010  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:18,010  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=3, getNotNullConstraints_(NotNullConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=10, getAllTableConstraints_(AllTableConstraintsRequest)=6, getTable_(GetTableRequest)=25, allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T02:31:18,010  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.133 seconds
2024-04-24T02:31:18,011  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:18,011  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:18,027  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:31:18,027  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:31:18,029  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:31:18,029  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:18,029  INFO [main] ql.Driver: Query ID = alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
Total jobs = 1
2024-04-24T02:31:18,029  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:31:18,029  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:31:18,173  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:31:18,173  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:31:18,173  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:31:18,173  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:31:18,173  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:31:18,173  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:31:18,173  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:31:18,173  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:31:18,176  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:31:18,176  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:31:18,176  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-17_877_3255510361662690738-1/dummy_path
2024-04-24T02:31:18,185  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:31:18,185  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,03KB
2024-04-24T02:31:18,190  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:31:18,191  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:31:18,192  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:18,196  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-17_877_3255510361662690738-1/-mr-10000
2024-04-24T02:31:18,197  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:18,204  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:31:18,209  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:31:18,210  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:31:18,210  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:31:18,210  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-17_877_3255510361662690738-1/dummy_path
2024-04-24T02:31:18,210  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:31:18,227  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:31:18,246  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local169806006_0014
2024-04-24T02:31:18,246  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:31:18,342  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:31:18,343  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:31:18,343  INFO [Thread-1141] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:18,343  INFO [Thread-1141] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:18,344  INFO [Thread-1141] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:31:18,345  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local169806006_0014_m_000000_0
2024-04-24T02:31:18,345  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:18,346  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-17_877_3255510361662690738-1/dummy_path/null:0+1
2024-04-24T02:31:18,346  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:31:18,347  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,03KB
2024-04-24T02:31:18,347  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:31:18,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:31:18,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:31:18,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:31:18,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:31:18,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:31:18,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:31:18,361  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:31:18,361  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:31:18,361  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:31:18,361  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:31:18,362  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:31:18,362  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:31:18,362  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:31:18,362  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:31:18,362  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:31:18,362  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-24T02:31:18,363  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-24T02:31:18,364  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:31:18,364  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:31:18,364  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:31:18,364  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-24T02:31:18,364  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-24T02:31:18,375  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:31:18,378  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local169806006_0014_m_000000_0 is done. And is in the process of committing
2024-04-24T02:31:18,378  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:31:18,378  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local169806006_0014_m_000000_0' done.
2024-04-24T02:31:18,378  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local169806006_0014_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=311766
		FILE: Number of bytes written=16505542
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=8
		Total committed heap usage (bytes)=1159725056
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5078
2024-04-24T02:31:18,378  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local169806006_0014_m_000000_0
2024-04-24T02:31:18,379  INFO [Thread-1141] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:31:18,380  INFO [Thread-1141] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:31:18,380  INFO [pool-74-thread-1] mapred.LocalJobRunner: Starting task: attempt_local169806006_0014_r_000000_0
2024-04-24T02:31:18,380  INFO [pool-74-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:18,380  INFO [pool-74-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3df4ce75
2024-04-24T02:31:18,380  WARN [pool-74-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:18,381  INFO [pool-74-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:18,382  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local169806006_0014_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:18,383  INFO [localfetcher#20] reduce.LocalFetcher: localfetcher#20 about to shuffle output of map attempt_local169806006_0014_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:31:18,383  INFO [localfetcher#20] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local169806006_0014_m_000000_0
2024-04-24T02:31:18,383  INFO [localfetcher#20] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:31:18,384  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:18,384  INFO [pool-74-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:18,384  INFO [pool-74-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:18,392  INFO [pool-74-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:18,392  INFO [pool-74-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:31:18,394  INFO [pool-74-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:18,394  INFO [pool-74-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:31:18,394  INFO [pool-74-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:18,394  INFO [pool-74-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:18,394  INFO [pool-74-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:31:18,395  INFO [pool-74-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:18,395  INFO [pool-74-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:18,396  INFO [pool-74-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:31:18,397  INFO [pool-74-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:18,397  INFO [pool-74-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:18,397  INFO [pool-74-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:18,397  INFO [pool-74-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:18,398  INFO [pool-74-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local169806006_0014/job_local169806006_0014.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@a442062
2024-04-24T02:31:18,398  INFO [pool-74-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:18,398  INFO [pool-74-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:18,398  INFO [pool-74-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:31:18,399  INFO [pool-74-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:18,399  INFO [pool-74-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:31:18,406  INFO [pool-74-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:31:18,411  INFO [pool-74-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:18,411  INFO [pool-74-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:18,411  INFO [pool-74-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:18,411  INFO [pool-74-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:31:18,414  INFO [pool-74-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:31:18,427  INFO [pool-74-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T02:31:18,427  INFO [pool-74-thread-1] mapred.Task: Task:attempt_local169806006_0014_r_000000_0 is done. And is in the process of committing
2024-04-24T02:31:18,428  INFO [pool-74-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:18,428  INFO [pool-74-thread-1] mapred.Task: Task 'attempt_local169806006_0014_r_000000_0' done.
2024-04-24T02:31:18,428  INFO [pool-74-thread-1] mapred.Task: Final Counters for attempt_local169806006_0014_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=317968
		FILE: Number of bytes written=16506611
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1159725056
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:18,428  INFO [pool-74-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local169806006_0014_r_000000_0
2024-04-24T02:31:18,428  INFO [pool-74-thread-1] mapred.LocalJobRunner: Starting task: attempt_local169806006_0014_r_000001_0
2024-04-24T02:31:18,429  INFO [pool-74-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:18,429  INFO [pool-74-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@a905054
2024-04-24T02:31:18,429  WARN [pool-74-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:18,430  INFO [pool-74-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:18,430  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local169806006_0014_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:18,434  INFO [localfetcher#21] reduce.LocalFetcher: localfetcher#21 about to shuffle output of map attempt_local169806006_0014_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:31:18,434  INFO [localfetcher#21] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local169806006_0014_m_000000_0
2024-04-24T02:31:18,434  INFO [localfetcher#21] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:31:18,435  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:18,436  INFO [pool-74-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:18,436  INFO [pool-74-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:18,447  INFO [pool-74-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:18,447  INFO [pool-74-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:31:18,453  INFO [pool-74-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:18,453  INFO [pool-74-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:31:18,453  INFO [pool-74-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:18,453  INFO [pool-74-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:18,453  INFO [pool-74-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:31:18,454  INFO [pool-74-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:18,455  INFO [pool-74-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:18,456  INFO [pool-74-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:31:18,458  INFO [pool-74-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:18,458  INFO [pool-74-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:18,458  INFO [pool-74-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:18,458  INFO [pool-74-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:18,459  INFO [pool-74-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local169806006_0014/job_local169806006_0014.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3143f473
2024-04-24T02:31:18,460  INFO [pool-74-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:18,460  INFO [pool-74-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:18,460  INFO [pool-74-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:31:18,461  INFO [pool-74-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:18,461  INFO [pool-74-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:31:18,474  INFO [pool-74-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:31:18,474  INFO [pool-74-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:18,475  INFO [pool-74-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:18,475  INFO [pool-74-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:18,475  INFO [pool-74-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:31:18,480  INFO [pool-74-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:31:18,494  INFO [pool-74-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-24T02:31:18,495  INFO [pool-74-thread-1] mapred.Task: Task:attempt_local169806006_0014_r_000001_0 is done. And is in the process of committing
2024-04-24T02:31:18,495  INFO [pool-74-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:18,495  INFO [pool-74-thread-1] mapred.Task: Task 'attempt_local169806006_0014_r_000001_0' done.
2024-04-24T02:31:18,495  INFO [pool-74-thread-1] mapred.Task: Final Counters for attempt_local169806006_0014_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=324128
		FILE: Number of bytes written=16507681
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1159725056
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:18,495  INFO [pool-74-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local169806006_0014_r_000001_0
2024-04-24T02:31:18,495  INFO [Thread-1141] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:31:19,347 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:31:19,347  INFO [main] exec.Task: 2024-04-24 02:31:19,347 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local169806006_0014
2024-04-24T02:31:19,349  INFO [main] exec.Task: Ended Job = job_local169806006_0014
2024-04-24T02:31:19,350  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:31:19,350  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:31:19,350  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:31:19,351  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:31:19,351  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:31:19,352  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:31:19,352  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:19,353  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:19,360  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:19,369  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:31:19,396  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:31:19,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:19,402  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,402  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:31:19,403  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-17_877_3255510361662690738-1/-mr-10000
2024-04-24T02:31:19,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:19,411  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,422  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:31:19,422  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-24T02:31:19,422  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:31:19,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:31:19,444  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-24T02:31:19,444  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:31:19,444  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:31:19,446  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:31:19,447  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:19,447  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=48, getTable_(GetTableRequest)=29, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-24T02:31:19,447  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:31:19,447  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:19,447  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:19,447  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 1.418 seconds
2024-04-24T02:31:19,447  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:19,456  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:19,457  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:31:19,457  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE 
2024-04-24T02:31:19,457  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-17_877_3255510361662690738-1
2024-04-24T02:31:19,458  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-17_877_3255510361662690738-1 on fs with scheme file
2024-04-24T02:31:19,458  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE 
2024-04-24T02:31:19,461  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-24T02:31:19,461  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:31:19,461  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:19,462  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:19,468  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,469  INFO [main] parse.RewriteSemanticAnalyzer: Merge statement cardinality violation check is disabled: hive.merge.cardinality.check
2024-04-24T02:31:19,469  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE > as 
<FROM
  `default`.`acidTbl` `t`
  INNER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `t`.`a` > 3 and `t`.`a` < 5 AND NOT(`s`.`a` < 3)
 SORT BY `t`.ROW__ID 
>
2024-04-24T02:31:19,471  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:31:19,476  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:19,476  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:19,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:19,482  INFO [main] metastore.ObjectStore: Removed COLUMN_STATS_ACCURATE from Table's parameters.
2024-04-24T02:31:19,483  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,484  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:19,493  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,493  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:19,493  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:19,494  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:19,494  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:31:19,495  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:19,495  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:19,495  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:19,509  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:19,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:19,556  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:31:19,557  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:19,566  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,566  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:19,575  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,576  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:31:19,586  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-24T02:31:19,586  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-24T02:31:19,586  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:31:19,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:19,599  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:19,612  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,612  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-24T02:31:19,625  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: a
No Stats for default@nonacidorctbl, Columns: a
2024-04-24T02:31:19,625  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: a
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:19,824  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:19,834 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:31:19,835 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:31:19,835  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:31:19,836 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:31:19,836  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:19,836  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=24, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=11, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, getTableColumnStatistics_(String, String, List, String)=68, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:19,837  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.378 seconds
2024-04-24T02:31:19,837  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:19,840  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:19,846  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:31:19,847  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/80bc0b93-cfda-4cef-aa7b-2d88e2277a11/hive_2024-04-24_02-31-19_469_1053276581691955900-1
2024-04-24T02:31:19,847  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists acidTbl
2024-04-24T02:31:19,850  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-24T02:31:19,850  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:31:19,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:19,858  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,858  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:19,858  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:19,858  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:19,858  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-24T02:31:19,858  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.011 seconds
2024-04-24T02:31:19,858  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:19,859  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:19,873  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:31:19,873  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:19,873  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists acidTbl
2024-04-24T02:31:19,873  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:19,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:19,880  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,880  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:19,886  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:19,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:19,989  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:19,989  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=109}
2024-04-24T02:31:19,989  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.116 seconds
2024-04-24T02:31:19,989  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:19,993  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:31:19,999  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:19,999  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:31:20,000  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:31:20,000  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists acidTblPart
2024-04-24T02:31:20,009  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-24T02:31:20,009  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:31:20,012  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:20,022  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,022  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:20,022  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:20,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:20,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=2, getTable_(GetTableRequest)=10, openTxn_(String, TxnType)=8}
2024-04-24T02:31:20,023  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.022 seconds
2024-04-24T02:31:20,023  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,023  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,044  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:31:20,044  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:20,044  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists acidTblPart
2024-04-24T02:31:20,044  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:20,045  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:20,052  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,052  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:20,059  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:20,104  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:20,104  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=51, getTable_(GetTableRequest)=8}
2024-04-24T02:31:20,104  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.06 seconds
2024-04-24T02:31:20,104  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,108  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:31:20,113  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:20,114  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:31:20,114  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:31:20,114  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists acidTbl2
2024-04-24T02:31:20,116  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-24T02:31:20,117  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:31:20,117  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:20,117  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:20,118  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:20,118  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:31:20,118  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.004 seconds
2024-04-24T02:31:20,118  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,118  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:20,118  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists acidTbl2
2024-04-24T02:31:20,118  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:20,119  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:31:20,119  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:20,120  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:20,120  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.001 seconds
2024-04-24T02:31:20,120  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,125  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:31:20,130  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:20,130  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:31:20,131  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:31:20,131  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:20,134  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-24T02:31:20,134  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:31:20,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:20,156  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,156  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:20,156  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:20,156  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:20,156  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=22, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=1}
2024-04-24T02:31:20,156  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.025 seconds
2024-04-24T02:31:20,157  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,157  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,172  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:31:20,172  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:20,172  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:20,173  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:20,173  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:20,199  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:20,208  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,209  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:20,288  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:20,288  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=89, getTable_(GetTableRequest)=26}
2024-04-24T02:31:20,288  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.116 seconds
2024-04-24T02:31:20,288  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,293  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:31:20,299  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:20,299  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:31:20,300  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:20,300  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:20,302  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-24T02:31:20,302  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:31:20,303  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:20,312  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,312  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:20,312  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:20,312  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:20,313  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:20,313  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.012 seconds
2024-04-24T02:31:20,313  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,313  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,328  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:31:20,328  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:20,328  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:20,328  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:20,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:20,338  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,339  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:20,348  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:20,383  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:20,383  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=44, isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:20,384  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.055 seconds
2024-04-24T02:31:20,384  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,387  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:31:20,394  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:20,394  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:31:20,394  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:31:20,395  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists nonAcidNonBucket
2024-04-24T02:31:20,397  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-24T02:31:20,397  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:31:20,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:20,407  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,407  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:20,407  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:20,407  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:20,407  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T02:31:20,408  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.012 seconds
2024-04-24T02:31:20,408  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,408  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,423  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:31:20,423  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:20,423  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307): drop table if exists nonAcidNonBucket
2024-04-24T02:31:20,423  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:20,423  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:20,433  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:20,442  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:20,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:20,474  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:20,474  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=41, getTable_(GetTableRequest)=10}
2024-04-24T02:31:20,475  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307); Time taken: 0.051 seconds
2024-04-24T02:31:20,475  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023116_39135161-1549-459b-b9c9-e4a103039307
2024-04-24T02:31:20,478  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:31:20,483  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:20,484  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:31:20,484  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testNonAcidToAcidConversion01" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="14.973"/>
  <testcase name="testMoreBucketsThanReducers2" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="0">
    <skipped message="Moved to Tez"/>
  </testcase>
  <testcase name="testMergeDeleteUpdate" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.921">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:31:35,518  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:31:35,520  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = b3825a28-82ec-4abe-99dd-b1e5841cb070
2024-04-24T02:31:35,523  INFO [main] SessionState: Hive Session ID = b3825a28-82ec-4abe-99dd-b1e5841cb070
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:31:35,523  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:31:35,529  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b3825a28-82ec-4abe-99dd-b1e5841cb070
2024-04-24T02:31:35,531  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070
2024-04-24T02:31:35,533  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b3825a28-82ec-4abe-99dd-b1e5841cb070/_tmp_space.db
2024-04-24T02:31:35,534  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=b3825a28-82ec-4abe-99dd-b1e5841cb070, clientType=HIVECLI]
2024-04-24T02:31:35,534  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:31:35,534  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_d48276dd-a226-41f8-94ac-dda7f558d8e5): drop table if exists acidTbl
2024-04-24T02:31:35,544  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:31:35,544  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:31:35,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:35,552  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,552  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,552  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,553  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=9, flushCache_()=0}
2024-04-24T02:31:35,553  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_d48276dd-a226-41f8-94ac-dda7f558d8e5); Time taken: 0.018 seconds
2024-04-24T02:31:35,553  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023135_d48276dd-a226-41f8-94ac-dda7f558d8e5
2024-04-24T02:31:35,553  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:35,553  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_d48276dd-a226-41f8-94ac-dda7f558d8e5): drop table if exists acidTbl
2024-04-24T02:31:35,553  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:35,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,558  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:35,558  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_d48276dd-a226-41f8-94ac-dda7f558d8e5); Time taken: 0.004 seconds
2024-04-24T02:31:35,558  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_d48276dd-a226-41f8-94ac-dda7f558d8e5
2024-04-24T02:31:35,564  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:31:35,571  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,571  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:31:35,572  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:31:35,572  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_119bab82-c734-4c07-9190-94ff72a07e75): drop table if exists acidTblPart
2024-04-24T02:31:35,574  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:31:35,574  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:31:35,575  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:35,578  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,578  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,578  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,578  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-24T02:31:35,578  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_119bab82-c734-4c07-9190-94ff72a07e75); Time taken: 0.006 seconds
2024-04-24T02:31:35,578  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023135_119bab82-c734-4c07-9190-94ff72a07e75
2024-04-24T02:31:35,578  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:35,578  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_119bab82-c734-4c07-9190-94ff72a07e75): drop table if exists acidTblPart
2024-04-24T02:31:35,579  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,579  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:35,582  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,582  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:35,582  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_119bab82-c734-4c07-9190-94ff72a07e75); Time taken: 0.004 seconds
2024-04-24T02:31:35,582  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_119bab82-c734-4c07-9190-94ff72a07e75
2024-04-24T02:31:35,588  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:31:35,594  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,595  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:31:35,595  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:31:35,595  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_64a089b9-c825-44d6-93bb-72e9a17730fe): drop table if exists acidTbl2
2024-04-24T02:31:35,597  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:31:35,598  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:31:35,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:31:35,601  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,601  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,601  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,601  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:31:35,601  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_64a089b9-c825-44d6-93bb-72e9a17730fe); Time taken: 0.006 seconds
2024-04-24T02:31:35,602  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023135_64a089b9-c825-44d6-93bb-72e9a17730fe
2024-04-24T02:31:35,602  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:35,602  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_64a089b9-c825-44d6-93bb-72e9a17730fe): drop table if exists acidTbl2
2024-04-24T02:31:35,602  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:31:35,605  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,605  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:35,605  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_64a089b9-c825-44d6-93bb-72e9a17730fe); Time taken: 0.003 seconds
2024-04-24T02:31:35,605  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_64a089b9-c825-44d6-93bb-72e9a17730fe
2024-04-24T02:31:35,610  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:31:35,616  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,616  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:31:35,617  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:31:35,617  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_b57e5b2a-6abb-49ba-b2c0-4c193463d207): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:35,619  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:31:35,619  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:31:35,620  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:35,623  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,623  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,623  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,623  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=1, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:31:35,623  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_b57e5b2a-6abb-49ba-b2c0-4c193463d207); Time taken: 0.006 seconds
2024-04-24T02:31:35,624  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023135_b57e5b2a-6abb-49ba-b2c0-4c193463d207
2024-04-24T02:31:35,624  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:35,624  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_b57e5b2a-6abb-49ba-b2c0-4c193463d207): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:35,624  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,624  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:35,627  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,627  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:35,627  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_b57e5b2a-6abb-49ba-b2c0-4c193463d207); Time taken: 0.003 seconds
2024-04-24T02:31:35,627  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_b57e5b2a-6abb-49ba-b2c0-4c193463d207
2024-04-24T02:31:35,633  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:31:35,641  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,641  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:31:35,641  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:35,642  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_1ada0caa-6383-4765-93c0-82829a401e8a): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:35,644  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:31:35,645  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:31:35,645  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:35,648  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,648  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,648  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,648  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-24T02:31:35,648  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_1ada0caa-6383-4765-93c0-82829a401e8a); Time taken: 0.006 seconds
2024-04-24T02:31:35,649  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023135_1ada0caa-6383-4765-93c0-82829a401e8a
2024-04-24T02:31:35,649  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:35,649  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_1ada0caa-6383-4765-93c0-82829a401e8a): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:35,649  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,649  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:35,652  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,652  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:35,652  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_1ada0caa-6383-4765-93c0-82829a401e8a); Time taken: 0.003 seconds
2024-04-24T02:31:35,652  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_1ada0caa-6383-4765-93c0-82829a401e8a
2024-04-24T02:31:35,659  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:31:35,667  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,667  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:31:35,667  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:31:35,667  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_8eba2e04-a7a1-47e6-b6a7-7d362808fd77): drop table if exists nonAcidNonBucket
2024-04-24T02:31:35,670  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:31:35,670  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:31:35,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:35,674  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,674  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,674  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,674  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=15}
2024-04-24T02:31:35,674  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_8eba2e04-a7a1-47e6-b6a7-7d362808fd77); Time taken: 0.007 seconds
2024-04-24T02:31:35,674  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023135_8eba2e04-a7a1-47e6-b6a7-7d362808fd77
2024-04-24T02:31:35,674  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:35,675  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_8eba2e04-a7a1-47e6-b6a7-7d362808fd77): drop table if exists nonAcidNonBucket
2024-04-24T02:31:35,675  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:35,678  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,678  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:35,678  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_8eba2e04-a7a1-47e6-b6a7-7d362808fd77); Time taken: 0.003 seconds
2024-04-24T02:31:35,678  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_8eba2e04-a7a1-47e6-b6a7-7d362808fd77
2024-04-24T02:31:35,684  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:31:35,691  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,691  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:31:35,692  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,692  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_0454fc75-de7f-4b15-b7ad-fb4067099840): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,695  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:31:35,695  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:31:35,696  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:35,696  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:35,702  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:31:35,702  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:35,704  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:35,704  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,704  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,704  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6, flushCache_()=1, getValidTxns_(long)=1, getDatabase_(String)=2}
2024-04-24T02:31:35,704  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_0454fc75-de7f-4b15-b7ad-fb4067099840); Time taken: 0.012 seconds
2024-04-24T02:31:35,705  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023135_0454fc75-de7f-4b15-b7ad-fb4067099840
2024-04-24T02:31:35,705  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023135_0454fc75-de7f-4b15-b7ad-fb4067099840
2024-04-24T02:31:35,725  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023135_0454fc75-de7f-4b15-b7ad-fb4067099840 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:31:35,725  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:35,726  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_0454fc75-de7f-4b15-b7ad-fb4067099840): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,726  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951095, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numRows=0, numFilesErasureCoded=0, bucketing_version=2, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:35,734  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:35,775  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,775  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=47}
2024-04-24T02:31:35,775  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_0454fc75-de7f-4b15-b7ad-fb4067099840); Time taken: 0.048 seconds
2024-04-24T02:31:35,775  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_0454fc75-de7f-4b15-b7ad-fb4067099840
2024-04-24T02:31:35,779  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:31:35,786  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,786  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:31:35,786  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,787  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_019c1677-2d4e-41f6-b909-4aa7e8ce46ec): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,789  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:31:35,789  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:31:35,790  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:35,790  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:35,792  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:31:35,792  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:35,794  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:35,794  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,794  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,794  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,794  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0}
2024-04-24T02:31:35,795  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_019c1677-2d4e-41f6-b909-4aa7e8ce46ec); Time taken: 0.008 seconds
2024-04-24T02:31:35,795  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023135_019c1677-2d4e-41f6-b909-4aa7e8ce46ec
2024-04-24T02:31:35,795  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023135_019c1677-2d4e-41f6-b909-4aa7e8ce46ec
2024-04-24T02:31:35,811  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023135_019c1677-2d4e-41f6-b909-4aa7e8ce46ec LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:31:35,812  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:35,812  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_019c1677-2d4e-41f6-b909-4aa7e8ce46ec): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,812  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951095, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:35,820  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:31:35,837  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,837  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:35,837  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_019c1677-2d4e-41f6-b909-4aa7e8ce46ec); Time taken: 0.025 seconds
2024-04-24T02:31:35,838  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_019c1677-2d4e-41f6-b909-4aa7e8ce46ec
2024-04-24T02:31:35,842  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:31:35,850  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,850  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:31:35,850  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:35,851  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_ad25ca1d-7ee8-419f-8633-33a6b93f5a2d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:35,853  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:31:35,853  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:31:35,854  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:35,854  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:35,856  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:31:35,856  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:35,858  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:35,858  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,858  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,858  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,858  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, flushCache_()=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-24T02:31:35,859  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_ad25ca1d-7ee8-419f-8633-33a6b93f5a2d); Time taken: 0.007 seconds
2024-04-24T02:31:35,859  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023135_ad25ca1d-7ee8-419f-8633-33a6b93f5a2d
2024-04-24T02:31:35,859  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023135_ad25ca1d-7ee8-419f-8633-33a6b93f5a2d
2024-04-24T02:31:35,875  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023135_ad25ca1d-7ee8-419f-8633-33a6b93f5a2d LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:31:35,875  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:35,875  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_ad25ca1d-7ee8-419f-8633-33a6b93f5a2d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:35,875  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951095, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, transactional=false, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numFiles=0, numRows=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:35,882  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:31:35,902  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,903  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=26, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:35,903  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_ad25ca1d-7ee8-419f-8633-33a6b93f5a2d); Time taken: 0.027 seconds
2024-04-24T02:31:35,903  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_ad25ca1d-7ee8-419f-8633-33a6b93f5a2d
2024-04-24T02:31:35,907  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:31:35,914  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,914  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:31:35,915  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:35,915  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_a459c27c-9501-4f8f-8917-dece0efde551): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:35,918  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:31:35,918  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:31:35,918  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:35,918  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:35,921  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:31:35,921  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:35,923  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:35,923  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,923  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,923  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,923  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:31:35,923  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_a459c27c-9501-4f8f-8917-dece0efde551); Time taken: 0.008 seconds
2024-04-24T02:31:35,923  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023135_a459c27c-9501-4f8f-8917-dece0efde551
2024-04-24T02:31:35,924  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023135_a459c27c-9501-4f8f-8917-dece0efde551
2024-04-24T02:31:35,939  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023135_a459c27c-9501-4f8f-8917-dece0efde551 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:31:35,939  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:35,939  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_a459c27c-9501-4f8f-8917-dece0efde551): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:35,939  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:35,940  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951095, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, transactional=false, totalSize=0, numRows=0, bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:35,946  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:31:35,960  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:35,960  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:35,960  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_a459c27c-9501-4f8f-8917-dece0efde551); Time taken: 0.021 seconds
2024-04-24T02:31:35,960  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_a459c27c-9501-4f8f-8917-dece0efde551
2024-04-24T02:31:35,965  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:31:35,972  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:35,972  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:31:35,973  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,973  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023135_d965344b-cfdb-4f67-acec-dc7062e94e3f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,976  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:31:35,976  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:31:35,977  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:35,977  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:35,979  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:31:35,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:35,981  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:35,981  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:35,981  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:35,981  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:35,981  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=2}
2024-04-24T02:31:35,982  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023135_d965344b-cfdb-4f67-acec-dc7062e94e3f); Time taken: 0.008 seconds
2024-04-24T02:31:35,982  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023135_d965344b-cfdb-4f67-acec-dc7062e94e3f
2024-04-24T02:31:35,982  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023135_d965344b-cfdb-4f67-acec-dc7062e94e3f
2024-04-24T02:31:35,999  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023135_d965344b-cfdb-4f67-acec-dc7062e94e3f LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:31:35,999  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:35,999  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023135_d965344b-cfdb-4f67-acec-dc7062e94e3f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:35,999  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:36,000  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b3825a28-82ec-4abe-99dd-b1e5841cb070/_tmp_space.db/5b00a44a-99dc-46e6-a50d-22b892f4b881
2024-04-24T02:31:36,003  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:36,004  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=3}
2024-04-24T02:31:36,004  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023135_d965344b-cfdb-4f67-acec-dc7062e94e3f); Time taken: 0.004 seconds
2024-04-24T02:31:36,004  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023135_d965344b-cfdb-4f67-acec-dc7062e94e3f
2024-04-24T02:31:36,009  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:31:36,016  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:36,016  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:31:36,016  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:36,017  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023136_c45caa41-81e8-4288-a0ba-961c7e010886): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:36,019  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:31:36,019  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:31:36,020  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:36,020  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:36,022  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:31:36,022  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:36,024  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:36,024  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:36,024  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:36,024  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:36,024  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:31:36,024  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023136_c45caa41-81e8-4288-a0ba-961c7e010886); Time taken: 0.007 seconds
2024-04-24T02:31:36,025  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023136_c45caa41-81e8-4288-a0ba-961c7e010886
2024-04-24T02:31:36,025  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023136_c45caa41-81e8-4288-a0ba-961c7e010886
2024-04-24T02:31:36,041  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023136_c45caa41-81e8-4288-a0ba-961c7e010886 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:31:36,041  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:36,041  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023136_c45caa41-81e8-4288-a0ba-961c7e010886): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:36,041  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:36,042  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951096, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, numFilesErasureCoded=0, totalSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:36,047  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:31:36,063  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:36,063  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:36,063  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023136_c45caa41-81e8-4288-a0ba-961c7e010886); Time taken: 0.022 seconds
2024-04-24T02:31:36,063  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023136_c45caa41-81e8-4288-a0ba-961c7e010886
2024-04-24T02:31:36,067  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:31:36,073  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:36,073  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:31:36,074  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:31:36,074  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:31:36,076  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:31:36,077  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:31:36,077  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:36,077  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:36,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:36,118  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:36,118  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:36,118  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:36,118  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:36,118  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:36,118  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:36,128  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:36,128  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:36,128  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:31:36,150  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:36,230  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:36,230  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:36,230  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:36,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:36,233  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:36,233  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:36,233  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:36,233  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:36,243  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:36,245  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1
2024-04-24T02:31:36,247  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:36,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:36,250  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:31:36,254  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:31:36,254  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:31:36,255  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:31:36,255  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:31:36,264  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:36,275  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:36,275  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:31:36,275  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:36,275  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:36,275  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:31:36,275  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:36,275  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=29, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=69, flushCache_()=0, getValidTxns_(long)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-24T02:31:36,276  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70); Time taken: 0.201 seconds
2024-04-24T02:31:36,276  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70
2024-04-24T02:31:36,276  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70
2024-04-24T02:31:36,297  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:31:36,297  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:31:36,297  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-24T02:31:36,297  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70
2024-04-24T02:31:36,297  INFO [main] ql.Driver: Query ID = alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70
Total jobs = 1
2024-04-24T02:31:36,297  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:31:36,297  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:31:36,449  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:31:36,449  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:31:36,449  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:31:36,449  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:31:36,449  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:31:36,449  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:31:36,449  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:31:36,449  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:31:36,451  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:31:36,452  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:31:36,452  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-36_074_3206038403456202906-1/dummy_path
2024-04-24T02:31:36,461  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:31:36,462  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,01KB
2024-04-24T02:31:36,466  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:31:36,467  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:31:36,468  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:36,472  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-36_074_3206038403456202906-1/-mr-10001
2024-04-24T02:31:36,476  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:36,483  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:31:36,488  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:31:36,489  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:31:36,489  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:31:36,489  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-36_074_3206038403456202906-1/dummy_path
2024-04-24T02:31:36,489  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:31:36,507  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:31:36,527  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local910040130_0021
2024-04-24T02:31:36,527  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:31:36,590  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:31:36,590  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:31:36,590  INFO [Thread-1673] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:36,590  INFO [Thread-1673] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:36,592  INFO [Thread-1673] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:31:36,592  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local910040130_0021_m_000000_0
2024-04-24T02:31:36,595  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:36,595  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-36_074_3206038403456202906-1/dummy_path/null:0+1
2024-04-24T02:31:36,598  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:31:36,598  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,01KB
2024-04-24T02:31:36,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:31:36,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:31:36,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:31:36,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:31:36,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:31:36,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:31:36,604  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:31:36,604  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:31:36,604  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:31:36,605  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:31:36,605  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:31:36,605  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:31:36,606  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:31:36,606  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:31:36,606  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:31:36,606  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:31:36,606  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:31:36,606  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:31:36,606  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:31:36,606  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-24T02:31:36,607  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-24T02:31:36,610  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:31:36,610  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:31:36,610  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:31:36,610  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-24T02:31:36,610  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-24T02:31:36,620  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:31:36,625  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local910040130_0021_m_000000_0 is done. And is in the process of committing
2024-04-24T02:31:36,626  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:31:36,626  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local910040130_0021_m_000000_0' done.
2024-04-24T02:31:36,626  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local910040130_0021_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=446272
		FILE: Number of bytes written=24730433
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1157627904
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5058
2024-04-24T02:31:36,626  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local910040130_0021_m_000000_0
2024-04-24T02:31:36,626  INFO [Thread-1673] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:31:36,627  INFO [Thread-1673] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:31:36,627  INFO [pool-105-thread-1] mapred.LocalJobRunner: Starting task: attempt_local910040130_0021_r_000000_0
2024-04-24T02:31:36,630  INFO [pool-105-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:36,630  INFO [pool-105-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1a4c04ac
2024-04-24T02:31:36,630  WARN [pool-105-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:36,631  INFO [pool-105-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:36,632  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local910040130_0021_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:36,634  INFO [localfetcher#30] reduce.LocalFetcher: localfetcher#30 about to shuffle output of map attempt_local910040130_0021_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:31:36,634  INFO [localfetcher#30] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local910040130_0021_m_000000_0
2024-04-24T02:31:36,634  INFO [localfetcher#30] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:31:36,635  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:36,635  INFO [pool-105-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:36,635  INFO [pool-105-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:36,641  INFO [pool-105-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:36,641  INFO [pool-105-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:31:36,643  INFO [pool-105-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:36,643  INFO [pool-105-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:31:36,643  INFO [pool-105-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:36,643  INFO [pool-105-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:36,644  INFO [pool-105-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:31:36,644  INFO [pool-105-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:36,644  INFO [pool-105-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:36,645  INFO [pool-105-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:31:36,646  INFO [pool-105-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:36,646  INFO [pool-105-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:36,646  INFO [pool-105-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:36,646  INFO [pool-105-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:36,646  INFO [pool-105-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local910040130_0021/job_local910040130_0021.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3d145735
2024-04-24T02:31:36,646  INFO [pool-105-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_tmp.-ext-10000/000000_0
2024-04-24T02:31:36,646  INFO [pool-105-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-24T02:31:36,646  INFO [pool-105-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_tmp.-ext-10000/000000_0
2024-04-24T02:31:36,647  INFO [pool-105-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:36,647  INFO [pool-105-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T02:31:36,654  INFO [pool-105-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T02:31:36,654  INFO [pool-105-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:36,654  INFO [pool-105-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:36,654  INFO [pool-105-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:36,654  INFO [pool-105-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:36,661  INFO [pool-105-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.nonacidorctbl:1, 
2024-04-24T02:31:36,661  INFO [pool-105-thread-1] mapred.Task: Task:attempt_local910040130_0021_r_000000_0 is done. And is in the process of committing
2024-04-24T02:31:36,662  INFO [pool-105-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:36,662  INFO [pool-105-thread-1] mapred.Task: Task 'attempt_local910040130_0021_r_000000_0' done.
2024-04-24T02:31:36,662  INFO [pool-105-thread-1] mapred.Task: Final Counters for attempt_local910040130_0021_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=452853
		FILE: Number of bytes written=24730799
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1157627904
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:36,662  INFO [pool-105-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local910040130_0021_r_000000_0
2024-04-24T02:31:36,662  INFO [pool-105-thread-1] mapred.LocalJobRunner: Starting task: attempt_local910040130_0021_r_000001_0
2024-04-24T02:31:36,662  INFO [pool-105-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:36,662  INFO [pool-105-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@61f19f69
2024-04-24T02:31:36,662  WARN [pool-105-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:36,663  INFO [pool-105-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:36,664  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local910040130_0021_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:36,666  INFO [localfetcher#31] reduce.LocalFetcher: localfetcher#31 about to shuffle output of map attempt_local910040130_0021_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-24T02:31:36,666  INFO [localfetcher#31] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local910040130_0021_m_000000_0
2024-04-24T02:31:36,666  INFO [localfetcher#31] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-24T02:31:36,667  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:36,667  INFO [pool-105-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:36,667  INFO [pool-105-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:36,673  INFO [pool-105-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:36,673  INFO [pool-105-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-24T02:31:36,676  INFO [pool-105-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:36,676  INFO [pool-105-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-24T02:31:36,676  INFO [pool-105-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:36,676  INFO [pool-105-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:36,676  INFO [pool-105-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-24T02:31:36,677  INFO [pool-105-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:36,677  INFO [pool-105-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:36,677  INFO [pool-105-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-24T02:31:36,678  INFO [pool-105-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:36,678  INFO [pool-105-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:36,678  INFO [pool-105-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:36,679  INFO [pool-105-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:36,679  INFO [pool-105-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local910040130_0021/job_local910040130_0021.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@15d24107
2024-04-24T02:31:36,679  INFO [pool-105-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_tmp.-ext-10000/000001_0
2024-04-24T02:31:36,679  INFO [pool-105-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-24T02:31:36,679  INFO [pool-105-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_tmp.-ext-10000/000001_0
2024-04-24T02:31:36,679  INFO [pool-105-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:36,680  INFO [pool-105-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T02:31:36,684  INFO [pool-105-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T02:31:36,684  INFO [pool-105-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:36,684  INFO [pool-105-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:3, 
2024-04-24T02:31:36,684  INFO [pool-105-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:36,684  INFO [pool-105-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-24T02:31:36,692  INFO [pool-105-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:3, TOTAL_TABLE_ROWS_WRITTEN:3, RECORDS_OUT_1_default.nonacidorctbl:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:36,692  INFO [pool-105-thread-1] mapred.Task: Task:attempt_local910040130_0021_r_000001_0 is done. And is in the process of committing
2024-04-24T02:31:36,693  INFO [pool-105-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:36,693  INFO [pool-105-thread-1] mapred.Task: Task 'attempt_local910040130_0021_r_000001_0' done.
2024-04-24T02:31:36,693  INFO [pool-105-thread-1] mapred.Task: Final Counters for attempt_local910040130_0021_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=459446
		FILE: Number of bytes written=24731218
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1157627904
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:36,693  INFO [pool-105-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local910040130_0021_r_000001_0
2024-04-24T02:31:36,693  INFO [Thread-1673] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:31:37,593 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:31:37,593  INFO [main] exec.Task: 2024-04-24 02:31:37,593 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local910040130_0021
2024-04-24T02:31:37,595  INFO [main] exec.Task: Ended Job = job_local910040130_0021
2024-04-24T02:31:37,597  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-24T02:31:37,597  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1/-ext-10000
2024-04-24T02:31:37,597  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:37,606  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:37,607  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:37,616  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:37,617  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-24T02:31:37,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-24T02:31:37,648  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:31:37,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:37,656  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:37,657  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:31:37,657  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-36_074_3206038403456202906-1/-mr-10001
2024-04-24T02:31:37,658  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:37,668  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:37,669  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-24T02:31:37,669  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-24T02:31:37,669  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-24T02:31:37,669  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-24T02:31:37,693  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-24T02:31:37,693  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:37,693  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=54, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=37}
MapReduce Jobs Launched: 
2024-04-24T02:31:37,694  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:31:37,694  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:37,694  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:37,694  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70); Time taken: 1.396 seconds
2024-04-24T02:31:37,694  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023136_bf908b04-c2f3-4363-9543-137bf83b3b70
2024-04-24T02:31:37,698  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:31:37,703  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:37,703  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:31:37,704  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:31:37,704  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-36_074_3206038403456202906-1
2024-04-24T02:31:37,705  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-36_074_3206038403456202906-1 on fs with scheme file
2024-04-24T02:31:37,705  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1
2024-04-24T02:31:37,705  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-24_02-31-36_074_3206038403456202906-1 on fs with scheme file
2024-04-24T02:31:37,705  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:31:37,708  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:31:37,708  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:31:37,709  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:37,709  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:37,711  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:37,718  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:37,718  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:37,718  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:37,718  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:37,718  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:37,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:37,725  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:37,725  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:37,725  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:31:37,746  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:37,800  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:37,800  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:37,800  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:37,800  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:37,803  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:37,803  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:37,803  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:37,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:37,810  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:37,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:37,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:37,820  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-24T02:31:37,821  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-24T02:31:37,822  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:31:37,825  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:31:37,825  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:31:37,826  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:31:37,826  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:31:37,834  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:37,842  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:37,842  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:31:37,842  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:37,842  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:37,842  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:31:37,843  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:37,843  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=0, getAllTableConstraints_(AllTableConstraintsRequest)=5, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=29, allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3}
2024-04-24T02:31:37,843  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc); Time taken: 0.137 seconds
2024-04-24T02:31:37,843  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc
2024-04-24T02:31:37,843  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc
2024-04-24T02:31:37,858  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:31:37,858  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:31:37,861  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-24T02:31:37,861  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc
2024-04-24T02:31:37,861  INFO [main] ql.Driver: Query ID = alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc
Total jobs = 1
2024-04-24T02:31:37,861  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:31:37,862  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:31:38,002  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:31:38,002  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:31:38,002  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:31:38,002  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:31:38,002  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:31:38,002  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:31:38,002  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:31:38,002  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:31:38,005  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:31:38,005  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:31:38,005  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-37_705_1818137739529687714-1/dummy_path
2024-04-24T02:31:38,015  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:31:38,016  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,03KB
2024-04-24T02:31:38,021  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:31:38,022  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:31:38,023  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:38,028  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-37_705_1818137739529687714-1/-mr-10000
2024-04-24T02:31:38,031  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:38,040  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:31:38,045  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:31:38,046  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:31:38,046  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:31:38,046  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-37_705_1818137739529687714-1/dummy_path
2024-04-24T02:31:38,047  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:31:38,065  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:31:38,085  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local91096705_0022
2024-04-24T02:31:38,085  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:31:38,169  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:31:38,169  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:31:38,170  INFO [Thread-1736] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:38,170  INFO [Thread-1736] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:38,171  INFO [Thread-1736] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:31:38,171  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local91096705_0022_m_000000_0
2024-04-24T02:31:38,172  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:38,172  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-37_705_1818137739529687714-1/dummy_path/null:0+1
2024-04-24T02:31:38,173  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:31:38,173  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,03KB
2024-04-24T02:31:38,173  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:31:38,188  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:31:38,188  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:31:38,188  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:31:38,188  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:31:38,188  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:31:38,188  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:31:38,189  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:31:38,189  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:31:38,190  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:31:38,190  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:31:38,190  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:31:38,190  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:31:38,190  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:31:38,190  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:31:38,190  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:31:38,190  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:31:38,191  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-24T02:31:38,192  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-24T02:31:38,202  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:31:38,205  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local91096705_0022_m_000000_0 is done. And is in the process of committing
2024-04-24T02:31:38,205  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:31:38,206  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local91096705_0022_m_000000_0' done.
2024-04-24T02:31:38,206  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local91096705_0022_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=465115
		FILE: Number of bytes written=25901792
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=9
		Total committed heap usage (bytes)=1161822208
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5078
2024-04-24T02:31:38,206  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local91096705_0022_m_000000_0
2024-04-24T02:31:38,206  INFO [Thread-1736] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:31:38,207  INFO [Thread-1736] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:31:38,207  INFO [pool-110-thread-1] mapred.LocalJobRunner: Starting task: attempt_local91096705_0022_r_000000_0
2024-04-24T02:31:38,208  INFO [pool-110-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:38,208  INFO [pool-110-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@36276f92
2024-04-24T02:31:38,208  WARN [pool-110-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:38,209  INFO [pool-110-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:38,209  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local91096705_0022_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:38,210  INFO [localfetcher#32] reduce.LocalFetcher: localfetcher#32 about to shuffle output of map attempt_local91096705_0022_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:31:38,210  INFO [localfetcher#32] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local91096705_0022_m_000000_0
2024-04-24T02:31:38,210  INFO [localfetcher#32] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:31:38,210  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:38,211  INFO [pool-110-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:38,211  INFO [pool-110-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:38,217  INFO [pool-110-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:38,217  INFO [pool-110-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:31:38,219  INFO [pool-110-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:38,219  INFO [pool-110-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:31:38,219  INFO [pool-110-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:38,219  INFO [pool-110-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:38,219  INFO [pool-110-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:31:38,220  INFO [pool-110-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:38,220  INFO [pool-110-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:38,220  INFO [pool-110-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:31:38,221  INFO [pool-110-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:38,221  INFO [pool-110-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:38,221  INFO [pool-110-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:38,221  INFO [pool-110-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:38,222  INFO [pool-110-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local91096705_0022/job_local91096705_0022.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@17d60f43
2024-04-24T02:31:38,222  INFO [pool-110-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:38,222  INFO [pool-110-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:38,222  INFO [pool-110-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:31:38,222  INFO [pool-110-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:38,223  INFO [pool-110-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:31:38,229  INFO [pool-110-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:31:38,233  INFO [pool-110-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:38,234  INFO [pool-110-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T02:31:38,234  INFO [pool-110-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:38,234  INFO [pool-110-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:31:38,236  INFO [pool-110-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:31:38,247  INFO [pool-110-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-24T02:31:38,247  INFO [pool-110-thread-1] mapred.Task: Task:attempt_local91096705_0022_r_000000_0 is done. And is in the process of committing
2024-04-24T02:31:38,248  INFO [pool-110-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:38,248  INFO [pool-110-thread-1] mapred.Task: Task 'attempt_local91096705_0022_r_000000_0' done.
2024-04-24T02:31:38,248  INFO [pool-110-thread-1] mapred.Task: Final Counters for attempt_local91096705_0022_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=471317
		FILE: Number of bytes written=25902861
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1161822208
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:38,248  INFO [pool-110-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local91096705_0022_r_000000_0
2024-04-24T02:31:38,248  INFO [pool-110-thread-1] mapred.LocalJobRunner: Starting task: attempt_local91096705_0022_r_000001_0
2024-04-24T02:31:38,249  INFO [pool-110-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:38,249  INFO [pool-110-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6076f919
2024-04-24T02:31:38,249  WARN [pool-110-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:38,250  INFO [pool-110-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:38,250  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local91096705_0022_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:38,253  INFO [localfetcher#33] reduce.LocalFetcher: localfetcher#33 about to shuffle output of map attempt_local91096705_0022_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:31:38,253  INFO [localfetcher#33] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local91096705_0022_m_000000_0
2024-04-24T02:31:38,253  INFO [localfetcher#33] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:31:38,254  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:38,254  INFO [pool-110-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:38,254  INFO [pool-110-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:38,260  INFO [pool-110-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:38,260  INFO [pool-110-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:31:38,262  INFO [pool-110-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:38,262  INFO [pool-110-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:31:38,262  INFO [pool-110-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:38,262  INFO [pool-110-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:38,262  INFO [pool-110-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:31:38,263  INFO [pool-110-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:38,263  INFO [pool-110-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:38,263  INFO [pool-110-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:31:38,264  INFO [pool-110-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:38,264  INFO [pool-110-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:38,264  INFO [pool-110-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:38,264  INFO [pool-110-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:38,265  INFO [pool-110-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local91096705_0022/job_local91096705_0022.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@34aef421
2024-04-24T02:31:38,265  INFO [pool-110-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:38,265  INFO [pool-110-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:38,265  INFO [pool-110-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:31:38,266  INFO [pool-110-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:38,266  INFO [pool-110-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:31:38,271  INFO [pool-110-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:31:38,271  INFO [pool-110-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:38,271  INFO [pool-110-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T02:31:38,271  INFO [pool-110-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:38,271  INFO [pool-110-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:31:38,273  INFO [pool-110-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:31:38,283  INFO [pool-110-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:38,284  INFO [pool-110-thread-1] mapred.Task: Task:attempt_local91096705_0022_r_000001_0 is done. And is in the process of committing
2024-04-24T02:31:38,284  INFO [pool-110-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:38,284  INFO [pool-110-thread-1] mapred.Task: Task 'attempt_local91096705_0022_r_000001_0' done.
2024-04-24T02:31:38,284  INFO [pool-110-thread-1] mapred.Task: Final Counters for attempt_local91096705_0022_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=477477
		FILE: Number of bytes written=25903931
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1161822208
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:38,284  INFO [pool-110-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local91096705_0022_r_000001_0
2024-04-24T02:31:38,284  INFO [Thread-1736] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:31:39,173 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:31:39,173  INFO [main] exec.Task: 2024-04-24 02:31:39,173 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local91096705_0022
2024-04-24T02:31:39,174  INFO [main] exec.Task: Ended Job = job_local91096705_0022
2024-04-24T02:31:39,175  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:31:39,175  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:31:39,175  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:31:39,176  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:31:39,176  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:31:39,177  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:31:39,178  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:39,178  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:39,188  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,188  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:39,197  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,198  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:31:39,222  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:31:39,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:39,229  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,229  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:31:39,229  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-37_705_1818137739529687714-1/-mr-10000
2024-04-24T02:31:39,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:39,237  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,247  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:31:39,248  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-24T02:31:39,248  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:31:39,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:31:39,269  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-24T02:31:39,269  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:31:39,269  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:31:39,272  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:31:39,272  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:39,272  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=45, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, getTable_(GetTableRequest)=32, isCompatibleWith_(Configuration)=1}
MapReduce Jobs Launched: 
2024-04-24T02:31:39,272  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:31:39,273  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:39,273  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:39,273  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc); Time taken: 1.411 seconds
2024-04-24T02:31:39,273  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023137_6818327a-b72e-4ab7-9201-8f538f598fcc
2024-04-24T02:31:39,282  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:39,282  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:31:39,283  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-24T02:31:39,283  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-37_705_1818137739529687714-1
2024-04-24T02:31:39,284  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-37_705_1818137739529687714-1 on fs with scheme file
2024-04-24T02:31:39,284  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023139_36f128b5-a054-410c-b6b0-05655dbf8ac5): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-24T02:31:39,286  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-24T02:31:39,287  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:31:39,287  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:31:39,287  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,294  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,294  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-24T02:31:39,297  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b3825a28-82ec-4abe-99dd-b1e5841cb070/_tmp_space.db/merge_tmp_table
2024-04-24T02:31:39,300  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 5
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3 AND NOT(`s`.`a` < 5)
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3 AND NOT(`s`.`a` < 5)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-24T02:31:39,303  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:31:39,308  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:39,308  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:39,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:39,318  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:39,328  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:39,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:39,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,336  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,344  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,350  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,357  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,358  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:39,358  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:31:39,358  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:39,359  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:39,359  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:39,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:39,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:39,408  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:31:39,408  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:39,417  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,418  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:39,430  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:31:39,445  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-24T02:31:39,445  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-24T02:31:39,445  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:31:39,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:39,461  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:31:39,473  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,473  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-24T02:31:39,489  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: b, a
No Stats for default@nonacidorctbl, Columns: b, a
2024-04-24T02:31:39,489  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: b, a
2024-04-24T02:31:39,692  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:39,692  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:39,692  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:39,692  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:39,692  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:39,692  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:39,692  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:39,692  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:39,693  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:39,693  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:39,693  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:39,693  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:39,693  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,700  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,707  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,707  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,714  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,721  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,727 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:31:39,728 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:31:39,728  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:31:39,728 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:31:39,728  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:39,728  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=10, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=2, createTable_(Table)=3, getTable_(GetTableRequest)=80, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getTableColumnStatistics_(String, String, List, String)=79}
2024-04-24T02:31:39,728  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023139_36f128b5-a054-410c-b6b0-05655dbf8ac5); Time taken: 0.444 seconds
2024-04-24T02:31:39,729  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:31:39,732  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:39,738  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:31:39,738  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b3825a28-82ec-4abe-99dd-b1e5841cb070/hive_2024-04-24_02-31-39_300_8772986537794315012-1
2024-04-24T02:31:39,738  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023139_485c8582-8740-481f-9f66-5ca48bb1df89): drop table if exists acidTbl
2024-04-24T02:31:39,741  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-24T02:31:39,741  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:31:39,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,749  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,749  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:39,749  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:39,750  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:39,750  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=9, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=7}
2024-04-24T02:31:39,750  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023139_485c8582-8740-481f-9f66-5ca48bb1df89); Time taken: 0.012 seconds
2024-04-24T02:31:39,750  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023139_485c8582-8740-481f-9f66-5ca48bb1df89
2024-04-24T02:31:39,751  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023139_485c8582-8740-481f-9f66-5ca48bb1df89
2024-04-24T02:31:39,765  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023139_485c8582-8740-481f-9f66-5ca48bb1df89 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:31:39,765  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:39,765  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023139_485c8582-8740-481f-9f66-5ca48bb1df89): drop table if exists acidTbl
2024-04-24T02:31:39,765  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:39,765  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,772  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,772  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,778  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:39,888  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:39,888  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=116, getTable_(GetTableRequest)=7}
2024-04-24T02:31:39,888  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023139_485c8582-8740-481f-9f66-5ca48bb1df89); Time taken: 0.123 seconds
2024-04-24T02:31:39,888  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023139_485c8582-8740-481f-9f66-5ca48bb1df89
2024-04-24T02:31:39,892  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:31:39,899  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:39,900  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:31:39,901  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:31:39,901  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023139_6c6d183a-9788-4e93-84be-38e9ee7195e7): drop table if exists acidTblPart
2024-04-24T02:31:39,903  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-24T02:31:39,904  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:31:39,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:39,916  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,916  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:39,916  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:39,916  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:39,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getTable_(GetTableRequest)=12}
2024-04-24T02:31:39,916  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023139_6c6d183a-9788-4e93-84be-38e9ee7195e7); Time taken: 0.015 seconds
2024-04-24T02:31:39,916  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023139_6c6d183a-9788-4e93-84be-38e9ee7195e7
2024-04-24T02:31:39,917  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023139_6c6d183a-9788-4e93-84be-38e9ee7195e7
2024-04-24T02:31:39,938  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023139_6c6d183a-9788-4e93-84be-38e9ee7195e7 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:31:39,938  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:39,938  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023139_6c6d183a-9788-4e93-84be-38e9ee7195e7): drop table if exists acidTblPart
2024-04-24T02:31:39,938  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:39,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:39,945  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:39,952  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:39,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:39,994  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:39,994  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=49, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-24T02:31:39,994  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023139_6c6d183a-9788-4e93-84be-38e9ee7195e7); Time taken: 0.056 seconds
2024-04-24T02:31:39,994  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023139_6c6d183a-9788-4e93-84be-38e9ee7195e7
2024-04-24T02:31:39,998  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:31:40,005  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,005  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:31:40,006  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:31:40,006  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_c526ab60-aaf8-444a-8f11-af8645481bc2): drop table if exists acidTbl2
2024-04-24T02:31:40,008  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-24T02:31:40,008  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:31:40,009  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,009  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,009  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,009  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T02:31:40,009  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_c526ab60-aaf8-444a-8f11-af8645481bc2); Time taken: 0.003 seconds
2024-04-24T02:31:40,010  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023140_c526ab60-aaf8-444a-8f11-af8645481bc2
2024-04-24T02:31:40,010  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:40,010  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_c526ab60-aaf8-444a-8f11-af8645481bc2): drop table if exists acidTbl2
2024-04-24T02:31:40,010  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,010  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:31:40,011  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,011  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=1}
2024-04-24T02:31:40,011  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_c526ab60-aaf8-444a-8f11-af8645481bc2); Time taken: 0.001 seconds
2024-04-24T02:31:40,011  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_c526ab60-aaf8-444a-8f11-af8645481bc2
2024-04-24T02:31:40,017  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:31:40,024  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,024  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:31:40,025  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:31:40,025  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_fc40ea9f-9685-49d4-ac4a-dd6d15503d1d): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:40,027  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-24T02:31:40,028  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:31:40,028  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:40,053  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,053  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,053  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,053  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,053  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=25, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T02:31:40,054  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_fc40ea9f-9685-49d4-ac4a-dd6d15503d1d); Time taken: 0.028 seconds
2024-04-24T02:31:40,054  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023140_fc40ea9f-9685-49d4-ac4a-dd6d15503d1d
2024-04-24T02:31:40,054  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023140_fc40ea9f-9685-49d4-ac4a-dd6d15503d1d
2024-04-24T02:31:40,070  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023140_fc40ea9f-9685-49d4-ac4a-dd6d15503d1d LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:31:40,070  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:40,070  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_fc40ea9f-9685-49d4-ac4a-dd6d15503d1d): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:40,070  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,071  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:40,082  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,082  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:40,092  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:40,177  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,178  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=12, dropTable_(String, String, boolean, boolean, boolean)=95}
2024-04-24T02:31:40,178  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_fc40ea9f-9685-49d4-ac4a-dd6d15503d1d); Time taken: 0.107 seconds
2024-04-24T02:31:40,178  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_fc40ea9f-9685-49d4-ac4a-dd6d15503d1d
2024-04-24T02:31:40,183  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:31:40,190  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,191  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:31:40,191  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:40,191  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_cad27cb8-d7d6-4190-867d-fd1b11789c06): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:40,194  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-24T02:31:40,194  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:31:40,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:40,205  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,205  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,205  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,205  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,205  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-24T02:31:40,206  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_cad27cb8-d7d6-4190-867d-fd1b11789c06); Time taken: 0.014 seconds
2024-04-24T02:31:40,206  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023140_cad27cb8-d7d6-4190-867d-fd1b11789c06
2024-04-24T02:31:40,206  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023140_cad27cb8-d7d6-4190-867d-fd1b11789c06
2024-04-24T02:31:40,222  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023140_cad27cb8-d7d6-4190-867d-fd1b11789c06 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:31:40,222  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:40,222  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_cad27cb8-d7d6-4190-867d-fd1b11789c06): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:40,223  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:40,233  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,233  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:40,242  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:40,276  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,276  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=43, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,276  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_cad27cb8-d7d6-4190-867d-fd1b11789c06); Time taken: 0.054 seconds
2024-04-24T02:31:40,276  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_cad27cb8-d7d6-4190-867d-fd1b11789c06
2024-04-24T02:31:40,281  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:31:40,286  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,287  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:31:40,287  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:31:40,287  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_b0220f61-cfd1-45d0-a779-364fff20cc5c): drop table if exists nonAcidNonBucket
2024-04-24T02:31:40,290  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-24T02:31:40,290  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:31:40,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:40,299  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,300  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,300  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,300  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,300  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=10, getValidTxns_(long)=0}
2024-04-24T02:31:40,300  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_b0220f61-cfd1-45d0-a779-364fff20cc5c); Time taken: 0.013 seconds
2024-04-24T02:31:40,300  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023140_b0220f61-cfd1-45d0-a779-364fff20cc5c
2024-04-24T02:31:40,301  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023140_b0220f61-cfd1-45d0-a779-364fff20cc5c
2024-04-24T02:31:40,316  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023140_b0220f61-cfd1-45d0-a779-364fff20cc5c LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:31:40,316  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:40,316  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_b0220f61-cfd1-45d0-a779-364fff20cc5c): drop table if exists nonAcidNonBucket
2024-04-24T02:31:40,316  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:40,325  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,325  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:40,335  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:40,335  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:40,368  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,368  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=43, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T02:31:40,368  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_b0220f61-cfd1-45d0-a779-364fff20cc5c); Time taken: 0.052 seconds
2024-04-24T02:31:40,368  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_b0220f61-cfd1-45d0-a779-364fff20cc5c
2024-04-24T02:31:40,373  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:31:40,379  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,379  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:31:40,380  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testQuotedIdentifier" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="2.118">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: 
merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz') failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:31:40,435  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:31:40,435  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:31:40,435  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:31:40,435  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:31:40,435  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:31:40,435  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:31:40,435  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:31:40,435  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:31:40,436  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:31:40,436  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:31:40,436  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:31:40,438  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = dc113135-0f69-470d-93e2-42d1879970ee
2024-04-24T02:31:40,440  INFO [main] SessionState: Hive Session ID = dc113135-0f69-470d-93e2-42d1879970ee
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:31:40,441  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:31:40,446  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dc113135-0f69-470d-93e2-42d1879970ee
2024-04-24T02:31:40,448  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc113135-0f69-470d-93e2-42d1879970ee
2024-04-24T02:31:40,450  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dc113135-0f69-470d-93e2-42d1879970ee/_tmp_space.db
2024-04-24T02:31:40,451  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=dc113135-0f69-470d-93e2-42d1879970ee, clientType=HIVECLI]
2024-04-24T02:31:40,451  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:31:40,451  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_3e07ddb5-7027-45ea-9162-c4f8fb396407): drop table if exists acidTbl
2024-04-24T02:31:40,460  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:31:40,461  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:31:40,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:40,474  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,474  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,474  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,474  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=10, getValidTxns_(long)=3}
2024-04-24T02:31:40,474  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_3e07ddb5-7027-45ea-9162-c4f8fb396407); Time taken: 0.023 seconds
2024-04-24T02:31:40,475  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023140_3e07ddb5-7027-45ea-9162-c4f8fb396407
2024-04-24T02:31:40,475  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:40,475  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_3e07ddb5-7027-45ea-9162-c4f8fb396407): drop table if exists acidTbl
2024-04-24T02:31:40,475  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,475  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:40,478  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,478  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,478  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_3e07ddb5-7027-45ea-9162-c4f8fb396407); Time taken: 0.003 seconds
2024-04-24T02:31:40,478  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_3e07ddb5-7027-45ea-9162-c4f8fb396407
2024-04-24T02:31:40,484  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:31:40,491  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,491  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:31:40,491  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:31:40,491  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_aa566874-c90a-4aa8-a4a0-21ae5113312d): drop table if exists acidTblPart
2024-04-24T02:31:40,493  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:31:40,494  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:31:40,494  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:40,497  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,497  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,497  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,497  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T02:31:40,497  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_aa566874-c90a-4aa8-a4a0-21ae5113312d); Time taken: 0.006 seconds
2024-04-24T02:31:40,498  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023140_aa566874-c90a-4aa8-a4a0-21ae5113312d
2024-04-24T02:31:40,498  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:40,498  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_aa566874-c90a-4aa8-a4a0-21ae5113312d): drop table if exists acidTblPart
2024-04-24T02:31:40,498  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:40,501  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,501  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,501  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_aa566874-c90a-4aa8-a4a0-21ae5113312d); Time taken: 0.003 seconds
2024-04-24T02:31:40,501  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_aa566874-c90a-4aa8-a4a0-21ae5113312d
2024-04-24T02:31:40,506  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:31:40,512  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,512  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:31:40,513  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:31:40,513  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_570bf45b-dfa7-44cf-a253-3203988e701a): drop table if exists acidTbl2
2024-04-24T02:31:40,515  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:31:40,516  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:31:40,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:31:40,519  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,519  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,519  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,519  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,520  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_570bf45b-dfa7-44cf-a253-3203988e701a); Time taken: 0.006 seconds
2024-04-24T02:31:40,520  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023140_570bf45b-dfa7-44cf-a253-3203988e701a
2024-04-24T02:31:40,520  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:40,520  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_570bf45b-dfa7-44cf-a253-3203988e701a): drop table if exists acidTbl2
2024-04-24T02:31:40,520  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:31:40,523  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,523  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,524  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_570bf45b-dfa7-44cf-a253-3203988e701a); Time taken: 0.003 seconds
2024-04-24T02:31:40,524  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_570bf45b-dfa7-44cf-a253-3203988e701a
2024-04-24T02:31:40,529  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:31:40,535  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,535  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:31:40,536  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:31:40,536  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_48ca6b1f-6565-48f9-9be6-9d3f3cf929da): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:40,538  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:31:40,538  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:31:40,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:40,542  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,542  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,542  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,542  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-24T02:31:40,542  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_48ca6b1f-6565-48f9-9be6-9d3f3cf929da); Time taken: 0.006 seconds
2024-04-24T02:31:40,543  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023140_48ca6b1f-6565-48f9-9be6-9d3f3cf929da
2024-04-24T02:31:40,543  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:40,543  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_48ca6b1f-6565-48f9-9be6-9d3f3cf929da): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:40,543  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:40,546  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,546  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,546  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_48ca6b1f-6565-48f9-9be6-9d3f3cf929da); Time taken: 0.003 seconds
2024-04-24T02:31:40,546  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_48ca6b1f-6565-48f9-9be6-9d3f3cf929da
2024-04-24T02:31:40,552  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:31:40,558  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,558  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:31:40,559  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:40,559  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_99eba2a3-4a50-4036-ad78-65ade4ec8d1e): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:40,561  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:31:40,561  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:31:40,562  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:40,565  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,565  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,565  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,565  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:31:40,565  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_99eba2a3-4a50-4036-ad78-65ade4ec8d1e); Time taken: 0.006 seconds
2024-04-24T02:31:40,565  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023140_99eba2a3-4a50-4036-ad78-65ade4ec8d1e
2024-04-24T02:31:40,565  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:40,565  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_99eba2a3-4a50-4036-ad78-65ade4ec8d1e): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:40,566  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,566  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:40,569  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,569  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,569  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_99eba2a3-4a50-4036-ad78-65ade4ec8d1e); Time taken: 0.004 seconds
2024-04-24T02:31:40,569  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_99eba2a3-4a50-4036-ad78-65ade4ec8d1e
2024-04-24T02:31:40,574  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:31:40,579  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,580  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:31:40,580  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:31:40,580  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_9260edca-9566-4636-a695-2b80f9f5c83c): drop table if exists nonAcidNonBucket
2024-04-24T02:31:40,582  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:31:40,583  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:31:40,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:40,586  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,586  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,586  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,586  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,586  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_9260edca-9566-4636-a695-2b80f9f5c83c); Time taken: 0.006 seconds
2024-04-24T02:31:40,587  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023140_9260edca-9566-4636-a695-2b80f9f5c83c
2024-04-24T02:31:40,587  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:40,587  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_9260edca-9566-4636-a695-2b80f9f5c83c): drop table if exists nonAcidNonBucket
2024-04-24T02:31:40,587  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:40,590  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,590  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,590  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_9260edca-9566-4636-a695-2b80f9f5c83c); Time taken: 0.003 seconds
2024-04-24T02:31:40,590  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_9260edca-9566-4636-a695-2b80f9f5c83c
2024-04-24T02:31:40,591  INFO [Metastore Scheduled Worker 0] metastore.HMSHandler: 5: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:31:40,591  INFO [Metastore Scheduled Worker 0] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4749ae8e, with PersistenceManager: null will be shutdown
2024-04-24T02:31:40,591  INFO [Metastore Scheduled Worker 0] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4749ae8e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3d0fd595 created in the thread with id: 44
2024-04-24T02:31:40,596  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:31:40,604  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,604  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:31:40,605  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:40,605  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_7d0f2cc9-c720-496b-8803-e80ad921a019): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:40,608  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:31:40,608  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:31:40,609  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:40,609  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:40,614  INFO [Metastore Scheduled Worker 0] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4749ae8e from thread id: 44
2024-04-24T02:31:40,615  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:31:40,616  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:40,618  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:40,618  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,618  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,618  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,618  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=15, getDatabase_(String)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:31:40,618  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_7d0f2cc9-c720-496b-8803-e80ad921a019); Time taken: 0.013 seconds
2024-04-24T02:31:40,618  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023140_7d0f2cc9-c720-496b-8803-e80ad921a019
2024-04-24T02:31:40,618  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023140_7d0f2cc9-c720-496b-8803-e80ad921a019
2024-04-24T02:31:40,641  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023140_7d0f2cc9-c720-496b-8803-e80ad921a019 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:31:40,641  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:40,642  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_7d0f2cc9-c720-496b-8803-e80ad921a019): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:40,642  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951100, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFiles=0, numRows=0, totalSize=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:40,650  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:40,770  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,770  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=126, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,770  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_7d0f2cc9-c720-496b-8803-e80ad921a019); Time taken: 0.127 seconds
2024-04-24T02:31:40,770  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_7d0f2cc9-c720-496b-8803-e80ad921a019
2024-04-24T02:31:40,775  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:31:40,782  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,782  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:31:40,783  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:40,783  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_286ce884-2bbc-4b7d-80ee-869864176331): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:40,795  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:31:40,795  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:31:40,798  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:40,798  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:40,801  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:31:40,801  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:40,806  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:40,807  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,807  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,807  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,807  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=5, getValidTxns_(long)=3, openTxn_(String, TxnType)=11, isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:40,807  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_286ce884-2bbc-4b7d-80ee-869864176331); Time taken: 0.024 seconds
2024-04-24T02:31:40,807  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023140_286ce884-2bbc-4b7d-80ee-869864176331
2024-04-24T02:31:40,807  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023140_286ce884-2bbc-4b7d-80ee-869864176331
2024-04-24T02:31:40,826  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023140_286ce884-2bbc-4b7d-80ee-869864176331 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:31:40,826  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:40,827  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_286ce884-2bbc-4b7d-80ee-869864176331): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:40,827  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951100, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:40,837  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:31:40,856  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,856  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=27, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:40,856  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_286ce884-2bbc-4b7d-80ee-869864176331); Time taken: 0.029 seconds
2024-04-24T02:31:40,856  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_286ce884-2bbc-4b7d-80ee-869864176331
2024-04-24T02:31:40,862  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:31:40,869  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,869  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:31:40,870  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:40,870  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_f7d1cba4-c3db-4552-bb4a-b4b4635f3c7e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:40,873  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:31:40,873  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:31:40,874  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:40,874  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:40,877  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:31:40,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:40,879  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:40,879  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,879  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,879  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,879  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14}
2024-04-24T02:31:40,879  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_f7d1cba4-c3db-4552-bb4a-b4b4635f3c7e); Time taken: 0.009 seconds
2024-04-24T02:31:40,879  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023140_f7d1cba4-c3db-4552-bb4a-b4b4635f3c7e
2024-04-24T02:31:40,880  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023140_f7d1cba4-c3db-4552-bb4a-b4b4635f3c7e
2024-04-24T02:31:40,904  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023140_f7d1cba4-c3db-4552-bb4a-b4b4635f3c7e LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:31:40,904  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:40,904  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_f7d1cba4-c3db-4552-bb4a-b4b4635f3c7e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:40,904  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,905  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951100, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, transactional=false, bucketing_version=2, totalSize=0, numFilesErasureCoded=0, rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:40,915  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:31:40,942  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:40,942  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=37}
2024-04-24T02:31:40,943  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_f7d1cba4-c3db-4552-bb4a-b4b4635f3c7e); Time taken: 0.038 seconds
2024-04-24T02:31:40,943  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_f7d1cba4-c3db-4552-bb4a-b4b4635f3c7e
2024-04-24T02:31:40,950  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:31:40,957  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:40,958  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:31:40,958  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:40,958  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023140_95181efb-40d2-4604-88d6-e64b148ac492): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:40,961  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:31:40,961  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:31:40,962  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:40,962  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:40,965  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:31:40,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:40,967  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:40,967  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:40,967  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:40,967  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:40,967  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=15, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0}
2024-04-24T02:31:40,967  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023140_95181efb-40d2-4604-88d6-e64b148ac492); Time taken: 0.009 seconds
2024-04-24T02:31:40,968  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023140_95181efb-40d2-4604-88d6-e64b148ac492
2024-04-24T02:31:40,968  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023140_95181efb-40d2-4604-88d6-e64b148ac492
2024-04-24T02:31:40,987  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023140_95181efb-40d2-4604-88d6-e64b148ac492 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:31:40,987  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:40,987  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023140_95181efb-40d2-4604-88d6-e64b148ac492): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:40,987  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:40,988  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951100, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0, numFilesErasureCoded=0, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:40,995  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:31:41,012  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:41,012  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:41,012  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023140_95181efb-40d2-4604-88d6-e64b148ac492); Time taken: 0.025 seconds
2024-04-24T02:31:41,012  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023140_95181efb-40d2-4604-88d6-e64b148ac492
2024-04-24T02:31:41,017  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:31:41,024  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,024  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:31:41,025  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:41,025  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_df074a2e-69c0-48db-b6dd-711a0b3dd61d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:41,027  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:31:41,028  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:31:41,028  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:41,028  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:41,031  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:31:41,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:41,033  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:41,033  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:41,033  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:41,033  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,033  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, getDatabase_(String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T02:31:41,033  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_df074a2e-69c0-48db-b6dd-711a0b3dd61d); Time taken: 0.008 seconds
2024-04-24T02:31:41,034  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023141_df074a2e-69c0-48db-b6dd-711a0b3dd61d
2024-04-24T02:31:41,034  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023141_df074a2e-69c0-48db-b6dd-711a0b3dd61d
2024-04-24T02:31:41,049  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023141_df074a2e-69c0-48db-b6dd-711a0b3dd61d LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:31:41,049  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:41,050  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023141_df074a2e-69c0-48db-b6dd-711a0b3dd61d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:41,050  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:41,051  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dc113135-0f69-470d-93e2-42d1879970ee/_tmp_space.db/d636c1d6-d471-435d-a37b-069245cc0d6a
2024-04-24T02:31:41,054  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:41,054  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:41,054  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023141_df074a2e-69c0-48db-b6dd-711a0b3dd61d); Time taken: 0.004 seconds
2024-04-24T02:31:41,054  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023141_df074a2e-69c0-48db-b6dd-711a0b3dd61d
2024-04-24T02:31:41,058  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:31:41,065  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,065  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:31:41,066  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:41,066  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_4e9ae5fc-ed35-4260-b75c-9ca587ad41cb): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:41,069  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:31:41,069  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:31:41,070  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:41,070  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:41,072  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:31:41,072  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:41,074  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:41,074  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:41,074  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:41,074  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,074  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getDatabase_(String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, flushCache_()=0}
2024-04-24T02:31:41,075  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_4e9ae5fc-ed35-4260-b75c-9ca587ad41cb); Time taken: 0.008 seconds
2024-04-24T02:31:41,075  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023141_4e9ae5fc-ed35-4260-b75c-9ca587ad41cb
2024-04-24T02:31:41,075  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023141_4e9ae5fc-ed35-4260-b75c-9ca587ad41cb
2024-04-24T02:31:41,091  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023141_4e9ae5fc-ed35-4260-b75c-9ca587ad41cb LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:31:41,091  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:41,091  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023141_4e9ae5fc-ed35-4260-b75c-9ca587ad41cb): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:41,091  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:41,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951101, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=false, numFilesErasureCoded=0, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:41,098  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:31:41,113  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:41,113  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-24T02:31:41,113  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023141_4e9ae5fc-ed35-4260-b75c-9ca587ad41cb); Time taken: 0.022 seconds
2024-04-24T02:31:41,113  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023141_4e9ae5fc-ed35-4260-b75c-9ca587ad41cb
2024-04-24T02:31:41,117  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:31:41,124  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,125  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:31:41,125  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `aci/d_u/ami`
2024-04-24T02:31:41,126  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_379e53be-5a2c-4e47-aa7c-c375aadad7ad): drop table if exists `aci/d_u/ami`
2024-04-24T02:31:41,128  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:31:41,128  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:31:41,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,132  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:41,132  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:41,132  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,132  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:41,132  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_379e53be-5a2c-4e47-aa7c-c375aadad7ad); Time taken: 0.006 seconds
2024-04-24T02:31:41,133  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023141_379e53be-5a2c-4e47-aa7c-c375aadad7ad
2024-04-24T02:31:41,133  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:41,133  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023141_379e53be-5a2c-4e47-aa7c-c375aadad7ad): drop table if exists `aci/d_u/ami`
2024-04-24T02:31:41,133  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:41,133  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,136  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:41,136  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:41,136  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023141_379e53be-5a2c-4e47-aa7c-c375aadad7ad); Time taken: 0.003 seconds
2024-04-24T02:31:41,136  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023141_379e53be-5a2c-4e47-aa7c-c375aadad7ad
2024-04-24T02:31:41,142  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:31:41,149  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,149  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:31:41,150  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `src/name`
2024-04-24T02:31:41,150  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_79b53d01-908c-497a-8937-3e80fea7568b): drop table if exists `src/name`
2024-04-24T02:31:41,152  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:31:41,153  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:31:41,153  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:31:41,157  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:41,157  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:41,157  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,157  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:31:41,157  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_79b53d01-908c-497a-8937-3e80fea7568b); Time taken: 0.007 seconds
2024-04-24T02:31:41,158  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023141_79b53d01-908c-497a-8937-3e80fea7568b
2024-04-24T02:31:41,158  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:41,158  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023141_79b53d01-908c-497a-8937-3e80fea7568b): drop table if exists `src/name`
2024-04-24T02:31:41,158  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:41,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:31:41,161  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:41,161  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:41,162  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023141_79b53d01-908c-497a-8937-3e80fea7568b); Time taken: 0.003 seconds
2024-04-24T02:31:41,162  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023141_79b53d01-908c-497a-8937-3e80fea7568b
2024-04-24T02:31:41,167  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:31:41,175  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,175  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:31:41,175  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:41,176  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_00c057f4-e283-498c-89cc-723584b1a42a): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:41,179  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T02:31:41,179  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:31:41,180  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:41,180  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:41,182  INFO [main] parse.CalcitePlanner: Creating table default.aci/d_u/ami position=13
2024-04-24T02:31:41,183  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:41,184  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:41,184  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:41,184  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:41,185  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,185  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:41,185  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_00c057f4-e283-498c-89cc-723584b1a42a); Time taken: 0.009 seconds
2024-04-24T02:31:41,185  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023141_00c057f4-e283-498c-89cc-723584b1a42a
2024-04-24T02:31:41,185  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023141_00c057f4-e283-498c-89cc-723584b1a42a
2024-04-24T02:31:41,201  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023141_00c057f4-e283-498c-89cc-723584b1a42a LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:31:41,201  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:41,201  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023141_00c057f4-e283-498c-89cc-723584b1a42a): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:41,201  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:41,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:aci/d_u/ami, dbName:default, owner:alex, createTime:1713951101, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:i, type:int, comment:null), FieldSchema(name:d?*de e, type:decimal(5,2), comment:null), FieldSchema(name:vc, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[i], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, totalSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"d?*de e":"true","i":"true","vc":"true"}}, transactional=true, numFilesErasureCoded=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:41,207  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/aci-47-d_u-47-ami
2024-04-24T02:31:41,223  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:41,223  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:41,223  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023141_00c057f4-e283-498c-89cc-723584b1a42a); Time taken: 0.022 seconds
2024-04-24T02:31:41,223  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023141_00c057f4-e283-498c-89cc-723584b1a42a
2024-04-24T02:31:41,227  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T02:31:41,233  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,233  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:31:41,233  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-24T02:31:41,234  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_1a068f10-ba59-49fe-a799-5014b0c53d89): create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-24T02:31:41,236  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T02:31:41,236  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:31:41,237  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:41,237  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:41,239  INFO [main] parse.CalcitePlanner: Creating table default.src/name position=13
2024-04-24T02:31:41,239  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:41,241  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:41,241  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:41,241  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:41,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:31:41,241  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_1a068f10-ba59-49fe-a799-5014b0c53d89); Time taken: 0.007 seconds
2024-04-24T02:31:41,242  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023141_1a068f10-ba59-49fe-a799-5014b0c53d89
2024-04-24T02:31:41,242  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023141_1a068f10-ba59-49fe-a799-5014b0c53d89
2024-04-24T02:31:41,255  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023141_1a068f10-ba59-49fe-a799-5014b0c53d89 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:31:41,255  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:41,255  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023141_1a068f10-ba59-49fe-a799-5014b0c53d89): create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-24T02:31:41,255  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:41,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:src/name, dbName:default, owner:alex, createTime:1713951101, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:gh, type:int, comment:null), FieldSchema(name:j, type:decimal(5,2), comment:null), FieldSchema(name:k, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"gh":"true","j":"true","k":"true"}}, bucketing_version=2, totalSize=0, numRows=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:41,262  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/src-47-name
2024-04-24T02:31:41,276  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:41,277  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:41,277  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023141_1a068f10-ba59-49fe-a799-5014b0c53d89); Time taken: 0.021 seconds
2024-04-24T02:31:41,277  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023141_1a068f10-ba59-49fe-a799-5014b0c53d89
2024-04-24T02:31:41,281  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:31:41,286  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,286  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:31:41,287  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')
2024-04-24T02:31:41,287  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_9367dccd-fa7f-4795-8a6e-b2c00bac3d1a): merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')
2024-04-24T02:31:41,290  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-24T02:31:41,290  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:31:41,291  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:31:41,291  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,312  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-24T02:31:41,315  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dc113135-0f69-470d-93e2-42d1879970ee/_tmp_space.db/merge_tmp_table
2024-04-24T02:31:41,318  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')> as 
<FROM
  `default`.`aci/d_u/ami` `d/8`
  RIGHT OUTER JOIN
  `default`.`src/name` `a/b`
  ON `i`=`gh`
INSERT INTO `default`.`aci/d_u/ami`    -- delete clause
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`gh` AND `i` > 5
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- update clause(insert part)
 SELECT `d/8`.`i`, `d/8`.`d?*de e`, 'blah'
   WHERE `i`=`gh` AND NOT(`i` > 5)
INSERT INTO `default`.`aci/d_u/ami`    -- update clause (delete part)
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`gh` AND NOT(`i` > 5)
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- insert clause
  SELECT 1,2.1,'baz'
   WHERE `d/8`.`i` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`d/8`.ROW__ID)
 WHERE `i`=`gh` GROUP BY `d/8`.ROW__ID HAVING count(*) > 1>
2024-04-24T02:31:41,319  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:31:41,323  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:41,323  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:41,324  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,331  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:31:41,355  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,356  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:41,356  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:41,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,363  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,371  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,378  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,385  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,385  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:41,385  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:31:41,385  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:41,386  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:41,386  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:41,399  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.src/name	
2024-04-24T02:31:41,464  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.aci/d_u/ami, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:31:41,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,473  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,483  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,494  WARN [main] calcite.RelOptHiveTable: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-24T02:31:41,494  INFO [main] SessionState: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-24T02:31:41,494  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.src/name, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:31:41,495  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:31:41,510  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,510  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:31:41,522  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.src/name	
2024-04-24T02:31:41,534  WARN [main] calcite.RelOptHiveTable: No Stats for default@src/name, Columns: gh
No Stats for default@src/name, Columns: gh
2024-04-24T02:31:41,534  INFO [main] SessionState: No Stats for default@src/name, Columns: gh
2024-04-24T02:31:41,729  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:41,729  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:41,729  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:41,729  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:41,729  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:41,729  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:41,729  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:41,729  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:31:41,730  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:31:41,730  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:41,730  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:41,730  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:31:41,730  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,738  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,738  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,745  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,745  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,754  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:31:41,761  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,767 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:31:41,768 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:31:41,768  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:31:41,769 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:31:41,769  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,769  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=7, getTableColumnStatistics_(String, String, List, String)=68, getAllTableConstraints_(AllTableConstraintsRequest)=30, getTable_(GetTableRequest)=112, createTable_(Table)=3, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:31:41,769  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_9367dccd-fa7f-4795-8a6e-b2c00bac3d1a); Time taken: 0.482 seconds
2024-04-24T02:31:41,769  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:31:41,773  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,781  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:31:41,781  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc113135-0f69-470d-93e2-42d1879970ee/hive_2024-04-24_02-31-41_318_170501164918021608-1
2024-04-24T02:31:41,781  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_4cabf77e-f307-42a2-ae2b-f0dac1629837): drop table if exists acidTbl
2024-04-24T02:31:41,784  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 8
2024-04-24T02:31:41,784  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:31:41,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:41,792  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,792  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:41,792  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:41,792  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,792  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, rollbackTxn_(long)=11, getTable_(GetTableRequest)=7, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-24T02:31:41,792  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_4cabf77e-f307-42a2-ae2b-f0dac1629837); Time taken: 0.011 seconds
2024-04-24T02:31:41,793  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023141_4cabf77e-f307-42a2-ae2b-f0dac1629837
2024-04-24T02:31:41,793  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023141_4cabf77e-f307-42a2-ae2b-f0dac1629837
2024-04-24T02:31:41,811  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023141_4cabf77e-f307-42a2-ae2b-f0dac1629837 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:31:41,811  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:41,811  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023141_4cabf77e-f307-42a2-ae2b-f0dac1629837): drop table if exists acidTbl
2024-04-24T02:31:41,811  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:41,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:41,818  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:41,824  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:41,931  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:41,931  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=112, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:41,931  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023141_4cabf77e-f307-42a2-ae2b-f0dac1629837); Time taken: 0.12 seconds
2024-04-24T02:31:41,931  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023141_4cabf77e-f307-42a2-ae2b-f0dac1629837
2024-04-24T02:31:41,935  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:31:41,941  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:41,941  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:31:41,941  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:31:41,942  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023141_05ea5179-f62e-4292-a747-36a0f08e7188): drop table if exists acidTblPart
2024-04-24T02:31:41,944  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 10
2024-04-24T02:31:41,944  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:31:41,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:41,951  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,951  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:41,951  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:41,951  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:41,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=6, getValidTxns_(long)=1}
2024-04-24T02:31:41,952  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023141_05ea5179-f62e-4292-a747-36a0f08e7188); Time taken: 0.009 seconds
2024-04-24T02:31:41,952  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023141_05ea5179-f62e-4292-a747-36a0f08e7188
2024-04-24T02:31:41,953  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023141_05ea5179-f62e-4292-a747-36a0f08e7188
2024-04-24T02:31:41,966  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023141_05ea5179-f62e-4292-a747-36a0f08e7188 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:31:41,966  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:41,967  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023141_05ea5179-f62e-4292-a747-36a0f08e7188): drop table if exists acidTblPart
2024-04-24T02:31:41,967  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:41,967  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:41,973  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:41,980  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:41,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:42,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:42,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=49, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:42,022  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023141_05ea5179-f62e-4292-a747-36a0f08e7188); Time taken: 0.055 seconds
2024-04-24T02:31:42,023  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023141_05ea5179-f62e-4292-a747-36a0f08e7188
2024-04-24T02:31:42,028  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:31:42,034  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:42,035  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:31:42,035  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:31:42,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023142_b0cbf42a-6776-4771-a6d8-c046106b7340): drop table if exists acidTbl2
2024-04-24T02:31:42,037  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 12
2024-04-24T02:31:42,038  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:31:42,038  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:42,038  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:42,038  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:42,039  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, getValidTxns_(long)=0}
2024-04-24T02:31:42,039  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023142_b0cbf42a-6776-4771-a6d8-c046106b7340); Time taken: 0.003 seconds
2024-04-24T02:31:42,039  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023142_b0cbf42a-6776-4771-a6d8-c046106b7340
2024-04-24T02:31:42,039  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:42,039  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023142_b0cbf42a-6776-4771-a6d8-c046106b7340): drop table if exists acidTbl2
2024-04-24T02:31:42,039  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:42,040  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:31:42,040  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:42,040  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-24T02:31:42,040  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023142_b0cbf42a-6776-4771-a6d8-c046106b7340); Time taken: 0.001 seconds
2024-04-24T02:31:42,041  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023142_b0cbf42a-6776-4771-a6d8-c046106b7340
2024-04-24T02:31:42,045  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:31:42,051  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:42,051  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:31:42,052  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:31:42,052  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023142_5bf218c5-9a67-4339-b9af-731bad326853): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:42,054  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 12
2024-04-24T02:31:42,055  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:31:42,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:42,083  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,083  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:42,083  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:42,083  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:42,084  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=28, openTxn_(String, TxnType)=3}
2024-04-24T02:31:42,084  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023142_5bf218c5-9a67-4339-b9af-731bad326853); Time taken: 0.031 seconds
2024-04-24T02:31:42,084  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023142_5bf218c5-9a67-4339-b9af-731bad326853
2024-04-24T02:31:42,085  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023142_5bf218c5-9a67-4339-b9af-731bad326853
2024-04-24T02:31:42,113  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023142_5bf218c5-9a67-4339-b9af-731bad326853 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:31:42,113  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:42,113  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023142_5bf218c5-9a67-4339-b9af-731bad326853): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:42,114  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:42,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:42,128  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:42,143  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:42,252  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:42,252  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=123}
2024-04-24T02:31:42,253  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023142_5bf218c5-9a67-4339-b9af-731bad326853); Time taken: 0.139 seconds
2024-04-24T02:31:42,253  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023142_5bf218c5-9a67-4339-b9af-731bad326853
2024-04-24T02:31:42,258  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:31:42,266  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:42,266  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:31:42,267  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:42,267  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023142_707b4723-96b8-4b0a-ab9a-556a203df44f): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:42,270  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 17
2024-04-24T02:31:42,270  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T02:31:42,271  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:42,282  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,282  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:42,282  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:42,282  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:42,282  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=11, openTxn_(String, TxnType)=2}
2024-04-24T02:31:42,282  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023142_707b4723-96b8-4b0a-ab9a-556a203df44f); Time taken: 0.015 seconds
2024-04-24T02:31:42,282  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424023142_707b4723-96b8-4b0a-ab9a-556a203df44f
2024-04-24T02:31:42,283  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023142_707b4723-96b8-4b0a-ab9a-556a203df44f
2024-04-24T02:31:42,299  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023142_707b4723-96b8-4b0a-ab9a-556a203df44f LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:31:42,299  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:42,299  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023142_707b4723-96b8-4b0a-ab9a-556a203df44f): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:42,299  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:42,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:42,312  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:42,321  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:42,356  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:42,356  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=44, getTable_(GetTableRequest)=13, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:42,357  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023142_707b4723-96b8-4b0a-ab9a-556a203df44f); Time taken: 0.057 seconds
2024-04-24T02:31:42,357  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023142_707b4723-96b8-4b0a-ab9a-556a203df44f
2024-04-24T02:31:42,361  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T02:31:42,369  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:42,369  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T02:31:42,384  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:31:42,385  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023142_bb0ddab6-a8d5-444b-858b-507123f61bb3): drop table if exists nonAcidNonBucket
2024-04-24T02:31:42,388  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 18
2024-04-24T02:31:42,389  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T02:31:42,390  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:42,400  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,400  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:42,400  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:42,400  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:42,401  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=27, openTxn_(String, TxnType)=4, getValidTxns_(long)=0, getTable_(GetTableRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:42,401  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023142_bb0ddab6-a8d5-444b-858b-507123f61bb3); Time taken: 0.015 seconds
2024-04-24T02:31:42,401  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424023142_bb0ddab6-a8d5-444b-858b-507123f61bb3
2024-04-24T02:31:42,401  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023142_bb0ddab6-a8d5-444b-858b-507123f61bb3
2024-04-24T02:31:42,418  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023142_bb0ddab6-a8d5-444b-858b-507123f61bb3 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:31:42,418  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:31:42,418  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023142_bb0ddab6-a8d5-444b-858b-507123f61bb3): drop table if exists nonAcidNonBucket
2024-04-24T02:31:42,418  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:42,418  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:42,428  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,428  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:42,437  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:42,437  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:42,473  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:42,474  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=45, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:42,474  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023142_bb0ddab6-a8d5-444b-858b-507123f61bb3); Time taken: 0.055 seconds
2024-04-24T02:31:42,474  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023142_bb0ddab6-a8d5-444b-858b-507123f61bb3
2024-04-24T02:31:42,478  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T02:31:42,486  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:42,486  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T02:31:42,487  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testParallelTruncateAnalyzeStats" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="7.876"/>
  <testcase name="testMergeCardinalityViolation" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="6.904"/>
  <testcase name="testUpdateOfInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="7.486">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = 1 where b != 1 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:31:57,334  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:31:57,336  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 77c025b1-8581-4262-87fd-6f0a1411c13b
2024-04-24T02:31:57,338  INFO [main] SessionState: Hive Session ID = 77c025b1-8581-4262-87fd-6f0a1411c13b
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:31:57,339  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:31:57,344  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/77c025b1-8581-4262-87fd-6f0a1411c13b
2024-04-24T02:31:57,346  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b
2024-04-24T02:31:57,349  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/77c025b1-8581-4262-87fd-6f0a1411c13b/_tmp_space.db
2024-04-24T02:31:57,349  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=77c025b1-8581-4262-87fd-6f0a1411c13b, clientType=HIVECLI]
2024-04-24T02:31:57,349  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:31:57,349  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_a1221bdf-20fe-4d4f-8ee0-bfbbccb2f1ff): drop table if exists acidTbl
2024-04-24T02:31:57,359  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:31:57,360  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:31:57,362  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:57,370  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,370  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,370  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,370  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2}
2024-04-24T02:31:57,370  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_a1221bdf-20fe-4d4f-8ee0-bfbbccb2f1ff); Time taken: 0.021 seconds
2024-04-24T02:31:57,370  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023157_a1221bdf-20fe-4d4f-8ee0-bfbbccb2f1ff
2024-04-24T02:31:57,370  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:57,371  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_a1221bdf-20fe-4d4f-8ee0-bfbbccb2f1ff): drop table if exists acidTbl
2024-04-24T02:31:57,371  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:57,374  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,374  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,374  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_a1221bdf-20fe-4d4f-8ee0-bfbbccb2f1ff); Time taken: 0.003 seconds
2024-04-24T02:31:57,374  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_a1221bdf-20fe-4d4f-8ee0-bfbbccb2f1ff
2024-04-24T02:31:57,379  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:31:57,384  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,384  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:31:57,384  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:31:57,385  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_910b90df-db5c-4bc7-bf23-3c0daf0d2870): drop table if exists acidTblPart
2024-04-24T02:31:57,387  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:31:57,387  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:31:57,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:57,390  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,390  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,391  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,391  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2}
2024-04-24T02:31:57,391  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_910b90df-db5c-4bc7-bf23-3c0daf0d2870); Time taken: 0.006 seconds
2024-04-24T02:31:57,391  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023157_910b90df-db5c-4bc7-bf23-3c0daf0d2870
2024-04-24T02:31:57,391  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:57,391  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_910b90df-db5c-4bc7-bf23-3c0daf0d2870): drop table if exists acidTblPart
2024-04-24T02:31:57,391  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:31:57,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,395  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:57,395  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_910b90df-db5c-4bc7-bf23-3c0daf0d2870); Time taken: 0.004 seconds
2024-04-24T02:31:57,395  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_910b90df-db5c-4bc7-bf23-3c0daf0d2870
2024-04-24T02:31:57,399  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:31:57,404  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,404  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:31:57,405  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:31:57,405  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_c31c0c8e-59b9-4e77-9f81-aaafd1b4c19d): drop table if exists acidTbl2
2024-04-24T02:31:57,408  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:31:57,408  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:31:57,409  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:31:57,412  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,412  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,412  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,412  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2}
2024-04-24T02:31:57,412  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_c31c0c8e-59b9-4e77-9f81-aaafd1b4c19d); Time taken: 0.007 seconds
2024-04-24T02:31:57,412  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023157_c31c0c8e-59b9-4e77-9f81-aaafd1b4c19d
2024-04-24T02:31:57,413  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:57,413  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_c31c0c8e-59b9-4e77-9f81-aaafd1b4c19d): drop table if exists acidTbl2
2024-04-24T02:31:57,413  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:31:57,416  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,416  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,416  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_c31c0c8e-59b9-4e77-9f81-aaafd1b4c19d); Time taken: 0.003 seconds
2024-04-24T02:31:57,416  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_c31c0c8e-59b9-4e77-9f81-aaafd1b4c19d
2024-04-24T02:31:57,421  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:31:57,426  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,426  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:31:57,427  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:31:57,427  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_a50d6015-0a5b-4337-8057-67e10d2033be): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:57,429  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:31:57,430  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:31:57,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:57,433  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,433  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,433  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-24T02:31:57,434  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_a50d6015-0a5b-4337-8057-67e10d2033be); Time taken: 0.006 seconds
2024-04-24T02:31:57,434  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023157_a50d6015-0a5b-4337-8057-67e10d2033be
2024-04-24T02:31:57,434  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:57,434  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_a50d6015-0a5b-4337-8057-67e10d2033be): drop table if exists nonAcidOrcTbl
2024-04-24T02:31:57,434  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,434  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:31:57,437  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,438  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,438  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_a50d6015-0a5b-4337-8057-67e10d2033be); Time taken: 0.003 seconds
2024-04-24T02:31:57,438  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_a50d6015-0a5b-4337-8057-67e10d2033be
2024-04-24T02:31:57,443  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:31:57,449  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,449  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:31:57,449  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:57,450  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_3ccdb54f-00c5-4f4c-9703-12c1c4700724): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:57,452  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:31:57,452  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:31:57,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:57,456  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,456  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,456  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,456  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,456  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_3ccdb54f-00c5-4f4c-9703-12c1c4700724); Time taken: 0.006 seconds
2024-04-24T02:31:57,456  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023157_3ccdb54f-00c5-4f4c-9703-12c1c4700724
2024-04-24T02:31:57,456  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:57,456  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_3ccdb54f-00c5-4f4c-9703-12c1c4700724): drop table if exists nonAcidOrcTbl2
2024-04-24T02:31:57,456  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:31:57,460  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,460  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,460  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_3ccdb54f-00c5-4f4c-9703-12c1c4700724); Time taken: 0.004 seconds
2024-04-24T02:31:57,460  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_3ccdb54f-00c5-4f4c-9703-12c1c4700724
2024-04-24T02:31:57,465  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:31:57,471  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,471  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:31:57,472  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:31:57,472  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_f9d4ab83-3c4e-4dc4-a6bb-16e1ca15e60a): drop table if exists nonAcidNonBucket
2024-04-24T02:31:57,474  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:31:57,475  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:31:57,475  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:57,479  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,479  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,479  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,479  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-24T02:31:57,479  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_f9d4ab83-3c4e-4dc4-a6bb-16e1ca15e60a); Time taken: 0.007 seconds
2024-04-24T02:31:57,480  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023157_f9d4ab83-3c4e-4dc4-a6bb-16e1ca15e60a
2024-04-24T02:31:57,480  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:31:57,480  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_f9d4ab83-3c4e-4dc4-a6bb-16e1ca15e60a): drop table if exists nonAcidNonBucket
2024-04-24T02:31:57,480  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,480  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:31:57,483  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,483  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,484  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_f9d4ab83-3c4e-4dc4-a6bb-16e1ca15e60a); Time taken: 0.003 seconds
2024-04-24T02:31:57,484  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_f9d4ab83-3c4e-4dc4-a6bb-16e1ca15e60a
2024-04-24T02:31:57,489  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:31:57,495  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,495  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:31:57,496  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,496  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_7038cfed-237e-475b-a981-865754192803): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,498  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:31:57,498  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:31:57,499  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:57,499  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:57,505  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:31:57,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:57,507  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:57,507  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,507  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,507  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,508  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=6}
2024-04-24T02:31:57,508  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_7038cfed-237e-475b-a981-865754192803); Time taken: 0.011 seconds
2024-04-24T02:31:57,508  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023157_7038cfed-237e-475b-a981-865754192803
2024-04-24T02:31:57,508  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023157_7038cfed-237e-475b-a981-865754192803
2024-04-24T02:31:57,526  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023157_7038cfed-237e-475b-a981-865754192803 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:31:57,526  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:57,526  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_7038cfed-237e-475b-a981-865754192803): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,526  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,527  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951117, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, bucketing_version=2, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numRows=0, rawDataSize=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:57,533  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:57,562  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,562  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=35, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,562  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_7038cfed-237e-475b-a981-865754192803); Time taken: 0.036 seconds
2024-04-24T02:31:57,562  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_7038cfed-237e-475b-a981-865754192803
2024-04-24T02:31:57,566  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:31:57,571  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,571  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:31:57,572  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,572  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_02bc1d7c-7579-4b84-88a5-169538925407): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,575  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:31:57,575  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:31:57,576  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:57,576  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:57,578  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:31:57,578  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:57,580  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:57,580  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,580  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,580  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,580  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2, flushCache_()=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-24T02:31:57,581  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_02bc1d7c-7579-4b84-88a5-169538925407); Time taken: 0.008 seconds
2024-04-24T02:31:57,581  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023157_02bc1d7c-7579-4b84-88a5-169538925407
2024-04-24T02:31:57,581  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023157_02bc1d7c-7579-4b84-88a5-169538925407
2024-04-24T02:31:57,594  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023157_02bc1d7c-7579-4b84-88a5-169538925407 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:31:57,594  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:57,594  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_02bc1d7c-7579-4b84-88a5-169538925407): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,594  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951117, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:31:57,601  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:31:57,620  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,621  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=25}
2024-04-24T02:31:57,621  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_02bc1d7c-7579-4b84-88a5-169538925407); Time taken: 0.026 seconds
2024-04-24T02:31:57,621  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_02bc1d7c-7579-4b84-88a5-169538925407
2024-04-24T02:31:57,624  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:31:57,630  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,630  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:31:57,630  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,631  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_b1cb51bb-dcd0-4ff5-b59b-4a1da34b88fb): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,633  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:31:57,633  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:31:57,634  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:57,634  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:57,636  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:31:57,636  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:57,638  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:57,638  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,638  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,638  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,638  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2}
2024-04-24T02:31:57,638  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_b1cb51bb-dcd0-4ff5-b59b-4a1da34b88fb); Time taken: 0.007 seconds
2024-04-24T02:31:57,638  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023157_b1cb51bb-dcd0-4ff5-b59b-4a1da34b88fb
2024-04-24T02:31:57,638  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023157_b1cb51bb-dcd0-4ff5-b59b-4a1da34b88fb
2024-04-24T02:31:57,652  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023157_b1cb51bb-dcd0-4ff5-b59b-4a1da34b88fb LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:31:57,652  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:57,652  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_b1cb51bb-dcd0-4ff5-b59b-4a1da34b88fb): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,652  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951117, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0, bucketing_version=2, numRows=0, rawDataSize=0, transactional=false, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:57,659  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:31:57,676  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,677  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=23}
2024-04-24T02:31:57,677  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_b1cb51bb-dcd0-4ff5-b59b-4a1da34b88fb); Time taken: 0.024 seconds
2024-04-24T02:31:57,677  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_b1cb51bb-dcd0-4ff5-b59b-4a1da34b88fb
2024-04-24T02:31:57,681  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:31:57,687  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,687  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:31:57,688  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,688  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_e3066d11-4eff-4a8a-a3b9-151b2fc0f3ae): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,691  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:31:57,691  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:31:57,691  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:57,691  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:57,694  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:31:57,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:57,696  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:57,696  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,696  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,696  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,696  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0, getValidWriteIds_(List, String)=2}
2024-04-24T02:31:57,696  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_e3066d11-4eff-4a8a-a3b9-151b2fc0f3ae); Time taken: 0.008 seconds
2024-04-24T02:31:57,697  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023157_e3066d11-4eff-4a8a-a3b9-151b2fc0f3ae
2024-04-24T02:31:57,697  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023157_e3066d11-4eff-4a8a-a3b9-151b2fc0f3ae
2024-04-24T02:31:57,712  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023157_e3066d11-4eff-4a8a-a3b9-151b2fc0f3ae LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:31:57,712  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:57,712  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_e3066d11-4eff-4a8a-a3b9-151b2fc0f3ae): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,713  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,713  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951117, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, transactional=false, numRows=0, totalSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:57,720  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:31:57,744  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,744  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=31, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,744  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_e3066d11-4eff-4a8a-a3b9-151b2fc0f3ae); Time taken: 0.032 seconds
2024-04-24T02:31:57,744  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_e3066d11-4eff-4a8a-a3b9-151b2fc0f3ae
2024-04-24T02:31:57,748  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:31:57,754  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,754  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:31:57,755  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,755  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_3a36352d-9233-4c42-87e0-719d01551022): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,757  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:31:57,757  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:31:57,758  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:57,758  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:57,760  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:31:57,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:57,762  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:57,762  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,762  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,762  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,762  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2}
2024-04-24T02:31:57,762  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_3a36352d-9233-4c42-87e0-719d01551022); Time taken: 0.007 seconds
2024-04-24T02:31:57,763  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023157_3a36352d-9233-4c42-87e0-719d01551022
2024-04-24T02:31:57,763  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023157_3a36352d-9233-4c42-87e0-719d01551022
2024-04-24T02:31:57,782  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023157_3a36352d-9233-4c42-87e0-719d01551022 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:31:57,782  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:57,783  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_3a36352d-9233-4c42-87e0-719d01551022): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:31:57,783  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,784  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/77c025b1-8581-4262-87fd-6f0a1411c13b/_tmp_space.db/c0e2f53b-dc5f-4f93-8905-5a08bc763f7b
2024-04-24T02:31:57,787  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,787  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,788  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_3a36352d-9233-4c42-87e0-719d01551022); Time taken: 0.004 seconds
2024-04-24T02:31:57,788  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_3a36352d-9233-4c42-87e0-719d01551022
2024-04-24T02:31:57,793  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:31:57,801  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,801  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:31:57,802  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,802  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_f4362bf0-7c6c-410e-9c60-ae9d77d39b1a): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,805  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:31:57,806  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:31:57,806  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:57,806  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:57,810  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:31:57,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:31:57,812  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:57,812  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:57,813  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:31:57,813  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:57,813  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, getValidTxns_(long)=0}
2024-04-24T02:31:57,813  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_f4362bf0-7c6c-410e-9c60-ae9d77d39b1a); Time taken: 0.011 seconds
2024-04-24T02:31:57,813  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023157_f4362bf0-7c6c-410e-9c60-ae9d77d39b1a
2024-04-24T02:31:57,814  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023157_f4362bf0-7c6c-410e-9c60-ae9d77d39b1a
2024-04-24T02:31:57,832  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023157_f4362bf0-7c6c-410e-9c60-ae9d77d39b1a LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:31:57,832  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:31:57,832  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_f4362bf0-7c6c-410e-9c60-ae9d77d39b1a): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:31:57,832  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:31:57,833  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951117, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, transactional=false, bucketing_version=2, numFiles=0, totalSize=0, numFilesErasureCoded=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:31:57,843  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:31:57,860  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:57,860  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=27, isCompatibleWith_(Configuration)=0}
2024-04-24T02:31:57,860  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_f4362bf0-7c6c-410e-9c60-ae9d77d39b1a); Time taken: 0.028 seconds
2024-04-24T02:31:57,860  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_f4362bf0-7c6c-410e-9c60-ae9d77d39b1a
2024-04-24T02:31:57,864  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:31:57,870  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:57,870  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:31:57,870  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:31:57,870  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:31:57,873  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:31:57,873  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:31:57,873  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:57,873  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:57,878  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:57,898  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:57,899  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:57,899  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:57,899  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:57,899  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:57,899  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:57,906  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:57,906  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:57,906  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:31:57,929  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:58,004  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:58,004  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:58,005  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:58,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:31:58,008  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:58,008  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:58,008  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:58,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:31:58,014  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:58,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:58,017  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:58,024  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-24T02:31:58,024  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-24T02:31:58,025  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:31:58,029  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:31:58,030  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:31:58,030  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:31:58,031  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:31:58,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:58,049  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:58,050  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:31:58,050  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:58,050  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:58,050  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-24T02:31:58,050  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:58,050  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, getValidTxns_(long)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, allocateTableWriteId_(long, String, String)=6, getAllTableConstraints_(AllTableConstraintsRequest)=27, openTxn_(String, TxnType)=2, getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=43, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:31:58,050  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd); Time taken: 0.18 seconds
2024-04-24T02:31:58,051  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd
2024-04-24T02:31:58,051  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd
2024-04-24T02:31:58,071  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:31:58,071  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:31:58,074  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:31:58,074  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd
2024-04-24T02:31:58,074  INFO [main] ql.Driver: Query ID = alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd
Total jobs = 1
2024-04-24T02:31:58,074  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:31:58,074  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:31:58,221  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:31:58,221  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:31:58,221  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:31:58,221  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:31:58,221  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:31:58,221  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:31:58,221  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:31:58,221  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:31:58,224  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:31:58,224  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:31:58,224  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-57_870_1440401581272947062-1/dummy_path
2024-04-24T02:31:58,233  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:31:58,234  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:31:58,238  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:31:58,239  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:31:58,240  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:58,244  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-57_870_1440401581272947062-1/-mr-10000
2024-04-24T02:31:58,247  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:58,253  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:31:58,258  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:31:58,259  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:31:58,259  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:31:58,259  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-57_870_1440401581272947062-1/dummy_path
2024-04-24T02:31:58,259  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:31:58,276  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:31:58,294  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1111571339_0030
2024-04-24T02:31:58,294  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:31:58,354  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:31:58,354  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:31:58,354  INFO [Thread-2395] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:58,355  INFO [Thread-2395] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:58,356  INFO [Thread-2395] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:31:58,356  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1111571339_0030_m_000000_0
2024-04-24T02:31:58,359  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:58,359  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-57_870_1440401581272947062-1/dummy_path/null:0+1
2024-04-24T02:31:58,361  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:31:58,361  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:31:58,362  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:31:58,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:31:58,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:31:58,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:31:58,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:31:58,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:31:58,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:31:58,367  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:31:58,367  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:31:58,368  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:31:58,368  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:31:58,368  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:31:58,368  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:31:58,368  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:31:58,368  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:31:58,368  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:31:58,368  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:31:58,369  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:31:58,369  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:31:58,369  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:31:58,369  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:31:58,369  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:31:58,369  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-24T02:31:58,369  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T02:31:58,370  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T02:31:58,372  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:31:58,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:31:58,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:31:58,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T02:31:58,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:31:58,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:31:58,387  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1111571339_0030_m_000000_0 is done. And is in the process of committing
2024-04-24T02:31:58,388  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:31:58,388  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1111571339_0030_m_000000_0' done.
2024-04-24T02:31:58,388  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1111571339_0030_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=589038
		FILE: Number of bytes written=35349356
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1310195712
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5019
2024-04-24T02:31:58,388  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1111571339_0030_m_000000_0
2024-04-24T02:31:58,388  INFO [Thread-2395] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:31:58,389  INFO [Thread-2395] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:31:58,389  INFO [pool-155-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1111571339_0030_r_000000_0
2024-04-24T02:31:58,391  INFO [pool-155-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:58,391  INFO [pool-155-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@16bd902b
2024-04-24T02:31:58,391  WARN [pool-155-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:58,392  INFO [pool-155-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:58,393  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1111571339_0030_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:58,396  INFO [localfetcher#43] reduce.LocalFetcher: localfetcher#43 about to shuffle output of map attempt_local1111571339_0030_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:31:58,396  INFO [localfetcher#43] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1111571339_0030_m_000000_0
2024-04-24T02:31:58,396  INFO [localfetcher#43] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:31:58,396  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:58,396  INFO [pool-155-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:58,397  INFO [pool-155-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:58,403  INFO [pool-155-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:58,403  INFO [pool-155-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:31:58,405  INFO [pool-155-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:58,405  INFO [pool-155-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:31:58,405  INFO [pool-155-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:58,405  INFO [pool-155-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:58,406  INFO [pool-155-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:31:58,406  INFO [pool-155-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:58,406  INFO [pool-155-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:58,407  INFO [pool-155-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:31:58,408  INFO [pool-155-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:58,408  INFO [pool-155-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:58,408  INFO [pool-155-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:58,408  INFO [pool-155-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:58,408  INFO [pool-155-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1111571339_0030/job_local1111571339_0030.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@286a311d
2024-04-24T02:31:58,408  INFO [pool-155-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:58,408  INFO [pool-155-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:58,408  INFO [pool-155-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:31:58,409  INFO [pool-155-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:58,409  INFO [pool-155-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:31:58,415  INFO [pool-155-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:31:58,419  INFO [pool-155-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:58,420  INFO [pool-155-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:58,420  INFO [pool-155-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:58,420  INFO [pool-155-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:58,421  INFO [pool-155-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:31:58,432  INFO [pool-155-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:58,433  INFO [pool-155-thread-1] mapred.Task: Task:attempt_local1111571339_0030_r_000000_0 is done. And is in the process of committing
2024-04-24T02:31:58,433  INFO [pool-155-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:58,433  INFO [pool-155-thread-1] mapred.Task: Task 'attempt_local1111571339_0030_r_000000_0' done.
2024-04-24T02:31:58,433  INFO [pool-155-thread-1] mapred.Task: Final Counters for attempt_local1111571339_0030_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=595143
		FILE: Number of bytes written=35350395
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1310195712
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:58,433  INFO [pool-155-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1111571339_0030_r_000000_0
2024-04-24T02:31:58,433  INFO [pool-155-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1111571339_0030_r_000001_0
2024-04-24T02:31:58,433  INFO [pool-155-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:58,434  INFO [pool-155-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7dd6af53
2024-04-24T02:31:58,434  WARN [pool-155-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:58,434  INFO [pool-155-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:58,435  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1111571339_0030_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:58,438  INFO [localfetcher#44] reduce.LocalFetcher: localfetcher#44 about to shuffle output of map attempt_local1111571339_0030_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:31:58,438  INFO [localfetcher#44] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1111571339_0030_m_000000_0
2024-04-24T02:31:58,438  INFO [localfetcher#44] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:31:58,438  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:31:58,438  INFO [pool-155-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:58,438  INFO [pool-155-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:31:58,446  INFO [pool-155-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:58,446  INFO [pool-155-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:31:58,449  INFO [pool-155-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:31:58,449  INFO [pool-155-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:31:58,449  INFO [pool-155-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:31:58,449  INFO [pool-155-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:31:58,449  INFO [pool-155-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:31:58,449  INFO [pool-155-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:31:58,449  INFO [pool-155-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:31:58,450  INFO [pool-155-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:31:58,450  INFO [pool-155-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:31:58,450  INFO [pool-155-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:31:58,450  INFO [pool-155-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:31:58,451  INFO [pool-155-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:31:58,452  INFO [pool-155-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1111571339_0030/job_local1111571339_0030.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7f90c3b5
2024-04-24T02:31:58,452  INFO [pool-155-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:58,452  INFO [pool-155-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:58,452  INFO [pool-155-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:31:58,452  INFO [pool-155-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:58,452  INFO [pool-155-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:31:58,457  INFO [pool-155-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:31:58,457  INFO [pool-155-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:31:58,457  INFO [pool-155-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:31:58,457  INFO [pool-155-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:31:58,457  INFO [pool-155-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:31:58,459  INFO [pool-155-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:31:58,468  INFO [pool-155-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-24T02:31:58,469  INFO [pool-155-thread-1] mapred.Task: Task:attempt_local1111571339_0030_r_000001_0 is done. And is in the process of committing
2024-04-24T02:31:58,469  INFO [pool-155-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:31:58,469  INFO [pool-155-thread-1] mapred.Task: Task 'attempt_local1111571339_0030_r_000001_0' done.
2024-04-24T02:31:58,469  INFO [pool-155-thread-1] mapred.Task: Final Counters for attempt_local1111571339_0030_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=601224
		FILE: Number of bytes written=35351423
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1310195712
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:31:58,469  INFO [pool-155-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1111571339_0030_r_000001_0
2024-04-24T02:31:58,469  INFO [Thread-2395] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:31:59,357 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:31:59,357  INFO [main] exec.Task: 2024-04-24 02:31:59,357 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1111571339_0030
2024-04-24T02:31:59,360  INFO [main] exec.Task: Ended Job = job_local1111571339_0030
2024-04-24T02:31:59,361  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:31:59,361  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:31:59,362  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:31:59,362  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:31:59,362  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:31:59,363  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:31:59,364  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:59,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:59,372  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:59,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:59,378  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:59,379  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:31:59,411  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:31:59,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:59,418  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:59,418  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:31:59,419  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-57_870_1440401581272947062-1/-mr-10000
2024-04-24T02:31:59,420  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:59,427  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:59,437  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:31:59,438  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-24T02:31:59,438  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:31:59,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:31:59,459  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-24T02:31:59,459  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:31:59,459  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:31:59,461  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:31:59,462  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:31:59,462  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=27, alter_table_(String, String, String, Table, EnvironmentContext, String)=53, isCompatibleWith_(Configuration)=2, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-24T02:31:59,462  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:31:59,462  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:59,462  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:31:59,462  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd); Time taken: 1.388 seconds
2024-04-24T02:31:59,462  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023157_f0a36e71-c710-430d-b4c6-a0ff1a9857cd
2024-04-24T02:31:59,471  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:31:59,471  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:31:59,472  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-24T02:31:59,472  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-57_870_1440401581272947062-1
2024-04-24T02:31:59,472  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-57_870_1440401581272947062-1 on fs with scheme file
2024-04-24T02:31:59,473  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730): select a,b from acidTbl order by a,b
2024-04-24T02:31:59,475  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:31:59,475  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:31:59,476  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:31:59,476  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:31:59,478  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:31:59,478  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:59,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:59,485  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:59,485  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:59,485  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:59,485  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:31:59,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:31:59,507  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:31:59,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:59,518  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:59,519  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:31:59,528  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:31:59,528  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:31:59,541  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:31:59,541  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:31:59,590  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:31:59,590  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:31:59,590  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:31:59,591  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-59_472_1929503049955620320-1/-mr-10001/.hive-staging_hive_2024-04-24_02-31-59_472_1929503049955620320-1
2024-04-24T02:31:59,599  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:31:59,601  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T02:31:59,601  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T02:31:59,603  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:31:59,611  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:31:59,611  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:31:59,611  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:31:59,611  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T02:31:59,612  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T02:31:59,613  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:31:59,613  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=5, getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTableColumnStatistics_(String, String, List, String)=32, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=7}
2024-04-24T02:31:59,613  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730); Time taken: 0.139 seconds
2024-04-24T02:31:59,613  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730
2024-04-24T02:31:59,614  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730
2024-04-24T02:31:59,628  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:31:59,628  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:31:59,629  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730): select a,b from acidTbl order by a,b
2024-04-24T02:31:59,629  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730
2024-04-24T02:31:59,629  INFO [main] ql.Driver: Query ID = alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730
Total jobs = 1
2024-04-24T02:31:59,629  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:31:59,629  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:31:59,778  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:31:59,778  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:31:59,778  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:31:59,778  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:31:59,778  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:31:59,778  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:31:59,778  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:31:59,778  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:31:59,781  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:31:59,781  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-24T02:31:59,781  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:59,790  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:31:59,791  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:31:59,796  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:31:59,797  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-24T02:31:59,798  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:59,804  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:59,812  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:31:59,816  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:31:59,817  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T02:31:59,817  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T02:31:59,817  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:31:59,818  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T02:31:59,818  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T02:31:59,818  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T02:31:59,830  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T02:31:59,830  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 12 ms
2024-04-24T02:31:59,830  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T02:31:59,848  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T02:31:59,868  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local538183763_0031
2024-04-24T02:31:59,868  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:31:59,930  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:31:59,931  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:31:59,931  INFO [Thread-2472] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:59,931  INFO [Thread-2472] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:31:59,933  INFO [Thread-2472] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:31:59,933  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local538183763_0031_m_000000_0
2024-04-24T02:31:59,934  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:59,934  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:31:59,935  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:31:59,935  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:31:59,936  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:31:59,936  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:31:59,937  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:31:59,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:31:59,942  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:31:59,942  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:31:59,942  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:31:59,942  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:31:59,942  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:31:59,942  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:31:59,943  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:31:59,944  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:31:59,944  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:31:59,944  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:31:59,944  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:31:59,944  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:31:59,945  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:31:59,946  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:31:59,946  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-24T02:31:59,946  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:31:59,946  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:31:59,946  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:31:59,946  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:31:59,946  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:31:59,957  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:31:59,960  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local538183763_0031_m_000000_0 is done. And is in the process of committing
2024-04-24T02:31:59,961  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:31:59,961  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local538183763_0031_m_000000_0' done.
2024-04-24T02:31:59,961  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local538183763_0031_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=610403
		FILE: Number of bytes written=36523378
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1310195712
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7474
2024-04-24T02:31:59,961  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local538183763_0031_m_000000_0
2024-04-24T02:31:59,961  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local538183763_0031_m_000001_0
2024-04-24T02:31:59,961  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:59,962  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:31:59,962  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:31:59,963  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:31:59,964  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:31:59,964  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:31:59,965  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:31:59,965  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:31:59,976  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:31:59,977  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:31:59,977  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:31:59,977  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:31:59,977  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:31:59,977  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:31:59,977  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:31:59,978  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:31:59,979  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:31:59,979  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:31:59,979  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:31:59,979  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:31:59,979  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:1, 
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:31:59,980  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:31:59,981  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:31:59,981  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:31:59,981  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:31:59,981  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:31:59,981  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:31:59,989  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:31:59,992  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local538183763_0031_m_000001_0 is done. And is in the process of committing
2024-04-24T02:31:59,993  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:31:59,993  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local538183763_0031_m_000001_0' done.
2024-04-24T02:31:59,993  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local538183763_0031_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=618882
		FILE: Number of bytes written=36523437
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=6
		Total committed heap usage (bytes)=1309147136
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7466
2024-04-24T02:31:59,993  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local538183763_0031_m_000001_0
2024-04-24T02:31:59,993  INFO [Thread-2472] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:31:59,994  INFO [Thread-2472] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:31:59,994  INFO [pool-160-thread-1] mapred.LocalJobRunner: Starting task: attempt_local538183763_0031_r_000000_0
2024-04-24T02:31:59,995  INFO [pool-160-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:31:59,995  INFO [pool-160-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@9139584
2024-04-24T02:31:59,995  WARN [pool-160-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:31:59,996  INFO [pool-160-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:31:59,996  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local538183763_0031_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:31:59,999  INFO [localfetcher#45] reduce.LocalFetcher: localfetcher#45 about to shuffle output of map attempt_local538183763_0031_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:31:59,999  INFO [localfetcher#45] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local538183763_0031_m_000000_0
2024-04-24T02:31:59,999  INFO [localfetcher#45] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-24T02:32:00,002  INFO [localfetcher#45] reduce.LocalFetcher: localfetcher#45 about to shuffle output of map attempt_local538183763_0031_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:00,002  INFO [localfetcher#45] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local538183763_0031_m_000001_0
2024-04-24T02:32:00,003  INFO [localfetcher#45] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-24T02:32:00,003  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:00,003  INFO [pool-160-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T02:32:00,003  INFO [pool-160-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:00,010  INFO [pool-160-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T02:32:00,010  INFO [pool-160-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-24T02:32:00,012  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:00,013  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-24T02:32:00,013  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:00,013  INFO [pool-160-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:00,013  INFO [pool-160-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-24T02:32:00,013  INFO [pool-160-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T02:32:00,013  INFO [pool-160-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:00,014  INFO [pool-160-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-24T02:32:00,014  INFO [pool-160-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:00,014  INFO [pool-160-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:00,014  INFO [pool-160-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-24T02:32:00,014  INFO [pool-160-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:32:00,015  INFO [pool-160-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@6e5d3201, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@34e151a7, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@30a167ec
2024-04-24T02:32:00,015  INFO [pool-160-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-59_472_1929503049955620320-1/-mr-10001/.hive-staging_hive_2024-04-24_02-31-59_472_1929503049955620320-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:00,015  INFO [pool-160-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-59_472_1929503049955620320-1/-mr-10001/.hive-staging_hive_2024-04-24_02-31-59_472_1929503049955620320-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:32:00,015  INFO [pool-160-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-59_472_1929503049955620320-1/-mr-10001/.hive-staging_hive_2024-04-24_02-31-59_472_1929503049955620320-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:00,022  INFO [pool-160-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:00,022  INFO [pool-160-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:00,022  INFO [pool-160-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T02:32:00,022  INFO [pool-160-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:32:00,022  INFO [pool-160-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T02:32:00,023  INFO [pool-160-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_0:2, 
2024-04-24T02:32:00,023  INFO [pool-160-thread-1] mapred.Task: Task:attempt_local538183763_0031_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:00,023  INFO [pool-160-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:00,023  INFO [pool-160-thread-1] mapred.Task: Task 'attempt_local538183763_0031_r_000000_0' done.
2024-04-24T02:32:00,023  INFO [pool-160-thread-1] mapred.Task: Final Counters for attempt_local538183763_0031_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=624695
		FILE: Number of bytes written=36523616
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1309147136
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:00,023  INFO [pool-160-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local538183763_0031_r_000000_0
2024-04-24T02:32:00,024  INFO [Thread-2472] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:00,933 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:00,933  INFO [main] exec.Task: 2024-04-24 02:32:00,933 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local538183763_0031
2024-04-24T02:32:00,934  INFO [main] exec.Task: Ended Job = job_local538183763_0031
2024-04-24T02:32:00,936  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:00,936  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T02:32:00,936  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:00,936  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:00,936  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:00,936  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730); Time taken: 1.307 seconds
2024-04-24T02:32:00,936  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023159_841f26e9-d172-4314-818b-4b7ce1d86730
2024-04-24T02:32:00,943  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:32:00,947  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:00,948  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:32:00,951  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T02:32:00,952  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T02:32:00,952  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:2, 
2024-04-24T02:32:00,952  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-24T02:32:00,952  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-59_472_1929503049955620320-1
2024-04-24T02:32:00,953  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-31-59_472_1929503049955620320-1 on fs with scheme file
2024-04-24T02:32:00,953  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023200_fa6eb52e-69c3-4f2d-b50f-25ebec773bb4): START TRANSACTION
2024-04-24T02:32:00,955  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-24T02:32:00,955  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:32:00,956  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:00,956  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:00,956  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:00,956  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:00,956  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:00,956  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:00,956  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=0}
2024-04-24T02:32:00,956  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023200_fa6eb52e-69c3-4f2d-b50f-25ebec773bb4); Time taken: 0.003 seconds
2024-04-24T02:32:00,956  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023200_fa6eb52e-69c3-4f2d-b50f-25ebec773bb4
2024-04-24T02:32:00,956  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-24T02:32:00,957  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023200_fa6eb52e-69c3-4f2d-b50f-25ebec773bb4): START TRANSACTION
2024-04-24T02:32:00,957  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:00,957  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T02:32:00,957  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023200_fa6eb52e-69c3-4f2d-b50f-25ebec773bb4); Time taken: 0.001 seconds
2024-04-24T02:32:00,957  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:00,957  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:00,958  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:00,958  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:00,960  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:00,967  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:00,968  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:00,968  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:00,968  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:00,968  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:00,968  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:00,974  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:00,974  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:00,975  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:00,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:01,043  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:01,043  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:01,043  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:01,043  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:01,045  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:01,046  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:01,046  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:01,046  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:01,052  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:01,054  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:01,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:01,060  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 15
2024-04-24T02:32:01,061  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [15])
2024-04-24T02:32:01,061  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:01,065  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:32:01,065  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:32:01,065  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:32:01,066  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:01,074  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:01,081  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:01,081  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:01,081  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:01,081  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:01,081  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-24T02:32:01,081  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:01,081  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=1, getTable_(GetTableRequest)=26, isCompatibleWith_(Configuration)=0, flushCache_()=0, allocateTableWriteId_(long, String, String)=5, getValidWriteIds_(List, String)=3, getAllTableConstraints_(AllTableConstraintsRequest)=5, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-24T02:32:01,082  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5); Time taken: 0.124 seconds
2024-04-24T02:32:01,082  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5
2024-04-24T02:32:01,082  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5
2024-04-24T02:32:01,096  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:32:01,096  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:01,098  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:01,098  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5
2024-04-24T02:32:01,099  INFO [main] ql.Driver: Query ID = alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5
Total jobs = 1
2024-04-24T02:32:01,099  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:01,099  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:01,252  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:32:01,252  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:01,252  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:01,252  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:01,252  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:01,252  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:01,252  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:01,252  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:01,254  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:01,254  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:32:01,255  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-00_957_805539773338480314-1/dummy_path
2024-04-24T02:32:01,265  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:01,265  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:32:01,270  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:01,271  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,91KB
2024-04-24T02:32:01,272  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:01,276  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-00_957_805539773338480314-1/-mr-10000
2024-04-24T02:32:01,278  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:01,286  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:01,290  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:01,291  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:32:01,291  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:32:01,291  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-00_957_805539773338480314-1/dummy_path
2024-04-24T02:32:01,292  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:32:01,309  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:32:01,329  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local358527917_0032
2024-04-24T02:32:01,329  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:01,391  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:01,391  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:01,391  INFO [Thread-2525] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:01,391  INFO [Thread-2525] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:01,393  INFO [Thread-2525] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:01,393  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local358527917_0032_m_000000_0
2024-04-24T02:32:01,394  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:01,394  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-00_957_805539773338480314-1/dummy_path/null:0+1
2024-04-24T02:32:01,394  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:01,395  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:32:01,395  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:32:01,400  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:01,400  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:01,400  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:01,400  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:01,400  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:01,400  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:01,401  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:01,401  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:01,401  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:01,401  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:01,401  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:32:01,402  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:32:01,402  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:01,402  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:32:01,402  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:32:01,402  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:01,402  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T02:32:01,403  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-24T02:32:01,404  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:01,404  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:01,404  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:01,404  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T02:32:01,404  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:32:01,415  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:01,419  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local358527917_0032_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:01,419  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:32:01,419  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local358527917_0032_m_000000_0' done.
2024-04-24T02:32:01,419  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local358527917_0032_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=630247
		FILE: Number of bytes written=37698826
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=360
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1309147136
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5017
2024-04-24T02:32:01,419  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local358527917_0032_m_000000_0
2024-04-24T02:32:01,420  INFO [Thread-2525] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:01,421  INFO [Thread-2525] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:01,421  INFO [pool-163-thread-1] mapred.LocalJobRunner: Starting task: attempt_local358527917_0032_r_000000_0
2024-04-24T02:32:01,422  INFO [pool-163-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:01,422  INFO [pool-163-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@394bf9d3
2024-04-24T02:32:01,422  WARN [pool-163-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:01,423  INFO [pool-163-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:01,423  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local358527917_0032_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:01,424  INFO [localfetcher#46] reduce.LocalFetcher: localfetcher#46 about to shuffle output of map attempt_local358527917_0032_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:01,424  INFO [localfetcher#46] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local358527917_0032_m_000000_0
2024-04-24T02:32:01,424  INFO [localfetcher#46] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:01,425  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:01,425  INFO [pool-163-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:01,425  INFO [pool-163-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:01,430  INFO [pool-163-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:01,431  INFO [pool-163-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:01,433  INFO [pool-163-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:01,433  INFO [pool-163-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:01,433  INFO [pool-163-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:01,433  INFO [pool-163-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:01,434  INFO [pool-163-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:01,434  INFO [pool-163-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:01,434  INFO [pool-163-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:01,435  INFO [pool-163-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,91KB
2024-04-24T02:32:01,435  INFO [pool-163-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:01,435  INFO [pool-163-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:01,436  INFO [pool-163-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:01,436  INFO [pool-163-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:01,436  INFO [pool-163-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local358527917_0032/job_local358527917_0032.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7300b542
2024-04-24T02:32:01,436  INFO [pool-163-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:01,436  INFO [pool-163-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:01,437  INFO [pool-163-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:01,437  INFO [pool-163-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:01,437  INFO [pool-163-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:01,445  INFO [pool-163-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:01,449  INFO [pool-163-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:01,449  INFO [pool-163-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:32:01,449  INFO [pool-163-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:01,449  INFO [pool-163-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:01,452  INFO [pool-163-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0]
2024-04-24T02:32:01,465  INFO [pool-163-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-24T02:32:01,465  INFO [pool-163-thread-1] mapred.Task: Task:attempt_local358527917_0032_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:01,465  INFO [pool-163-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:01,465  INFO [pool-163-thread-1] mapred.Task: Task 'attempt_local358527917_0032_r_000000_0' done.
2024-04-24T02:32:01,466  INFO [pool-163-thread-1] mapred.Task: Final Counters for attempt_local358527917_0032_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=636349
		FILE: Number of bytes written=37699866
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1309147136
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:01,466  INFO [pool-163-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local358527917_0032_r_000000_0
2024-04-24T02:32:01,466  INFO [pool-163-thread-1] mapred.LocalJobRunner: Starting task: attempt_local358527917_0032_r_000001_0
2024-04-24T02:32:01,466  INFO [pool-163-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:01,466  INFO [pool-163-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6c30fd5d
2024-04-24T02:32:01,466  WARN [pool-163-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:01,467  INFO [pool-163-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:01,468  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local358527917_0032_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:01,470  INFO [localfetcher#47] reduce.LocalFetcher: localfetcher#47 about to shuffle output of map attempt_local358527917_0032_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:01,471  INFO [localfetcher#47] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local358527917_0032_m_000000_0
2024-04-24T02:32:01,471  INFO [localfetcher#47] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:01,471  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:01,472  INFO [pool-163-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:01,472  INFO [pool-163-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:01,478  INFO [pool-163-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:01,478  INFO [pool-163-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:01,481  INFO [pool-163-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:01,481  INFO [pool-163-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:01,481  INFO [pool-163-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:01,481  INFO [pool-163-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:01,481  INFO [pool-163-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:01,481  INFO [pool-163-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:01,481  INFO [pool-163-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:01,482  INFO [pool-163-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,91KB
2024-04-24T02:32:01,482  INFO [pool-163-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:01,482  INFO [pool-163-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:01,483  INFO [pool-163-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:01,483  INFO [pool-163-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:01,483  INFO [pool-163-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local358527917_0032/job_local358527917_0032.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2bc0bfd4
2024-04-24T02:32:01,483  INFO [pool-163-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:01,483  INFO [pool-163-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:01,483  INFO [pool-163-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:01,484  INFO [pool-163-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:01,484  INFO [pool-163-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:01,488  INFO [pool-163-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:01,489  INFO [pool-163-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:01,489  INFO [pool-163-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:01,489  INFO [pool-163-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:01,489  INFO [pool-163-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:01,490  INFO [pool-163-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-24T02:32:01,500  INFO [pool-163-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-24T02:32:01,500  INFO [pool-163-thread-1] mapred.Task: Task:attempt_local358527917_0032_r_000001_0 is done. And is in the process of committing
2024-04-24T02:32:01,501  INFO [pool-163-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:01,501  INFO [pool-163-thread-1] mapred.Task: Task 'attempt_local358527917_0032_r_000001_0' done.
2024-04-24T02:32:01,501  INFO [pool-163-thread-1] mapred.Task: Final Counters for attempt_local358527917_0032_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=642427
		FILE: Number of bytes written=37700900
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1309147136
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:01,501  INFO [pool-163-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local358527917_0032_r_000001_0
2024-04-24T02:32:01,501  INFO [Thread-2525] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:02,394 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:02,394  INFO [main] exec.Task: 2024-04-24 02:32:02,394 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local358527917_0032
2024-04-24T02:32:02,397  INFO [main] exec.Task: Ended Job = job_local358527917_0032
2024-04-24T02:32:02,398  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:32:02,398  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:32:02,398  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest
2024-04-24T02:32:02,398  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-24T02:32:02,398  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-24T02:32:02,399  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:32:02,400  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:02,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:02,407  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:02,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:02,413  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:02,414  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:02,434  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:32:02,434  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:02,441  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:02,441  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:32:02,441  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-00_957_805539773338480314-1/-mr-10000
2024-04-24T02:32:02,443  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:02,450  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:02,473  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:32:02,473  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-24T02:32:02,473  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:32:02,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:02,496  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-24T02:32:02,496  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:32:02,496  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:32:02,497  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2695, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:32:02,497  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:02,497  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=42, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=1, getTable_(GetTableRequest)=27, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:32:02,497  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:02,498  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:02,498  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:02,498  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023200_62a5843c-7ef2-411f-9329-5b53bec5d6c5); Time taken: 1.399 seconds
2024-04-24T02:32:02,498  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-24T02:32:02,498  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-00_957_805539773338480314-1
2024-04-24T02:32:02,499  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-00_957_805539773338480314-1 on fs with scheme file
2024-04-24T02:32:02,499  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b): select a,b from acidTbl order by a,b
2024-04-24T02:32:02,499  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:02,499  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:02,500  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:02,500  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:02,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:02,507  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:02,507  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:02,507  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:02,507  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:02,519  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:02,528  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:32:02,528  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:02,537  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:02,537  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:02,545  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:02,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:32:02,553  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-24T02:32:02,553  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-24T02:32:02,593  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:02,593  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:02,593  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:02,594  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-02_499_2898393955980182202-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-02_499_2898393955980182202-1
2024-04-24T02:32:02,601  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:02,603  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:02,604  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T02:32:02,605  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:02,613  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:02,613  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:02,613  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:02,613  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T02:32:02,614  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T02:32:02,614  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:02,614  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=5, flushCache_()=0, getTable_(GetTableRequest)=7, getValidWriteIds_(List, String)=1, getTableColumnStatistics_(String, String, List, String)=24, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:02,615  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b); Time taken: 0.115 seconds
2024-04-24T02:32:02,615  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b
2024-04-24T02:32:02,615  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b
2024-04-24T02:32:02,628  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:32:02,628  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:02,628  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b): select a,b from acidTbl order by a,b
2024-04-24T02:32:02,628  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b
2024-04-24T02:32:02,628  INFO [main] ql.Driver: Query ID = alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b
Total jobs = 1
2024-04-24T02:32:02,628  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:02,628  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:02,777  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:32:02,777  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:02,777  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:02,777  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:02,777  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:02,777  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:02,777  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:02,777  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:02,780  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:02,780  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-24T02:32:02,780  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:02,790  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:02,791  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,74KB
2024-04-24T02:32:02,795  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:02,796  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,60KB
2024-04-24T02:32:02,797  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:02,803  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:02,810  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:02,815  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:02,816  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T02:32:02,816  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T02:32:02,816  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:02,816  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T02:32:02,816  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:2:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T02:32:02,816  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T02:32:02,840  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/4
2024-04-24T02:32:02,840  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 4). duration: 24 ms
2024-04-24T02:32:02,840  INFO [main] io.HiveInputFormat: number of splits 4
2024-04-24T02:32:02,859  INFO [main] mapreduce.JobSubmitter: number of splits:4
2024-04-24T02:32:02,878  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1772878300_0033
2024-04-24T02:32:02,878  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:02,941  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:02,941  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:02,942  INFO [Thread-2610] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:02,942  INFO [Thread-2610] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:02,945  INFO [Thread-2610] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:02,945  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1772878300_0033_m_000000_0
2024-04-24T02:32:02,945  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:02,946  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:02,946  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:02,947  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-24T02:32:02,948  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:02,948  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 679, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:02,949  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:02,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:02,962  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:02,962  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:02,962  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:02,962  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:02,962  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:02,963  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:02,963  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:02,964  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:02,965  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:02,965  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:02,965  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:02,965  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:02,965  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:1, 
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:02,966  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:02,977  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:02,981  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1772878300_0033_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:02,981  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:02,981  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1772878300_0033_m_000000_0' done.
2024-04-24T02:32:02,981  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1772878300_0033_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=652748
		FILE: Number of bytes written=38878789
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=8
		Total committed heap usage (bytes)=1310720000
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7584
2024-04-24T02:32:02,981  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1772878300_0033_m_000000_0
2024-04-24T02:32:02,982  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1772878300_0033_m_000001_0
2024-04-24T02:32:02,982  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:02,982  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:02,983  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:02,983  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-24T02:32:02,985  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:02,985  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:02,985  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:02,986  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:02,991  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:02,991  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:02,991  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:02,991  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:02,991  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:02,991  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:02,992  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:02,993  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:02,993  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:02,993  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:02,993  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:02,993  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:02,993  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, DESERIALIZE_ERRORS:0, 
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:02,994  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-24T02:32:02,995  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:02,995  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:02,995  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:02,995  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:02,995  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:03,004  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:03,007  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1772878300_0033_m_000001_0 is done. And is in the process of committing
2024-04-24T02:32:03,007  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:03,007  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1772878300_0033_m_000001_0' done.
2024-04-24T02:32:03,007  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1772878300_0033_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=662319
		FILE: Number of bytes written=38878848
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1310720000
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7560
2024-04-24T02:32:03,007  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1772878300_0033_m_000001_0
2024-04-24T02:32:03,007  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1772878300_0033_m_000002_0
2024-04-24T02:32:03,008  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:03,008  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:03,009  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:03,009  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-24T02:32:03,010  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:03,010  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 672, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:03,011  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:03,011  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:03,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:03,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:03,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:03,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:03,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:03,018  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:03,018  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:03,019  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:1, 
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:03,020  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:03,021  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:03,030  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:03,033  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1772878300_0033_m_000002_0 is done. And is in the process of committing
2024-04-24T02:32:03,033  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:03,033  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1772878300_0033_m_000002_0' done.
2024-04-24T02:32:03,033  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1772878300_0033_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=671374
		FILE: Number of bytes written=38878907
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1310720000
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7556
2024-04-24T02:32:03,033  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1772878300_0033_m_000002_0
2024-04-24T02:32:03,033  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1772878300_0033_m_000003_0
2024-04-24T02:32:03,034  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:03,034  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:03,035  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:03,035  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-24T02:32:03,037  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:03,037  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:03,038  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:03,038  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:03,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:03,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:03,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:03,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:03,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:03,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:03,045  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:03,046  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:03,046  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:03,046  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:03,046  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:1, 
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:03,047  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:03,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:03,056  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:03,059  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1772878300_0033_m_000003_0 is done. And is in the process of committing
2024-04-24T02:32:03,060  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:03,060  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1772878300_0033_m_000003_0' done.
2024-04-24T02:32:03,060  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1772878300_0033_m_000003_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=679913
		FILE: Number of bytes written=38878966
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1310720000
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7552
2024-04-24T02:32:03,060  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1772878300_0033_m_000003_0
2024-04-24T02:32:03,060  INFO [Thread-2610] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:03,061  INFO [Thread-2610] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:03,061  INFO [pool-168-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1772878300_0033_r_000000_0
2024-04-24T02:32:03,062  INFO [pool-168-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:03,062  INFO [pool-168-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3e087953
2024-04-24T02:32:03,062  WARN [pool-168-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:03,063  INFO [pool-168-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:03,064  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1772878300_0033_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:03,066  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1772878300_0033_m_000002_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:03,066  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1772878300_0033_m_000002_0
2024-04-24T02:32:03,066  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-24T02:32:03,069  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1772878300_0033_m_000003_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:03,069  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1772878300_0033_m_000003_0
2024-04-24T02:32:03,069  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-24T02:32:03,072  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1772878300_0033_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:03,072  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1772878300_0033_m_000000_0
2024-04-24T02:32:03,072  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 3, commitMemory -> 46, usedMemory ->69
2024-04-24T02:32:03,074  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1772878300_0033_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:03,074  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1772878300_0033_m_000001_0
2024-04-24T02:32:03,074  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 4, commitMemory -> 69, usedMemory ->92
2024-04-24T02:32:03,074  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:03,075  INFO [pool-168-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-24T02:32:03,075  INFO [pool-168-thread-1] reduce.MergeManagerImpl: finalMerge called with 4 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:03,081  INFO [pool-168-thread-1] mapred.Merger: Merging 4 sorted segments
2024-04-24T02:32:03,081  INFO [pool-168-thread-1] mapred.Merger: Down to the last merge-pass, with 4 segments left of total size: 24 bytes
2024-04-24T02:32:03,084  INFO [pool-168-thread-1] reduce.MergeManagerImpl: Merged 4 segments, 92 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:03,084  INFO [pool-168-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-24T02:32:03,084  INFO [pool-168-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:03,084  INFO [pool-168-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:03,084  INFO [pool-168-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-24T02:32:03,084  INFO [pool-168-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-24T02:32:03,085  INFO [pool-168-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:03,085  INFO [pool-168-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,60KB
2024-04-24T02:32:03,086  INFO [pool-168-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:03,086  INFO [pool-168-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:03,086  INFO [pool-168-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-24T02:32:03,086  INFO [pool-168-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:32:03,086  INFO [pool-168-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@704b1fe7, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@7b7cb35e, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@6f18b142
2024-04-24T02:32:03,087  INFO [pool-168-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-02_499_2898393955980182202-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-02_499_2898393955980182202-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:03,087  INFO [pool-168-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-02_499_2898393955980182202-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-02_499_2898393955980182202-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:32:03,087  INFO [pool-168-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-02_499_2898393955980182202-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-02_499_2898393955980182202-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:03,094  INFO [pool-168-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:03,095  INFO [pool-168-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:03,095  INFO [pool-168-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-24T02:32:03,095  INFO [pool-168-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:32:03,095  INFO [pool-168-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T02:32:03,095  INFO [pool-168-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_0:4, 
2024-04-24T02:32:03,096  INFO [pool-168-thread-1] mapred.Task: Task:attempt_local1772878300_0033_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:03,096  INFO [pool-168-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:03,096  INFO [pool-168-thread-1] mapred.Task: Task 'attempt_local1772878300_0033_r_000000_0' done.
2024-04-24T02:32:03,096  INFO [pool-168-thread-1] mapred.Task: Final Counters for attempt_local1772878300_0033_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=685894
		FILE: Number of bytes written=38879219
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=108
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =4
		Failed Shuffles=0
		Merged Map outputs=4
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1310720000
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:03,096  INFO [pool-168-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1772878300_0033_r_000000_0
2024-04-24T02:32:03,096  INFO [Thread-2610] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:03,945 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:03,945  INFO [main] exec.Task: 2024-04-24 02:32:03,945 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1772878300_0033
2024-04-24T02:32:03,947  INFO [main] exec.Task: Ended Job = job_local1772878300_0033
2024-04-24T02:32:03,948  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:03,948  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T02:32:03,948  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:03,948  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:03,948  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:03,948  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b); Time taken: 1.32 seconds
2024-04-24T02:32:03,952  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T02:32:03,953  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T02:32:03,953  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:03,953  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = 1 where b != 1
2024-04-24T02:32:03,953  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-02_499_2898393955980182202-1
2024-04-24T02:32:03,954  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/77c025b1-8581-4262-87fd-6f0a1411c13b/hive_2024-04-24_02-32-02_499_2898393955980182202-1 on fs with scheme file
2024-04-24T02:32:03,954  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023203_ddbf5cf7-6f7c-44d1-a40c-3e0f113dd90f): update acidTbl set b = 1 where b != 1
2024-04-24T02:32:03,954  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:32:03,955  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:03,962  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:03,962  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = 1 where b != 1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-24T02:32:03,963  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:32:03,963  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:03,971  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:03,971  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:03,971  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:03,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:03,979  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:03,979  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:03,979  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:03,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:03,986  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:03,986  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:03,986  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:04,000  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:04,006  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:04,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:04,069  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:32:04,070  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:04,079  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:04,089  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:32:04,097  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:32:04,097  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:32:04,159  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:04,159  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:04,159  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:04,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:04,167  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,170 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:32:04,171 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:32:04,171  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:32:04,171 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:32:04,171  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:04,172  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTableColumnStatistics_(String, String, List, String)=27, getCheckConstraints_(CheckConstraintsRequest)=0, flushCache_()=0, getTable_(GetTableRequest)=38, isCompatibleWith_(Configuration)=0, getNotNullConstraints_(NotNullConstraintsRequest)=2}
2024-04-24T02:32:04,172  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023203_ddbf5cf7-6f7c-44d1-a40c-3e0f113dd90f); Time taken: 0.217 seconds
2024-04-24T02:32:04,172  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023202_47b296e5-26c8-4176-a6ad-12b3a38b079b
2024-04-24T02:32:04,174  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:04,180  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:04,180  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023204_79c1a400-e545-4f49-ac57-2fff38b0b861): drop table if exists acidTbl
2024-04-24T02:32:04,184  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-24T02:32:04,185  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:32:04,186  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:04,192  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,192  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:04,192  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:04,192  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:04,193  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=6, rollbackTxn_(long)=8, openTxn_(String, TxnType)=3}
2024-04-24T02:32:04,193  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023204_79c1a400-e545-4f49-ac57-2fff38b0b861); Time taken: 0.012 seconds
2024-04-24T02:32:04,193  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023204_79c1a400-e545-4f49-ac57-2fff38b0b861
2024-04-24T02:32:04,193  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023204_79c1a400-e545-4f49-ac57-2fff38b0b861
2024-04-24T02:32:04,206  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023204_79c1a400-e545-4f49-ac57-2fff38b0b861 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:32:04,206  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:04,207  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023204_79c1a400-e545-4f49-ac57-2fff38b0b861): drop table if exists acidTbl
2024-04-24T02:32:04,207  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:04,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:04,213  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,214  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:04,220  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:04,326  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:04,326  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=112, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:04,326  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023204_79c1a400-e545-4f49-ac57-2fff38b0b861); Time taken: 0.12 seconds
2024-04-24T02:32:04,326  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023204_79c1a400-e545-4f49-ac57-2fff38b0b861
2024-04-24T02:32:04,330  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:32:04,336  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:04,336  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:32:04,337  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:04,337  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023204_45943745-20a8-4231-948c-7577e81dcf99): drop table if exists acidTblPart
2024-04-24T02:32:04,346  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-24T02:32:04,346  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:32:04,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:04,366  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,367  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:04,367  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:04,367  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:04,367  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=9, getTable_(GetTableRequest)=19, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=2}
2024-04-24T02:32:04,367  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023204_45943745-20a8-4231-948c-7577e81dcf99); Time taken: 0.03 seconds
2024-04-24T02:32:04,367  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023204_45943745-20a8-4231-948c-7577e81dcf99
2024-04-24T02:32:04,368  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023204_45943745-20a8-4231-948c-7577e81dcf99
2024-04-24T02:32:04,384  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023204_45943745-20a8-4231-948c-7577e81dcf99 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:32:04,384  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:04,384  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023204_45943745-20a8-4231-948c-7577e81dcf99): drop table if exists acidTblPart
2024-04-24T02:32:04,384  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:04,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:04,391  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:04,398  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:04,435  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:04,435  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=43, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:04,435  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023204_45943745-20a8-4231-948c-7577e81dcf99); Time taken: 0.051 seconds
2024-04-24T02:32:04,435  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023204_45943745-20a8-4231-948c-7577e81dcf99
2024-04-24T02:32:04,439  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:32:04,444  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:04,444  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:32:04,444  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:04,445  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023204_b6b9101a-04ca-4d7a-93a8-d63bed32759c): drop table if exists acidTbl2
2024-04-24T02:32:04,447  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-24T02:32:04,447  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:32:04,448  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:04,448  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:04,448  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:04,448  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:04,448  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023204_b6b9101a-04ca-4d7a-93a8-d63bed32759c); Time taken: 0.004 seconds
2024-04-24T02:32:04,448  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023204_b6b9101a-04ca-4d7a-93a8-d63bed32759c
2024-04-24T02:32:04,448  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:04,448  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023204_b6b9101a-04ca-4d7a-93a8-d63bed32759c): drop table if exists acidTbl2
2024-04-24T02:32:04,448  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:04,449  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:32:04,449  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:04,449  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=1}
2024-04-24T02:32:04,449  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023204_b6b9101a-04ca-4d7a-93a8-d63bed32759c); Time taken: 0.001 seconds
2024-04-24T02:32:04,450  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023204_b6b9101a-04ca-4d7a-93a8-d63bed32759c
2024-04-24T02:32:04,454  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:32:04,458  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:04,458  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:32:04,459  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:04,459  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023204_af3bb131-9433-4c6f-84a5-37a815230316): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:04,461  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-24T02:32:04,461  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:32:04,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:04,480  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,480  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:04,480  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:04,480  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:04,480  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=8, flushCache_()=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=19, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:32:04,481  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023204_af3bb131-9433-4c6f-84a5-37a815230316); Time taken: 0.021 seconds
2024-04-24T02:32:04,481  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023204_af3bb131-9433-4c6f-84a5-37a815230316
2024-04-24T02:32:04,481  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023204_af3bb131-9433-4c6f-84a5-37a815230316
2024-04-24T02:32:04,493  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023204_af3bb131-9433-4c6f-84a5-37a815230316 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:32:04,493  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:04,493  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023204_af3bb131-9433-4c6f-84a5-37a815230316): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:04,493  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:04,494  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:04,502  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:04,510  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,510  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:04,589  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:04,589  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=87, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:04,589  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023204_af3bb131-9433-4c6f-84a5-37a815230316); Time taken: 0.096 seconds
2024-04-24T02:32:04,589  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023204_af3bb131-9433-4c6f-84a5-37a815230316
2024-04-24T02:32:04,593  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:32:04,599  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:04,599  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:32:04,599  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:04,600  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023204_130bf5a4-2668-4581-a69a-77d42b4f433b): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:04,601  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-24T02:32:04,602  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:32:04,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:04,612  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,612  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:04,612  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:04,612  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:04,612  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=10, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:32:04,612  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023204_130bf5a4-2668-4581-a69a-77d42b4f433b); Time taken: 0.012 seconds
2024-04-24T02:32:04,612  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023204_130bf5a4-2668-4581-a69a-77d42b4f433b
2024-04-24T02:32:04,613  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023204_130bf5a4-2668-4581-a69a-77d42b4f433b
2024-04-24T02:32:04,626  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023204_130bf5a4-2668-4581-a69a-77d42b4f433b LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T02:32:04,626  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:04,626  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023204_130bf5a4-2668-4581-a69a-77d42b4f433b): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:04,626  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:04,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:04,635  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:04,644  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:04,676  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:04,676  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=41}
2024-04-24T02:32:04,676  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023204_130bf5a4-2668-4581-a69a-77d42b4f433b); Time taken: 0.05 seconds
2024-04-24T02:32:04,676  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023204_130bf5a4-2668-4581-a69a-77d42b4f433b
2024-04-24T02:32:04,679  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:32:04,684  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:04,684  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:32:04,685  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:04,685  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023204_45209cb2-152e-4980-a3b4-0858ca56750c): drop table if exists nonAcidNonBucket
2024-04-24T02:32:04,687  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-24T02:32:04,687  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:32:04,687  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:04,696  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,696  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:04,696  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:04,696  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:04,696  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=8, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:32:04,697  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023204_45209cb2-152e-4980-a3b4-0858ca56750c); Time taken: 0.011 seconds
2024-04-24T02:32:04,697  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023204_45209cb2-152e-4980-a3b4-0858ca56750c
2024-04-24T02:32:04,697  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023204_45209cb2-152e-4980-a3b4-0858ca56750c
2024-04-24T02:32:04,709  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023204_45209cb2-152e-4980-a3b4-0858ca56750c LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T02:32:04,709  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:04,710  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023204_45209cb2-152e-4980-a3b4-0858ca56750c): drop table if exists nonAcidNonBucket
2024-04-24T02:32:04,710  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:04,710  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:04,718  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:04,727  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:04,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:04,757  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:04,757  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=39, getTable_(GetTableRequest)=8}
2024-04-24T02:32:04,757  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023204_45209cb2-152e-4980-a3b4-0858ca56750c); Time taken: 0.047 seconds
2024-04-24T02:32:04,757  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023204_45209cb2-152e-4980-a3b4-0858ca56750c
2024-04-24T02:32:04,761  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:32:04,765  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:04,765  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:32:04,766  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="exchangePartitionShouldNotWorkForTransactionalTables" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.459"/>
  <testcase name="testMergeNegative2" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.183"/>
  <testcase name="testCompactionBlocking" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="6.125"/>
  <testcase name="testVersioningVersionFileDisabled" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="3.01">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update T set a=3 where b=2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:32:13,586  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:32:13,588  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 6a22e74a-5843-49c0-b782-26ca8660ea21
2024-04-24T02:32:13,590  INFO [main] SessionState: Hive Session ID = 6a22e74a-5843-49c0-b782-26ca8660ea21
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:13,591  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:13,596  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6a22e74a-5843-49c0-b782-26ca8660ea21
2024-04-24T02:32:13,598  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a22e74a-5843-49c0-b782-26ca8660ea21
2024-04-24T02:32:13,600  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6a22e74a-5843-49c0-b782-26ca8660ea21/_tmp_space.db
2024-04-24T02:32:13,601  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=6a22e74a-5843-49c0-b782-26ca8660ea21, clientType=HIVECLI]
2024-04-24T02:32:13,601  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:13,601  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_96e4a940-fb78-4601-97a4-3cedf99bde62): drop table if exists acidTbl
2024-04-24T02:32:13,608  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:32:13,609  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:32:13,611  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:13,614  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,614  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,614  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,614  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, openTxn_(String, TxnType)=8}
2024-04-24T02:32:13,614  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_96e4a940-fb78-4601-97a4-3cedf99bde62); Time taken: 0.013 seconds
2024-04-24T02:32:13,614  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023213_96e4a940-fb78-4601-97a4-3cedf99bde62
2024-04-24T02:32:13,614  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:13,614  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_96e4a940-fb78-4601-97a4-3cedf99bde62): drop table if exists acidTbl
2024-04-24T02:32:13,614  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,615  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:13,617  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,617  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:32:13,618  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_96e4a940-fb78-4601-97a4-3cedf99bde62); Time taken: 0.003 seconds
2024-04-24T02:32:13,618  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_96e4a940-fb78-4601-97a4-3cedf99bde62
2024-04-24T02:32:13,623  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:32:13,628  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,629  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:32:13,630  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:13,630  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_d3c70f48-1c78-4d2f-8c0a-7d6183aa8a5b): drop table if exists acidTblPart
2024-04-24T02:32:13,632  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:32:13,632  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:32:13,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:13,635  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,635  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,636  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,636  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:32:13,636  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_d3c70f48-1c78-4d2f-8c0a-7d6183aa8a5b); Time taken: 0.006 seconds
2024-04-24T02:32:13,636  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023213_d3c70f48-1c78-4d2f-8c0a-7d6183aa8a5b
2024-04-24T02:32:13,636  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:13,636  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_d3c70f48-1c78-4d2f-8c0a-7d6183aa8a5b): drop table if exists acidTblPart
2024-04-24T02:32:13,636  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:13,639  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,640  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:32:13,640  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_d3c70f48-1c78-4d2f-8c0a-7d6183aa8a5b); Time taken: 0.003 seconds
2024-04-24T02:32:13,640  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_d3c70f48-1c78-4d2f-8c0a-7d6183aa8a5b
2024-04-24T02:32:13,644  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:32:13,649  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,649  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:32:13,650  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:13,650  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_40bc5df8-a7f4-48c3-a728-86a07719a771): drop table if exists acidTbl2
2024-04-24T02:32:13,652  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:32:13,652  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:32:13,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:13,655  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,655  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,655  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,656  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:32:13,656  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_40bc5df8-a7f4-48c3-a728-86a07719a771); Time taken: 0.005 seconds
2024-04-24T02:32:13,656  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023213_40bc5df8-a7f4-48c3-a728-86a07719a771
2024-04-24T02:32:13,656  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:13,656  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_40bc5df8-a7f4-48c3-a728-86a07719a771): drop table if exists acidTbl2
2024-04-24T02:32:13,656  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,656  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:13,659  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,659  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,660  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_40bc5df8-a7f4-48c3-a728-86a07719a771); Time taken: 0.003 seconds
2024-04-24T02:32:13,660  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_40bc5df8-a7f4-48c3-a728-86a07719a771
2024-04-24T02:32:13,664  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:32:13,670  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,670  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:32:13,671  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:13,672  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_ed5b4446-e3b6-48be-b97b-98cd802f8be8): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:13,674  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:32:13,674  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:32:13,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:13,677  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,678  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,678  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,678  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:32:13,678  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_ed5b4446-e3b6-48be-b97b-98cd802f8be8); Time taken: 0.006 seconds
2024-04-24T02:32:13,678  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023213_ed5b4446-e3b6-48be-b97b-98cd802f8be8
2024-04-24T02:32:13,678  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:13,678  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_ed5b4446-e3b6-48be-b97b-98cd802f8be8): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:13,678  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,678  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:13,681  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,681  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,682  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_ed5b4446-e3b6-48be-b97b-98cd802f8be8); Time taken: 0.003 seconds
2024-04-24T02:32:13,682  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_ed5b4446-e3b6-48be-b97b-98cd802f8be8
2024-04-24T02:32:13,686  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:32:13,691  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,691  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:32:13,692  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:13,692  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_b24c3a83-bf67-4b24-9519-5241a806d5e7): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:13,694  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:32:13,694  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:32:13,695  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:13,697  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,697  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,697  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,698  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,698  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_b24c3a83-bf67-4b24-9519-5241a806d5e7); Time taken: 0.005 seconds
2024-04-24T02:32:13,698  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023213_b24c3a83-bf67-4b24-9519-5241a806d5e7
2024-04-24T02:32:13,698  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:13,698  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_b24c3a83-bf67-4b24-9519-5241a806d5e7): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:13,698  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:13,701  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,701  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,701  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_b24c3a83-bf67-4b24-9519-5241a806d5e7); Time taken: 0.003 seconds
2024-04-24T02:32:13,702  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_b24c3a83-bf67-4b24-9519-5241a806d5e7
2024-04-24T02:32:13,706  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:32:13,711  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,711  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:32:13,711  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:13,712  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_5ff371b8-5a0a-4fee-88c1-41c5150b0966): drop table if exists nonAcidNonBucket
2024-04-24T02:32:13,714  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:32:13,714  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:32:13,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:13,717  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,717  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,717  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,717  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,718  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_5ff371b8-5a0a-4fee-88c1-41c5150b0966); Time taken: 0.005 seconds
2024-04-24T02:32:13,718  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023213_5ff371b8-5a0a-4fee-88c1-41c5150b0966
2024-04-24T02:32:13,718  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:13,718  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_5ff371b8-5a0a-4fee-88c1-41c5150b0966): drop table if exists nonAcidNonBucket
2024-04-24T02:32:13,718  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:13,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,721  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_5ff371b8-5a0a-4fee-88c1-41c5150b0966); Time taken: 0.003 seconds
2024-04-24T02:32:13,721  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_5ff371b8-5a0a-4fee-88c1-41c5150b0966
2024-04-24T02:32:13,726  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:32:13,731  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,731  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:32:13,731  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,732  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_475ddd2a-0b23-422d-a965-4c04ed6967af): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,735  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:32:13,735  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:32:13,736  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:13,736  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:13,740  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:32:13,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:13,742  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:13,742  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,742  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,742  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,742  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, getDatabase_(String)=1, isCompatibleWith_(Configuration)=1}
2024-04-24T02:32:13,743  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_475ddd2a-0b23-422d-a965-4c04ed6967af); Time taken: 0.01 seconds
2024-04-24T02:32:13,743  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023213_475ddd2a-0b23-422d-a965-4c04ed6967af
2024-04-24T02:32:13,743  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023213_475ddd2a-0b23-422d-a965-4c04ed6967af
2024-04-24T02:32:13,759  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023213_475ddd2a-0b23-422d-a965-4c04ed6967af LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:32:13,759  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:13,760  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_475ddd2a-0b23-422d-a965-4c04ed6967af): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,760  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951133, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, transactional=true, numFilesErasureCoded=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:13,767  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:13,797  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=36, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,797  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_475ddd2a-0b23-422d-a965-4c04ed6967af); Time taken: 0.037 seconds
2024-04-24T02:32:13,797  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_475ddd2a-0b23-422d-a965-4c04ed6967af
2024-04-24T02:32:13,801  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:32:13,805  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,805  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:32:13,806  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,806  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_9434616c-e986-4f8b-89fd-8c0f4146f516): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,809  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:32:13,809  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:32:13,809  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:13,809  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:13,812  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:32:13,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:13,814  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:13,814  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,814  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,814  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,814  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, flushCache_()=0, getDatabase_(String)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3}
2024-04-24T02:32:13,814  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_9434616c-e986-4f8b-89fd-8c0f4146f516); Time taken: 0.008 seconds
2024-04-24T02:32:13,814  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023213_9434616c-e986-4f8b-89fd-8c0f4146f516
2024-04-24T02:32:13,815  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023213_9434616c-e986-4f8b-89fd-8c0f4146f516
2024-04-24T02:32:13,827  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023213_9434616c-e986-4f8b-89fd-8c0f4146f516 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:32:13,827  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:13,828  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_9434616c-e986-4f8b-89fd-8c0f4146f516): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,828  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951133, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:13,834  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:32:13,848  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,848  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,848  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_9434616c-e986-4f8b-89fd-8c0f4146f516); Time taken: 0.02 seconds
2024-04-24T02:32:13,848  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_9434616c-e986-4f8b-89fd-8c0f4146f516
2024-04-24T02:32:13,852  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:32:13,858  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,858  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:32:13,859  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:13,859  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_80e303e4-c40e-48ca-b641-abfba24c8552): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:13,861  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:32:13,861  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:32:13,862  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:13,862  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:13,864  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:32:13,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:13,866  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:13,866  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,866  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,866  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-24T02:32:13,866  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_80e303e4-c40e-48ca-b641-abfba24c8552); Time taken: 0.007 seconds
2024-04-24T02:32:13,866  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023213_80e303e4-c40e-48ca-b641-abfba24c8552
2024-04-24T02:32:13,867  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023213_80e303e4-c40e-48ca-b641-abfba24c8552
2024-04-24T02:32:13,879  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023213_80e303e4-c40e-48ca-b641-abfba24c8552 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:32:13,879  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:13,879  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_80e303e4-c40e-48ca-b641-abfba24c8552): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:13,879  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,880  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951133, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, bucketing_version=2, totalSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, rawDataSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:13,886  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:32:13,905  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,905  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-24T02:32:13,905  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_80e303e4-c40e-48ca-b641-abfba24c8552); Time taken: 0.026 seconds
2024-04-24T02:32:13,905  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_80e303e4-c40e-48ca-b641-abfba24c8552
2024-04-24T02:32:13,908  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:32:13,913  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,913  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:32:13,914  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:13,914  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_6ea05952-105b-4560-8e11-0cfe89826f13): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:13,916  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:32:13,916  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:32:13,917  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:13,917  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:13,919  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:32:13,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:13,921  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:13,921  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,921  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,921  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,921  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2}
2024-04-24T02:32:13,921  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_6ea05952-105b-4560-8e11-0cfe89826f13); Time taken: 0.007 seconds
2024-04-24T02:32:13,921  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023213_6ea05952-105b-4560-8e11-0cfe89826f13
2024-04-24T02:32:13,922  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023213_6ea05952-105b-4560-8e11-0cfe89826f13
2024-04-24T02:32:13,935  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023213_6ea05952-105b-4560-8e11-0cfe89826f13 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:32:13,935  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:13,935  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_6ea05952-105b-4560-8e11-0cfe89826f13): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:13,935  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,936  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951133, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, bucketing_version=2, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:13,941  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:32:13,955  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,955  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,955  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_6ea05952-105b-4560-8e11-0cfe89826f13); Time taken: 0.02 seconds
2024-04-24T02:32:13,955  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_6ea05952-105b-4560-8e11-0cfe89826f13
2024-04-24T02:32:13,958  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:32:13,963  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:13,963  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:32:13,964  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,964  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023213_bfb76cc9-786c-4cb2-86a2-8aebdf178ac9): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,966  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:32:13,966  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:32:13,967  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:13,967  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:13,969  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:32:13,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:13,971  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:13,971  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:13,971  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:13,971  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:13,971  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, flushCache_()=0}
2024-04-24T02:32:13,971  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023213_bfb76cc9-786c-4cb2-86a2-8aebdf178ac9); Time taken: 0.007 seconds
2024-04-24T02:32:13,972  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023213_bfb76cc9-786c-4cb2-86a2-8aebdf178ac9
2024-04-24T02:32:13,972  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023213_bfb76cc9-786c-4cb2-86a2-8aebdf178ac9
2024-04-24T02:32:13,985  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023213_bfb76cc9-786c-4cb2-86a2-8aebdf178ac9 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:32:13,985  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:13,986  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023213_bfb76cc9-786c-4cb2-86a2-8aebdf178ac9): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:13,986  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:13,987  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6a22e74a-5843-49c0-b782-26ca8660ea21/_tmp_space.db/649db1db-c0ed-48f6-88df-5a5dc5f1f91f
2024-04-24T02:32:13,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:13,990  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:13,990  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023213_bfb76cc9-786c-4cb2-86a2-8aebdf178ac9); Time taken: 0.004 seconds
2024-04-24T02:32:13,990  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023213_bfb76cc9-786c-4cb2-86a2-8aebdf178ac9
2024-04-24T02:32:13,994  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:32:14,000  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:14,000  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:32:14,001  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:14,001  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023214_72d572af-4851-4267-b070-0c367a5b435d): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:14,004  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:32:14,004  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:32:14,004  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:14,004  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:14,007  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:32:14,007  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:14,009  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:14,009  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:14,009  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:14,009  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:14,009  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, flushCache_()=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=3}
2024-04-24T02:32:14,009  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023214_72d572af-4851-4267-b070-0c367a5b435d); Time taken: 0.008 seconds
2024-04-24T02:32:14,010  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023214_72d572af-4851-4267-b070-0c367a5b435d
2024-04-24T02:32:14,010  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023214_72d572af-4851-4267-b070-0c367a5b435d
2024-04-24T02:32:14,023  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023214_72d572af-4851-4267-b070-0c367a5b435d LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:32:14,023  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:14,023  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023214_72d572af-4851-4267-b070-0c367a5b435d): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:14,023  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:14,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951134, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFiles=0, bucketing_version=2, rawDataSize=0, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:14,030  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:32:14,046  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:14,046  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-24T02:32:14,046  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023214_72d572af-4851-4267-b070-0c367a5b435d); Time taken: 0.023 seconds
2024-04-24T02:32:14,046  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023214_72d572af-4851-4267-b070-0c367a5b435d
2024-04-24T02:32:14,050  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:32:14,057  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:14,057  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:32:14,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:32:14,058  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26c6fe24, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4fef8466 will be shutdown
2024-04-24T02:32:14,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:32:14,058  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -8
2024-04-24T02:32:14,058  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T02:32:14,058  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023214_dde810e7-965e-42c3-a07f-8e1f6e26acbc): drop table if exists T
2024-04-24T02:32:14,060  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:32:14,061  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:32:14,061  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:32:14,061  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a1d0386, with PersistenceManager: null will be shutdown
2024-04-24T02:32:14,062  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a1d0386, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@48cbded5 created in the thread with id: 1
2024-04-24T02:32:14,086  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a1d0386 from thread id: 1
2024-04-24T02:32:14,086  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:32:14,086  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:32:14,088  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:32:14,089  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:32:14,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:14,091  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:14,091  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:14,091  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:14,091  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T02:32:14,092  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023214_dde810e7-965e-42c3-a07f-8e1f6e26acbc); Time taken: 0.033 seconds
2024-04-24T02:32:14,092  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023214_dde810e7-965e-42c3-a07f-8e1f6e26acbc
2024-04-24T02:32:14,092  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:14,092  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023214_dde810e7-965e-42c3-a07f-8e1f6e26acbc): drop table if exists T
2024-04-24T02:32:14,092  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:14,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:14,094  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:14,094  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:14,095  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023214_dde810e7-965e-42c3-a07f-8e1f6e26acbc); Time taken: 0.002 seconds
2024-04-24T02:32:14,095  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023214_dde810e7-965e-42c3-a07f-8e1f6e26acbc
2024-04-24T02:32:14,099  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:32:14,105  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:14,106  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:32:14,106  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) stored as orc
2024-04-24T02:32:14,106  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023214_3ea5ecc0-7cac-4f15-a4d4-a8fd02ce4ac4): create table T (a int, b int) stored as orc
2024-04-24T02:32:14,108  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:32:14,109  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:32:14,109  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:14,109  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:14,115  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T02:32:14,115  INFO [main] parse.CalcitePlanner: Automatically chose to make default.T acid.
2024-04-24T02:32:14,115  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:14,116  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:14,116  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:14,116  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:14,116  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:14,117  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, openTxn_(String, TxnType)=2, flushCache_()=0, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-24T02:32:14,117  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023214_3ea5ecc0-7cac-4f15-a4d4-a8fd02ce4ac4); Time taken: 0.01 seconds
2024-04-24T02:32:14,117  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023214_3ea5ecc0-7cac-4f15-a4d4-a8fd02ce4ac4
2024-04-24T02:32:14,117  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023214_3ea5ecc0-7cac-4f15-a4d4-a8fd02ce4ac4
2024-04-24T02:32:14,133  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023214_3ea5ecc0-7cac-4f15-a4d4-a8fd02ce4ac4 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:32:14,133  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:14,134  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023214_3ea5ecc0-7cac-4f15-a4d4-a8fd02ce4ac4): create table T (a int, b int) stored as orc
2024-04-24T02:32:14,134  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:14,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713951134, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFilesErasureCoded=0, rawDataSize=0, transactional_properties=default, bucketing_version=2, numRows=0, numFiles=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:14,139  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:14,165  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:14,165  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=30}
2024-04-24T02:32:14,165  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023214_3ea5ecc0-7cac-4f15-a4d4-a8fd02ce4ac4); Time taken: 0.031 seconds
2024-04-24T02:32:14,165  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023214_3ea5ecc0-7cac-4f15-a4d4-a8fd02ce4ac4
2024-04-24T02:32:14,169  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:32:14,174  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:14,174  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:32:14,174  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into T values(1,2)
2024-04-24T02:32:14,175  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed): insert into T values(1,2)
2024-04-24T02:32:14,177  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T02:32:14,178  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:32:14,178  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:14,178  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:14,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:14,200  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:14,200  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:14,200  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:14,200  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:14,200  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:14,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:14,207  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:14,207  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:14,207  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:14,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:14,298  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:14,298  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:14,298  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:14,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:14,301  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:14,301  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:14,301  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:14,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:14,308  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:14,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-24T02:32:14,310  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-24T02:32:14,317  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 15
2024-04-24T02:32:14,317  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [15])
2024-04-24T02:32:14,318  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:14,321  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:32:14,321  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:14,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:14,336  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:14,337  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:14,337  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:14,337  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:14,337  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:32:14,337  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:14,337  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=25, getTable_(GetTableRequest)=39, allocateTableWriteId_(long, String, String)=7, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=3}
2024-04-24T02:32:14,337  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed); Time taken: 0.162 seconds
2024-04-24T02:32:14,337  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed
2024-04-24T02:32:14,338  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed
2024-04-24T02:32:14,351  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:32:14,351  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:14,353  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed): insert into T values(1,2)
2024-04-24T02:32:14,354  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed
2024-04-24T02:32:14,354  INFO [main] ql.Driver: Query ID = alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed
Total jobs = 1
2024-04-24T02:32:14,354  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:14,354  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:14,496  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:32:14,497  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:32:14,499  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:14,499  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:32:14,499  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a22e74a-5843-49c0-b782-26ca8660ea21/hive_2024-04-24_02-32-14_174_8038341029418824805-1/dummy_path
2024-04-24T02:32:14,508  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:14,509  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,35KB
2024-04-24T02:32:14,510  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:14,513  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a22e74a-5843-49c0-b782-26ca8660ea21/hive_2024-04-24_02-32-14_174_8038341029418824805-1/-mr-10000
2024-04-24T02:32:14,515  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:14,535  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:14,539  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:14,540  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:32:14,540  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:32:14,540  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a22e74a-5843-49c0-b782-26ca8660ea21/hive_2024-04-24_02-32-14_174_8038341029418824805-1/dummy_path
2024-04-24T02:32:14,541  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:32:14,557  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:32:14,577  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1239070654_0034
2024-04-24T02:32:14,577  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:14,654  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:14,654  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:14,654  INFO [Thread-2804] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:14,654  INFO [Thread-2804] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:14,656  INFO [Thread-2804] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:14,656  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1239070654_0034_m_000000_0
2024-04-24T02:32:14,658  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:14,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a22e74a-5843-49c0-b782-26ca8660ea21/hive_2024-04-24_02-32-14_174_8038341029418824805-1/dummy_path/null:0+1
2024-04-24T02:32:14,661  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:14,662  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,35KB
2024-04-24T02:32:14,662  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T02:32:14,665  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:14,665  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:14,666  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:14,666  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:14,666  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:32:14,666  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:32:14,667  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:14,667  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:32:14,667  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:32:14,667  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1239070654_0034/job_local1239070654_0034.xml], properties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@11177c31
2024-04-24T02:32:14,667  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:14,667  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:14,668  INFO [LocalJobRunner Map Task Executor #0] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:14,670  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:14,670  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:1, 
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:32:14,677  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:14,679  INFO [LocalJobRunner Map Task Executor #0] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:32:14,691  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:1, RECORDS_OUT_1_default.t:1, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-24T02:32:14,692  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:14,694  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1239070654_0034_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:14,694  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:32:14,694  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1239070654_0034_m_000000_0' done.
2024-04-24T02:32:14,694  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1239070654_0034_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=691865
		FILE: Number of bytes written=40053995
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1311244288
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.t=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	File Input Format Counters 
		Bytes Read=5403
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:14,694  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1239070654_0034_m_000000_0
2024-04-24T02:32:14,694  INFO [Thread-2804] mapred.LocalJobRunner: map task executor complete.
2024-04-24 02:32:15,655 Stage-1 map = 100%,  reduce = 0%
2024-04-24T02:32:15,655  INFO [main] exec.Task: 2024-04-24 02:32:15,655 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1239070654_0034
2024-04-24T02:32:15,655  INFO [main] exec.Task: Ended Job = job_local1239070654_0034
2024-04-24T02:32:15,656  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:32:15,656  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:32:15,656  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/_tmp.delta_0000001_0000001_0000
2024-04-24T02:32:15,657  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.t
2024-04-24T02:32:15,657  INFO [main] exec.Task: Loading data to table default.t from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:15,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:15,664  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,665  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:15,671  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-24T02:32:15,704  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:32:15,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:15,711  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,711  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:32:15,711  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a22e74a-5843-49c0-b782-26ca8660ea21/hive_2024-04-24_02-32-14_174_8038341029418824805-1/-mr-10000
2024-04-24T02:32:15,712  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:15,719  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,725  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:32:15,725  INFO [main] FileOperations: Read stats for default.t/, numRows, true, 1, false: 
2024-04-24T02:32:15,725  INFO [main] FileOperations: Read stats for default.t/, rawDataSize, true, 0, false: 
2024-04-24T02:32:15,726  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-24T02:32:15,755  INFO [main] FileOperations: Read stats for default.t/, insertCount, true, 1, false: 
2024-04-24T02:32:15,755  INFO [main] FileOperations: Read stats for default.t/, updateCount, true, 0, false: 
2024-04-24T02:32:15,755  INFO [main] FileOperations: Read stats for default.t/, deleteCount, true, 0, false: 
2024-04-24T02:32:15,757  INFO [main] stats.BasicStatsTask: Table default.t stats: [numFiles=1, numRows=1, totalSize=666, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:32:15,758  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:15,758  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=27, alter_table_(String, String, String, Table, EnvironmentContext, String)=61, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:32:15,758  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:15,758  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:15,758  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:15,758  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed); Time taken: 1.405 seconds
2024-04-24T02:32:15,758  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023214_202e4b3c-6d23-44d3-9dce-fcaf4f6b2aed
2024-04-24T02:32:15,769  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:15,770  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:32:15,770  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update T set a=3 where b=2
2024-04-24T02:32:15,770  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a22e74a-5843-49c0-b782-26ca8660ea21/hive_2024-04-24_02-32-14_174_8038341029418824805-1
2024-04-24T02:32:15,771  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a22e74a-5843-49c0-b782-26ca8660ea21/hive_2024-04-24_02-32-14_174_8038341029418824805-1 on fs with scheme file
2024-04-24T02:32:15,771  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023215_854cd41f-5822-44d2-839d-ad122252b4fb): update T set a=3 where b=2
2024-04-24T02:32:15,774  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-24T02:32:15,775  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:32:15,775  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:32:15,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:15,782  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,782  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update T set a=3 where b=2> as 
<insert into table `default`.`T` select ROW__ID,`a`,`b` from `default`.`T` sort by ROW__ID >
2024-04-24T02:32:15,783  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:32:15,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:15,796  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,796  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:15,796  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:15,797  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:15,804  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,804  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:15,804  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:15,804  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:15,812  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,812  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:15,812  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:15,825  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T02:32:15,831  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-24T02:32:15,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-24T02:32:15,855  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [1], allowMissingStats: true
2024-04-24T02:32:15,856  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:15,865  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:15,874  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.t	
2024-04-24T02:32:15,887  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b
No Stats for default@t, Columns: b
2024-04-24T02:32:15,887  INFO [main] SessionState: No Stats for default@t, Columns: b
2024-04-24T02:32:15,946  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:15,946  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:15,946  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:15,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:15,953  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,956 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:32:15,957 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:32:15,957  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:32:15,957 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:32:15,957  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:15,958  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=11, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTableColumnStatistics_(String, String, List, String)=31, getTable_(GetTableRequest)=39, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-24T02:32:15,958  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023215_854cd41f-5822-44d2-839d-ad122252b4fb); Time taken: 0.186 seconds
2024-04-24T02:32:15,958  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:32:15,961  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:15,967  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:15,968  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023215_ef305dee-cb0f-4ddd-bcf5-57ddbf0d44a5): drop table if exists acidTbl
2024-04-24T02:32:15,969  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-24T02:32:15,970  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:32:15,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:15,976  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,976  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:15,976  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:15,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:15,976  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:32:15,977  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023215_ef305dee-cb0f-4ddd-bcf5-57ddbf0d44a5); Time taken: 0.009 seconds
2024-04-24T02:32:15,977  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023215_ef305dee-cb0f-4ddd-bcf5-57ddbf0d44a5
2024-04-24T02:32:15,977  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023215_ef305dee-cb0f-4ddd-bcf5-57ddbf0d44a5
2024-04-24T02:32:15,990  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023215_ef305dee-cb0f-4ddd-bcf5-57ddbf0d44a5 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:32:15,990  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:15,990  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023215_ef305dee-cb0f-4ddd-bcf5-57ddbf0d44a5): drop table if exists acidTbl
2024-04-24T02:32:15,990  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:15,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:15,997  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:15,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:16,003  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:16,089  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,089  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=92}
2024-04-24T02:32:16,090  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023215_ef305dee-cb0f-4ddd-bcf5-57ddbf0d44a5); Time taken: 0.099 seconds
2024-04-24T02:32:16,090  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023215_ef305dee-cb0f-4ddd-bcf5-57ddbf0d44a5
2024-04-24T02:32:16,093  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:32:16,098  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,099  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:32:16,100  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:16,100  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_f33792e3-c8c1-48ec-b4ae-eed32f704783): drop table if exists acidTblPart
2024-04-24T02:32:16,102  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-24T02:32:16,102  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:32:16,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:16,109  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,109  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,109  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,109  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,109  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T02:32:16,109  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_f33792e3-c8c1-48ec-b4ae-eed32f704783); Time taken: 0.009 seconds
2024-04-24T02:32:16,109  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023216_f33792e3-c8c1-48ec-b4ae-eed32f704783
2024-04-24T02:32:16,110  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023216_f33792e3-c8c1-48ec-b4ae-eed32f704783
2024-04-24T02:32:16,122  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023216_f33792e3-c8c1-48ec-b4ae-eed32f704783 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:32:16,122  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:16,122  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_f33792e3-c8c1-48ec-b4ae-eed32f704783): drop table if exists acidTblPart
2024-04-24T02:32:16,122  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:16,128  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,128  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:16,134  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,134  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:16,174  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,174  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=46, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:32:16,174  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_f33792e3-c8c1-48ec-b4ae-eed32f704783); Time taken: 0.052 seconds
2024-04-24T02:32:16,174  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_f33792e3-c8c1-48ec-b4ae-eed32f704783
2024-04-24T02:32:16,177  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:32:16,183  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,183  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:32:16,183  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:16,183  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_df77f9e3-1967-4c9d-9024-1f2d8a12babd): drop table if exists acidTbl2
2024-04-24T02:32:16,185  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-24T02:32:16,186  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:32:16,186  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,186  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,186  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,186  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-24T02:32:16,187  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_df77f9e3-1967-4c9d-9024-1f2d8a12babd); Time taken: 0.003 seconds
2024-04-24T02:32:16,187  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023216_df77f9e3-1967-4c9d-9024-1f2d8a12babd
2024-04-24T02:32:16,187  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:16,187  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_df77f9e3-1967-4c9d-9024-1f2d8a12babd): drop table if exists acidTbl2
2024-04-24T02:32:16,187  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,187  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:32:16,188  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,188  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,188  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_df77f9e3-1967-4c9d-9024-1f2d8a12babd); Time taken: 0.001 seconds
2024-04-24T02:32:16,188  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_df77f9e3-1967-4c9d-9024-1f2d8a12babd
2024-04-24T02:32:16,193  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:32:16,198  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,198  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:32:16,198  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:16,199  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_6ef8b27b-e015-4012-8367-cff577533f41): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:16,200  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-24T02:32:16,201  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:32:16,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:16,222  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,222  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,222  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,222  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,222  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=21, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:32:16,222  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_6ef8b27b-e015-4012-8367-cff577533f41); Time taken: 0.023 seconds
2024-04-24T02:32:16,223  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023216_6ef8b27b-e015-4012-8367-cff577533f41
2024-04-24T02:32:16,223  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023216_6ef8b27b-e015-4012-8367-cff577533f41
2024-04-24T02:32:16,235  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023216_6ef8b27b-e015-4012-8367-cff577533f41 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:32:16,235  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:16,235  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_6ef8b27b-e015-4012-8367-cff577533f41): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:16,236  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,236  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:16,244  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:16,252  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:16,344  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,344  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=100, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,344  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_6ef8b27b-e015-4012-8367-cff577533f41); Time taken: 0.109 seconds
2024-04-24T02:32:16,344  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_6ef8b27b-e015-4012-8367-cff577533f41
2024-04-24T02:32:16,347  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:32:16,352  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,353  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:32:16,353  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:16,353  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_f14b4a2d-f657-4cf0-9f34-825489ed198a): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:16,355  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-24T02:32:16,355  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:32:16,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:16,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,364  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,364  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,364  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,364  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1}
2024-04-24T02:32:16,364  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_f14b4a2d-f657-4cf0-9f34-825489ed198a); Time taken: 0.011 seconds
2024-04-24T02:32:16,364  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023216_f14b4a2d-f657-4cf0-9f34-825489ed198a
2024-04-24T02:32:16,365  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023216_f14b4a2d-f657-4cf0-9f34-825489ed198a
2024-04-24T02:32:16,377  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023216_f14b4a2d-f657-4cf0-9f34-825489ed198a LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:32:16,377  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:16,377  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_f14b4a2d-f657-4cf0-9f34-825489ed198a): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:16,377  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:16,385  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,386  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:16,394  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:16,426  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,426  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=41, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,426  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_f14b4a2d-f657-4cf0-9f34-825489ed198a); Time taken: 0.049 seconds
2024-04-24T02:32:16,426  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_f14b4a2d-f657-4cf0-9f34-825489ed198a
2024-04-24T02:32:16,430  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:32:16,436  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,436  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:32:16,436  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:16,437  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_c4040859-f274-4527-93c3-bcb384838e66): drop table if exists nonAcidNonBucket
2024-04-24T02:32:16,439  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 16
2024-04-24T02:32:16,439  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T02:32:16,440  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:16,448  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,448  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,448  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,448  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,449  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:32:16,449  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_c4040859-f274-4527-93c3-bcb384838e66); Time taken: 0.011 seconds
2024-04-24T02:32:16,449  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424023216_c4040859-f274-4527-93c3-bcb384838e66
2024-04-24T02:32:16,449  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023216_c4040859-f274-4527-93c3-bcb384838e66
2024-04-24T02:32:16,467  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023216_c4040859-f274-4527-93c3-bcb384838e66 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:32:16,467  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:16,467  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_c4040859-f274-4527-93c3-bcb384838e66): drop table if exists nonAcidNonBucket
2024-04-24T02:32:16,468  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:16,481  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,481  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:16,494  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:16,494  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:16,527  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,527  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=13, dropTable_(String, String, boolean, boolean, boolean)=46}
2024-04-24T02:32:16,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_c4040859-f274-4527-93c3-bcb384838e66); Time taken: 0.06 seconds
2024-04-24T02:32:16,528  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_c4040859-f274-4527-93c3-bcb384838e66
2024-04-24T02:32:16,531  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T02:32:16,537  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,537  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T02:32:16,537  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMultipleDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.42">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 8 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:32:16,600  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:32:16,600  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:32:16,600  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:32:16,600  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:32:16,600  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:32:16,600  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:32:16,600  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:32:16,600  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:32:16,601  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:32:16,601  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:32:16,601  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:32:16,603  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = c3dd7512-06f6-4f15-aaf6-b9c154c44e18
2024-04-24T02:32:16,605  INFO [main] SessionState: Hive Session ID = c3dd7512-06f6-4f15-aaf6-b9c154c44e18
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:16,605  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:16,611  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c3dd7512-06f6-4f15-aaf6-b9c154c44e18
2024-04-24T02:32:16,613  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18
2024-04-24T02:32:16,615  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/_tmp_space.db
2024-04-24T02:32:16,616  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=c3dd7512-06f6-4f15-aaf6-b9c154c44e18, clientType=HIVECLI]
2024-04-24T02:32:16,616  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:16,616  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_618a22af-28c5-4344-856c-fb1926272f42): drop table if exists acidTbl
2024-04-24T02:32:16,624  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:32:16,624  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:32:16,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:16,629  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,629  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,629  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,629  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=7}
2024-04-24T02:32:16,630  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_618a22af-28c5-4344-856c-fb1926272f42); Time taken: 0.013 seconds
2024-04-24T02:32:16,630  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023216_618a22af-28c5-4344-856c-fb1926272f42
2024-04-24T02:32:16,630  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:16,630  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_618a22af-28c5-4344-856c-fb1926272f42): drop table if exists acidTbl
2024-04-24T02:32:16,630  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,630  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:16,633  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,633  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,633  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_618a22af-28c5-4344-856c-fb1926272f42); Time taken: 0.003 seconds
2024-04-24T02:32:16,633  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_618a22af-28c5-4344-856c-fb1926272f42
2024-04-24T02:32:16,638  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:32:16,643  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,643  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:32:16,644  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:16,644  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_0681ac40-dc4f-4d80-89ce-3eb70d460a42): drop table if exists acidTblPart
2024-04-24T02:32:16,646  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:32:16,646  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:32:16,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:16,649  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,649  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,649  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,649  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-24T02:32:16,650  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_0681ac40-dc4f-4d80-89ce-3eb70d460a42); Time taken: 0.005 seconds
2024-04-24T02:32:16,650  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023216_0681ac40-dc4f-4d80-89ce-3eb70d460a42
2024-04-24T02:32:16,650  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:16,650  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_0681ac40-dc4f-4d80-89ce-3eb70d460a42): drop table if exists acidTblPart
2024-04-24T02:32:16,650  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,650  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:16,653  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,653  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,654  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_0681ac40-dc4f-4d80-89ce-3eb70d460a42); Time taken: 0.003 seconds
2024-04-24T02:32:16,654  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_0681ac40-dc4f-4d80-89ce-3eb70d460a42
2024-04-24T02:32:16,659  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:32:16,667  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,667  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:32:16,668  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:16,668  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_21327a10-ceb7-4cc0-a93c-4d690b5e7279): drop table if exists acidTbl2
2024-04-24T02:32:16,671  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:32:16,671  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:32:16,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:16,676  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,676  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,676  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,676  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,676  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_21327a10-ceb7-4cc0-a93c-4d690b5e7279); Time taken: 0.008 seconds
2024-04-24T02:32:16,677  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023216_21327a10-ceb7-4cc0-a93c-4d690b5e7279
2024-04-24T02:32:16,677  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:16,677  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_21327a10-ceb7-4cc0-a93c-4d690b5e7279): drop table if exists acidTbl2
2024-04-24T02:32:16,677  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,677  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:16,682  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,682  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,683  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_21327a10-ceb7-4cc0-a93c-4d690b5e7279); Time taken: 0.005 seconds
2024-04-24T02:32:16,683  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_21327a10-ceb7-4cc0-a93c-4d690b5e7279
2024-04-24T02:32:16,690  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:32:16,697  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,697  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:32:16,697  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:16,698  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_577dc27b-1e5e-475b-b687-5fd5cc0eff76): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:16,700  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:32:16,700  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:32:16,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:16,703  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,703  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,704  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:32:16,704  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_577dc27b-1e5e-475b-b687-5fd5cc0eff76); Time taken: 0.006 seconds
2024-04-24T02:32:16,704  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023216_577dc27b-1e5e-475b-b687-5fd5cc0eff76
2024-04-24T02:32:16,704  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:16,704  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_577dc27b-1e5e-475b-b687-5fd5cc0eff76): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:16,704  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:16,708  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,708  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:32:16,708  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_577dc27b-1e5e-475b-b687-5fd5cc0eff76); Time taken: 0.004 seconds
2024-04-24T02:32:16,708  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_577dc27b-1e5e-475b-b687-5fd5cc0eff76
2024-04-24T02:32:16,713  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:32:16,719  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,720  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:32:16,720  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:16,720  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_9e35104b-f0f5-4a0f-87dc-3653191d3b33): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:16,722  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:32:16,723  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:32:16,723  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:16,726  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,726  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,726  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,726  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T02:32:16,727  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_9e35104b-f0f5-4a0f-87dc-3653191d3b33); Time taken: 0.006 seconds
2024-04-24T02:32:16,727  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023216_9e35104b-f0f5-4a0f-87dc-3653191d3b33
2024-04-24T02:32:16,727  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:16,727  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_9e35104b-f0f5-4a0f-87dc-3653191d3b33): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:16,727  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:16,730  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,730  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,731  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_9e35104b-f0f5-4a0f-87dc-3653191d3b33); Time taken: 0.003 seconds
2024-04-24T02:32:16,731  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_9e35104b-f0f5-4a0f-87dc-3653191d3b33
2024-04-24T02:32:16,736  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:32:16,742  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,742  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:32:16,743  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:16,743  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_92e51aed-c8b5-4164-9caa-6f771daafbd7): drop table if exists nonAcidNonBucket
2024-04-24T02:32:16,745  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:32:16,746  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:32:16,746  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:16,749  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,749  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,749  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,750  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:32:16,750  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_92e51aed-c8b5-4164-9caa-6f771daafbd7); Time taken: 0.006 seconds
2024-04-24T02:32:16,750  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023216_92e51aed-c8b5-4164-9caa-6f771daafbd7
2024-04-24T02:32:16,750  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:16,750  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_92e51aed-c8b5-4164-9caa-6f771daafbd7): drop table if exists nonAcidNonBucket
2024-04-24T02:32:16,750  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:16,754  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,754  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,754  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_92e51aed-c8b5-4164-9caa-6f771daafbd7); Time taken: 0.004 seconds
2024-04-24T02:32:16,754  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_92e51aed-c8b5-4164-9caa-6f771daafbd7
2024-04-24T02:32:16,759  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:32:16,765  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,766  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:32:16,766  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:16,766  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_ae3543d0-65bd-4de0-9a1b-c9dc9ef0f10a): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:16,768  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:32:16,769  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:32:16,769  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:16,769  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:16,774  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:32:16,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:16,776  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:16,776  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,776  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,776  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,776  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=5, getDatabase_(String)=2}
2024-04-24T02:32:16,777  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_ae3543d0-65bd-4de0-9a1b-c9dc9ef0f10a); Time taken: 0.01 seconds
2024-04-24T02:32:16,777  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023216_ae3543d0-65bd-4de0-9a1b-c9dc9ef0f10a
2024-04-24T02:32:16,777  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023216_ae3543d0-65bd-4de0-9a1b-c9dc9ef0f10a
2024-04-24T02:32:16,795  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023216_ae3543d0-65bd-4de0-9a1b-c9dc9ef0f10a LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:32:16,795  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:16,796  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_ae3543d0-65bd-4de0-9a1b-c9dc9ef0f10a): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:16,796  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,797  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951136, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, numFiles=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, bucketing_version=2, numRows=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:16,803  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:16,838  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,838  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=41, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,838  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_ae3543d0-65bd-4de0-9a1b-c9dc9ef0f10a); Time taken: 0.042 seconds
2024-04-24T02:32:16,838  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_ae3543d0-65bd-4de0-9a1b-c9dc9ef0f10a
2024-04-24T02:32:16,842  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:32:16,848  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,850  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:32:16,850  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:16,851  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_1b607447-973f-4b6f-81b0-82b7ff864241): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:16,854  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:32:16,854  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:32:16,856  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:16,856  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:16,859  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:32:16,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:16,861  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:16,861  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,861  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,861  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T02:32:16,861  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_1b607447-973f-4b6f-81b0-82b7ff864241); Time taken: 0.01 seconds
2024-04-24T02:32:16,861  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023216_1b607447-973f-4b6f-81b0-82b7ff864241
2024-04-24T02:32:16,862  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023216_1b607447-973f-4b6f-81b0-82b7ff864241
2024-04-24T02:32:16,876  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023216_1b607447-973f-4b6f-81b0-82b7ff864241 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:32:16,876  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:16,876  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_1b607447-973f-4b6f-81b0-82b7ff864241): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:16,876  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951136, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:16,883  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:32:16,900  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,900  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:16,900  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_1b607447-973f-4b6f-81b0-82b7ff864241); Time taken: 0.024 seconds
2024-04-24T02:32:16,900  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_1b607447-973f-4b6f-81b0-82b7ff864241
2024-04-24T02:32:16,904  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:32:16,909  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,909  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:32:16,910  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:16,910  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_26904ad4-f1c9-4163-93d3-0f5edf75d0b4): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:16,912  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:32:16,912  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:32:16,912  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:16,912  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:16,915  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:32:16,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:16,916  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:16,916  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,916  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,916  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=8, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getDatabase_(String)=1, flushCache_()=0}
2024-04-24T02:32:16,917  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_26904ad4-f1c9-4163-93d3-0f5edf75d0b4); Time taken: 0.006 seconds
2024-04-24T02:32:16,917  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023216_26904ad4-f1c9-4163-93d3-0f5edf75d0b4
2024-04-24T02:32:16,917  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023216_26904ad4-f1c9-4163-93d3-0f5edf75d0b4
2024-04-24T02:32:16,929  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023216_26904ad4-f1c9-4163-93d3-0f5edf75d0b4 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:32:16,929  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:16,930  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_26904ad4-f1c9-4163-93d3-0f5edf75d0b4): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:16,930  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,930  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951136, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, totalSize=0, numFilesErasureCoded=0, transactional=false, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:16,936  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:32:16,950  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:16,950  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-24T02:32:16,950  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_26904ad4-f1c9-4163-93d3-0f5edf75d0b4); Time taken: 0.02 seconds
2024-04-24T02:32:16,950  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_26904ad4-f1c9-4163-93d3-0f5edf75d0b4
2024-04-24T02:32:16,954  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:32:16,959  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:16,959  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:32:16,959  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:16,960  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023216_eebb0e69-0854-4330-9c78-0f76e95162a8): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:16,962  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:32:16,962  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:32:16,962  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:16,962  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:16,964  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:32:16,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:16,966  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:16,966  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:16,966  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:16,966  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:16,966  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:32:16,966  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023216_eebb0e69-0854-4330-9c78-0f76e95162a8); Time taken: 0.006 seconds
2024-04-24T02:32:16,967  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023216_eebb0e69-0854-4330-9c78-0f76e95162a8
2024-04-24T02:32:16,967  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023216_eebb0e69-0854-4330-9c78-0f76e95162a8
2024-04-24T02:32:16,979  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023216_eebb0e69-0854-4330-9c78-0f76e95162a8 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:32:16,979  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:16,979  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023216_eebb0e69-0854-4330-9c78-0f76e95162a8): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:16,980  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:16,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951136, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0, transactional=false, numFiles=0, bucketing_version=2, totalSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:16,986  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:32:17,001  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:17,001  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-24T02:32:17,001  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023216_eebb0e69-0854-4330-9c78-0f76e95162a8); Time taken: 0.022 seconds
2024-04-24T02:32:17,001  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023216_eebb0e69-0854-4330-9c78-0f76e95162a8
2024-04-24T02:32:17,005  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:32:17,010  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:17,010  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:32:17,011  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:17,011  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023217_f3fd442e-00c1-4b2a-b590-54b49fc9034f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:17,013  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:32:17,013  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:32:17,014  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:17,014  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:17,016  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:32:17,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:17,018  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:17,018  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:17,018  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:17,018  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:17,018  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, flushCache_()=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:17,018  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023217_f3fd442e-00c1-4b2a-b590-54b49fc9034f); Time taken: 0.007 seconds
2024-04-24T02:32:17,019  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023217_f3fd442e-00c1-4b2a-b590-54b49fc9034f
2024-04-24T02:32:17,019  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023217_f3fd442e-00c1-4b2a-b590-54b49fc9034f
2024-04-24T02:32:17,033  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023217_f3fd442e-00c1-4b2a-b590-54b49fc9034f LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:32:17,033  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:17,034  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023217_f3fd442e-00c1-4b2a-b590-54b49fc9034f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:17,034  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:17,035  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/_tmp_space.db/c90d4fe1-e122-49b4-bb6d-18b752c8efce
2024-04-24T02:32:17,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:17,037  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:17,038  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023217_f3fd442e-00c1-4b2a-b590-54b49fc9034f); Time taken: 0.003 seconds
2024-04-24T02:32:17,038  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023217_f3fd442e-00c1-4b2a-b590-54b49fc9034f
2024-04-24T02:32:17,041  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:32:17,046  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:17,046  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:32:17,047  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:17,047  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023217_c2979a3c-2007-4678-b82f-96fe05997532): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:17,049  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:32:17,049  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:32:17,049  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:17,049  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:17,051  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:32:17,052  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:17,053  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:17,053  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:17,053  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:17,053  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:17,054  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=8, getDatabase_(String)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T02:32:17,054  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023217_c2979a3c-2007-4678-b82f-96fe05997532); Time taken: 0.006 seconds
2024-04-24T02:32:17,054  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023217_c2979a3c-2007-4678-b82f-96fe05997532
2024-04-24T02:32:17,054  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023217_c2979a3c-2007-4678-b82f-96fe05997532
2024-04-24T02:32:17,067  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023217_c2979a3c-2007-4678-b82f-96fe05997532 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:32:17,067  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:17,067  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023217_c2979a3c-2007-4678-b82f-96fe05997532): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:17,068  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:17,068  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951137, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, transactional=false, numFilesErasureCoded=0, numFiles=0, numRows=0, totalSize=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:17,073  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:32:17,087  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:17,087  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:17,087  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023217_c2979a3c-2007-4678-b82f-96fe05997532); Time taken: 0.02 seconds
2024-04-24T02:32:17,087  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023217_c2979a3c-2007-4678-b82f-96fe05997532
2024-04-24T02:32:17,091  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:32:17,096  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:17,096  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:32:17,096  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-24T02:32:17,097  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09): insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-24T02:32:17,100  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:32:17,100  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:32:17,100  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:17,100  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:17,106  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:17,129  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:17,129  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:17,129  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:17,129  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:17,129  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:17,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:17,139  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:17,139  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:17,140  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:17,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:17,245  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:17,245  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:17,245  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:17,245  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:17,248  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:17,248  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:17,248  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:17,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:17,255  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:17,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:17,258  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:17,268  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-24T02:32:17,268  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-24T02:32:17,269  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:17,272  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:17,272  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:17,272  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:32:17,273  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:17,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:17,288  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:17,288  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:17,288  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:17,288  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:17,288  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-24T02:32:17,288  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:17,289  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=1, getTable_(GetTableRequest)=47, allocateTableWriteId_(long, String, String)=8, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=1, getCheckConstraints_(CheckConstraintsRequest)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=9, getAllTableConstraints_(AllTableConstraintsRequest)=30, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:32:17,289  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09); Time taken: 0.191 seconds
2024-04-24T02:32:17,289  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09
2024-04-24T02:32:17,289  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09
2024-04-24T02:32:17,308  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:32:17,308  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:17,310  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09): insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-24T02:32:17,311  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09
2024-04-24T02:32:17,311  INFO [main] ql.Driver: Query ID = alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09
Total jobs = 1
2024-04-24T02:32:17,311  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:17,311  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:17,450  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:32:17,450  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:17,450  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:17,450  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:17,450  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:17,450  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:17,450  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:17,450  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:17,452  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:17,453  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:32:17,453  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-17_096_8421007104005834637-1/dummy_path
2024-04-24T02:32:17,461  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:17,462  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,03KB
2024-04-24T02:32:17,466  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:17,467  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:32:17,468  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:17,472  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-17_096_8421007104005834637-1/-mr-10000
2024-04-24T02:32:17,473  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:17,480  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:17,485  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:17,486  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:32:17,486  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:32:17,486  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-17_096_8421007104005834637-1/dummy_path
2024-04-24T02:32:17,486  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:32:17,503  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:32:17,521  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2129910977_0035
2024-04-24T02:32:17,521  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:17,577  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:17,577  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:17,578  INFO [Thread-2879] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:17,578  INFO [Thread-2879] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:17,579  INFO [Thread-2879] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:17,580  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2129910977_0035_m_000000_0
2024-04-24T02:32:17,582  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:17,583  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-17_096_8421007104005834637-1/dummy_path/null:0+1
2024-04-24T02:32:17,585  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:17,585  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,03KB
2024-04-24T02:32:17,585  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:32:17,590  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:17,590  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:17,590  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:17,590  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:17,590  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:17,590  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:17,591  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:17,591  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:17,591  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:17,591  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:17,592  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:32:17,592  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:32:17,592  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:17,592  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:32:17,592  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:32:17,592  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:17,592  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-24T02:32:17,593  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-24T02:32:17,596  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:17,596  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:17,596  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:17,596  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-24T02:32:17,596  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-24T02:32:17,606  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:17,611  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2129910977_0035_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:17,611  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:32:17,611  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2129910977_0035_m_000000_0' done.
2024-04-24T02:32:17,611  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2129910977_0035_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=697660
		FILE: Number of bytes written=41234245
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1311244288
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5083
2024-04-24T02:32:17,611  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2129910977_0035_m_000000_0
2024-04-24T02:32:17,611  INFO [Thread-2879] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:17,613  INFO [Thread-2879] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:17,613  INFO [pool-176-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2129910977_0035_r_000000_0
2024-04-24T02:32:17,615  INFO [pool-176-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:17,615  INFO [pool-176-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6a4fcdc
2024-04-24T02:32:17,616  WARN [pool-176-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:17,616  INFO [pool-176-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:17,617  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2129910977_0035_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:17,619  INFO [localfetcher#49] reduce.LocalFetcher: localfetcher#49 about to shuffle output of map attempt_local2129910977_0035_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:32:17,620  INFO [localfetcher#49] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local2129910977_0035_m_000000_0
2024-04-24T02:32:17,620  INFO [localfetcher#49] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:32:17,620  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:17,621  INFO [pool-176-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:17,621  INFO [pool-176-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:17,627  INFO [pool-176-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:17,627  INFO [pool-176-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:32:17,630  INFO [pool-176-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:17,630  INFO [pool-176-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:32:17,630  INFO [pool-176-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:17,630  INFO [pool-176-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:17,630  INFO [pool-176-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:32:17,630  INFO [pool-176-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:17,631  INFO [pool-176-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:17,631  INFO [pool-176-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:32:17,632  INFO [pool-176-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:17,632  INFO [pool-176-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:17,632  INFO [pool-176-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:17,632  INFO [pool-176-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:17,633  INFO [pool-176-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2129910977_0035/job_local2129910977_0035.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@71064916
2024-04-24T02:32:17,633  INFO [pool-176-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:17,633  INFO [pool-176-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:17,633  INFO [pool-176-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:17,634  INFO [pool-176-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:17,634  INFO [pool-176-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:17,641  INFO [pool-176-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:17,645  INFO [pool-176-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:17,646  INFO [pool-176-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:17,646  INFO [pool-176-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:17,646  INFO [pool-176-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:32:17,648  INFO [pool-176-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:32:17,660  INFO [pool-176-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T02:32:17,660  INFO [pool-176-thread-1] mapred.Task: Task:attempt_local2129910977_0035_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:17,660  INFO [pool-176-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:17,660  INFO [pool-176-thread-1] mapred.Task: Task 'attempt_local2129910977_0035_r_000000_0' done.
2024-04-24T02:32:17,661  INFO [pool-176-thread-1] mapred.Task: Final Counters for attempt_local2129910977_0035_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=703863
		FILE: Number of bytes written=41235321
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1311244288
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:17,661  INFO [pool-176-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2129910977_0035_r_000000_0
2024-04-24T02:32:17,661  INFO [pool-176-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2129910977_0035_r_000001_0
2024-04-24T02:32:17,661  INFO [pool-176-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:17,661  INFO [pool-176-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2a8053b6
2024-04-24T02:32:17,661  WARN [pool-176-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:17,662  INFO [pool-176-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:17,663  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2129910977_0035_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:17,666  INFO [localfetcher#50] reduce.LocalFetcher: localfetcher#50 about to shuffle output of map attempt_local2129910977_0035_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:32:17,666  INFO [localfetcher#50] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local2129910977_0035_m_000000_0
2024-04-24T02:32:17,666  INFO [localfetcher#50] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:32:17,667  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:17,668  INFO [pool-176-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:17,668  INFO [pool-176-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:17,682  INFO [pool-176-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:17,682  INFO [pool-176-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:32:17,688  INFO [pool-176-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:17,688  INFO [pool-176-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:32:17,688  INFO [pool-176-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:17,688  INFO [pool-176-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:17,688  INFO [pool-176-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:32:17,688  INFO [pool-176-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:17,689  INFO [pool-176-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:17,689  INFO [pool-176-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T02:32:17,691  INFO [pool-176-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:17,691  INFO [pool-176-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:17,691  INFO [pool-176-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:17,691  INFO [pool-176-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:17,691  INFO [pool-176-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2129910977_0035/job_local2129910977_0035.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@ffeb80a
2024-04-24T02:32:17,692  INFO [pool-176-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:17,692  INFO [pool-176-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:17,692  INFO [pool-176-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:17,692  INFO [pool-176-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:17,692  INFO [pool-176-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:17,698  INFO [pool-176-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:17,699  INFO [pool-176-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:17,699  INFO [pool-176-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T02:32:17,699  INFO [pool-176-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:17,699  INFO [pool-176-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:32:17,701  INFO [pool-176-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:32:17,712  INFO [pool-176-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-24T02:32:17,712  INFO [pool-176-thread-1] mapred.Task: Task:attempt_local2129910977_0035_r_000001_0 is done. And is in the process of committing
2024-04-24T02:32:17,713  INFO [pool-176-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:17,713  INFO [pool-176-thread-1] mapred.Task: Task 'attempt_local2129910977_0035_r_000001_0' done.
2024-04-24T02:32:17,713  INFO [pool-176-thread-1] mapred.Task: Final Counters for attempt_local2129910977_0035_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=710024
		FILE: Number of bytes written=41236393
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1311244288
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:17,713  INFO [pool-176-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2129910977_0035_r_000001_0
2024-04-24T02:32:17,713  INFO [Thread-2879] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:18,581 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:18,581  INFO [main] exec.Task: 2024-04-24 02:32:18,581 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2129910977_0035
2024-04-24T02:32:18,583  INFO [main] exec.Task: Ended Job = job_local2129910977_0035
2024-04-24T02:32:18,584  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:32:18,584  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:32:18,584  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:32:18,585  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:32:18,585  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:32:18,586  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:32:18,586  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:18,586  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:18,593  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:18,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:18,599  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:18,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:18,636  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:32:18,636  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:18,642  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:18,642  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:32:18,643  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-17_096_8421007104005834637-1/-mr-10000
2024-04-24T02:32:18,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:18,650  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:18,661  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:32:18,662  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-24T02:32:18,662  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:32:18,662  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:18,682  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-24T02:32:18,682  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:32:18,682  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:32:18,684  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1389, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:32:18,685  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:18,685  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=57, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=25, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-24T02:32:18,685  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:18,685  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:18,685  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:18,685  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09); Time taken: 1.375 seconds
2024-04-24T02:32:18,685  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023217_24a3dd1e-b6a0-4c15-b39a-782dcb0f3b09
2024-04-24T02:32:18,694  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:18,694  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:32:18,695  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-24T02:32:18,695  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-17_096_8421007104005834637-1
2024-04-24T02:32:18,696  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-17_096_8421007104005834637-1 on fs with scheme file
2024-04-24T02:32:18,696  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e): select a,b from acidTbl order by a,b
2024-04-24T02:32:18,699  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:32:18,699  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:32:18,700  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:18,700  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:18,702  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:18,702  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:18,703  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:18,709  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:18,710  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:18,710  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:18,710  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:18,730  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:18,765  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:32:18,765  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:18,775  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:18,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:18,784  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:18,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:32:18,795  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:32:18,795  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:32:18,836  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:18,836  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:18,836  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:18,837  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-18_696_6561508301943489877-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-18_696_6561508301943489877-1
2024-04-24T02:32:18,844  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:18,847  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:18,847  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:18,848  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:18,856  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:18,856  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:18,856  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:18,856  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T02:32:18,857  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T02:32:18,858  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:18,858  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, flushCache_()=0, getTableColumnStatistics_(String, String, List, String)=30, getTable_(GetTableRequest)=7, getAllTableConstraints_(AllTableConstraintsRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:18,858  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e); Time taken: 0.162 seconds
2024-04-24T02:32:18,858  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e
2024-04-24T02:32:18,859  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e
2024-04-24T02:32:18,872  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:32:18,872  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:18,873  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e): select a,b from acidTbl order by a,b
2024-04-24T02:32:18,873  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e
2024-04-24T02:32:18,873  INFO [main] ql.Driver: Query ID = alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e
Total jobs = 1
2024-04-24T02:32:18,873  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:18,873  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:19,024  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:32:19,024  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:19,024  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:19,024  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:19,024  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:19,024  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:19,024  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:19,024  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:19,026  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:19,026  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-24T02:32:19,026  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:19,035  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:19,036  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:32:19,040  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:19,041  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-24T02:32:19,042  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:19,047  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:19,054  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:19,058  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:19,059  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T02:32:19,059  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T02:32:19,059  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:19,060  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T02:32:19,060  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T02:32:19,060  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T02:32:19,071  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T02:32:19,071  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 11 ms
2024-04-24T02:32:19,071  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T02:32:19,089  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T02:32:19,107  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1829079477_0036
2024-04-24T02:32:19,107  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:19,167  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:19,167  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:19,168  INFO [Thread-2956] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:19,168  INFO [Thread-2956] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:19,170  INFO [Thread-2956] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:19,170  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1829079477_0036_m_000000_0
2024-04-24T02:32:19,170  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:19,171  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=699, isOriginal=false, fileLength=699, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:19,171  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:19,172  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:32:19,173  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:19,173  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 699, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:19,173  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:19,173  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:19,178  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:19,178  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:19,178  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:19,178  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:19,178  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:19,178  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:19,178  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:19,179  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:19,180  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 38; bufvoid = 104857600
2024-04-24T02:32:19,181  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:32:19,191  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:19,194  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1829079477_0036_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:19,194  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=699, isOriginal=false, fileLength=699, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:19,194  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1829079477_0036_m_000000_0' done.
2024-04-24T02:32:19,194  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1829079477_0036_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=719307
		FILE: Number of bytes written=42413177
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=38
		Map output materialized bytes=48
		Input split bytes=495
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1312292864
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7578
2024-04-24T02:32:19,194  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1829079477_0036_m_000000_0
2024-04-24T02:32:19,194  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1829079477_0036_m_000001_0
2024-04-24T02:32:19,195  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:19,195  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=690, isOriginal=false, fileLength=690, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:19,196  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:19,196  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:32:19,197  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:19,197  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 690, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:19,198  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:19,198  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:19,202  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:19,202  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:19,202  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:19,202  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:19,202  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:19,203  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:19,203  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:19,204  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:19,204  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:19,204  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:19,204  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:19,204  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:19,204  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T02:32:19,205  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T02:32:19,206  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:19,206  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:19,206  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:19,206  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 38; bufvoid = 104857600
2024-04-24T02:32:19,206  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:32:19,218  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:19,226  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1829079477_0036_m_000001_0 is done. And is in the process of committing
2024-04-24T02:32:19,227  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=690, isOriginal=false, fileLength=690, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:19,227  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1829079477_0036_m_000001_0' done.
2024-04-24T02:32:19,227  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1829079477_0036_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=727862
		FILE: Number of bytes written=42413257
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=38
		Map output materialized bytes=48
		Input split bytes=495
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1312292864
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7542
2024-04-24T02:32:19,227  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1829079477_0036_m_000001_0
2024-04-24T02:32:19,228  INFO [Thread-2956] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:19,230  INFO [Thread-2956] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:19,230  INFO [pool-181-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1829079477_0036_r_000000_0
2024-04-24T02:32:19,231  INFO [pool-181-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:19,231  INFO [pool-181-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@65740adc
2024-04-24T02:32:19,232  WARN [pool-181-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:19,234  INFO [pool-181-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:19,236  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1829079477_0036_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:19,238  INFO [localfetcher#51] reduce.LocalFetcher: localfetcher#51 about to shuffle output of map attempt_local1829079477_0036_m_000001_0 decomp: 44 len: 48 to MEMORY
2024-04-24T02:32:19,238  INFO [localfetcher#51] reduce.InMemoryMapOutput: Read 44 bytes from map-output for attempt_local1829079477_0036_m_000001_0
2024-04-24T02:32:19,238  INFO [localfetcher#51] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 44, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->44
2024-04-24T02:32:19,242  INFO [localfetcher#51] reduce.LocalFetcher: localfetcher#51 about to shuffle output of map attempt_local1829079477_0036_m_000000_0 decomp: 44 len: 48 to MEMORY
2024-04-24T02:32:19,243  INFO [localfetcher#51] reduce.InMemoryMapOutput: Read 44 bytes from map-output for attempt_local1829079477_0036_m_000000_0
2024-04-24T02:32:19,243  INFO [localfetcher#51] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 44, inMemoryMapOutputs.size() -> 2, commitMemory -> 44, usedMemory ->88
2024-04-24T02:32:19,243  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:19,244  INFO [pool-181-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T02:32:19,244  INFO [pool-181-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:19,256  INFO [pool-181-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T02:32:19,256  INFO [pool-181-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 54 bytes
2024-04-24T02:32:19,263  INFO [pool-181-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 88 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:19,263  INFO [pool-181-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-24T02:32:19,263  INFO [pool-181-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:19,263  INFO [pool-181-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:19,264  INFO [pool-181-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-24T02:32:19,264  INFO [pool-181-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T02:32:19,265  INFO [pool-181-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:19,266  INFO [pool-181-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-24T02:32:19,268  INFO [pool-181-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:19,268  INFO [pool-181-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:19,268  INFO [pool-181-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-24T02:32:19,268  INFO [pool-181-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:32:19,269  INFO [pool-181-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@6c1448a3, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@65a1099, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@c675529
2024-04-24T02:32:19,271  INFO [pool-181-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-18_696_6561508301943489877-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-18_696_6561508301943489877-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:19,271  INFO [pool-181-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-18_696_6561508301943489877-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-18_696_6561508301943489877-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:32:19,271  INFO [pool-181-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-18_696_6561508301943489877-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-18_696_6561508301943489877-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:19,291  INFO [pool-181-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:19,292  INFO [pool-181-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:19,292  INFO [pool-181-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-24T02:32:19,292  INFO [pool-181-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:32:19,292  INFO [pool-181-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T02:32:19,293  INFO [pool-181-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:19,294  INFO [pool-181-thread-1] mapred.Task: Task:attempt_local1829079477_0036_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:19,295  INFO [pool-181-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:19,295  INFO [pool-181-thread-1] mapred.Task: Task 'attempt_local1829079477_0036_r_000000_0' done.
2024-04-24T02:32:19,295  INFO [pool-181-thread-1] mapred.Task: Final Counters for attempt_local1829079477_0036_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=733759
		FILE: Number of bytes written=42413510
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=96
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1312292864
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:19,295  INFO [pool-181-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1829079477_0036_r_000000_0
2024-04-24T02:32:19,295  INFO [Thread-2956] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:20,170 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:20,170  INFO [main] exec.Task: 2024-04-24 02:32:20,170 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1829079477_0036
2024-04-24T02:32:20,172  INFO [main] exec.Task: Ended Job = job_local1829079477_0036
2024-04-24T02:32:20,174  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:20,174  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T02:32:20,175  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:20,175  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:20,175  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:20,175  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e); Time taken: 1.301 seconds
2024-04-24T02:32:20,175  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023218_278eb19d-3fda-4b56-8f34-400748cd0d0e
2024-04-24T02:32:20,179  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:32:20,185  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:20,185  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:32:20,189  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T02:32:20,190  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T02:32:20,190  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:4, 
2024-04-24T02:32:20,190  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-24T02:32:20,191  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-18_696_6561508301943489877-1
2024-04-24T02:32:20,191  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3dd7512-06f6-4f15-aaf6-b9c154c44e18/hive_2024-04-24_02-32-18_696_6561508301943489877-1 on fs with scheme file
2024-04-24T02:32:20,191  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023220_dbcb2bcd-2d4a-4c58-b060-19b063beebae): START TRANSACTION
2024-04-24T02:32:20,194  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-24T02:32:20,194  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:32:20,194  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:20,194  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:20,195  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:20,195  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:20,195  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:20,195  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:20,195  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:32:20,195  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023220_dbcb2bcd-2d4a-4c58-b060-19b063beebae); Time taken: 0.004 seconds
2024-04-24T02:32:20,195  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023220_dbcb2bcd-2d4a-4c58-b060-19b063beebae
2024-04-24T02:32:20,195  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-24T02:32:20,196  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023220_dbcb2bcd-2d4a-4c58-b060-19b063beebae): START TRANSACTION
2024-04-24T02:32:20,196  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:20,196  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T02:32:20,196  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023220_dbcb2bcd-2d4a-4c58-b060-19b063beebae); Time taken: 0.001 seconds
2024-04-24T02:32:20,196  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 8
2024-04-24T02:32:20,196  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023220_44959c42-eba7-40dd-bfc1-e21c9506c462): delete from acidTbl where b = 8
2024-04-24T02:32:20,197  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:32:20,197  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:20,205  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,205  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 8> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-24T02:32:20,205  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:32:20,207  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:20,207  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:20,208  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:20,214  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,215  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:20,215  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:20,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:20,221  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,221  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:20,221  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:20,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:20,261  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-24T02:32:20,261  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:20,271  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,272  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:20,281  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:32:20,291  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-24T02:32:20,291  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-24T02:32:20,347  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:20,347  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:20,347  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:20,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:20,354  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,357 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:32:20,358 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:32:20,358  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:32:20,358 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:32:20,358  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:20,358  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=30, getTable_(GetTableRequest)=26, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, flushCache_()=0, getValidWriteIds_(List, String)=2}
2024-04-24T02:32:20,358  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023220_44959c42-eba7-40dd-bfc1-e21c9506c462); Time taken: 0.162 seconds
2024-04-24T02:32:20,359  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023220_dbcb2bcd-2d4a-4c58-b060-19b063beebae
2024-04-24T02:32:20,363  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:20,370  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:20,370  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023220_df92b1e4-8b4e-422c-a72a-e21bbe34ad7b): drop table if exists acidTbl
2024-04-24T02:32:20,373  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-24T02:32:20,373  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:32:20,374  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:20,380  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,380  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:20,380  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:20,380  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:20,380  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, flushCache_()=0, isCompatibleWith_(Configuration)=0, rollbackTxn_(long)=11, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-24T02:32:20,380  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023220_df92b1e4-8b4e-422c-a72a-e21bbe34ad7b); Time taken: 0.01 seconds
2024-04-24T02:32:20,380  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023220_df92b1e4-8b4e-422c-a72a-e21bbe34ad7b
2024-04-24T02:32:20,381  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023220_df92b1e4-8b4e-422c-a72a-e21bbe34ad7b
2024-04-24T02:32:20,394  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023220_df92b1e4-8b4e-422c-a72a-e21bbe34ad7b LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:32:20,394  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:20,394  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023220_df92b1e4-8b4e-422c-a72a-e21bbe34ad7b): drop table if exists acidTbl
2024-04-24T02:32:20,394  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:20,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:20,400  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:20,406  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:20,508  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:20,508  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=108, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:32:20,509  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023220_df92b1e4-8b4e-422c-a72a-e21bbe34ad7b); Time taken: 0.114 seconds
2024-04-24T02:32:20,509  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023220_df92b1e4-8b4e-422c-a72a-e21bbe34ad7b
2024-04-24T02:32:20,512  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:32:20,518  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:20,519  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:32:20,520  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:20,520  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023220_785e7b5a-d9fb-44f5-985e-fbe5fd8a698d): drop table if exists acidTblPart
2024-04-24T02:32:20,523  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-24T02:32:20,523  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:32:20,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:20,541  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,541  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:20,541  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:20,541  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:20,541  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=16, openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2}
2024-04-24T02:32:20,541  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023220_785e7b5a-d9fb-44f5-985e-fbe5fd8a698d); Time taken: 0.021 seconds
2024-04-24T02:32:20,542  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023220_785e7b5a-d9fb-44f5-985e-fbe5fd8a698d
2024-04-24T02:32:20,542  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023220_785e7b5a-d9fb-44f5-985e-fbe5fd8a698d
2024-04-24T02:32:20,559  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023220_785e7b5a-d9fb-44f5-985e-fbe5fd8a698d LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:32:20,559  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:20,559  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023220_785e7b5a-d9fb-44f5-985e-fbe5fd8a698d): drop table if exists acidTblPart
2024-04-24T02:32:20,559  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:20,559  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:20,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:20,572  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:20,612  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:20,613  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=47, getTable_(GetTableRequest)=6}
2024-04-24T02:32:20,613  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023220_785e7b5a-d9fb-44f5-985e-fbe5fd8a698d); Time taken: 0.053 seconds
2024-04-24T02:32:20,613  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023220_785e7b5a-d9fb-44f5-985e-fbe5fd8a698d
2024-04-24T02:32:20,616  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:32:20,622  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:20,622  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:32:20,623  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:20,623  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023220_67ce9345-4bdb-44c6-a256-d9789ee48ba0): drop table if exists acidTbl2
2024-04-24T02:32:20,625  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-24T02:32:20,625  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:32:20,626  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:20,626  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:20,626  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:20,626  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:32:20,626  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023220_67ce9345-4bdb-44c6-a256-d9789ee48ba0); Time taken: 0.003 seconds
2024-04-24T02:32:20,626  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023220_67ce9345-4bdb-44c6-a256-d9789ee48ba0
2024-04-24T02:32:20,627  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:20,627  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023220_67ce9345-4bdb-44c6-a256-d9789ee48ba0): drop table if exists acidTbl2
2024-04-24T02:32:20,627  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:20,627  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:32:20,627  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:20,627  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0}
2024-04-24T02:32:20,628  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023220_67ce9345-4bdb-44c6-a256-d9789ee48ba0); Time taken: 0.0 seconds
2024-04-24T02:32:20,628  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023220_67ce9345-4bdb-44c6-a256-d9789ee48ba0
2024-04-24T02:32:20,632  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:32:20,638  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:20,638  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:32:20,638  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:20,638  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023220_dfdbc8d8-405b-4a87-9b7a-47a885e9e22d): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:20,641  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-24T02:32:20,641  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:32:20,641  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:20,664  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,665  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:20,665  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:20,665  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:20,665  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=24, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-24T02:32:20,665  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023220_dfdbc8d8-405b-4a87-9b7a-47a885e9e22d); Time taken: 0.027 seconds
2024-04-24T02:32:20,665  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023220_dfdbc8d8-405b-4a87-9b7a-47a885e9e22d
2024-04-24T02:32:20,666  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023220_dfdbc8d8-405b-4a87-9b7a-47a885e9e22d
2024-04-24T02:32:20,680  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023220_dfdbc8d8-405b-4a87-9b7a-47a885e9e22d LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:32:20,680  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:20,680  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023220_dfdbc8d8-405b-4a87-9b7a-47a885e9e22d): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:20,680  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:20,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:20,689  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:20,698  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:20,771  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:20,771  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=82}
2024-04-24T02:32:20,771  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023220_dfdbc8d8-405b-4a87-9b7a-47a885e9e22d); Time taken: 0.091 seconds
2024-04-24T02:32:20,771  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023220_dfdbc8d8-405b-4a87-9b7a-47a885e9e22d
2024-04-24T02:32:20,775  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:32:20,782  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:20,782  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:32:20,782  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:20,782  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023220_717a4e5b-19bc-4014-a9fd-e92f8e1fad99): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:20,784  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-24T02:32:20,785  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:32:20,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:20,794  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,794  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:20,794  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:20,794  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:20,794  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:32:20,794  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023220_717a4e5b-19bc-4014-a9fd-e92f8e1fad99); Time taken: 0.012 seconds
2024-04-24T02:32:20,794  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023220_717a4e5b-19bc-4014-a9fd-e92f8e1fad99
2024-04-24T02:32:20,795  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023220_717a4e5b-19bc-4014-a9fd-e92f8e1fad99
2024-04-24T02:32:20,810  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023220_717a4e5b-19bc-4014-a9fd-e92f8e1fad99 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:32:20,810  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:20,810  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023220_717a4e5b-19bc-4014-a9fd-e92f8e1fad99): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:20,810  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:20,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:20,819  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,820  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:20,828  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:20,860  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:20,860  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=41, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:20,861  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023220_717a4e5b-19bc-4014-a9fd-e92f8e1fad99); Time taken: 0.05 seconds
2024-04-24T02:32:20,861  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023220_717a4e5b-19bc-4014-a9fd-e92f8e1fad99
2024-04-24T02:32:20,865  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:32:20,872  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:20,872  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:32:20,873  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:20,873  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023220_98ebbbb9-c13d-4f22-893b-ecab6b84d6fc): drop table if exists nonAcidNonBucket
2024-04-24T02:32:20,875  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-24T02:32:20,875  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:32:20,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:20,884  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,885  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:20,885  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:20,885  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:20,885  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:32:20,885  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023220_98ebbbb9-c13d-4f22-893b-ecab6b84d6fc); Time taken: 0.012 seconds
2024-04-24T02:32:20,885  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023220_98ebbbb9-c13d-4f22-893b-ecab6b84d6fc
2024-04-24T02:32:20,886  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023220_98ebbbb9-c13d-4f22-893b-ecab6b84d6fc
2024-04-24T02:32:20,899  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023220_98ebbbb9-c13d-4f22-893b-ecab6b84d6fc LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:32:20,899  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:20,900  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023220_98ebbbb9-c13d-4f22-893b-ecab6b84d6fc): drop table if exists nonAcidNonBucket
2024-04-24T02:32:20,900  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:20,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:20,908  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:20,919  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:20,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:20,950  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:20,950  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=42, getTable_(GetTableRequest)=8}
2024-04-24T02:32:20,950  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023220_98ebbbb9-c13d-4f22-893b-ecab6b84d6fc); Time taken: 0.05 seconds
2024-04-24T02:32:20,950  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023220_98ebbbb9-c13d-4f22-893b-ecab6b84d6fc
2024-04-24T02:32:20,954  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:32:20,960  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:20,960  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:32:20,960  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="truncateTableAdvancingWriteId" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.455"/>
  <testcase name="testAddAndDropConstraintAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="3.697"/>
  <testcase name="testMultipleInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="7.295"/>
  <testcase name="testDeleteOfMultipleInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.456">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:32:33,477  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:32:33,479  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 2f349115-bee1-410e-9068-e1c480d80826
2024-04-24T02:32:33,482  INFO [main] SessionState: Hive Session ID = 2f349115-bee1-410e-9068-e1c480d80826
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:33,482  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:33,487  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/2f349115-bee1-410e-9068-e1c480d80826
2024-04-24T02:32:33,490  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826
2024-04-24T02:32:33,492  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/2f349115-bee1-410e-9068-e1c480d80826/_tmp_space.db
2024-04-24T02:32:33,492  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=2f349115-bee1-410e-9068-e1c480d80826, clientType=HIVECLI]
2024-04-24T02:32:33,492  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:33,493  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_310de225-7f89-4dae-8de6-b690475ad440): drop table if exists acidTbl
2024-04-24T02:32:33,500  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:32:33,500  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:32:33,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:33,509  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,509  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,509  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,509  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=2, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=7}
2024-04-24T02:32:33,509  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_310de225-7f89-4dae-8de6-b690475ad440); Time taken: 0.016 seconds
2024-04-24T02:32:33,510  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023233_310de225-7f89-4dae-8de6-b690475ad440
2024-04-24T02:32:33,510  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:33,510  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_310de225-7f89-4dae-8de6-b690475ad440): drop table if exists acidTbl
2024-04-24T02:32:33,510  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,510  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:33,513  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,513  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,513  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_310de225-7f89-4dae-8de6-b690475ad440); Time taken: 0.003 seconds
2024-04-24T02:32:33,513  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_310de225-7f89-4dae-8de6-b690475ad440
2024-04-24T02:32:33,519  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:32:33,525  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,525  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:32:33,526  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:33,526  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_1c81dfc9-644a-49c9-adda-42f67668b893): drop table if exists acidTblPart
2024-04-24T02:32:33,528  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:32:33,528  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:32:33,528  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:33,531  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,531  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,531  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,531  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13}
2024-04-24T02:32:33,532  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_1c81dfc9-644a-49c9-adda-42f67668b893); Time taken: 0.005 seconds
2024-04-24T02:32:33,532  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023233_1c81dfc9-644a-49c9-adda-42f67668b893
2024-04-24T02:32:33,532  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:33,532  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_1c81dfc9-644a-49c9-adda-42f67668b893): drop table if exists acidTblPart
2024-04-24T02:32:33,532  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,532  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:33,535  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,535  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,535  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_1c81dfc9-644a-49c9-adda-42f67668b893); Time taken: 0.003 seconds
2024-04-24T02:32:33,535  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_1c81dfc9-644a-49c9-adda-42f67668b893
2024-04-24T02:32:33,540  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:32:33,546  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,546  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:32:33,547  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:33,547  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_0ee4e1d6-d817-4a02-98be-e0a66bc0e7bf): drop table if exists acidTbl2
2024-04-24T02:32:33,549  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:32:33,550  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:32:33,550  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:33,553  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,553  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,553  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,553  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:32:33,553  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_0ee4e1d6-d817-4a02-98be-e0a66bc0e7bf); Time taken: 0.006 seconds
2024-04-24T02:32:33,553  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023233_0ee4e1d6-d817-4a02-98be-e0a66bc0e7bf
2024-04-24T02:32:33,553  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:33,553  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_0ee4e1d6-d817-4a02-98be-e0a66bc0e7bf): drop table if exists acidTbl2
2024-04-24T02:32:33,553  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:33,556  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,556  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:32:33,557  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_0ee4e1d6-d817-4a02-98be-e0a66bc0e7bf); Time taken: 0.003 seconds
2024-04-24T02:32:33,557  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_0ee4e1d6-d817-4a02-98be-e0a66bc0e7bf
2024-04-24T02:32:33,562  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:32:33,568  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,568  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:32:33,568  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:33,568  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_41c39d29-9e5f-434b-9307-eab700c4488e): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:33,570  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:32:33,571  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:32:33,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:33,574  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,574  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,574  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,574  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0}
2024-04-24T02:32:33,574  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_41c39d29-9e5f-434b-9307-eab700c4488e); Time taken: 0.006 seconds
2024-04-24T02:32:33,574  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023233_41c39d29-9e5f-434b-9307-eab700c4488e
2024-04-24T02:32:33,574  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:33,574  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_41c39d29-9e5f-434b-9307-eab700c4488e): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:33,575  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,575  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:33,577  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,577  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,578  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_41c39d29-9e5f-434b-9307-eab700c4488e); Time taken: 0.003 seconds
2024-04-24T02:32:33,578  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_41c39d29-9e5f-434b-9307-eab700c4488e
2024-04-24T02:32:33,583  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:32:33,589  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,589  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:32:33,589  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:33,590  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_6e115227-85d2-4d25-849e-b9f9487daf02): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:33,592  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:32:33,592  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:32:33,592  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:33,595  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,595  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,595  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,595  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T02:32:33,595  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_6e115227-85d2-4d25-849e-b9f9487daf02); Time taken: 0.005 seconds
2024-04-24T02:32:33,596  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023233_6e115227-85d2-4d25-849e-b9f9487daf02
2024-04-24T02:32:33,596  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:33,596  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_6e115227-85d2-4d25-849e-b9f9487daf02): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:33,596  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:33,599  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,599  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,599  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_6e115227-85d2-4d25-849e-b9f9487daf02); Time taken: 0.003 seconds
2024-04-24T02:32:33,599  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_6e115227-85d2-4d25-849e-b9f9487daf02
2024-04-24T02:32:33,604  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:32:33,611  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,611  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:32:33,612  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:33,612  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_0fadd2aa-be69-4a9e-9388-753e983cdf42): drop table if exists nonAcidNonBucket
2024-04-24T02:32:33,614  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:32:33,614  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:32:33,614  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:33,617  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,617  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,617  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,617  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,618  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_0fadd2aa-be69-4a9e-9388-753e983cdf42); Time taken: 0.005 seconds
2024-04-24T02:32:33,618  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023233_0fadd2aa-be69-4a9e-9388-753e983cdf42
2024-04-24T02:32:33,618  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:33,618  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_0fadd2aa-be69-4a9e-9388-753e983cdf42): drop table if exists nonAcidNonBucket
2024-04-24T02:32:33,618  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:33,621  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,621  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,621  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_0fadd2aa-be69-4a9e-9388-753e983cdf42); Time taken: 0.003 seconds
2024-04-24T02:32:33,621  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_0fadd2aa-be69-4a9e-9388-753e983cdf42
2024-04-24T02:32:33,627  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:32:33,632  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,632  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:32:33,633  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,633  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_a86b76ff-9ac4-4d73-91dc-331f1b29694c): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,635  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:32:33,636  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:32:33,636  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:33,636  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:33,641  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:32:33,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:33,643  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:33,643  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,643  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,643  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,643  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=5, flushCache_()=0}
2024-04-24T02:32:33,644  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_a86b76ff-9ac4-4d73-91dc-331f1b29694c); Time taken: 0.01 seconds
2024-04-24T02:32:33,644  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023233_a86b76ff-9ac4-4d73-91dc-331f1b29694c
2024-04-24T02:32:33,644  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023233_a86b76ff-9ac4-4d73-91dc-331f1b29694c
2024-04-24T02:32:33,661  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023233_a86b76ff-9ac4-4d73-91dc-331f1b29694c LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:32:33,661  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:33,662  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_a86b76ff-9ac4-4d73-91dc-331f1b29694c): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,662  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,663  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951153, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true, numFiles=0, totalSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:33,668  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:33,706  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,706  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,706  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_a86b76ff-9ac4-4d73-91dc-331f1b29694c); Time taken: 0.044 seconds
2024-04-24T02:32:33,707  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_a86b76ff-9ac4-4d73-91dc-331f1b29694c
2024-04-24T02:32:33,711  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:32:33,717  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,717  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:32:33,717  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,717  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_03bbedf5-e060-4ba3-aae7-02951f2dd570): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,720  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:32:33,720  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:32:33,720  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:33,720  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:33,723  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:32:33,723  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:33,725  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:33,725  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,725  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,725  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,725  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,725  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_03bbedf5-e060-4ba3-aae7-02951f2dd570); Time taken: 0.008 seconds
2024-04-24T02:32:33,725  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023233_03bbedf5-e060-4ba3-aae7-02951f2dd570
2024-04-24T02:32:33,726  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023233_03bbedf5-e060-4ba3-aae7-02951f2dd570
2024-04-24T02:32:33,741  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023233_03bbedf5-e060-4ba3-aae7-02951f2dd570 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:32:33,741  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:33,741  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_03bbedf5-e060-4ba3-aae7-02951f2dd570): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,742  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951153, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:33,748  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:32:33,769  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,769  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=27}
2024-04-24T02:32:33,769  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_03bbedf5-e060-4ba3-aae7-02951f2dd570); Time taken: 0.028 seconds
2024-04-24T02:32:33,769  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_03bbedf5-e060-4ba3-aae7-02951f2dd570
2024-04-24T02:32:33,773  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:32:33,781  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,781  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:32:33,782  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,782  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_cedac172-4c9d-4631-b872-b2cb1908dfa5): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,784  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:32:33,785  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:32:33,785  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:33,785  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:33,788  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:32:33,788  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:33,789  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:33,789  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,790  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,790  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,790  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=3, getDatabase_(String)=1}
2024-04-24T02:32:33,790  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_cedac172-4c9d-4631-b872-b2cb1908dfa5); Time taken: 0.008 seconds
2024-04-24T02:32:33,790  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023233_cedac172-4c9d-4631-b872-b2cb1908dfa5
2024-04-24T02:32:33,790  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023233_cedac172-4c9d-4631-b872-b2cb1908dfa5
2024-04-24T02:32:33,807  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023233_cedac172-4c9d-4631-b872-b2cb1908dfa5 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:32:33,807  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:33,807  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_cedac172-4c9d-4631-b872-b2cb1908dfa5): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,807  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951153, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, totalSize=0, numFiles=0, bucketing_version=2, transactional=false, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:33,813  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:32:33,828  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,828  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-24T02:32:33,828  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_cedac172-4c9d-4631-b872-b2cb1908dfa5); Time taken: 0.021 seconds
2024-04-24T02:32:33,828  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_cedac172-4c9d-4631-b872-b2cb1908dfa5
2024-04-24T02:32:33,833  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:32:33,840  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,840  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:32:33,840  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,841  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_e442ef3e-352c-488a-9a5c-c723aafb8fd2): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,843  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:32:33,843  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:32:33,844  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:33,844  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:33,846  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:32:33,846  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:33,848  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:33,848  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,848  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,848  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,848  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0, getValidTxns_(long)=1}
2024-04-24T02:32:33,848  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_e442ef3e-352c-488a-9a5c-c723aafb8fd2); Time taken: 0.008 seconds
2024-04-24T02:32:33,848  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023233_e442ef3e-352c-488a-9a5c-c723aafb8fd2
2024-04-24T02:32:33,849  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023233_e442ef3e-352c-488a-9a5c-c723aafb8fd2
2024-04-24T02:32:33,864  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023233_e442ef3e-352c-488a-9a5c-c723aafb8fd2 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:32:33,864  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:33,864  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_e442ef3e-352c-488a-9a5c-c723aafb8fd2): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,864  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,865  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951153, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, rawDataSize=0, numFiles=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, transactional=false, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:33,871  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:32:33,885  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,885  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,885  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_e442ef3e-352c-488a-9a5c-c723aafb8fd2); Time taken: 0.021 seconds
2024-04-24T02:32:33,885  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_e442ef3e-352c-488a-9a5c-c723aafb8fd2
2024-04-24T02:32:33,889  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:32:33,897  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,897  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:32:33,897  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,898  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_b4c2566b-cd01-4e26-a7bb-52bb78063c06): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,900  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:32:33,901  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:32:33,901  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:33,901  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:33,904  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:32:33,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:33,905  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:33,905  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,905  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,906  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,906  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=3, flushCache_()=0}
2024-04-24T02:32:33,906  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_b4c2566b-cd01-4e26-a7bb-52bb78063c06); Time taken: 0.008 seconds
2024-04-24T02:32:33,906  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023233_b4c2566b-cd01-4e26-a7bb-52bb78063c06
2024-04-24T02:32:33,906  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023233_b4c2566b-cd01-4e26-a7bb-52bb78063c06
2024-04-24T02:32:33,922  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023233_b4c2566b-cd01-4e26-a7bb-52bb78063c06 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:32:33,922  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:33,922  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_b4c2566b-cd01-4e26-a7bb-52bb78063c06): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:33,922  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,923  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/2f349115-bee1-410e-9068-e1c480d80826/_tmp_space.db/fdc05be8-a34b-4d92-ae7f-a087170c28e9
2024-04-24T02:32:33,926  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,926  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,926  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_b4c2566b-cd01-4e26-a7bb-52bb78063c06); Time taken: 0.004 seconds
2024-04-24T02:32:33,926  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_b4c2566b-cd01-4e26-a7bb-52bb78063c06
2024-04-24T02:32:33,930  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:32:33,936  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,936  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:32:33,937  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,937  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_a210d2af-752a-4429-bd27-0e19e247e649): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,939  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:32:33,939  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:32:33,940  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:33,940  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:33,942  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:32:33,942  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:33,944  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:33,944  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,944  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-24T02:32:33,944  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_a210d2af-752a-4429-bd27-0e19e247e649); Time taken: 0.007 seconds
2024-04-24T02:32:33,944  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023233_a210d2af-752a-4429-bd27-0e19e247e649
2024-04-24T02:32:33,945  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023233_a210d2af-752a-4429-bd27-0e19e247e649
2024-04-24T02:32:33,958  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023233_a210d2af-752a-4429-bd27-0e19e247e649 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:32:33,958  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:33,958  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_a210d2af-752a-4429-bd27-0e19e247e649): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:33,958  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:33,959  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951153, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, rawDataSize=0, numFiles=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:33,964  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:32:33,978  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,978  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:33,978  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_a210d2af-752a-4429-bd27-0e19e247e649); Time taken: 0.02 seconds
2024-04-24T02:32:33,978  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023233_a210d2af-752a-4429-bd27-0e19e247e649
2024-04-24T02:32:33,982  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:32:33,988  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:33,988  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:32:33,989  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-24T02:32:33,989  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_c480e9c8-edbe-4cae-b779-c1b1e05c24cf): START TRANSACTION
2024-04-24T02:32:33,991  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:32:33,991  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:32:33,992  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:33,992  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:33,992  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:33,992  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:33,992  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:33,992  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:33,992  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=0, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T02:32:33,992  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_c480e9c8-edbe-4cae-b779-c1b1e05c24cf); Time taken: 0.003 seconds
2024-04-24T02:32:33,993  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023233_c480e9c8-edbe-4cae-b779-c1b1e05c24cf
2024-04-24T02:32:33,993  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-24T02:32:33,993  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_c480e9c8-edbe-4cae-b779-c1b1e05c24cf): START TRANSACTION
2024-04-24T02:32:33,993  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:33,993  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T02:32:33,993  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_c480e9c8-edbe-4cae-b779-c1b1e05c24cf); Time taken: 0.0 seconds
2024-04-24T02:32:33,993  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:32:33,994  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:32:33,995  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:33,995  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:33,998  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:34,017  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:34,017  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:34,017  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:34,017  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:34,017  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:34,017  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:34,024  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:34,024  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:34,024  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:34,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:34,121  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:34,121  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:34,121  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:34,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:34,124  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:34,124  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:34,124  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:34,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:34,131  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:34,133  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:34,134  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:34,145  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-24T02:32:34,146  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-24T02:32:34,147  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:34,150  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:32:34,150  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:32:34,151  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:32:34,151  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:34,161  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:34,168  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:34,169  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:34,169  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:34,169  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:34,169  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-24T02:32:34,169  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:34,169  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=10, getTable_(GetTableRequest)=42, getCheckConstraints_(CheckConstraintsRequest)=1, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, getNotNullConstraints_(NotNullConstraintsRequest)=1, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=26}
2024-04-24T02:32:34,169  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970); Time taken: 0.175 seconds
2024-04-24T02:32:34,170  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970
2024-04-24T02:32:34,170  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970
2024-04-24T02:32:34,194  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:32:34,194  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:34,197  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:32:34,197  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970
2024-04-24T02:32:34,197  INFO [main] ql.Driver: Query ID = alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970
Total jobs = 1
2024-04-24T02:32:34,197  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:34,197  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:34,347  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:32:34,347  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:34,347  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:34,347  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:34,347  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:34,347  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:34,347  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:34,347  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:34,350  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:34,350  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:32:34,350  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-33_993_733581717385641171-1/dummy_path
2024-04-24T02:32:34,359  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:34,359  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:32:34,364  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:34,364  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,91KB
2024-04-24T02:32:34,365  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:34,369  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-33_993_733581717385641171-1/-mr-10000
2024-04-24T02:32:34,371  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:34,378  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:34,382  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:34,383  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:32:34,383  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:32:34,383  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-33_993_733581717385641171-1/dummy_path
2024-04-24T02:32:34,384  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:32:34,400  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:32:34,418  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local917348391_0042
2024-04-24T02:32:34,418  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:34,476  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:34,476  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:34,476  INFO [Thread-3501] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:34,476  INFO [Thread-3501] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:34,478  INFO [Thread-3501] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:34,478  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local917348391_0042_m_000000_0
2024-04-24T02:32:34,481  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:34,481  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-33_993_733581717385641171-1/dummy_path/null:0+1
2024-04-24T02:32:34,483  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:34,484  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:32:34,484  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:32:34,488  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:34,488  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:34,488  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:34,488  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:34,488  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:34,489  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:34,489  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:34,489  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:34,490  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:34,490  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:34,490  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:32:34,490  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:32:34,490  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:34,490  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:32:34,490  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:32:34,490  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:34,491  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:32:34,491  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:32:34,491  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:34,491  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:34,491  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T02:32:34,492  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-24T02:32:34,494  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:34,494  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:34,494  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:34,494  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T02:32:34,494  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:32:34,504  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:34,509  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local917348391_0042_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:34,509  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:32:34,510  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local917348391_0042_m_000000_0' done.
2024-04-24T02:32:34,510  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local917348391_0042_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=884174
		FILE: Number of bytes written=49488319
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=360
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1307574272
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5017
2024-04-24T02:32:34,510  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local917348391_0042_m_000000_0
2024-04-24T02:32:34,510  INFO [Thread-3501] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:34,511  INFO [Thread-3501] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:34,511  INFO [pool-209-thread-1] mapred.LocalJobRunner: Starting task: attempt_local917348391_0042_r_000000_0
2024-04-24T02:32:34,513  INFO [pool-209-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:34,514  INFO [pool-209-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@557d78e2
2024-04-24T02:32:34,514  WARN [pool-209-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:34,514  INFO [pool-209-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:34,515  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local917348391_0042_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:34,518  INFO [localfetcher#59] reduce.LocalFetcher: localfetcher#59 about to shuffle output of map attempt_local917348391_0042_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:34,518  INFO [localfetcher#59] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local917348391_0042_m_000000_0
2024-04-24T02:32:34,518  INFO [localfetcher#59] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:34,518  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:34,518  INFO [pool-209-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:34,518  INFO [pool-209-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:34,525  INFO [pool-209-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:34,525  INFO [pool-209-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:34,531  INFO [pool-209-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:34,532  INFO [pool-209-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:34,532  INFO [pool-209-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:34,532  INFO [pool-209-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:34,532  INFO [pool-209-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:34,532  INFO [pool-209-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:34,533  INFO [pool-209-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:34,534  INFO [pool-209-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,91KB
2024-04-24T02:32:34,536  INFO [pool-209-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:34,536  INFO [pool-209-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:34,536  INFO [pool-209-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:34,536  INFO [pool-209-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:34,537  INFO [pool-209-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local917348391_0042/job_local917348391_0042.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@fe5585a
2024-04-24T02:32:34,538  INFO [pool-209-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:34,538  INFO [pool-209-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:34,538  INFO [pool-209-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:34,539  INFO [pool-209-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:34,540  INFO [pool-209-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:34,557  INFO [pool-209-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:34,568  INFO [pool-209-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:34,568  INFO [pool-209-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:32:34,568  INFO [pool-209-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:34,568  INFO [pool-209-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:34,572  INFO [pool-209-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:32:34,602  INFO [pool-209-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-24T02:32:34,603  INFO [pool-209-thread-1] mapred.Task: Task:attempt_local917348391_0042_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:34,604  INFO [pool-209-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:34,604  INFO [pool-209-thread-1] mapred.Task: Task 'attempt_local917348391_0042_r_000000_0' done.
2024-04-24T02:32:34,604  INFO [pool-209-thread-1] mapred.Task: Final Counters for attempt_local917348391_0042_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=890276
		FILE: Number of bytes written=49489358
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1307574272
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:34,604  INFO [pool-209-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local917348391_0042_r_000000_0
2024-04-24T02:32:34,604  INFO [pool-209-thread-1] mapred.LocalJobRunner: Starting task: attempt_local917348391_0042_r_000001_0
2024-04-24T02:32:34,605  INFO [pool-209-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:34,605  INFO [pool-209-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@a3f4c37
2024-04-24T02:32:34,606  WARN [pool-209-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:34,608  INFO [pool-209-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:34,609  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local917348391_0042_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:34,613  INFO [localfetcher#60] reduce.LocalFetcher: localfetcher#60 about to shuffle output of map attempt_local917348391_0042_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:34,614  INFO [localfetcher#60] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local917348391_0042_m_000000_0
2024-04-24T02:32:34,614  INFO [localfetcher#60] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:34,615  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:34,615  INFO [pool-209-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:34,616  INFO [pool-209-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:34,626  INFO [pool-209-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:34,626  INFO [pool-209-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:34,632  INFO [pool-209-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:34,632  INFO [pool-209-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:34,633  INFO [pool-209-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:34,633  INFO [pool-209-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:34,633  INFO [pool-209-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:34,633  INFO [pool-209-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:34,634  INFO [pool-209-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:34,635  INFO [pool-209-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,91KB
2024-04-24T02:32:34,637  INFO [pool-209-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:34,637  INFO [pool-209-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:34,637  INFO [pool-209-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:34,637  INFO [pool-209-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:34,638  INFO [pool-209-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local917348391_0042/job_local917348391_0042.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@31cef7bb
2024-04-24T02:32:34,639  INFO [pool-209-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:34,639  INFO [pool-209-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:34,639  INFO [pool-209-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:34,640  INFO [pool-209-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:34,640  INFO [pool-209-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:34,652  INFO [pool-209-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:34,652  INFO [pool-209-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:34,653  INFO [pool-209-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:32:34,653  INFO [pool-209-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:34,653  INFO [pool-209-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:34,656  INFO [pool-209-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:32:34,680  INFO [pool-209-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-24T02:32:34,681  INFO [pool-209-thread-1] mapred.Task: Task:attempt_local917348391_0042_r_000001_0 is done. And is in the process of committing
2024-04-24T02:32:34,682  INFO [pool-209-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:34,682  INFO [pool-209-thread-1] mapred.Task: Task 'attempt_local917348391_0042_r_000001_0' done.
2024-04-24T02:32:34,682  INFO [pool-209-thread-1] mapred.Task: Final Counters for attempt_local917348391_0042_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=896354
		FILE: Number of bytes written=49490386
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1307574272
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:34,682  INFO [pool-209-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local917348391_0042_r_000001_0
2024-04-24T02:32:34,682  INFO [Thread-3501] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:35,479 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:35,479  INFO [main] exec.Task: 2024-04-24 02:32:35,479 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local917348391_0042
2024-04-24T02:32:35,481  INFO [main] exec.Task: Ended Job = job_local917348391_0042
2024-04-24T02:32:35,482  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:32:35,482  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:32:35,482  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:32:35,482  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:32:35,483  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:32:35,484  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:32:35,484  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:35,484  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:35,491  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:35,491  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:35,498  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:35,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:35,535  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:32:35,535  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:35,541  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:35,542  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:32:35,542  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-33_993_733581717385641171-1/-mr-10000
2024-04-24T02:32:35,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:35,549  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:35,560  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:32:35,560  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-24T02:32:35,560  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:32:35,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:35,581  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-24T02:32:35,581  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:32:35,581  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:32:35,584  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:32:35,584  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:35,584  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, alter_table_(String, String, String, Table, EnvironmentContext, String)=58, getTable_(GetTableRequest)=27, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:32:35,584  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:35,584  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:35,585  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:35,585  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023233_7491ee23-f235-4cab-b455-6da70e593970); Time taken: 1.387 seconds
2024-04-24T02:32:35,585  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:35,585  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-33_993_733581717385641171-1
2024-04-24T02:32:35,585  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-33_993_733581717385641171-1 on fs with scheme file
2024-04-24T02:32:35,585  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:35,586  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:35,586  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:35,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:35,593  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:35,593  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:35,593  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:35,593  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:35,593  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:35,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:35,600  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:35,600  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:35,600  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:35,620  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:35,668  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:35,668  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:35,668  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:35,669  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:35,671  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:35,671  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:35,671  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:35,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:35,680  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:35,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:35,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:35,684  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:35,687  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:32:35,687  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:35,688  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:32:35,688  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:35,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:35,705  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:35,705  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:35,705  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:35,705  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:35,705  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-24T02:32:35,706  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:35,706  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=31, getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=4}
2024-04-24T02:32:35,706  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad); Time taken: 0.121 seconds
2024-04-24T02:32:35,706  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad
2024-04-24T02:32:35,706  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad
2024-04-24T02:32:35,720  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:32:35,720  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:35,721  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:35,721  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad
2024-04-24T02:32:35,721  INFO [main] ql.Driver: Query ID = alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad
Total jobs = 1
2024-04-24T02:32:35,721  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:35,721  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:35,869  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:32:35,869  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:35,869  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:35,869  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:35,870  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:35,870  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:35,870  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:35,870  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:35,872  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:35,872  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:32:35,872  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-35_585_1069389464370094602-1/dummy_path
2024-04-24T02:32:35,882  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:35,882  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,99KB
2024-04-24T02:32:35,887  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:35,887  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:35,888  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:35,892  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-35_585_1069389464370094602-1/-mr-10000
2024-04-24T02:32:35,894  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:35,900  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:35,905  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:35,905  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:32:35,905  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:32:35,905  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-35_585_1069389464370094602-1/dummy_path
2024-04-24T02:32:35,906  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:32:35,922  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:32:35,940  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local15242548_0043
2024-04-24T02:32:35,940  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:35,999  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:35,999  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:36,000  INFO [Thread-3575] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:36,000  INFO [Thread-3575] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:36,002  INFO [Thread-3575] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:36,002  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local15242548_0043_m_000000_0
2024-04-24T02:32:36,002  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:36,003  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-35_585_1069389464370094602-1/dummy_path/null:0+1
2024-04-24T02:32:36,003  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:36,003  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,99KB
2024-04-24T02:32:36,004  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:32:36,008  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:36,008  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:36,008  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:36,008  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:36,008  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:36,008  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:36,008  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:36,008  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:36,009  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:36,009  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:36,009  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:32:36,009  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:32:36,009  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:36,009  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:32:36,009  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:32:36,009  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:32:36,010  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T02:32:36,011  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:32:36,023  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:36,026  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local15242548_0043_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:36,026  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:32:36,026  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local15242548_0043_m_000000_0' done.
2024-04-24T02:32:36,026  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local15242548_0043_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=902436
		FILE: Number of bytes written=50660806
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1307574272
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5039
2024-04-24T02:32:36,026  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local15242548_0043_m_000000_0
2024-04-24T02:32:36,027  INFO [Thread-3575] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:36,028  INFO [Thread-3575] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:36,039  INFO [pool-214-thread-1] mapred.LocalJobRunner: Starting task: attempt_local15242548_0043_r_000000_0
2024-04-24T02:32:36,040  INFO [pool-214-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:36,040  INFO [pool-214-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@56f05653
2024-04-24T02:32:36,040  WARN [pool-214-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:36,041  INFO [pool-214-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:36,042  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local15242548_0043_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:36,042  INFO [localfetcher#61] reduce.LocalFetcher: localfetcher#61 about to shuffle output of map attempt_local15242548_0043_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:36,043  INFO [localfetcher#61] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local15242548_0043_m_000000_0
2024-04-24T02:32:36,043  INFO [localfetcher#61] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:36,043  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:36,043  INFO [pool-214-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:36,043  INFO [pool-214-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:36,051  INFO [pool-214-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:36,051  INFO [pool-214-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:36,053  INFO [pool-214-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:36,053  INFO [pool-214-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:36,053  INFO [pool-214-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:36,053  INFO [pool-214-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:36,053  INFO [pool-214-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:36,053  INFO [pool-214-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:36,054  INFO [pool-214-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:36,054  INFO [pool-214-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:36,055  INFO [pool-214-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:36,055  INFO [pool-214-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:36,055  INFO [pool-214-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:36,055  INFO [pool-214-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:36,055  INFO [pool-214-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local15242548_0043/job_local15242548_0043.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2ea1d947
2024-04-24T02:32:36,056  INFO [pool-214-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:36,056  INFO [pool-214-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:36,056  INFO [pool-214-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:36,056  INFO [pool-214-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:36,056  INFO [pool-214-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:36,063  INFO [pool-214-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:36,067  INFO [pool-214-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:36,067  INFO [pool-214-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:32:36,067  INFO [pool-214-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:36,067  INFO [pool-214-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:36,068  INFO [pool-214-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0]
2024-04-24T02:32:36,079  INFO [pool-214-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:36,080  INFO [pool-214-thread-1] mapred.Task: Task:attempt_local15242548_0043_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:36,080  INFO [pool-214-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:36,080  INFO [pool-214-thread-1] mapred.Task: Task 'attempt_local15242548_0043_r_000000_0' done.
2024-04-24T02:32:36,080  INFO [pool-214-thread-1] mapred.Task: Final Counters for attempt_local15242548_0043_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=908541
		FILE: Number of bytes written=50661852
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302331392
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:36,080  INFO [pool-214-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local15242548_0043_r_000000_0
2024-04-24T02:32:36,080  INFO [pool-214-thread-1] mapred.LocalJobRunner: Starting task: attempt_local15242548_0043_r_000001_0
2024-04-24T02:32:36,081  INFO [pool-214-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:36,081  INFO [pool-214-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3dc4e541
2024-04-24T02:32:36,081  WARN [pool-214-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:36,081  INFO [pool-214-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:36,082  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local15242548_0043_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:36,085  INFO [localfetcher#62] reduce.LocalFetcher: localfetcher#62 about to shuffle output of map attempt_local15242548_0043_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:36,085  INFO [localfetcher#62] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local15242548_0043_m_000000_0
2024-04-24T02:32:36,085  INFO [localfetcher#62] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:36,085  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:36,086  INFO [pool-214-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:36,086  INFO [pool-214-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:36,093  INFO [pool-214-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:36,093  INFO [pool-214-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:36,096  INFO [pool-214-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:36,096  INFO [pool-214-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:36,096  INFO [pool-214-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:36,096  INFO [pool-214-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:36,096  INFO [pool-214-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:36,096  INFO [pool-214-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:36,096  INFO [pool-214-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:36,097  INFO [pool-214-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:36,098  INFO [pool-214-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:36,098  INFO [pool-214-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:36,098  INFO [pool-214-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:36,098  INFO [pool-214-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:36,098  INFO [pool-214-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local15242548_0043/job_local15242548_0043.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1da579b1
2024-04-24T02:32:36,098  INFO [pool-214-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:36,098  INFO [pool-214-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:36,099  INFO [pool-214-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:36,099  INFO [pool-214-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:36,099  INFO [pool-214-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:36,103  INFO [pool-214-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:36,104  INFO [pool-214-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:36,104  INFO [pool-214-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:32:36,104  INFO [pool-214-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:36,104  INFO [pool-214-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:36,105  INFO [pool-214-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0]
2024-04-24T02:32:36,115  INFO [pool-214-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:36,115  INFO [pool-214-thread-1] mapred.Task: Task:attempt_local15242548_0043_r_000001_0 is done. And is in the process of committing
2024-04-24T02:32:36,115  INFO [pool-214-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:36,115  INFO [pool-214-thread-1] mapred.Task: Task 'attempt_local15242548_0043_r_000001_0' done.
2024-04-24T02:32:36,115  INFO [pool-214-thread-1] mapred.Task: Final Counters for attempt_local15242548_0043_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=914622
		FILE: Number of bytes written=50662886
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302331392
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:36,115  INFO [pool-214-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local15242548_0043_r_000001_0
2024-04-24T02:32:36,116  INFO [Thread-3575] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:37,002 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:37,003  INFO [main] exec.Task: 2024-04-24 02:32:37,002 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local15242548_0043
2024-04-24T02:32:37,005  INFO [main] exec.Task: Ended Job = job_local15242548_0043
2024-04-24T02:32:37,005  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest with attemptId 0.
2024-04-24T02:32:37,005  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest with attemptId 0.
2024-04-24T02:32:37,006  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest
2024-04-24T02:32:37,006  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest
2024-04-24T02:32:37,006  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001
2024-04-24T02:32:37,007  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:32:37,007  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:37,007  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:37,014  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:37,020  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:37,040  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:32:37,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:37,047  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,047  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:32:37,047  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-35_585_1069389464370094602-1/-mr-10000
2024-04-24T02:32:37,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:37,056  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,080  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:32:37,080  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-24T02:32:37,080  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:32:37,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:37,101  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-24T02:32:37,101  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:32:37,101  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:32:37,101  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2701, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:32:37,102  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,102  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=0, getTable_(GetTableRequest)=27, alter_table_(String, String, String, Table, EnvironmentContext, String)=41}
MapReduce Jobs Launched: 
2024-04-24T02:32:37,102  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:37,102  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:37,102  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:37,102  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023235_c249a6e7-9e38-4b6e-8b9a-d6bb0e65c5ad); Time taken: 1.38 seconds
2024-04-24T02:32:37,102  INFO [main] ql.TxnCommandsBaseForTests: Running the query: commit
2024-04-24T02:32:37,102  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-35_585_1069389464370094602-1
2024-04-24T02:32:37,103  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f349115-bee1-410e-9068-e1c480d80826/hive_2024-04-24_02-32-35_585_1069389464370094602-1 on fs with scheme file
2024-04-24T02:32:37,103  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_ca55b560-70b9-4d1a-bc66-20cf232d47e9): commit
2024-04-24T02:32:37,103  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:37,103  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:37,103  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:37,103  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,103  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,103  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,104  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=0, flushCache_()=0}
2024-04-24T02:32:37,104  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_ca55b560-70b9-4d1a-bc66-20cf232d47e9); Time taken: 0.0 seconds
2024-04-24T02:32:37,104  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023237_ca55b560-70b9-4d1a-bc66-20cf232d47e9
2024-04-24T02:32:37,104  INFO [main] ql.Driver: Operation COMMIT obtained 0 locks
2024-04-24T02:32:37,104  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_ca55b560-70b9-4d1a-bc66-20cf232d47e9): commit
2024-04-24T02:32:37,104  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,104  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T02:32:37,104  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_ca55b560-70b9-4d1a-bc66-20cf232d47e9); Time taken: 0.0 seconds
2024-04-24T02:32:37,104  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_ca55b560-70b9-4d1a-bc66-20cf232d47e9
2024-04-24T02:32:37,116  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,116  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:32:37,117  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 2
2024-04-24T02:32:37,117  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_71bf7169-4eb8-4fdf-86b0-b96c17fef17d): delete from acidTbl where b = 2
2024-04-24T02:32:37,119  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:32:37,120  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:32:37,120  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:32:37,120  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,127  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,127  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 2> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-24T02:32:37,127  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:32:37,130  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:37,130  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:37,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:37,138  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,138  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:37,138  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:37,138  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,145  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,145  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:37,145  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:37,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:37,185  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-24T02:32:37,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:37,194  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:37,203  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,204  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:32:37,213  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-24T02:32:37,213  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-24T02:32:37,275  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:37,275  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:37,275  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:37,275  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,282  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,285 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:32:37,286 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:32:37,286  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:32:37,287 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:32:37,287  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,287  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, getTableColumnStatistics_(String, String, List, String)=28, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTable_(GetTableRequest)=28, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=3}
2024-04-24T02:32:37,287  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_71bf7169-4eb8-4fdf-86b0-b96c17fef17d); Time taken: 0.17 seconds
2024-04-24T02:32:37,287  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:32:37,291  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,299  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:37,299  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_494fa301-e7a6-48be-95a5-f72338f2e0a1): drop table if exists acidTbl
2024-04-24T02:32:37,301  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 14
2024-04-24T02:32:37,301  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:32:37,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,308  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,308  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,308  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,309  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,309  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, rollbackTxn_(long)=12, getValidTxns_(long)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:32:37,309  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_494fa301-e7a6-48be-95a5-f72338f2e0a1); Time taken: 0.01 seconds
2024-04-24T02:32:37,309  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023237_494fa301-e7a6-48be-95a5-f72338f2e0a1
2024-04-24T02:32:37,309  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023237_494fa301-e7a6-48be-95a5-f72338f2e0a1
2024-04-24T02:32:37,325  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023237_494fa301-e7a6-48be-95a5-f72338f2e0a1 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:32:37,325  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:37,325  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_494fa301-e7a6-48be-95a5-f72338f2e0a1): drop table if exists acidTbl
2024-04-24T02:32:37,325  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,325  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,331  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,337  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,439  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,440  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=108, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:32:37,440  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_494fa301-e7a6-48be-95a5-f72338f2e0a1); Time taken: 0.114 seconds
2024-04-24T02:32:37,440  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_494fa301-e7a6-48be-95a5-f72338f2e0a1
2024-04-24T02:32:37,444  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T02:32:37,450  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,451  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:32:37,452  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:37,452  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_0cae37a7-6407-45e3-8a4d-8fab1a960021): drop table if exists acidTblPart
2024-04-24T02:32:37,460  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 14
2024-04-24T02:32:37,461  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:32:37,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:37,480  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,480  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,480  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,480  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,480  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=17, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=9, getValidTxns_(long)=2}
2024-04-24T02:32:37,480  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_0cae37a7-6407-45e3-8a4d-8fab1a960021); Time taken: 0.028 seconds
2024-04-24T02:32:37,481  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023237_0cae37a7-6407-45e3-8a4d-8fab1a960021
2024-04-24T02:32:37,481  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023237_0cae37a7-6407-45e3-8a4d-8fab1a960021
2024-04-24T02:32:37,499  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023237_0cae37a7-6407-45e3-8a4d-8fab1a960021 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:32:37,499  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:37,499  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_0cae37a7-6407-45e3-8a4d-8fab1a960021): drop table if exists acidTblPart
2024-04-24T02:32:37,499  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,499  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:37,505  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:37,511  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,511  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:37,550  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,550  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=45, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:37,550  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_0cae37a7-6407-45e3-8a4d-8fab1a960021); Time taken: 0.051 seconds
2024-04-24T02:32:37,550  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_0cae37a7-6407-45e3-8a4d-8fab1a960021
2024-04-24T02:32:37,554  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:32:37,560  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,560  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:32:37,561  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:37,561  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_76ee1456-8bda-43e8-91fe-46b66fa418f0): drop table if exists acidTbl2
2024-04-24T02:32:37,563  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 14
2024-04-24T02:32:37,563  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:32:37,564  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,564  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,564  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,564  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=0}
2024-04-24T02:32:37,565  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_76ee1456-8bda-43e8-91fe-46b66fa418f0); Time taken: 0.003 seconds
2024-04-24T02:32:37,565  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023237_76ee1456-8bda-43e8-91fe-46b66fa418f0
2024-04-24T02:32:37,565  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:37,565  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_76ee1456-8bda-43e8-91fe-46b66fa418f0): drop table if exists acidTbl2
2024-04-24T02:32:37,565  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,565  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:32:37,566  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,566  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-24T02:32:37,566  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_76ee1456-8bda-43e8-91fe-46b66fa418f0); Time taken: 0.001 seconds
2024-04-24T02:32:37,566  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_76ee1456-8bda-43e8-91fe-46b66fa418f0
2024-04-24T02:32:37,571  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:32:37,577  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,577  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:32:37,578  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:37,578  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_adc7df23-ae0b-4464-9c8f-f400463febbb): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:37,580  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 14
2024-04-24T02:32:37,580  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:32:37,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:37,603  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,603  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,603  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,603  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,603  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=22, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=1, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:32:37,603  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_adc7df23-ae0b-4464-9c8f-f400463febbb); Time taken: 0.025 seconds
2024-04-24T02:32:37,604  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023237_adc7df23-ae0b-4464-9c8f-f400463febbb
2024-04-24T02:32:37,604  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023237_adc7df23-ae0b-4464-9c8f-f400463febbb
2024-04-24T02:32:37,618  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023237_adc7df23-ae0b-4464-9c8f-f400463febbb LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:32:37,618  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:37,618  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_adc7df23-ae0b-4464-9c8f-f400463febbb): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:37,618  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:37,626  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,627  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:37,634  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:37,683  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,683  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=56}
2024-04-24T02:32:37,683  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_adc7df23-ae0b-4464-9c8f-f400463febbb); Time taken: 0.065 seconds
2024-04-24T02:32:37,684  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_adc7df23-ae0b-4464-9c8f-f400463febbb
2024-04-24T02:32:37,688  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:32:37,694  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,694  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:32:37,694  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:37,695  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_16774cdf-24a7-4fe9-a0a0-b79897b46f13): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:37,697  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 14
2024-04-24T02:32:37,697  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:32:37,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:37,705  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,705  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,705  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,705  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,706  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-24T02:32:37,706  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_16774cdf-24a7-4fe9-a0a0-b79897b46f13); Time taken: 0.01 seconds
2024-04-24T02:32:37,706  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023237_16774cdf-24a7-4fe9-a0a0-b79897b46f13
2024-04-24T02:32:37,706  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023237_16774cdf-24a7-4fe9-a0a0-b79897b46f13
2024-04-24T02:32:37,721  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023237_16774cdf-24a7-4fe9-a0a0-b79897b46f13 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:32:37,721  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:37,721  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_16774cdf-24a7-4fe9-a0a0-b79897b46f13): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:37,721  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,722  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:37,729  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,730  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:37,738  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,738  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:37,767  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,767  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=37, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:37,768  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_16774cdf-24a7-4fe9-a0a0-b79897b46f13); Time taken: 0.046 seconds
2024-04-24T02:32:37,768  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_16774cdf-24a7-4fe9-a0a0-b79897b46f13
2024-04-24T02:32:37,772  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:32:37,778  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,778  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:32:37,778  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:37,779  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_cd0b99d1-e547-4da4-a98f-be46a17d89ff): drop table if exists nonAcidNonBucket
2024-04-24T02:32:37,781  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 14
2024-04-24T02:32:37,781  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:32:37,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:37,790  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,790  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,790  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,790  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,790  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T02:32:37,790  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_cd0b99d1-e547-4da4-a98f-be46a17d89ff); Time taken: 0.011 seconds
2024-04-24T02:32:37,790  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023237_cd0b99d1-e547-4da4-a98f-be46a17d89ff
2024-04-24T02:32:37,791  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023237_cd0b99d1-e547-4da4-a98f-be46a17d89ff
2024-04-24T02:32:37,805  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023237_cd0b99d1-e547-4da4-a98f-be46a17d89ff LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:32:37,805  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:37,805  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_cd0b99d1-e547-4da4-a98f-be46a17d89ff): drop table if exists nonAcidNonBucket
2024-04-24T02:32:37,805  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:37,813  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:37,821  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:37,821  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:37,852  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,852  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=39}
2024-04-24T02:32:37,852  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_cd0b99d1-e547-4da4-a98f-be46a17d89ff); Time taken: 0.047 seconds
2024-04-24T02:32:37,852  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_cd0b99d1-e547-4da4-a98f-be46a17d89ff
2024-04-24T02:32:37,856  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:32:37,862  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,862  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:32:37,863  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testUpdateDeleteOfInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="7.373">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = 1 where b != 1 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateDeleteOfInserts(TestTxnCommands.java:883)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:32:37,919  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:32:37,920  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:32:37,922  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = fa4d4375-50c6-4f04-babc-202b1ae1e1a2
2024-04-24T02:32:37,924  INFO [main] SessionState: Hive Session ID = fa4d4375-50c6-4f04-babc-202b1ae1e1a2
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:37,925  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:37,930  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/fa4d4375-50c6-4f04-babc-202b1ae1e1a2
2024-04-24T02:32:37,932  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2
2024-04-24T02:32:37,935  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/_tmp_space.db
2024-04-24T02:32:37,935  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=fa4d4375-50c6-4f04-babc-202b1ae1e1a2, clientType=HIVECLI]
2024-04-24T02:32:37,935  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:37,935  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_9e40df7e-22d5-4cf1-b673-4de9caea560f): drop table if exists acidTbl
2024-04-24T02:32:37,943  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:32:37,943  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:32:37,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,948  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,948  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,949  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,949  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=3, openTxn_(String, TxnType)=7}
2024-04-24T02:32:37,949  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_9e40df7e-22d5-4cf1-b673-4de9caea560f); Time taken: 0.014 seconds
2024-04-24T02:32:37,949  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023237_9e40df7e-22d5-4cf1-b673-4de9caea560f
2024-04-24T02:32:37,949  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:37,949  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_9e40df7e-22d5-4cf1-b673-4de9caea560f): drop table if exists acidTbl
2024-04-24T02:32:37,949  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:37,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:37,953  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_9e40df7e-22d5-4cf1-b673-4de9caea560f); Time taken: 0.003 seconds
2024-04-24T02:32:37,953  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_9e40df7e-22d5-4cf1-b673-4de9caea560f
2024-04-24T02:32:37,959  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:32:37,965  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,965  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:32:37,966  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:37,966  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_1f2ae751-526b-41e6-83a6-696a5e232098): drop table if exists acidTblPart
2024-04-24T02:32:37,968  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:32:37,968  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:32:37,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:37,971  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,971  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,972  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,972  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:37,972  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_1f2ae751-526b-41e6-83a6-696a5e232098); Time taken: 0.006 seconds
2024-04-24T02:32:37,972  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023237_1f2ae751-526b-41e6-83a6-696a5e232098
2024-04-24T02:32:37,972  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:37,972  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_1f2ae751-526b-41e6-83a6-696a5e232098): drop table if exists acidTblPart
2024-04-24T02:32:37,972  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:37,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,976  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:37,976  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_1f2ae751-526b-41e6-83a6-696a5e232098); Time taken: 0.004 seconds
2024-04-24T02:32:37,976  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_1f2ae751-526b-41e6-83a6-696a5e232098
2024-04-24T02:32:37,981  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:32:37,988  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:37,988  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:32:37,989  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:37,989  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023237_ab9e3a50-4244-47a3-aaab-e5f290e7c211): drop table if exists acidTbl2
2024-04-24T02:32:37,991  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:32:37,991  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:32:37,992  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:37,995  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:37,995  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:37,995  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:37,995  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0}
2024-04-24T02:32:37,995  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023237_ab9e3a50-4244-47a3-aaab-e5f290e7c211); Time taken: 0.006 seconds
2024-04-24T02:32:37,995  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023237_ab9e3a50-4244-47a3-aaab-e5f290e7c211
2024-04-24T02:32:37,995  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:37,996  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023237_ab9e3a50-4244-47a3-aaab-e5f290e7c211): drop table if exists acidTbl2
2024-04-24T02:32:37,996  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:37,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:37,999  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:37,999  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:37,999  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023237_ab9e3a50-4244-47a3-aaab-e5f290e7c211); Time taken: 0.004 seconds
2024-04-24T02:32:37,999  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023237_ab9e3a50-4244-47a3-aaab-e5f290e7c211
2024-04-24T02:32:38,005  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:32:38,012  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,012  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:32:38,013  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:38,013  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_b7ca8e0a-0c06-4256-b60b-661108489b45): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:38,015  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:32:38,016  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:32:38,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:38,019  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,019  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,019  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,019  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=3, getValidTxns_(long)=0}
2024-04-24T02:32:38,020  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_b7ca8e0a-0c06-4256-b60b-661108489b45); Time taken: 0.006 seconds
2024-04-24T02:32:38,020  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023238_b7ca8e0a-0c06-4256-b60b-661108489b45
2024-04-24T02:32:38,020  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:38,020  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_b7ca8e0a-0c06-4256-b60b-661108489b45): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:38,020  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:38,023  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,023  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:38,024  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_b7ca8e0a-0c06-4256-b60b-661108489b45); Time taken: 0.003 seconds
2024-04-24T02:32:38,024  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_b7ca8e0a-0c06-4256-b60b-661108489b45
2024-04-24T02:32:38,030  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:32:38,037  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,037  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:32:38,037  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:38,038  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_0a6888aa-03d6-4b1a-91f9-e2cd5b5350b7): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:38,040  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:32:38,040  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:32:38,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:38,044  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,044  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,044  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:32:38,044  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_0a6888aa-03d6-4b1a-91f9-e2cd5b5350b7); Time taken: 0.006 seconds
2024-04-24T02:32:38,044  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023238_0a6888aa-03d6-4b1a-91f9-e2cd5b5350b7
2024-04-24T02:32:38,044  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:38,044  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_0a6888aa-03d6-4b1a-91f9-e2cd5b5350b7): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:38,045  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,045  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:38,048  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,048  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:38,048  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_0a6888aa-03d6-4b1a-91f9-e2cd5b5350b7); Time taken: 0.004 seconds
2024-04-24T02:32:38,048  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_0a6888aa-03d6-4b1a-91f9-e2cd5b5350b7
2024-04-24T02:32:38,053  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:32:38,059  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,059  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:32:38,060  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:38,060  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_3f06b290-305b-4c79-aca7-3e16464adb9b): drop table if exists nonAcidNonBucket
2024-04-24T02:32:38,062  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:32:38,062  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:32:38,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:38,065  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,065  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,065  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:32:38,066  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_3f06b290-305b-4c79-aca7-3e16464adb9b); Time taken: 0.005 seconds
2024-04-24T02:32:38,066  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023238_3f06b290-305b-4c79-aca7-3e16464adb9b
2024-04-24T02:32:38,066  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:38,066  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_3f06b290-305b-4c79-aca7-3e16464adb9b): drop table if exists nonAcidNonBucket
2024-04-24T02:32:38,066  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,066  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:38,069  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,069  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:38,069  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_3f06b290-305b-4c79-aca7-3e16464adb9b); Time taken: 0.003 seconds
2024-04-24T02:32:38,069  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_3f06b290-305b-4c79-aca7-3e16464adb9b
2024-04-24T02:32:38,075  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:32:38,081  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,081  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:32:38,081  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,082  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_1dbc14bc-d9d7-4d93-93ac-fe6f3a7c35ee): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,084  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:32:38,084  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:32:38,084  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:38,084  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:38,090  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:32:38,090  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:38,092  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:38,092  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,092  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,092  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,092  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-24T02:32:38,092  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_1dbc14bc-d9d7-4d93-93ac-fe6f3a7c35ee); Time taken: 0.01 seconds
2024-04-24T02:32:38,092  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023238_1dbc14bc-d9d7-4d93-93ac-fe6f3a7c35ee
2024-04-24T02:32:38,093  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023238_1dbc14bc-d9d7-4d93-93ac-fe6f3a7c35ee
2024-04-24T02:32:38,111  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023238_1dbc14bc-d9d7-4d93-93ac-fe6f3a7c35ee LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:32:38,111  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:38,111  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_1dbc14bc-d9d7-4d93-93ac-fe6f3a7c35ee): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,111  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,112  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951158, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFilesErasureCoded=0, transactional=true, numRows=0, rawDataSize=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:38,118  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:38,152  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,152  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=40, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:38,152  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_1dbc14bc-d9d7-4d93-93ac-fe6f3a7c35ee); Time taken: 0.041 seconds
2024-04-24T02:32:38,152  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_1dbc14bc-d9d7-4d93-93ac-fe6f3a7c35ee
2024-04-24T02:32:38,156  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:32:38,164  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,164  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:32:38,165  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,165  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_342ca5da-c51e-4450-a2b3-e3fab325c5f9): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,168  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:32:38,168  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:32:38,168  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:38,168  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:38,171  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:32:38,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:38,172  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:38,172  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,173  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,173  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,173  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, getDatabase_(String)=1}
2024-04-24T02:32:38,173  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_342ca5da-c51e-4450-a2b3-e3fab325c5f9); Time taken: 0.008 seconds
2024-04-24T02:32:38,173  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023238_342ca5da-c51e-4450-a2b3-e3fab325c5f9
2024-04-24T02:32:38,173  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023238_342ca5da-c51e-4450-a2b3-e3fab325c5f9
2024-04-24T02:32:38,189  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023238_342ca5da-c51e-4450-a2b3-e3fab325c5f9 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:32:38,189  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:38,190  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_342ca5da-c51e-4450-a2b3-e3fab325c5f9): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,190  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951158, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:38,196  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:32:38,215  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,216  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=25}
2024-04-24T02:32:38,216  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_342ca5da-c51e-4450-a2b3-e3fab325c5f9); Time taken: 0.025 seconds
2024-04-24T02:32:38,216  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_342ca5da-c51e-4450-a2b3-e3fab325c5f9
2024-04-24T02:32:38,220  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:32:38,227  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,228  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:32:38,228  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,228  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_63877269-6646-41ea-ac73-5a0db107ca39): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,230  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:32:38,231  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:32:38,231  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:38,231  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:38,234  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:32:38,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:38,235  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:38,235  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,236  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,236  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,236  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, flushCache_()=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=1}
2024-04-24T02:32:38,236  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_63877269-6646-41ea-ac73-5a0db107ca39); Time taken: 0.008 seconds
2024-04-24T02:32:38,236  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023238_63877269-6646-41ea-ac73-5a0db107ca39
2024-04-24T02:32:38,236  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023238_63877269-6646-41ea-ac73-5a0db107ca39
2024-04-24T02:32:38,252  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023238_63877269-6646-41ea-ac73-5a0db107ca39 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:32:38,252  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:38,252  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_63877269-6646-41ea-ac73-5a0db107ca39): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,252  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951158, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, transactional=false, bucketing_version=2, numFilesErasureCoded=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:38,259  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:32:38,273  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,274  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-24T02:32:38,274  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_63877269-6646-41ea-ac73-5a0db107ca39); Time taken: 0.021 seconds
2024-04-24T02:32:38,274  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_63877269-6646-41ea-ac73-5a0db107ca39
2024-04-24T02:32:38,278  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:32:38,284  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,284  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:32:38,285  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,285  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_1631d6d8-0221-4bd8-ad66-899334cde1b7): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,287  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:32:38,288  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:32:38,288  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:38,288  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:38,290  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:32:38,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:38,292  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:38,292  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,292  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,292  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,292  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0}
2024-04-24T02:32:38,292  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_1631d6d8-0221-4bd8-ad66-899334cde1b7); Time taken: 0.007 seconds
2024-04-24T02:32:38,293  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023238_1631d6d8-0221-4bd8-ad66-899334cde1b7
2024-04-24T02:32:38,293  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023238_1631d6d8-0221-4bd8-ad66-899334cde1b7
2024-04-24T02:32:38,307  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023238_1631d6d8-0221-4bd8-ad66-899334cde1b7 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:32:38,307  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:38,307  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_1631d6d8-0221-4bd8-ad66-899334cde1b7): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,307  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951158, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, bucketing_version=2, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numRows=0, transactional=false, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:38,313  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:32:38,326  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,326  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:38,326  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_1631d6d8-0221-4bd8-ad66-899334cde1b7); Time taken: 0.019 seconds
2024-04-24T02:32:38,326  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_1631d6d8-0221-4bd8-ad66-899334cde1b7
2024-04-24T02:32:38,330  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:32:38,336  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,336  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:32:38,337  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,337  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_e7fde034-ebd3-412b-9d0e-4457c9fe1a6a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,340  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:32:38,340  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:32:38,340  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:38,340  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:38,343  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:32:38,343  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:38,344  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:38,344  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,344  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,345  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,345  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, flushCache_()=0, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:32:38,345  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_e7fde034-ebd3-412b-9d0e-4457c9fe1a6a); Time taken: 0.007 seconds
2024-04-24T02:32:38,345  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023238_e7fde034-ebd3-412b-9d0e-4457c9fe1a6a
2024-04-24T02:32:38,345  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023238_e7fde034-ebd3-412b-9d0e-4457c9fe1a6a
2024-04-24T02:32:38,359  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023238_e7fde034-ebd3-412b-9d0e-4457c9fe1a6a LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:32:38,359  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:38,360  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_e7fde034-ebd3-412b-9d0e-4457c9fe1a6a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:38,360  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,361  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/_tmp_space.db/2c4c3192-26a6-4c79-83ad-290ef7a5d4f5
2024-04-24T02:32:38,363  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,364  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:38,364  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_e7fde034-ebd3-412b-9d0e-4457c9fe1a6a); Time taken: 0.003 seconds
2024-04-24T02:32:38,364  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_e7fde034-ebd3-412b-9d0e-4457c9fe1a6a
2024-04-24T02:32:38,368  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:32:38,374  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,374  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:32:38,374  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,374  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_9199e760-831a-46b6-a4d7-54d1af36aaa1): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,376  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:32:38,377  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:32:38,377  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:38,377  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:38,379  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:32:38,380  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:38,381  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:38,381  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,381  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:38,381  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,381  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T02:32:38,382  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_9199e760-831a-46b6-a4d7-54d1af36aaa1); Time taken: 0.007 seconds
2024-04-24T02:32:38,382  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023238_9199e760-831a-46b6-a4d7-54d1af36aaa1
2024-04-24T02:32:38,382  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023238_9199e760-831a-46b6-a4d7-54d1af36aaa1
2024-04-24T02:32:38,396  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023238_9199e760-831a-46b6-a4d7-54d1af36aaa1 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:32:38,396  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:38,396  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_9199e760-831a-46b6-a4d7-54d1af36aaa1): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:38,396  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:38,397  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951158, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, transactional=false, totalSize=0, numFiles=0, rawDataSize=0, bucketing_version=2, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:38,402  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:32:38,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:38,415  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:38,416  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_9199e760-831a-46b6-a4d7-54d1af36aaa1); Time taken: 0.019 seconds
2024-04-24T02:32:38,416  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_9199e760-831a-46b6-a4d7-54d1af36aaa1
2024-04-24T02:32:38,420  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:32:38,425  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:38,426  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:32:38,426  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:32:38,426  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:32:38,429  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:32:38,429  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:32:38,429  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:38,429  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:38,432  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:38,453  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:38,453  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:38,453  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:38,453  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:38,453  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:38,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:38,460  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:38,460  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:38,460  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:38,480  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:38,550  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:38,550  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:38,550  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:38,550  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:38,552  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:38,552  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:38,552  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:38,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:38,559  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:38,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:38,561  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:38,569  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-24T02:32:38,570  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-24T02:32:38,571  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:38,574  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:38,574  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:38,575  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:32:38,575  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:38,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:38,590  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:38,590  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:38,590  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:38,590  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:38,590  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-24T02:32:38,590  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:38,590  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=7, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=42, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=27, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=2, getValidWriteIds_(List, String)=2, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-24T02:32:38,591  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7); Time taken: 0.164 seconds
2024-04-24T02:32:38,591  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7
2024-04-24T02:32:38,591  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7
2024-04-24T02:32:38,611  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:32:38,611  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:38,614  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:32:38,614  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7
2024-04-24T02:32:38,614  INFO [main] ql.Driver: Query ID = alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7
Total jobs = 1
2024-04-24T02:32:38,614  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:38,614  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:38,756  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:32:38,756  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:38,756  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:38,756  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:38,756  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:38,756  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:38,756  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:38,756  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:38,758  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:38,759  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:32:38,759  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-38_426_1361515319386720064-1/dummy_path
2024-04-24T02:32:38,767  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:38,768  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,99KB
2024-04-24T02:32:38,773  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:38,774  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:38,775  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:38,779  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-38_426_1361515319386720064-1/-mr-10000
2024-04-24T02:32:38,781  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:38,788  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:38,793  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:38,794  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:32:38,794  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:32:38,794  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-38_426_1361515319386720064-1/dummy_path
2024-04-24T02:32:38,794  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:32:38,811  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:32:38,829  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1530253401_0044
2024-04-24T02:32:38,829  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:38,888  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:38,888  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:38,889  INFO [Thread-3683] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:38,889  INFO [Thread-3683] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:38,890  INFO [Thread-3683] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:38,890  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1530253401_0044_m_000000_0
2024-04-24T02:32:38,893  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:38,894  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-38_426_1361515319386720064-1/dummy_path/null:0+1
2024-04-24T02:32:38,896  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:38,897  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,99KB
2024-04-24T02:32:38,897  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:32:38,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:38,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:38,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:38,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:38,901  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:38,902  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:38,902  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:38,902  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:38,903  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:38,903  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:38,903  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:32:38,903  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:32:38,903  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:38,903  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:32:38,903  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:32:38,903  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T02:32:38,904  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T02:32:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T02:32:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:32:38,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:38,923  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1530253401_0044_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:38,923  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:32:38,923  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1530253401_0044_m_000000_0' done.
2024-04-24T02:32:38,923  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1530253401_0044_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=920704
		FILE: Number of bytes written=51842954
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302331392
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5039
2024-04-24T02:32:38,924  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1530253401_0044_m_000000_0
2024-04-24T02:32:38,924  INFO [Thread-3683] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:38,925  INFO [Thread-3683] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:38,925  INFO [pool-219-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1530253401_0044_r_000000_0
2024-04-24T02:32:38,927  INFO [pool-219-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:38,927  INFO [pool-219-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6d063743
2024-04-24T02:32:38,927  WARN [pool-219-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:38,928  INFO [pool-219-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:38,929  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1530253401_0044_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:38,931  INFO [localfetcher#63] reduce.LocalFetcher: localfetcher#63 about to shuffle output of map attempt_local1530253401_0044_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:38,931  INFO [localfetcher#63] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1530253401_0044_m_000000_0
2024-04-24T02:32:38,931  INFO [localfetcher#63] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:38,932  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:38,932  INFO [pool-219-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:38,932  INFO [pool-219-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:38,939  INFO [pool-219-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:38,939  INFO [pool-219-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:38,941  INFO [pool-219-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:38,942  INFO [pool-219-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:38,942  INFO [pool-219-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:38,942  INFO [pool-219-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:38,942  INFO [pool-219-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:38,942  INFO [pool-219-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:38,942  INFO [pool-219-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:38,943  INFO [pool-219-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:38,943  INFO [pool-219-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:38,944  INFO [pool-219-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:38,944  INFO [pool-219-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:38,944  INFO [pool-219-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:38,944  INFO [pool-219-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1530253401_0044/job_local1530253401_0044.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@9323144
2024-04-24T02:32:38,944  INFO [pool-219-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:38,944  INFO [pool-219-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:38,944  INFO [pool-219-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:38,945  INFO [pool-219-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:38,945  INFO [pool-219-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:38,952  INFO [pool-219-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:38,957  INFO [pool-219-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:38,957  INFO [pool-219-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:32:38,957  INFO [pool-219-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:38,957  INFO [pool-219-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:38,958  INFO [pool-219-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:32:38,970  INFO [pool-219-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-24T02:32:38,971  INFO [pool-219-thread-1] mapred.Task: Task:attempt_local1530253401_0044_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:38,971  INFO [pool-219-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:38,971  INFO [pool-219-thread-1] mapred.Task: Task 'attempt_local1530253401_0044_r_000000_0' done.
2024-04-24T02:32:38,971  INFO [pool-219-thread-1] mapred.Task: Final Counters for attempt_local1530253401_0044_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=926809
		FILE: Number of bytes written=51843993
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302331392
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:38,971  INFO [pool-219-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1530253401_0044_r_000000_0
2024-04-24T02:32:38,971  INFO [pool-219-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1530253401_0044_r_000001_0
2024-04-24T02:32:38,972  INFO [pool-219-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:38,972  INFO [pool-219-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@172f31b3
2024-04-24T02:32:38,972  WARN [pool-219-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:38,973  INFO [pool-219-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:38,973  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1530253401_0044_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:38,976  INFO [localfetcher#64] reduce.LocalFetcher: localfetcher#64 about to shuffle output of map attempt_local1530253401_0044_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:38,976  INFO [localfetcher#64] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1530253401_0044_m_000000_0
2024-04-24T02:32:38,976  INFO [localfetcher#64] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:38,977  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:38,977  INFO [pool-219-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:38,977  INFO [pool-219-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:38,984  INFO [pool-219-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:38,984  INFO [pool-219-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:38,986  INFO [pool-219-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:38,987  INFO [pool-219-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:38,987  INFO [pool-219-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:38,987  INFO [pool-219-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:38,987  INFO [pool-219-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:38,987  INFO [pool-219-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:38,987  INFO [pool-219-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:38,988  INFO [pool-219-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:38,988  INFO [pool-219-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:38,988  INFO [pool-219-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:38,988  INFO [pool-219-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:38,989  INFO [pool-219-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:38,989  INFO [pool-219-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1530253401_0044/job_local1530253401_0044.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@4065a817
2024-04-24T02:32:38,989  INFO [pool-219-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:38,989  INFO [pool-219-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:38,989  INFO [pool-219-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:38,990  INFO [pool-219-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:38,990  INFO [pool-219-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:38,995  INFO [pool-219-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:38,995  INFO [pool-219-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:38,995  INFO [pool-219-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:38,995  INFO [pool-219-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:38,995  INFO [pool-219-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:38,996  INFO [pool-219-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:32:39,006  INFO [pool-219-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:39,007  INFO [pool-219-thread-1] mapred.Task: Task:attempt_local1530253401_0044_r_000001_0 is done. And is in the process of committing
2024-04-24T02:32:39,007  INFO [pool-219-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:39,007  INFO [pool-219-thread-1] mapred.Task: Task 'attempt_local1530253401_0044_r_000001_0' done.
2024-04-24T02:32:39,007  INFO [pool-219-thread-1] mapred.Task: Final Counters for attempt_local1530253401_0044_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=932890
		FILE: Number of bytes written=51845021
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302331392
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:39,007  INFO [pool-219-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1530253401_0044_r_000001_0
2024-04-24T02:32:39,008  INFO [Thread-3683] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:39,891 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:39,891  INFO [main] exec.Task: 2024-04-24 02:32:39,891 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1530253401_0044
2024-04-24T02:32:39,893  INFO [main] exec.Task: Ended Job = job_local1530253401_0044
2024-04-24T02:32:39,894  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:32:39,894  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:32:39,895  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:32:39,895  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:32:39,895  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:32:39,896  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:32:39,896  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:39,896  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:39,903  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:39,903  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:39,910  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:39,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:39,945  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:32:39,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:39,952  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:39,952  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:32:39,952  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-38_426_1361515319386720064-1/-mr-10000
2024-04-24T02:32:39,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:39,960  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:39,971  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:32:39,971  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-24T02:32:39,971  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:32:39,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:39,992  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-24T02:32:39,992  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:32:39,992  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:32:39,994  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:32:39,995  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:39,995  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, alter_table_(String, String, String, Table, EnvironmentContext, String)=56, getTable_(GetTableRequest)=27, isCompatibleWith_(Configuration)=1}
MapReduce Jobs Launched: 
2024-04-24T02:32:39,995  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:39,995  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:39,995  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:39,995  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7); Time taken: 1.381 seconds
2024-04-24T02:32:39,995  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023238_6805c5d7-74ce-4a00-ae24-6bb59c330da7
2024-04-24T02:32:40,006  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:40,006  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:32:40,006  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-24T02:32:40,006  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-38_426_1361515319386720064-1
2024-04-24T02:32:40,007  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-38_426_1361515319386720064-1 on fs with scheme file
2024-04-24T02:32:40,007  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee): select a,b from acidTbl order by a,b
2024-04-24T02:32:40,009  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:32:40,009  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:32:40,010  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:40,010  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:40,012  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:40,012  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:40,013  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:40,019  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:40,019  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:40,019  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:40,019  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:40,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:40,039  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:32:40,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:40,048  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:40,048  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:40,056  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:40,056  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:32:40,068  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:32:40,068  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:32:40,111  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:40,111  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:40,111  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:40,112  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-40_007_1585772700927902546-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-40_007_1585772700927902546-1
2024-04-24T02:32:40,119  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:40,121  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T02:32:40,121  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:32:40,122  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:40,130  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:40,130  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:40,130  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:40,130  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T02:32:40,131  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T02:32:40,132  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:40,132  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getTableColumnStatistics_(String, String, List, String)=28, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=6, flushCache_()=0}
2024-04-24T02:32:40,132  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee); Time taken: 0.125 seconds
2024-04-24T02:32:40,132  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee
2024-04-24T02:32:40,132  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee
2024-04-24T02:32:40,147  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:32:40,147  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:40,147  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee): select a,b from acidTbl order by a,b
2024-04-24T02:32:40,148  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee
2024-04-24T02:32:40,148  INFO [main] ql.Driver: Query ID = alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee
Total jobs = 1
2024-04-24T02:32:40,148  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:40,148  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:40,303  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:32:40,303  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:40,303  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:40,303  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:40,303  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:40,303  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:40,303  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:40,303  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:40,305  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:40,305  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-24T02:32:40,305  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:40,315  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:40,316  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,66KB
2024-04-24T02:32:40,320  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:40,321  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,60KB
2024-04-24T02:32:40,322  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:40,327  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:40,334  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:40,339  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:40,340  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T02:32:40,340  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T02:32:40,340  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:40,340  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T02:32:40,340  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T02:32:40,340  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T02:32:40,351  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T02:32:40,351  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 11 ms
2024-04-24T02:32:40,351  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T02:32:40,367  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T02:32:40,385  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local294963968_0045
2024-04-24T02:32:40,385  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:40,444  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:40,445  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:40,445  INFO [Thread-3760] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:40,445  INFO [Thread-3760] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:40,447  INFO [Thread-3760] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:40,447  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local294963968_0045_m_000000_0
2024-04-24T02:32:40,447  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:40,448  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:40,448  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:40,448  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,66KB
2024-04-24T02:32:40,449  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:40,449  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:40,450  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:40,450  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:40,455  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:40,455  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:40,455  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:40,455  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:40,455  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:40,456  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:40,456  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:40,457  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:40,458  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:40,458  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:40,458  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:40,458  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:40,458  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:40,459  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-24T02:32:40,460  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:40,460  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:40,460  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:40,460  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:40,460  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:40,470  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:40,473  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local294963968_0045_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:40,474  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:40,474  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local294963968_0045_m_000000_0' done.
2024-04-24T02:32:40,474  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local294963968_0045_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=942077
		FILE: Number of bytes written=53016992
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1303904256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7482
2024-04-24T02:32:40,474  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local294963968_0045_m_000000_0
2024-04-24T02:32:40,474  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local294963968_0045_m_000001_0
2024-04-24T02:32:40,474  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:40,475  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:40,475  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:40,476  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,66KB
2024-04-24T02:32:40,477  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:40,477  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:40,477  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:40,477  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:40,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:40,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:40,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:40,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:40,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:40,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:40,483  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:40,484  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:40,484  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:40,484  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:40,484  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:40,484  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:40,484  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:1, 
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:40,485  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:40,493  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:40,496  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local294963968_0045_m_000001_0 is done. And is in the process of committing
2024-04-24T02:32:40,497  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:40,497  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local294963968_0045_m_000001_0' done.
2024-04-24T02:32:40,497  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local294963968_0045_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=950564
		FILE: Number of bytes written=53017051
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1303904256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7474
2024-04-24T02:32:40,497  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local294963968_0045_m_000001_0
2024-04-24T02:32:40,497  INFO [Thread-3760] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:40,498  INFO [Thread-3760] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:40,498  INFO [pool-224-thread-1] mapred.LocalJobRunner: Starting task: attempt_local294963968_0045_r_000000_0
2024-04-24T02:32:40,499  INFO [pool-224-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:40,499  INFO [pool-224-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3537f420
2024-04-24T02:32:40,499  WARN [pool-224-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:40,500  INFO [pool-224-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:40,500  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local294963968_0045_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:40,501  INFO [localfetcher#65] reduce.LocalFetcher: localfetcher#65 about to shuffle output of map attempt_local294963968_0045_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:40,502  INFO [localfetcher#65] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local294963968_0045_m_000001_0
2024-04-24T02:32:40,502  INFO [localfetcher#65] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-24T02:32:40,504  INFO [localfetcher#65] reduce.LocalFetcher: localfetcher#65 about to shuffle output of map attempt_local294963968_0045_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:40,504  INFO [localfetcher#65] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local294963968_0045_m_000000_0
2024-04-24T02:32:40,504  INFO [localfetcher#65] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-24T02:32:40,505  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:40,505  INFO [pool-224-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T02:32:40,505  INFO [pool-224-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:40,511  INFO [pool-224-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T02:32:40,511  INFO [pool-224-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-24T02:32:40,513  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:40,514  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-24T02:32:40,514  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:40,514  INFO [pool-224-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:40,514  INFO [pool-224-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-24T02:32:40,514  INFO [pool-224-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T02:32:40,514  INFO [pool-224-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:40,515  INFO [pool-224-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,60KB
2024-04-24T02:32:40,515  INFO [pool-224-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:40,515  INFO [pool-224-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:40,515  INFO [pool-224-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-24T02:32:40,515  INFO [pool-224-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:32:40,516  INFO [pool-224-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@61128ae5, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@403ec509, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@138f52c3
2024-04-24T02:32:40,516  INFO [pool-224-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-40_007_1585772700927902546-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-40_007_1585772700927902546-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:40,516  INFO [pool-224-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-40_007_1585772700927902546-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-40_007_1585772700927902546-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:32:40,516  INFO [pool-224-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-40_007_1585772700927902546-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-40_007_1585772700927902546-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:40,522  INFO [pool-224-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:40,523  INFO [pool-224-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:40,523  INFO [pool-224-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:40,523  INFO [pool-224-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:32:40,523  INFO [pool-224-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T02:32:40,523  INFO [pool-224-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_0:2, 
2024-04-24T02:32:40,523  INFO [pool-224-thread-1] mapred.Task: Task:attempt_local294963968_0045_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:40,524  INFO [pool-224-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:40,524  INFO [pool-224-thread-1] mapred.Task: Task 'attempt_local294963968_0045_r_000000_0' done.
2024-04-24T02:32:40,524  INFO [pool-224-thread-1] mapred.Task: Final Counters for attempt_local294963968_0045_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=956385
		FILE: Number of bytes written=53017230
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1303904256
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:40,524  INFO [pool-224-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local294963968_0045_r_000000_0
2024-04-24T02:32:40,524  INFO [Thread-3760] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24T02:32:40,592  INFO [Metastore Scheduled Worker 2] metastore.HMSHandler: 9: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:32:40,593  INFO [Metastore Scheduled Worker 2] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a5a8400, with PersistenceManager: null will be shutdown
2024-04-24T02:32:40,593  INFO [Metastore Scheduled Worker 2] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a5a8400, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@24c20fc0 created in the thread with id: 46
2024-04-24T02:32:40,641  INFO [Metastore Scheduled Worker 2] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a5a8400 from thread id: 46
2024-04-24 02:32:41,447 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:41,447  INFO [main] exec.Task: 2024-04-24 02:32:41,447 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local294963968_0045
2024-04-24T02:32:41,448  INFO [main] exec.Task: Ended Job = job_local294963968_0045
2024-04-24T02:32:41,450  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:41,450  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T02:32:41,450  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:41,450  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:41,450  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:41,450  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee); Time taken: 1.303 seconds
2024-04-24T02:32:41,450  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023240_58d55dab-455d-4f44-8fa7-62d2abdd20ee
2024-04-24T02:32:41,454  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:32:41,461  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:41,461  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:32:41,465  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T02:32:41,466  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T02:32:41,466  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:2, 
2024-04-24T02:32:41,466  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-24T02:32:41,466  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-40_007_1585772700927902546-1
2024-04-24T02:32:41,467  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-40_007_1585772700927902546-1 on fs with scheme file
2024-04-24T02:32:41,467  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023241_e12eb32a-8d04-47a1-b2eb-bb71dacf256e): START TRANSACTION
2024-04-24T02:32:41,470  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-24T02:32:41,470  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:32:41,470  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:41,470  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:41,470  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:41,471  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:41,471  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:41,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:41,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=0}
2024-04-24T02:32:41,471  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023241_e12eb32a-8d04-47a1-b2eb-bb71dacf256e); Time taken: 0.004 seconds
2024-04-24T02:32:41,471  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023241_e12eb32a-8d04-47a1-b2eb-bb71dacf256e
2024-04-24T02:32:41,471  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-24T02:32:41,471  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023241_e12eb32a-8d04-47a1-b2eb-bb71dacf256e): START TRANSACTION
2024-04-24T02:32:41,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:41,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T02:32:41,472  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023241_e12eb32a-8d04-47a1-b2eb-bb71dacf256e); Time taken: 0.0 seconds
2024-04-24T02:32:41,472  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:41,472  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:41,472  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:41,472  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:41,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:41,483  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:41,483  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:41,483  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:41,483  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:41,483  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:41,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:41,489  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:41,490  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:41,490  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:41,511  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:41,558  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:41,558  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:41,558  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:41,559  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:41,561  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:41,561  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:41,561  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:41,561  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:41,567  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:41,568  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:41,569  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:41,577  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 15
2024-04-24T02:32:41,577  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [15])
2024-04-24T02:32:41,577  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:41,580  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:32:41,580  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:32:41,581  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:32:41,582  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:41,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:41,596  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:41,596  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:41,596  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:41,596  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:41,596  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-24T02:32:41,596  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:41,596  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=4, getCheckConstraints_(CheckConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTable_(GetTableRequest)=27, isCompatibleWith_(Configuration)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, allocateTableWriteId_(long, String, String)=6}
2024-04-24T02:32:41,597  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5); Time taken: 0.124 seconds
2024-04-24T02:32:41,597  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5
2024-04-24T02:32:41,597  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5
2024-04-24T02:32:41,611  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:32:41,611  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:41,614  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-24T02:32:41,614  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5
2024-04-24T02:32:41,614  INFO [main] ql.Driver: Query ID = alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5
Total jobs = 1
2024-04-24T02:32:41,614  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:41,614  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:41,759  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:32:41,759  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:41,759  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:41,759  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:41,759  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:41,759  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:41,759  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:41,759  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:41,762  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:41,762  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:32:41,762  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-41_472_2936236633592053887-1/dummy_path
2024-04-24T02:32:41,771  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:41,771  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:32:41,776  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:41,776  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:41,777  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:41,781  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-41_472_2936236633592053887-1/-mr-10000
2024-04-24T02:32:41,782  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:41,789  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:41,793  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:41,794  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:32:41,794  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:32:41,794  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-41_472_2936236633592053887-1/dummy_path
2024-04-24T02:32:41,795  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:32:41,812  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:32:41,831  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local645642591_0046
2024-04-24T02:32:41,831  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:41,890  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:41,890  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:41,890  INFO [Thread-3813] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:41,890  INFO [Thread-3813] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:41,892  INFO [Thread-3813] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:41,892  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local645642591_0046_m_000000_0
2024-04-24T02:32:41,893  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:41,893  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-41_472_2936236633592053887-1/dummy_path/null:0+1
2024-04-24T02:32:41,893  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:41,894  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:32:41,894  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:32:41,898  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:41,898  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:41,898  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:41,898  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:41,898  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:41,898  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:41,899  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:41,899  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:41,900  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, 
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T02:32:41,901  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-24T02:32:41,902  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:41,902  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:41,902  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:41,902  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T02:32:41,902  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:32:41,912  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:41,915  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local645642591_0046_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:41,916  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:32:41,916  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local645642591_0046_m_000000_0' done.
2024-04-24T02:32:41,916  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local645642591_0046_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=961940
		FILE: Number of bytes written=54192452
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1303904256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5019
2024-04-24T02:32:41,916  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local645642591_0046_m_000000_0
2024-04-24T02:32:41,916  INFO [Thread-3813] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:41,917  INFO [Thread-3813] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:41,917  INFO [pool-227-thread-1] mapred.LocalJobRunner: Starting task: attempt_local645642591_0046_r_000000_0
2024-04-24T02:32:41,918  INFO [pool-227-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:41,918  INFO [pool-227-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6ec73c94
2024-04-24T02:32:41,918  WARN [pool-227-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:41,918  INFO [pool-227-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:41,919  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local645642591_0046_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:41,920  INFO [localfetcher#66] reduce.LocalFetcher: localfetcher#66 about to shuffle output of map attempt_local645642591_0046_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:41,920  INFO [localfetcher#66] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local645642591_0046_m_000000_0
2024-04-24T02:32:41,920  INFO [localfetcher#66] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:41,920  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:41,920  INFO [pool-227-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:41,921  INFO [pool-227-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:41,927  INFO [pool-227-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:41,927  INFO [pool-227-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:41,930  INFO [pool-227-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:41,930  INFO [pool-227-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:41,930  INFO [pool-227-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:41,930  INFO [pool-227-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:41,930  INFO [pool-227-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:41,931  INFO [pool-227-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:41,931  INFO [pool-227-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:41,931  INFO [pool-227-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:41,932  INFO [pool-227-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:41,932  INFO [pool-227-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:41,932  INFO [pool-227-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:41,932  INFO [pool-227-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:41,933  INFO [pool-227-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local645642591_0046/job_local645642591_0046.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@154cbf60
2024-04-24T02:32:41,933  INFO [pool-227-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:41,933  INFO [pool-227-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:41,933  INFO [pool-227-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:41,933  INFO [pool-227-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:41,933  INFO [pool-227-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:41,940  INFO [pool-227-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:41,945  INFO [pool-227-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:41,945  INFO [pool-227-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:32:41,945  INFO [pool-227-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:41,945  INFO [pool-227-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:41,947  INFO [pool-227-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0]
2024-04-24T02:32:41,959  INFO [pool-227-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-24T02:32:41,959  INFO [pool-227-thread-1] mapred.Task: Task:attempt_local645642591_0046_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:41,959  INFO [pool-227-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:41,959  INFO [pool-227-thread-1] mapred.Task: Task 'attempt_local645642591_0046_r_000000_0' done.
2024-04-24T02:32:41,959  INFO [pool-227-thread-1] mapred.Task: Final Counters for attempt_local645642591_0046_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=968045
		FILE: Number of bytes written=54193492
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1303904256
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:41,960  INFO [pool-227-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local645642591_0046_r_000000_0
2024-04-24T02:32:41,960  INFO [pool-227-thread-1] mapred.LocalJobRunner: Starting task: attempt_local645642591_0046_r_000001_0
2024-04-24T02:32:41,960  INFO [pool-227-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:41,960  INFO [pool-227-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@332f5d11
2024-04-24T02:32:41,960  WARN [pool-227-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:41,961  INFO [pool-227-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:41,962  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local645642591_0046_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:41,964  INFO [localfetcher#67] reduce.LocalFetcher: localfetcher#67 about to shuffle output of map attempt_local645642591_0046_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:32:41,964  INFO [localfetcher#67] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local645642591_0046_m_000000_0
2024-04-24T02:32:41,965  INFO [localfetcher#67] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:32:41,965  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:41,965  INFO [pool-227-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:41,965  INFO [pool-227-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:41,971  INFO [pool-227-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:41,971  INFO [pool-227-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:41,974  INFO [pool-227-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:41,974  INFO [pool-227-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:32:41,974  INFO [pool-227-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:41,974  INFO [pool-227-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:41,974  INFO [pool-227-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:32:41,974  INFO [pool-227-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:32:41,975  INFO [pool-227-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:41,975  INFO [pool-227-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:32:41,976  INFO [pool-227-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:41,976  INFO [pool-227-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:32:41,976  INFO [pool-227-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:32:41,976  INFO [pool-227-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:32:41,976  INFO [pool-227-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local645642591_0046/job_local645642591_0046.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@69480e76
2024-04-24T02:32:41,977  INFO [pool-227-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:41,977  INFO [pool-227-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:41,977  INFO [pool-227-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:41,977  INFO [pool-227-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:41,977  INFO [pool-227-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:41,982  INFO [pool-227-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:41,982  INFO [pool-227-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:32:41,982  INFO [pool-227-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:32:41,982  INFO [pool-227-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:32:41,982  INFO [pool-227-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:32:41,984  INFO [pool-227-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-24T02:32:41,994  INFO [pool-227-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-24T02:32:41,994  INFO [pool-227-thread-1] mapred.Task: Task:attempt_local645642591_0046_r_000001_0 is done. And is in the process of committing
2024-04-24T02:32:41,995  INFO [pool-227-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:41,995  INFO [pool-227-thread-1] mapred.Task: Task 'attempt_local645642591_0046_r_000001_0' done.
2024-04-24T02:32:41,995  INFO [pool-227-thread-1] mapred.Task: Final Counters for attempt_local645642591_0046_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=974126
		FILE: Number of bytes written=54194526
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1303904256
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:41,995  INFO [pool-227-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local645642591_0046_r_000001_0
2024-04-24T02:32:41,995  INFO [Thread-3813] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:42,893 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:42,893  INFO [main] exec.Task: 2024-04-24 02:32:42,893 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local645642591_0046
2024-04-24T02:32:42,895  INFO [main] exec.Task: Ended Job = job_local645642591_0046
2024-04-24T02:32:42,896  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:32:42,896  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:32:42,897  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-24T02:32:42,897  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest
2024-04-24T02:32:42,897  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-24T02:32:42,909  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:32:42,910  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:42,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:42,917  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:42,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:42,923  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:42,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:42,943  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:32:42,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:42,949  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:42,949  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:32:42,950  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-41_472_2936236633592053887-1/-mr-10000
2024-04-24T02:32:42,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:42,958  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:42,978  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:32:42,979  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-24T02:32:42,979  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:32:42,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:32:42,999  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-24T02:32:42,999  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:32:42,999  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:32:42,999  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2695, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:32:43,000  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:43,000  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=0, isCompatibleWith_(Configuration)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=39, getTable_(GetTableRequest)=26}
MapReduce Jobs Launched: 
2024-04-24T02:32:43,000  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:43,000  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:43,000  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:43,000  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023241_eed96e4c-7be3-450f-8763-d98ce581dfe5); Time taken: 1.386 seconds
2024-04-24T02:32:43,000  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-24T02:32:43,001  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-41_472_2936236633592053887-1
2024-04-24T02:32:43,001  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-41_472_2936236633592053887-1 on fs with scheme file
2024-04-24T02:32:43,001  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e): select a,b from acidTbl order by a,b
2024-04-24T02:32:43,002  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:43,002  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:43,002  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:43,002  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:43,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:43,009  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:43,010  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:43,010  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:43,010  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:43,022  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:43,031  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:32:43,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:43,040  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:43,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:43,049  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:43,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:32:43,058  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-24T02:32:43,058  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-24T02:32:43,099  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:43,100  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:43,100  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:43,100  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-43_001_2511039561611198434-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-43_001_2511039561611198434-1
2024-04-24T02:32:43,107  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:43,109  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T02:32:43,109  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T02:32:43,110  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:43,118  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:43,118  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:43,118  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:43,118  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T02:32:43,119  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T02:32:43,119  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:43,120  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=6, getTableColumnStatistics_(String, String, List, String)=26, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:32:43,120  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e); Time taken: 0.118 seconds
2024-04-24T02:32:43,120  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e
2024-04-24T02:32:43,120  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e
2024-04-24T02:32:43,133  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:32:43,133  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:43,134  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e): select a,b from acidTbl order by a,b
2024-04-24T02:32:43,134  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e
2024-04-24T02:32:43,134  INFO [main] ql.Driver: Query ID = alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e
Total jobs = 1
2024-04-24T02:32:43,134  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:43,134  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:43,275  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:32:43,275  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:32:43,275  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:32:43,275  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:32:43,275  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:32:43,275  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:32:43,275  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:32:43,275  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:32:43,278  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:43,278  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-24T02:32:43,278  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:43,287  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:43,288  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:32:43,292  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:32:43,293  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-24T02:32:43,294  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:43,299  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:43,306  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:43,310  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:43,311  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T02:32:43,311  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T02:32:43,311  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:43,311  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T02:32:43,311  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:2:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T02:32:43,311  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T02:32:43,332  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/4
2024-04-24T02:32:43,332  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 4). duration: 21 ms
2024-04-24T02:32:43,333  INFO [main] io.HiveInputFormat: number of splits 4
2024-04-24T02:32:43,350  INFO [main] mapreduce.JobSubmitter: number of splits:4
2024-04-24T02:32:43,369  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1477550392_0047
2024-04-24T02:32:43,369  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:43,427  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:43,427  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:43,428  INFO [Thread-3898] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:43,428  INFO [Thread-3898] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:43,430  INFO [Thread-3898] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:43,430  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1477550392_0047_m_000000_0
2024-04-24T02:32:43,430  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:43,431  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:43,431  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:43,432  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:32:43,433  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:43,433  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 679, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:43,433  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:43,434  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:43,438  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:43,438  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:43,438  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:43,438  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:43,438  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:43,438  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:43,438  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:43,439  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:43,440  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:43,440  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:43,440  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:43,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:43,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:43,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:43,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:43,454  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:43,457  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1477550392_0047_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:43,457  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:43,457  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1477550392_0047_m_000000_0' done.
2024-04-24T02:32:43,457  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1477550392_0047_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=984361
		FILE: Number of bytes written=55372321
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1305477120
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7498
2024-04-24T02:32:43,457  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1477550392_0047_m_000000_0
2024-04-24T02:32:43,457  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1477550392_0047_m_000001_0
2024-04-24T02:32:43,458  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:43,458  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:43,459  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:43,459  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:32:43,460  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:43,460  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:43,460  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:43,461  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:43,465  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:43,465  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:43,465  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:43,465  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:43,465  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:43,465  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:43,466  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:43,467  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:43,467  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:43,467  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:43,467  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:43,467  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:43,467  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:43,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:43,477  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:43,480  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1477550392_0047_m_000001_0 is done. And is in the process of committing
2024-04-24T02:32:43,481  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:43,481  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1477550392_0047_m_000001_0' done.
2024-04-24T02:32:43,481  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1477550392_0047_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=993846
		FILE: Number of bytes written=55372380
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1305477120
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7474
2024-04-24T02:32:43,481  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1477550392_0047_m_000001_0
2024-04-24T02:32:43,481  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1477550392_0047_m_000002_0
2024-04-24T02:32:43,482  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:43,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:43,483  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:43,483  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:32:43,485  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:43,485  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 672, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:43,486  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:43,486  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:43,491  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:43,491  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:43,491  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:43,491  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:43,491  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:43,492  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:43,492  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:43,493  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:43,494  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:43,494  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:43,494  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:43,494  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:43,494  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:43,495  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:43,496  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:32:43,496  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:43,496  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:43,496  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:43,496  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:43,496  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:43,504  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:43,508  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1477550392_0047_m_000002_0 is done. And is in the process of committing
2024-04-24T02:32:43,508  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:43,509  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1477550392_0047_m_000002_0' done.
2024-04-24T02:32:43,509  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1477550392_0047_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1002815
		FILE: Number of bytes written=55372439
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1305477120
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7470
2024-04-24T02:32:43,509  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1477550392_0047_m_000002_0
2024-04-24T02:32:43,509  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1477550392_0047_m_000003_0
2024-04-24T02:32:43,509  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:43,510  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:43,510  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:43,511  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:32:43,512  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:32:43,512  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:32:43,513  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:32:43,514  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:32:43,519  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:32:43,519  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:32:43,519  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:32:43,519  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:32:43,519  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:32:43,520  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:32:43,520  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:43,521  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:43,522  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:43,522  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:43,522  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:32:43,523  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:32:43,524  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:32:43,533  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:32:43,536  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1477550392_0047_m_000003_0 is done. And is in the process of committing
2024-04-24T02:32:43,537  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:32:43,537  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1477550392_0047_m_000003_0' done.
2024-04-24T02:32:43,537  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1477550392_0047_m_000003_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1011268
		FILE: Number of bytes written=55372498
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1305477120
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7466
2024-04-24T02:32:43,537  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1477550392_0047_m_000003_0
2024-04-24T02:32:43,537  INFO [Thread-3898] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:32:43,538  INFO [Thread-3898] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:32:43,538  INFO [pool-232-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1477550392_0047_r_000000_0
2024-04-24T02:32:43,539  INFO [pool-232-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:43,539  INFO [pool-232-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@49aa900a
2024-04-24T02:32:43,539  WARN [pool-232-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:43,540  INFO [pool-232-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:32:43,540  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1477550392_0047_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:32:43,543  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local1477550392_0047_m_000002_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:43,543  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1477550392_0047_m_000002_0
2024-04-24T02:32:43,543  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-24T02:32:43,545  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local1477550392_0047_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:43,545  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1477550392_0047_m_000000_0
2024-04-24T02:32:43,545  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-24T02:32:43,548  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local1477550392_0047_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:43,548  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1477550392_0047_m_000001_0
2024-04-24T02:32:43,548  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 3, commitMemory -> 46, usedMemory ->69
2024-04-24T02:32:43,550  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local1477550392_0047_m_000003_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:32:43,550  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1477550392_0047_m_000003_0
2024-04-24T02:32:43,550  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 4, commitMemory -> 69, usedMemory ->92
2024-04-24T02:32:43,550  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:32:43,551  INFO [pool-232-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-24T02:32:43,551  INFO [pool-232-thread-1] reduce.MergeManagerImpl: finalMerge called with 4 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:32:43,557  INFO [pool-232-thread-1] mapred.Merger: Merging 4 sorted segments
2024-04-24T02:32:43,557  INFO [pool-232-thread-1] mapred.Merger: Down to the last merge-pass, with 4 segments left of total size: 24 bytes
2024-04-24T02:32:43,559  INFO [pool-232-thread-1] reduce.MergeManagerImpl: Merged 4 segments, 92 bytes to disk to satisfy reduce memory limit
2024-04-24T02:32:43,559  INFO [pool-232-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-24T02:32:43,559  INFO [pool-232-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:32:43,559  INFO [pool-232-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:32:43,560  INFO [pool-232-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-24T02:32:43,560  INFO [pool-232-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-24T02:32:43,560  INFO [pool-232-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:32:43,561  INFO [pool-232-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-24T02:32:43,562  INFO [pool-232-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:32:43,562  INFO [pool-232-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:43,562  INFO [pool-232-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-24T02:32:43,562  INFO [pool-232-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:32:43,562  INFO [pool-232-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@410475b7, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@102b1f53, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@78452384
2024-04-24T02:32:43,562  INFO [pool-232-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-43_001_2511039561611198434-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-43_001_2511039561611198434-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:43,562  INFO [pool-232-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-43_001_2511039561611198434-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-43_001_2511039561611198434-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:32:43,562  INFO [pool-232-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-43_001_2511039561611198434-1/-mr-10001/.hive-staging_hive_2024-04-24_02-32-43_001_2511039561611198434-1/_tmp.-ext-10002/000000_0
2024-04-24T02:32:43,570  INFO [pool-232-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:43,570  INFO [pool-232-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:43,570  INFO [pool-232-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:43,570  INFO [pool-232-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:32:43,570  INFO [pool-232-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T02:32:43,571  INFO [pool-232-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:4, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-24T02:32:43,571  INFO [pool-232-thread-1] mapred.Task: Task:attempt_local1477550392_0047_r_000000_0 is done. And is in the process of committing
2024-04-24T02:32:43,571  INFO [pool-232-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:32:43,571  INFO [pool-232-thread-1] mapred.Task: Task 'attempt_local1477550392_0047_r_000000_0' done.
2024-04-24T02:32:43,571  INFO [pool-232-thread-1] mapred.Task: Final Counters for attempt_local1477550392_0047_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1017241
		FILE: Number of bytes written=55372751
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=108
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =4
		Failed Shuffles=0
		Merged Map outputs=4
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1305477120
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:43,571  INFO [pool-232-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1477550392_0047_r_000000_0
2024-04-24T02:32:43,571  INFO [Thread-3898] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:32:44,430 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:32:44,430  INFO [main] exec.Task: 2024-04-24 02:32:44,430 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1477550392_0047
2024-04-24T02:32:44,432  INFO [main] exec.Task: Ended Job = job_local1477550392_0047
2024-04-24T02:32:44,433  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:44,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T02:32:44,434  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:44,434  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:44,434  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:44,434  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e); Time taken: 1.299 seconds
2024-04-24T02:32:44,437  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T02:32:44,438  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T02:32:44,438  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:4, 
2024-04-24T02:32:44,438  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = 1 where b != 1
2024-04-24T02:32:44,438  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-43_001_2511039561611198434-1
2024-04-24T02:32:44,439  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa4d4375-50c6-4f04-babc-202b1ae1e1a2/hive_2024-04-24_02-32-43_001_2511039561611198434-1 on fs with scheme file
2024-04-24T02:32:44,439  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023244_b4db7568-6f23-4fe4-b80b-9e6201a34825): update acidTbl set b = 1 where b != 1
2024-04-24T02:32:44,440  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:32:44,440  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:44,447  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,447  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = 1 where b != 1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-24T02:32:44,447  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:32:44,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:44,455  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,455  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:44,455  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:44,456  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:44,463  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,463  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:44,463  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:44,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:44,470  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,470  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:44,470  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:44,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:44,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:44,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:32:44,511  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:32:44,511  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:44,521  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,521  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:32:44,530  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,530  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:32:44,539  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-24T02:32:44,539  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-24T02:32:44,608  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:44,608  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:44,608  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:44,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:44,615  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,617 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateDeleteOfInserts(TestTxnCommands.java:883) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:32:44,618 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:32:44,618  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:32:44,618 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateDeleteOfInserts(TestTxnCommands.java:883)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:32:44,619  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:44,619  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=2, getAllTableConstraints_(AllTableConstraintsRequest)=4, getValidWriteIds_(List, String)=1, getTable_(GetTableRequest)=35, getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, getTableColumnStatistics_(String, String, List, String)=27}
2024-04-24T02:32:44,619  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023244_b4db7568-6f23-4fe4-b80b-9e6201a34825); Time taken: 0.18 seconds
2024-04-24T02:32:44,619  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023243_ae06dab2-c331-4d31-a293-55a7cfcd5d7e
2024-04-24T02:32:44,622  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:44,629  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:44,629  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023244_367b49a1-c19a-430f-8a1a-6b1a8e6cd870): drop table if exists acidTbl
2024-04-24T02:32:44,632  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-24T02:32:44,632  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:32:44,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:44,639  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,639  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:44,639  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:44,639  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:44,639  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, rollbackTxn_(long)=10, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=6, openTxn_(String, TxnType)=3}
2024-04-24T02:32:44,639  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023244_367b49a1-c19a-430f-8a1a-6b1a8e6cd870); Time taken: 0.01 seconds
2024-04-24T02:32:44,640  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023244_367b49a1-c19a-430f-8a1a-6b1a8e6cd870
2024-04-24T02:32:44,640  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023244_367b49a1-c19a-430f-8a1a-6b1a8e6cd870
2024-04-24T02:32:44,655  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023244_367b49a1-c19a-430f-8a1a-6b1a8e6cd870 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:32:44,655  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:44,655  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023244_367b49a1-c19a-430f-8a1a-6b1a8e6cd870): drop table if exists acidTbl
2024-04-24T02:32:44,655  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:44,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:44,661  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:44,667  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,667  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:44,771  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:44,772  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=110, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:32:44,772  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023244_367b49a1-c19a-430f-8a1a-6b1a8e6cd870); Time taken: 0.116 seconds
2024-04-24T02:32:44,772  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023244_367b49a1-c19a-430f-8a1a-6b1a8e6cd870
2024-04-24T02:32:44,776  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:32:44,782  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:44,783  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:32:44,784  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:44,784  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023244_3800fe93-595d-4da3-b431-d810d0a51f73): drop table if exists acidTblPart
2024-04-24T02:32:44,786  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-24T02:32:44,787  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:32:44,787  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:44,794  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,794  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:44,794  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:44,794  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:44,794  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, flushCache_()=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=7}
2024-04-24T02:32:44,795  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023244_3800fe93-595d-4da3-b431-d810d0a51f73); Time taken: 0.01 seconds
2024-04-24T02:32:44,795  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023244_3800fe93-595d-4da3-b431-d810d0a51f73
2024-04-24T02:32:44,795  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023244_3800fe93-595d-4da3-b431-d810d0a51f73
2024-04-24T02:32:44,811  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023244_3800fe93-595d-4da3-b431-d810d0a51f73 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:32:44,811  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:44,811  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023244_3800fe93-595d-4da3-b431-d810d0a51f73): drop table if exists acidTblPart
2024-04-24T02:32:44,811  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:44,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:44,818  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:44,824  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:44,863  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:44,864  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=45}
2024-04-24T02:32:44,864  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023244_3800fe93-595d-4da3-b431-d810d0a51f73); Time taken: 0.052 seconds
2024-04-24T02:32:44,864  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023244_3800fe93-595d-4da3-b431-d810d0a51f73
2024-04-24T02:32:44,868  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:32:44,874  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:44,874  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:32:44,875  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:44,875  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023244_5ab4f444-2923-487f-9428-4659c18f331d): drop table if exists acidTbl2
2024-04-24T02:32:44,877  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-24T02:32:44,877  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:32:44,878  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:44,878  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:44,878  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:44,878  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=1}
2024-04-24T02:32:44,878  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023244_5ab4f444-2923-487f-9428-4659c18f331d); Time taken: 0.003 seconds
2024-04-24T02:32:44,879  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023244_5ab4f444-2923-487f-9428-4659c18f331d
2024-04-24T02:32:44,879  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:44,879  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023244_5ab4f444-2923-487f-9428-4659c18f331d): drop table if exists acidTbl2
2024-04-24T02:32:44,879  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:44,879  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:32:44,880  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:44,880  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-24T02:32:44,880  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023244_5ab4f444-2923-487f-9428-4659c18f331d); Time taken: 0.001 seconds
2024-04-24T02:32:44,880  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023244_5ab4f444-2923-487f-9428-4659c18f331d
2024-04-24T02:32:44,885  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:32:44,891  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:44,891  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:32:44,892  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:44,892  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023244_17fedede-8605-4558-a1a4-bacb7fec6911): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:44,894  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-24T02:32:44,894  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:32:44,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:44,915  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,915  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:44,915  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:44,915  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:44,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=20, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-24T02:32:44,916  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023244_17fedede-8605-4558-a1a4-bacb7fec6911); Time taken: 0.023 seconds
2024-04-24T02:32:44,916  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023244_17fedede-8605-4558-a1a4-bacb7fec6911
2024-04-24T02:32:44,916  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023244_17fedede-8605-4558-a1a4-bacb7fec6911
2024-04-24T02:32:44,934  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023244_17fedede-8605-4558-a1a4-bacb7fec6911 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:32:44,935  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:44,935  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023244_17fedede-8605-4558-a1a4-bacb7fec6911): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:44,935  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:44,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:44,943  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:44,951  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:44,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:45,040  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,040  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=97, getTable_(GetTableRequest)=8}
2024-04-24T02:32:45,041  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023244_17fedede-8605-4558-a1a4-bacb7fec6911); Time taken: 0.105 seconds
2024-04-24T02:32:45,041  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023244_17fedede-8605-4558-a1a4-bacb7fec6911
2024-04-24T02:32:45,045  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:32:45,051  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,051  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:32:45,052  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:45,052  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_cb3b2645-7e11-4da6-b309-7c448440908c): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:45,060  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-24T02:32:45,061  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:32:45,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:45,071  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,071  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,071  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,071  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,071  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=9, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:45,072  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_cb3b2645-7e11-4da6-b309-7c448440908c); Time taken: 0.019 seconds
2024-04-24T02:32:45,072  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023245_cb3b2645-7e11-4da6-b309-7c448440908c
2024-04-24T02:32:45,072  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_cb3b2645-7e11-4da6-b309-7c448440908c
2024-04-24T02:32:45,086  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_cb3b2645-7e11-4da6-b309-7c448440908c LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T02:32:45,086  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:45,086  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_cb3b2645-7e11-4da6-b309-7c448440908c): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:45,087  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,087  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:45,095  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:45,103  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:45,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=38}
2024-04-24T02:32:45,133  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_cb3b2645-7e11-4da6-b309-7c448440908c); Time taken: 0.047 seconds
2024-04-24T02:32:45,133  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_cb3b2645-7e11-4da6-b309-7c448440908c
2024-04-24T02:32:45,138  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:32:45,145  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,145  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:32:45,146  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:45,146  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_bea69327-832a-46bb-a031-53ed20ef2d0d): drop table if exists nonAcidNonBucket
2024-04-24T02:32:45,148  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-24T02:32:45,149  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:32:45,149  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:45,157  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,158  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,158  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,158  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,158  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0}
2024-04-24T02:32:45,158  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_bea69327-832a-46bb-a031-53ed20ef2d0d); Time taken: 0.012 seconds
2024-04-24T02:32:45,158  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023245_bea69327-832a-46bb-a031-53ed20ef2d0d
2024-04-24T02:32:45,159  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_bea69327-832a-46bb-a031-53ed20ef2d0d
2024-04-24T02:32:45,175  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_bea69327-832a-46bb-a031-53ed20ef2d0d LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T02:32:45,175  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:45,175  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_bea69327-832a-46bb-a031-53ed20ef2d0d): drop table if exists nonAcidNonBucket
2024-04-24T02:32:45,175  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:45,184  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,184  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:45,193  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,193  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:45,224  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,225  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=40, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T02:32:45,225  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_bea69327-832a-46bb-a031-53ed20ef2d0d); Time taken: 0.049 seconds
2024-04-24T02:32:45,225  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_bea69327-832a-46bb-a031-53ed20ef2d0d
2024-04-24T02:32:45,229  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:32:45,235  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,235  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:32:45,236  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testVersioningVersionFileEnabled" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="3.212">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update T set a=3 where b=2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:32:45,293  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:32:45,293  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:32:45,293  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:32:45,293  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:32:45,294  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:32:45,294  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:32:45,294  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:32:45,294  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:32:45,294  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:32:45,294  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:32:45,294  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:32:45,296  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = cd3ef49d-c822-4155-8d36-45fb6b127276
2024-04-24T02:32:45,298  INFO [main] SessionState: Hive Session ID = cd3ef49d-c822-4155-8d36-45fb6b127276
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:45,299  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:32:45,304  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/cd3ef49d-c822-4155-8d36-45fb6b127276
2024-04-24T02:32:45,306  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cd3ef49d-c822-4155-8d36-45fb6b127276
2024-04-24T02:32:45,308  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/cd3ef49d-c822-4155-8d36-45fb6b127276/_tmp_space.db
2024-04-24T02:32:45,309  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=cd3ef49d-c822-4155-8d36-45fb6b127276, clientType=HIVECLI]
2024-04-24T02:32:45,309  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:45,309  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_e513ca15-0571-4320-ada3-cf303b8864ac): drop table if exists acidTbl
2024-04-24T02:32:45,319  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:32:45,319  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:32:45,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:45,325  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,325  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,325  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,325  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=10, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T02:32:45,325  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_e513ca15-0571-4320-ada3-cf303b8864ac); Time taken: 0.016 seconds
2024-04-24T02:32:45,325  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023245_e513ca15-0571-4320-ada3-cf303b8864ac
2024-04-24T02:32:45,325  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:45,325  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_e513ca15-0571-4320-ada3-cf303b8864ac): drop table if exists acidTbl
2024-04-24T02:32:45,326  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:45,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:45,329  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_e513ca15-0571-4320-ada3-cf303b8864ac); Time taken: 0.004 seconds
2024-04-24T02:32:45,329  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_e513ca15-0571-4320-ada3-cf303b8864ac
2024-04-24T02:32:45,335  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:32:45,342  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,342  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:32:45,342  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:45,343  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_36579b9c-b32e-4d02-a4a3-8982bd6607f7): drop table if exists acidTblPart
2024-04-24T02:32:45,345  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:32:45,345  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:32:45,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:45,348  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,348  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,348  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,349  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T02:32:45,349  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_36579b9c-b32e-4d02-a4a3-8982bd6607f7); Time taken: 0.005 seconds
2024-04-24T02:32:45,349  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023245_36579b9c-b32e-4d02-a4a3-8982bd6607f7
2024-04-24T02:32:45,349  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:45,349  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_36579b9c-b32e-4d02-a4a3-8982bd6607f7): drop table if exists acidTblPart
2024-04-24T02:32:45,349  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,349  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:45,352  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,352  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:45,352  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_36579b9c-b32e-4d02-a4a3-8982bd6607f7); Time taken: 0.003 seconds
2024-04-24T02:32:45,353  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_36579b9c-b32e-4d02-a4a3-8982bd6607f7
2024-04-24T02:32:45,358  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:32:45,364  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,365  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:32:45,365  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:45,366  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_b3ac7397-17b3-4461-8e88-3b38b0c22fd7): drop table if exists acidTbl2
2024-04-24T02:32:45,368  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:32:45,368  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:32:45,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:45,371  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,371  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,372  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,372  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-24T02:32:45,372  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_b3ac7397-17b3-4461-8e88-3b38b0c22fd7); Time taken: 0.006 seconds
2024-04-24T02:32:45,372  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023245_b3ac7397-17b3-4461-8e88-3b38b0c22fd7
2024-04-24T02:32:45,372  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:45,372  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_b3ac7397-17b3-4461-8e88-3b38b0c22fd7): drop table if exists acidTbl2
2024-04-24T02:32:45,372  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,373  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:32:45,376  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,376  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:32:45,376  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_b3ac7397-17b3-4461-8e88-3b38b0c22fd7); Time taken: 0.004 seconds
2024-04-24T02:32:45,376  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_b3ac7397-17b3-4461-8e88-3b38b0c22fd7
2024-04-24T02:32:45,381  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:32:45,387  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,387  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:32:45,388  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:45,388  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_0ea45ff9-8564-4a7a-aa52-4666060293e1): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:45,390  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:32:45,390  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:32:45,391  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:45,393  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,394  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,394  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,394  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=1}
2024-04-24T02:32:45,394  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_0ea45ff9-8564-4a7a-aa52-4666060293e1); Time taken: 0.006 seconds
2024-04-24T02:32:45,394  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023245_0ea45ff9-8564-4a7a-aa52-4666060293e1
2024-04-24T02:32:45,394  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:45,394  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_0ea45ff9-8564-4a7a-aa52-4666060293e1): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:45,394  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:45,397  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,397  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:45,397  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_0ea45ff9-8564-4a7a-aa52-4666060293e1); Time taken: 0.003 seconds
2024-04-24T02:32:45,398  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_0ea45ff9-8564-4a7a-aa52-4666060293e1
2024-04-24T02:32:45,403  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:32:45,409  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,409  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:32:45,410  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:45,410  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_321c5985-88a1-4ffb-be00-8a80d4c60838): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:45,412  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:32:45,412  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:32:45,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:45,416  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,416  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,416  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,416  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-24T02:32:45,416  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_321c5985-88a1-4ffb-be00-8a80d4c60838); Time taken: 0.006 seconds
2024-04-24T02:32:45,416  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023245_321c5985-88a1-4ffb-be00-8a80d4c60838
2024-04-24T02:32:45,416  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:45,416  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_321c5985-88a1-4ffb-be00-8a80d4c60838): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:45,416  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,416  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:45,419  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,419  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:45,420  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_321c5985-88a1-4ffb-be00-8a80d4c60838); Time taken: 0.003 seconds
2024-04-24T02:32:45,420  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_321c5985-88a1-4ffb-be00-8a80d4c60838
2024-04-24T02:32:45,425  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:32:45,431  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,432  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:32:45,432  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:45,432  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_16e8f80c-bd61-4735-bcbd-7a216b7a9aed): drop table if exists nonAcidNonBucket
2024-04-24T02:32:45,434  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:32:45,435  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:32:45,435  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:45,438  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,438  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,438  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,438  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2}
2024-04-24T02:32:45,438  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_16e8f80c-bd61-4735-bcbd-7a216b7a9aed); Time taken: 0.006 seconds
2024-04-24T02:32:45,439  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023245_16e8f80c-bd61-4735-bcbd-7a216b7a9aed
2024-04-24T02:32:45,439  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:45,439  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_16e8f80c-bd61-4735-bcbd-7a216b7a9aed): drop table if exists nonAcidNonBucket
2024-04-24T02:32:45,439  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:45,442  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,442  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:45,442  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_16e8f80c-bd61-4735-bcbd-7a216b7a9aed); Time taken: 0.003 seconds
2024-04-24T02:32:45,442  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_16e8f80c-bd61-4735-bcbd-7a216b7a9aed
2024-04-24T02:32:45,447  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:32:45,454  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,454  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:32:45,454  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,454  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_1ab3cdae-573e-4633-ac55-a70730ccb941): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,457  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:32:45,457  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:32:45,458  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:45,458  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:45,464  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:32:45,465  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:45,466  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:45,466  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,466  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,466  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,466  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:32:45,467  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_1ab3cdae-573e-4633-ac55-a70730ccb941); Time taken: 0.012 seconds
2024-04-24T02:32:45,467  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023245_1ab3cdae-573e-4633-ac55-a70730ccb941
2024-04-24T02:32:45,467  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_1ab3cdae-573e-4633-ac55-a70730ccb941
2024-04-24T02:32:45,487  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_1ab3cdae-573e-4633-ac55-a70730ccb941 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:32:45,487  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:45,487  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_1ab3cdae-573e-4633-ac55-a70730ccb941): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,488  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,488  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951165, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, totalSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFiles=0, bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:45,494  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:32:45,528  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=40}
2024-04-24T02:32:45,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_1ab3cdae-573e-4633-ac55-a70730ccb941); Time taken: 0.041 seconds
2024-04-24T02:32:45,528  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_1ab3cdae-573e-4633-ac55-a70730ccb941
2024-04-24T02:32:45,533  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:32:45,539  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,539  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:32:45,540  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,540  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_cddf83f7-f882-4219-bbdb-46c6a25198ac): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,542  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:32:45,542  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:32:45,543  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:45,543  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:45,545  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:32:45,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:45,547  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:45,547  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,547  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,547  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,547  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:32:45,547  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_cddf83f7-f882-4219-bbdb-46c6a25198ac); Time taken: 0.007 seconds
2024-04-24T02:32:45,548  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023245_cddf83f7-f882-4219-bbdb-46c6a25198ac
2024-04-24T02:32:45,548  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_cddf83f7-f882-4219-bbdb-46c6a25198ac
2024-04-24T02:32:45,564  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_cddf83f7-f882-4219-bbdb-46c6a25198ac LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:32:45,564  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:45,565  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_cddf83f7-f882-4219-bbdb-46c6a25198ac): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,565  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,566  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951165, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:45,572  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:32:45,593  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,593  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=27}
2024-04-24T02:32:45,593  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_cddf83f7-f882-4219-bbdb-46c6a25198ac); Time taken: 0.028 seconds
2024-04-24T02:32:45,593  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_cddf83f7-f882-4219-bbdb-46c6a25198ac
2024-04-24T02:32:45,597  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:32:45,604  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,604  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:32:45,605  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,605  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_b44813b6-21f8-44ef-8378-6ac31d15429e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,607  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:32:45,608  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:32:45,608  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:45,608  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:45,610  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:32:45,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:45,612  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:45,612  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,612  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,612  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,612  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=2}
2024-04-24T02:32:45,612  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_b44813b6-21f8-44ef-8378-6ac31d15429e); Time taken: 0.007 seconds
2024-04-24T02:32:45,613  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023245_b44813b6-21f8-44ef-8378-6ac31d15429e
2024-04-24T02:32:45,613  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_b44813b6-21f8-44ef-8378-6ac31d15429e
2024-04-24T02:32:45,627  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_b44813b6-21f8-44ef-8378-6ac31d15429e LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:32:45,627  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:45,627  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_b44813b6-21f8-44ef-8378-6ac31d15429e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,627  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,628  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951165, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, rawDataSize=0, numRows=0, bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:45,633  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:32:45,647  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,647  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:45,648  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_b44813b6-21f8-44ef-8378-6ac31d15429e); Time taken: 0.02 seconds
2024-04-24T02:32:45,648  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_b44813b6-21f8-44ef-8378-6ac31d15429e
2024-04-24T02:32:45,652  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:32:45,658  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,658  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:32:45,659  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,659  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_e1e0bf5d-0690-4e57-819d-e3e6c4ab9633): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,662  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:32:45,663  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:32:45,663  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:45,663  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:45,666  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:32:45,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:45,668  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:45,668  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,668  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,668  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,668  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2}
2024-04-24T02:32:45,668  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_e1e0bf5d-0690-4e57-819d-e3e6c4ab9633); Time taken: 0.009 seconds
2024-04-24T02:32:45,668  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023245_e1e0bf5d-0690-4e57-819d-e3e6c4ab9633
2024-04-24T02:32:45,668  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_e1e0bf5d-0690-4e57-819d-e3e6c4ab9633
2024-04-24T02:32:45,685  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_e1e0bf5d-0690-4e57-819d-e3e6c4ab9633 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:32:45,685  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:45,685  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_e1e0bf5d-0690-4e57-819d-e3e6c4ab9633): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,686  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951165, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0, numFilesErasureCoded=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:45,692  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:32:45,705  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,705  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-24T02:32:45,706  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_e1e0bf5d-0690-4e57-819d-e3e6c4ab9633); Time taken: 0.02 seconds
2024-04-24T02:32:45,706  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_e1e0bf5d-0690-4e57-819d-e3e6c4ab9633
2024-04-24T02:32:45,710  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:32:45,716  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,716  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:32:45,717  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,717  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_6b36154c-8f9d-474e-bb0a-667f5065da66): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,719  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:32:45,720  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:32:45,720  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:45,720  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:45,723  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:32:45,723  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:45,724  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:45,724  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,724  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,724  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,725  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=3, flushCache_()=0, getValidWriteIds_(List, String)=3}
2024-04-24T02:32:45,725  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_6b36154c-8f9d-474e-bb0a-667f5065da66); Time taken: 0.007 seconds
2024-04-24T02:32:45,725  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023245_6b36154c-8f9d-474e-bb0a-667f5065da66
2024-04-24T02:32:45,725  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_6b36154c-8f9d-474e-bb0a-667f5065da66
2024-04-24T02:32:45,739  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_6b36154c-8f9d-474e-bb0a-667f5065da66 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:32:45,740  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:45,740  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_6b36154c-8f9d-474e-bb0a-667f5065da66): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:32:45,740  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,741  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/cd3ef49d-c822-4155-8d36-45fb6b127276/_tmp_space.db/072ebfcc-037a-45d7-b523-89a15a9b9b3c
2024-04-24T02:32:45,743  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,744  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:45,744  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_6b36154c-8f9d-474e-bb0a-667f5065da66); Time taken: 0.003 seconds
2024-04-24T02:32:45,744  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_6b36154c-8f9d-474e-bb0a-667f5065da66
2024-04-24T02:32:45,748  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:32:45,754  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,754  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:32:45,754  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,755  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_293d8436-3038-40b0-a605-169584a04036): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,757  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:32:45,757  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:32:45,757  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:45,757  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:45,760  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:32:45,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:45,761  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:45,761  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,761  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,762  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,762  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-24T02:32:45,762  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_293d8436-3038-40b0-a605-169584a04036); Time taken: 0.006 seconds
2024-04-24T02:32:45,762  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023245_293d8436-3038-40b0-a605-169584a04036
2024-04-24T02:32:45,762  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_293d8436-3038-40b0-a605-169584a04036
2024-04-24T02:32:45,777  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_293d8436-3038-40b0-a605-169584a04036 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:32:45,777  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:45,777  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_293d8436-3038-40b0-a605-169584a04036): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:32:45,777  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951165, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, transactional=false, numRows=0, numFilesErasureCoded=0, totalSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:32:45,783  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:32:45,796  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-24T02:32:45,797  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_293d8436-3038-40b0-a605-169584a04036); Time taken: 0.019 seconds
2024-04-24T02:32:45,797  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_293d8436-3038-40b0-a605-169584a04036
2024-04-24T02:32:45,801  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:32:45,807  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:45,807  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:32:45,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-24T02:32:45,808  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@12504c91, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@14de1929 will be shutdown
2024-04-24T02:32:45,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:32:45,808  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -10
2024-04-24T02:32:45,808  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T02:32:45,808  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023245_b29db652-140e-4953-a3f1-de3833d8f27a): drop table if exists T
2024-04-24T02:32:45,809  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T02:32:45,810  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:32:45,810  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T02:32:45,810  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@c768374, with PersistenceManager: null will be shutdown
2024-04-24T02:32:45,810  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@c768374, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1f60efb5 created in the thread with id: 1
2024-04-24T02:32:45,831  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@c768374 from thread id: 1
2024-04-24T02:32:45,831  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T02:32:45,831  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T02:32:45,833  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:32:45,834  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:32:45,834  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:45,854  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,854  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:45,854  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:45,854  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:45,854  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=20}
2024-04-24T02:32:45,854  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023245_b29db652-140e-4953-a3f1-de3833d8f27a); Time taken: 0.046 seconds
2024-04-24T02:32:45,855  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023245_b29db652-140e-4953-a3f1-de3833d8f27a
2024-04-24T02:32:45,855  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023245_b29db652-140e-4953-a3f1-de3833d8f27a
2024-04-24T02:32:45,874  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023245_b29db652-140e-4953-a3f1-de3833d8f27a LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:32:45,874  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:45,874  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023245_b29db652-140e-4953-a3f1-de3833d8f27a): drop table if exists T
2024-04-24T02:32:45,874  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:45,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:45,881  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,881  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:45,887  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:45,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T02:32:45,993  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t does not exist; Force to delete it.
2024-04-24T02:32:45,993 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:45,993  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:45,993  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=112}
2024-04-24T02:32:45,993  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023245_b29db652-140e-4953-a3f1-de3833d8f27a); Time taken: 0.119 seconds
2024-04-24T02:32:45,993  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023245_b29db652-140e-4953-a3f1-de3833d8f27a
2024-04-24T02:32:45,997  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:32:46,004  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:46,004  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:32:46,004  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) stored as orc
2024-04-24T02:32:46,004  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023246_4810f2d0-cc06-42c5-ae9b-8f4a707fab6b): create table T (a int, b int) stored as orc
2024-04-24T02:32:46,007  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:32:46,007  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:32:46,008  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:46,008  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:46,013  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T02:32:46,013  INFO [main] parse.CalcitePlanner: Automatically chose to make default.T acid.
2024-04-24T02:32:46,013  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:32:46,015  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:46,015  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:46,015  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:46,015  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:46,015  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, flushCache_()=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=5}
2024-04-24T02:32:46,015  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023246_4810f2d0-cc06-42c5-ae9b-8f4a707fab6b); Time taken: 0.011 seconds
2024-04-24T02:32:46,015  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023246_4810f2d0-cc06-42c5-ae9b-8f4a707fab6b
2024-04-24T02:32:46,016  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023246_4810f2d0-cc06-42c5-ae9b-8f4a707fab6b
2024-04-24T02:32:46,030  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023246_4810f2d0-cc06-42c5-ae9b-8f4a707fab6b LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:32:46,030  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:32:46,030  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023246_4810f2d0-cc06-42c5-ae9b-8f4a707fab6b): create table T (a int, b int) stored as orc
2024-04-24T02:32:46,030  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:46,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713951166, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, rawDataSize=0, numRows=0, totalSize=0, transactional_properties=default, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:32:46,036  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:46,066  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:46,066  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=35}
2024-04-24T02:32:46,066  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023246_4810f2d0-cc06-42c5-ae9b-8f4a707fab6b); Time taken: 0.036 seconds
2024-04-24T02:32:46,066  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023246_4810f2d0-cc06-42c5-ae9b-8f4a707fab6b
2024-04-24T02:32:46,071  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:32:46,077  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:46,077  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:32:46,078  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into T values(1,2)
2024-04-24T02:32:46,078  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6): insert into T values(1,2)
2024-04-24T02:32:46,087  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T02:32:46,087  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:32:46,089  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:32:46,089  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:32:46,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:46,102  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:46,102  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:46,102  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:46,102  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:46,102  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:46,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:46,109  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:46,109  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:46,109  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:46,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:46,200  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:46,200  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:46,200  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:32:46,200  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:32:46,202  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:32:46,202  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:46,202  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:32:46,203  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:46,210  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:46,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-24T02:32:46,213  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-24T02:32:46,223  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 15
2024-04-24T02:32:46,223  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [15])
2024-04-24T02:32:46,224  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:32:46,226  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:32:46,227  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:32:46,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:46,241  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:46,241  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:32:46,241  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:32:46,241  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:46,241  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:32:46,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:46,242  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=31, allocateTableWriteId_(long, String, String)=9, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=2, openTxn_(String, TxnType)=9, commitTxn_(CommitTxnRequest)=12, getAllTableConstraints_(AllTableConstraintsRequest)=27, getCheckConstraints_(CheckConstraintsRequest)=2}
2024-04-24T02:32:46,242  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6); Time taken: 0.163 seconds
2024-04-24T02:32:46,242  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6
2024-04-24T02:32:46,242  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6
2024-04-24T02:32:46,263  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:32:46,264  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:32:46,267  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6): insert into T values(1,2)
2024-04-24T02:32:46,267  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6
2024-04-24T02:32:46,267  INFO [main] ql.Driver: Query ID = alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6
Total jobs = 1
2024-04-24T02:32:46,267  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:32:46,267  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:32:46,411  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:32:46,411  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:32:46,413  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:32:46,413  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:32:46,413  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cd3ef49d-c822-4155-8d36-45fb6b127276/hive_2024-04-24_02-32-46_078_1953508318327312773-1/dummy_path
2024-04-24T02:32:46,422  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:32:46,423  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,35KB
2024-04-24T02:32:46,423  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:46,427  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cd3ef49d-c822-4155-8d36-45fb6b127276/hive_2024-04-24_02-32-46_078_1953508318327312773-1/-mr-10000
2024-04-24T02:32:46,429  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:32:46,436  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:32:46,440  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:32:46,441  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:32:46,441  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:32:46,441  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cd3ef49d-c822-4155-8d36-45fb6b127276/hive_2024-04-24_02-32-46_078_1953508318327312773-1/dummy_path
2024-04-24T02:32:46,442  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:32:46,458  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:32:46,476  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local58780850_0048
2024-04-24T02:32:46,476  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:32:46,536  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:32:46,537  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:32:46,537  INFO [Thread-3990] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:46,537  INFO [Thread-3990] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:32:46,538  INFO [Thread-3990] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:32:46,538  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local58780850_0048_m_000000_0
2024-04-24T02:32:46,541  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:32:46,542  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cd3ef49d-c822-4155-8d36-45fb6b127276/hive_2024-04-24_02-32-46_078_1953508318327312773-1/dummy_path/null:0+1
2024-04-24T02:32:46,544  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:32:46,544  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,35KB
2024-04-24T02:32:46,544  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T02:32:46,546  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:32:46,546  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:32:46,547  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:32:46,547  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:32:46,547  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:32:46,547  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:32:46,547  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:32:46,547  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:32:46,547  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:32:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local58780850_0048/job_local58780850_0048.xml], properties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@580d1307
2024-04-24T02:32:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:46,548  INFO [LocalJobRunner Map Task Executor #0] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:32:46,550  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:46,550  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:32:46,557  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:32:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:32:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:32:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:32:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-24T02:32:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:32:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:32:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:32:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:32:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:32:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:1, 
2024-04-24T02:32:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:32:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:1, 
2024-04-24T02:32:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:32:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:32:46,563  INFO [LocalJobRunner Map Task Executor #0] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:32:46,575  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_1_default.t:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_4:1, 
2024-04-24T02:32:46,575  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:32:46,577  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local58780850_0048_m_000000_0 is done. And is in the process of committing
2024-04-24T02:32:46,578  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:32:46,578  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local58780850_0048_m_000000_0' done.
2024-04-24T02:32:46,578  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local58780850_0048_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=1023212
		FILE: Number of bytes written=56537894
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1304428544
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.t=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	File Input Format Counters 
		Bytes Read=5403
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:32:46,578  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local58780850_0048_m_000000_0
2024-04-24T02:32:46,578  INFO [Thread-3990] mapred.LocalJobRunner: map task executor complete.
2024-04-24 02:32:47,538 Stage-1 map = 100%,  reduce = 0%
2024-04-24T02:32:47,538  INFO [main] exec.Task: 2024-04-24 02:32:47,538 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local58780850_0048
2024-04-24T02:32:47,538  INFO [main] exec.Task: Ended Job = job_local58780850_0048
2024-04-24T02:32:47,539  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:32:47,539  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:32:47,539  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t/_tmp.delta_0000001_0000001_0000
2024-04-24T02:32:47,540  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.t
2024-04-24T02:32:47,540  INFO [main] exec.Task: Loading data to table default.t from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/t
2024-04-24T02:32:47,541  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:47,548  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:47,554  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-24T02:32:47,579  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:32:47,579  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:47,586  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,586  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:32:47,586  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cd3ef49d-c822-4155-8d36-45fb6b127276/hive_2024-04-24_02-32-46_078_1953508318327312773-1/-mr-10000
2024-04-24T02:32:47,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:47,594  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,603  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:32:47,603  INFO [main] FileOperations: Read stats for default.t/, numRows, true, 1, false: 
2024-04-24T02:32:47,603  INFO [main] FileOperations: Read stats for default.t/, rawDataSize, true, 0, false: 
2024-04-24T02:32:47,603  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-24T02:32:47,626  INFO [main] FileOperations: Read stats for default.t/, insertCount, true, 1, false: 
2024-04-24T02:32:47,626  INFO [main] FileOperations: Read stats for default.t/, updateCount, true, 0, false: 
2024-04-24T02:32:47,626  INFO [main] FileOperations: Read stats for default.t/, deleteCount, true, 0, false: 
2024-04-24T02:32:47,628  INFO [main] stats.BasicStatsTask: Table default.t stats: [numFiles=1, numRows=1, totalSize=666, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:32:47,628  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:47,628  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, getTable_(GetTableRequest)=28, isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=47}
MapReduce Jobs Launched: 
2024-04-24T02:32:47,628  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:32:47,629  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:47,629  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:32:47,629  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6); Time taken: 1.362 seconds
2024-04-24T02:32:47,629  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023246_5bf4aad9-e7a9-45f6-8111-b37a0ace81d6
2024-04-24T02:32:47,640  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:47,640  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:32:47,640  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update T set a=3 where b=2
2024-04-24T02:32:47,641  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cd3ef49d-c822-4155-8d36-45fb6b127276/hive_2024-04-24_02-32-46_078_1953508318327312773-1
2024-04-24T02:32:47,641  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cd3ef49d-c822-4155-8d36-45fb6b127276/hive_2024-04-24_02-32-46_078_1953508318327312773-1 on fs with scheme file
2024-04-24T02:32:47,641  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023247_a9293b7d-841a-4410-ba0e-7b501eea0ae3): update T set a=3 where b=2
2024-04-24T02:32:47,644  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-24T02:32:47,644  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:32:47,645  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:32:47,645  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:47,651  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,652  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update T set a=3 where b=2> as 
<insert into table `default`.`T` select ROW__ID,`a`,`b` from `default`.`T` sort by ROW__ID >
2024-04-24T02:32:47,652  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:32:47,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:47,662  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,662  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:32:47,662  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:47,662  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:47,669  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,669  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:47,669  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:47,669  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:47,675  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,676  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:32:47,676  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:32:47,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T02:32:47,695  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-24T02:32:47,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-24T02:32:47,718  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [1], allowMissingStats: true
2024-04-24T02:32:47,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:47,728  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,728  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T02:32:47,737  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.t	
2024-04-24T02:32:47,747  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b
No Stats for default@t, Columns: b
2024-04-24T02:32:47,747  INFO [main] SessionState: No Stats for default@t, Columns: b
2024-04-24T02:32:47,808  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:32:47,809  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:32:47,809  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:32:47,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T02:32:47,816  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,819 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:32:47,820 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:32:47,820  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:32:47,820 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:32:47,820  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:47,820  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=33, getTableColumnStatistics_(String, String, List, String)=29, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=5, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-24T02:32:47,821  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023247_a9293b7d-841a-4410-ba0e-7b501eea0ae3); Time taken: 0.179 seconds
2024-04-24T02:32:47,821  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:32:47,825  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:47,834  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:32:47,834  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023247_6d653681-72b6-4782-81c3-2d26cd615a51): drop table if exists acidTbl
2024-04-24T02:32:47,837  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-24T02:32:47,837  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:32:47,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:47,844  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,844  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:47,844  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:47,844  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:47,844  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=13, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=7, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T02:32:47,844  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023247_6d653681-72b6-4782-81c3-2d26cd615a51); Time taken: 0.01 seconds
2024-04-24T02:32:47,845  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023247_6d653681-72b6-4782-81c3-2d26cd615a51
2024-04-24T02:32:47,845  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023247_6d653681-72b6-4782-81c3-2d26cd615a51
2024-04-24T02:32:47,862  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023247_6d653681-72b6-4782-81c3-2d26cd615a51 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:32:47,862  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:47,862  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023247_6d653681-72b6-4782-81c3-2d26cd615a51): drop table if exists acidTbl
2024-04-24T02:32:47,862  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:47,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:47,869  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,870  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:47,876  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:47,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:32:47,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:47,990  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=121}
2024-04-24T02:32:47,990  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023247_6d653681-72b6-4782-81c3-2d26cd615a51); Time taken: 0.128 seconds
2024-04-24T02:32:47,990  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023247_6d653681-72b6-4782-81c3-2d26cd615a51
2024-04-24T02:32:47,995  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:32:48,001  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:48,003  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:32:48,003  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:32:48,004  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023248_0bcdbdfa-d568-4480-9c14-b6ad8158da7e): drop table if exists acidTblPart
2024-04-24T02:32:48,012  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-24T02:32:48,013  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:32:48,015  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:48,036  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,037  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:48,037  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:48,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:48,037  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=9, getTable_(GetTableRequest)=21}
2024-04-24T02:32:48,037  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023248_0bcdbdfa-d568-4480-9c14-b6ad8158da7e); Time taken: 0.033 seconds
2024-04-24T02:32:48,037  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023248_0bcdbdfa-d568-4480-9c14-b6ad8158da7e
2024-04-24T02:32:48,038  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023248_0bcdbdfa-d568-4480-9c14-b6ad8158da7e
2024-04-24T02:32:48,053  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023248_0bcdbdfa-d568-4480-9c14-b6ad8158da7e LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:32:48,053  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:48,053  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023248_0bcdbdfa-d568-4480-9c14-b6ad8158da7e): drop table if exists acidTblPart
2024-04-24T02:32:48,053  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:48,053  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:48,059  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:48,066  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,066  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:32:48,104  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:48,104  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=44, getTable_(GetTableRequest)=7}
2024-04-24T02:32:48,105  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023248_0bcdbdfa-d568-4480-9c14-b6ad8158da7e); Time taken: 0.051 seconds
2024-04-24T02:32:48,105  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023248_0bcdbdfa-d568-4480-9c14-b6ad8158da7e
2024-04-24T02:32:48,109  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:32:48,115  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:48,115  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:32:48,116  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:32:48,116  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023248_f5ef38d7-8204-4e3c-98b9-8d7a91bd153d): drop table if exists acidTbl2
2024-04-24T02:32:48,118  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-24T02:32:48,118  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:32:48,119  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:48,119  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:48,119  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:48,119  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=0}
2024-04-24T02:32:48,119  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023248_f5ef38d7-8204-4e3c-98b9-8d7a91bd153d); Time taken: 0.003 seconds
2024-04-24T02:32:48,119  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023248_f5ef38d7-8204-4e3c-98b9-8d7a91bd153d
2024-04-24T02:32:48,120  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:32:48,120  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023248_f5ef38d7-8204-4e3c-98b9-8d7a91bd153d): drop table if exists acidTbl2
2024-04-24T02:32:48,120  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:48,120  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:32:48,120  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:48,120  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-24T02:32:48,121  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023248_f5ef38d7-8204-4e3c-98b9-8d7a91bd153d); Time taken: 0.0 seconds
2024-04-24T02:32:48,121  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023248_f5ef38d7-8204-4e3c-98b9-8d7a91bd153d
2024-04-24T02:32:48,126  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:32:48,133  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:48,133  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:32:48,133  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:32:48,133  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023248_82675375-b634-4e67-aeec-956bd334e8cf): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:48,135  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-24T02:32:48,136  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:32:48,136  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:48,157  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,157  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:48,158  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:48,158  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:48,158  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=21, flushCache_()=0}
2024-04-24T02:32:48,158  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023248_82675375-b634-4e67-aeec-956bd334e8cf); Time taken: 0.025 seconds
2024-04-24T02:32:48,158  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023248_82675375-b634-4e67-aeec-956bd334e8cf
2024-04-24T02:32:48,159  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023248_82675375-b634-4e67-aeec-956bd334e8cf
2024-04-24T02:32:48,174  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023248_82675375-b634-4e67-aeec-956bd334e8cf LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:32:48,174  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:48,175  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023248_82675375-b634-4e67-aeec-956bd334e8cf): drop table if exists nonAcidOrcTbl
2024-04-24T02:32:48,175  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:48,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:48,183  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,183  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:48,191  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,191  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:32:48,245  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:48,245  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=62, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-24T02:32:48,245  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023248_82675375-b634-4e67-aeec-956bd334e8cf); Time taken: 0.071 seconds
2024-04-24T02:32:48,245  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023248_82675375-b634-4e67-aeec-956bd334e8cf
2024-04-24T02:32:48,249  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:32:48,256  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:48,256  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:32:48,257  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:48,257  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023248_ac3f40a3-8729-4eea-808e-ab4ec460220b): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:48,261  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-24T02:32:48,261  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:32:48,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:48,271  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,271  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:48,271  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:48,271  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:48,271  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=9}
2024-04-24T02:32:48,271  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023248_ac3f40a3-8729-4eea-808e-ab4ec460220b); Time taken: 0.014 seconds
2024-04-24T02:32:48,271  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023248_ac3f40a3-8729-4eea-808e-ab4ec460220b
2024-04-24T02:32:48,272  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023248_ac3f40a3-8729-4eea-808e-ab4ec460220b
2024-04-24T02:32:48,286  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023248_ac3f40a3-8729-4eea-808e-ab4ec460220b LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:32:48,286  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:48,286  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023248_ac3f40a3-8729-4eea-808e-ab4ec460220b): drop table if exists nonAcidOrcTbl2
2024-04-24T02:32:48,287  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:48,287  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:48,295  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,295  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:48,303  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,303  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:32:48,334  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:48,335  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=39, isCompatibleWith_(Configuration)=0}
2024-04-24T02:32:48,335  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023248_ac3f40a3-8729-4eea-808e-ab4ec460220b); Time taken: 0.048 seconds
2024-04-24T02:32:48,335  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023248_ac3f40a3-8729-4eea-808e-ab4ec460220b
2024-04-24T02:32:48,339  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:32:48,347  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:48,347  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:32:48,348  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:32:48,348  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023248_cd6f8b00-68be-400a-90a1-0e0bd7ec2d99): drop table if exists nonAcidNonBucket
2024-04-24T02:32:48,350  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 16
2024-04-24T02:32:48,351  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T02:32:48,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:48,360  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,360  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:32:48,360  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:32:48,360  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:32:48,360  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=9, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T02:32:48,361  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023248_cd6f8b00-68be-400a-90a1-0e0bd7ec2d99); Time taken: 0.012 seconds
2024-04-24T02:32:48,361  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424023248_cd6f8b00-68be-400a-90a1-0e0bd7ec2d99
2024-04-24T02:32:48,361  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023248_cd6f8b00-68be-400a-90a1-0e0bd7ec2d99
2024-04-24T02:32:48,377  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023248_cd6f8b00-68be-400a-90a1-0e0bd7ec2d99 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T02:32:48,377  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:32:48,377  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023248_cd6f8b00-68be-400a-90a1-0e0bd7ec2d99): drop table if exists nonAcidNonBucket
2024-04-24T02:32:48,377  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:32:48,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:48,385  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:48,394  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:32:48,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:32:48,427  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:32:48,427  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=42, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-24T02:32:48,428  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023248_cd6f8b00-68be-400a-90a1-0e0bd7ec2d99); Time taken: 0.05 seconds
2024-04-24T02:32:48,428  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023248_cd6f8b00-68be-400a-90a1-0e0bd7ec2d99
2024-04-24T02:32:48,432  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T02:32:48,440  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T02:32:48,440  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T02:32:48,441  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testReadMyOwnInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.853"/>
  <testcase name="testAddAndDropPartitionAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.715"/>
  <testcase name="testImplicitRollback" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.777"/>
  <testcase name="testTruncateWithBase" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="3.22"/>
  <testcase name="exchangePartition" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.399"/>
  <testcase name="testTruncateWithBaseOnePartition" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.62"/>
  <testcase name="testParallelInsertAnalyzeStats" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="9.42"/>
  <testcase name="testDDLsAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.358"/>
  <testcase name="testTruncateWithBaseAllPartition" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.734"/>
  <testcase name="testTimeOutReaper" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.363">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where a = 5 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:33:29,602  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:33:29,605  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 6ccd320a-8363-4c1d-b762-f8cc1586a3ab
2024-04-24T02:33:29,607  INFO [main] SessionState: Hive Session ID = 6ccd320a-8363-4c1d-b762-f8cc1586a3ab
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:29,608  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:29,613  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6ccd320a-8363-4c1d-b762-f8cc1586a3ab
2024-04-24T02:33:29,616  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6ccd320a-8363-4c1d-b762-f8cc1586a3ab
2024-04-24T02:33:29,618  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6ccd320a-8363-4c1d-b762-f8cc1586a3ab/_tmp_space.db
2024-04-24T02:33:29,619  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=6ccd320a-8363-4c1d-b762-f8cc1586a3ab, clientType=HIVECLI]
2024-04-24T02:33:29,619  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:29,619  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_28e05a30-f68a-4bce-a31d-dd18be871c09): drop table if exists acidTbl
2024-04-24T02:33:29,628  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:33:29,628  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:33:29,630  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:29,634  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,634  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,634  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,634  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=9, commitTxn_(CommitTxnRequest)=8, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, flushCache_()=0}
2024-04-24T02:33:29,634  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_28e05a30-f68a-4bce-a31d-dd18be871c09); Time taken: 0.015 seconds
2024-04-24T02:33:29,634  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023329_28e05a30-f68a-4bce-a31d-dd18be871c09
2024-04-24T02:33:29,634  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:29,634  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_28e05a30-f68a-4bce-a31d-dd18be871c09): drop table if exists acidTbl
2024-04-24T02:33:29,634  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:29,638  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,638  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:29,638  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_28e05a30-f68a-4bce-a31d-dd18be871c09); Time taken: 0.004 seconds
2024-04-24T02:33:29,638  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_28e05a30-f68a-4bce-a31d-dd18be871c09
2024-04-24T02:33:29,643  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:33:29,648  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,648  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:33:29,649  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:29,649  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_11574d98-0864-4b0a-b41b-744f3c3cc8f0): drop table if exists acidTblPart
2024-04-24T02:33:29,651  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:33:29,651  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:33:29,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:29,654  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,654  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,654  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,654  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:33:29,655  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_11574d98-0864-4b0a-b41b-744f3c3cc8f0); Time taken: 0.005 seconds
2024-04-24T02:33:29,655  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023329_11574d98-0864-4b0a-b41b-744f3c3cc8f0
2024-04-24T02:33:29,655  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:29,655  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_11574d98-0864-4b0a-b41b-744f3c3cc8f0): drop table if exists acidTblPart
2024-04-24T02:33:29,655  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:29,658  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,658  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:29,658  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_11574d98-0864-4b0a-b41b-744f3c3cc8f0); Time taken: 0.003 seconds
2024-04-24T02:33:29,658  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_11574d98-0864-4b0a-b41b-744f3c3cc8f0
2024-04-24T02:33:29,663  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:33:29,668  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,668  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:33:29,668  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:29,668  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_04fac485-92a6-4da3-9cfb-3a6166154b1a): drop table if exists acidTbl2
2024-04-24T02:33:29,670  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:33:29,670  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:33:29,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:29,673  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,673  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,674  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,674  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:29,674  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_04fac485-92a6-4da3-9cfb-3a6166154b1a); Time taken: 0.006 seconds
2024-04-24T02:33:29,674  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023329_04fac485-92a6-4da3-9cfb-3a6166154b1a
2024-04-24T02:33:29,674  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:29,674  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_04fac485-92a6-4da3-9cfb-3a6166154b1a): drop table if exists acidTbl2
2024-04-24T02:33:29,674  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:29,677  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,677  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:29,677  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_04fac485-92a6-4da3-9cfb-3a6166154b1a); Time taken: 0.003 seconds
2024-04-24T02:33:29,678  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_04fac485-92a6-4da3-9cfb-3a6166154b1a
2024-04-24T02:33:29,682  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:33:29,687  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,687  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:33:29,688  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:29,688  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_0b6a69c0-9034-4896-bae6-adb1696c1f15): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:29,690  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:33:29,691  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:33:29,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:29,695  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,695  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,695  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,695  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-24T02:33:29,695  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_0b6a69c0-9034-4896-bae6-adb1696c1f15); Time taken: 0.007 seconds
2024-04-24T02:33:29,695  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023329_0b6a69c0-9034-4896-bae6-adb1696c1f15
2024-04-24T02:33:29,695  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:29,695  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_0b6a69c0-9034-4896-bae6-adb1696c1f15): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:29,696  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:29,699  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,699  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:29,699  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_0b6a69c0-9034-4896-bae6-adb1696c1f15); Time taken: 0.004 seconds
2024-04-24T02:33:29,699  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_0b6a69c0-9034-4896-bae6-adb1696c1f15
2024-04-24T02:33:29,704  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:33:29,709  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,709  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:33:29,709  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:29,709  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_e7edaae5-4a15-4bf2-a412-f7e8d7dfd569): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:29,712  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:33:29,712  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:33:29,712  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:29,715  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,715  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,715  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,716  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:29,716  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_e7edaae5-4a15-4bf2-a412-f7e8d7dfd569); Time taken: 0.006 seconds
2024-04-24T02:33:29,716  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023329_e7edaae5-4a15-4bf2-a412-f7e8d7dfd569
2024-04-24T02:33:29,716  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:29,716  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_e7edaae5-4a15-4bf2-a412-f7e8d7dfd569): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:29,716  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,716  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:29,720  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,720  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:29,720  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_e7edaae5-4a15-4bf2-a412-f7e8d7dfd569); Time taken: 0.003 seconds
2024-04-24T02:33:29,720  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_e7edaae5-4a15-4bf2-a412-f7e8d7dfd569
2024-04-24T02:33:29,725  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:33:29,731  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,732  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:33:29,732  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:29,732  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_e00a4c0c-7a3f-4a53-b6f1-c54d5812bfd0): drop table if exists nonAcidNonBucket
2024-04-24T02:33:29,734  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:33:29,735  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:33:29,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:29,738  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,738  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,738  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,738  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:29,738  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_e00a4c0c-7a3f-4a53-b6f1-c54d5812bfd0); Time taken: 0.006 seconds
2024-04-24T02:33:29,738  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023329_e00a4c0c-7a3f-4a53-b6f1-c54d5812bfd0
2024-04-24T02:33:29,738  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:29,738  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_e00a4c0c-7a3f-4a53-b6f1-c54d5812bfd0): drop table if exists nonAcidNonBucket
2024-04-24T02:33:29,738  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:29,741  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,741  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:29,742  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_e00a4c0c-7a3f-4a53-b6f1-c54d5812bfd0); Time taken: 0.003 seconds
2024-04-24T02:33:29,742  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_e00a4c0c-7a3f-4a53-b6f1-c54d5812bfd0
2024-04-24T02:33:29,746  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:33:29,751  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,751  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:33:29,752  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,752  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_0bc4ee86-2592-4ed9-abca-3bf54703b695): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,754  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:33:29,754  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:33:29,754  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:29,754  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:29,759  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:33:29,759  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:29,761  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:29,761  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,761  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,761  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,761  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=2, getValidWriteIds_(List, String)=5, flushCache_()=0}
2024-04-24T02:33:29,761  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_0bc4ee86-2592-4ed9-abca-3bf54703b695); Time taken: 0.009 seconds
2024-04-24T02:33:29,761  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023329_0bc4ee86-2592-4ed9-abca-3bf54703b695
2024-04-24T02:33:29,762  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023329_0bc4ee86-2592-4ed9-abca-3bf54703b695
2024-04-24T02:33:29,777  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023329_0bc4ee86-2592-4ed9-abca-3bf54703b695 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:33:29,777  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:29,778  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_0bc4ee86-2592-4ed9-abca-3bf54703b695): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,778  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,779  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951209, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFilesErasureCoded=0, transactional=true, totalSize=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:29,785  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:29,818  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,818  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=38, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:29,818  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_0bc4ee86-2592-4ed9-abca-3bf54703b695); Time taken: 0.04 seconds
2024-04-24T02:33:29,818  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_0bc4ee86-2592-4ed9-abca-3bf54703b695
2024-04-24T02:33:29,821  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:33:29,826  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,826  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:33:29,827  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,827  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_d59455a2-982e-4c1f-aeb6-38582e1fac83): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,829  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:33:29,829  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:33:29,830  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:29,830  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:29,832  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:33:29,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:29,834  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:29,834  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,834  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,834  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,835  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, flushCache_()=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=1}
2024-04-24T02:33:29,835  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_d59455a2-982e-4c1f-aeb6-38582e1fac83); Time taken: 0.007 seconds
2024-04-24T02:33:29,835  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023329_d59455a2-982e-4c1f-aeb6-38582e1fac83
2024-04-24T02:33:29,835  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023329_d59455a2-982e-4c1f-aeb6-38582e1fac83
2024-04-24T02:33:29,848  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023329_d59455a2-982e-4c1f-aeb6-38582e1fac83 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:33:29,848  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:29,848  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_d59455a2-982e-4c1f-aeb6-38582e1fac83): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,848  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,849  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951209, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:29,854  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:33:29,868  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,868  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-24T02:33:29,868  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_d59455a2-982e-4c1f-aeb6-38582e1fac83); Time taken: 0.02 seconds
2024-04-24T02:33:29,868  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_d59455a2-982e-4c1f-aeb6-38582e1fac83
2024-04-24T02:33:29,871  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:33:29,876  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,876  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:33:29,877  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:29,877  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_4f259404-5b9a-4a37-8d41-d4f10141d46d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:29,879  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:33:29,879  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:33:29,879  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:29,879  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:29,881  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:33:29,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:29,883  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:29,883  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,883  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,883  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,883  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=1, getDatabase_(String)=2}
2024-04-24T02:33:29,883  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_4f259404-5b9a-4a37-8d41-d4f10141d46d); Time taken: 0.006 seconds
2024-04-24T02:33:29,884  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023329_4f259404-5b9a-4a37-8d41-d4f10141d46d
2024-04-24T02:33:29,884  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023329_4f259404-5b9a-4a37-8d41-d4f10141d46d
2024-04-24T02:33:29,896  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023329_4f259404-5b9a-4a37-8d41-d4f10141d46d LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:33:29,896  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:29,896  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_4f259404-5b9a-4a37-8d41-d4f10141d46d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:29,896  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,897  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951209, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFilesErasureCoded=0, bucketing_version=2, transactional=false, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:29,903  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:33:29,916  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=18}
2024-04-24T02:33:29,916  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_4f259404-5b9a-4a37-8d41-d4f10141d46d); Time taken: 0.02 seconds
2024-04-24T02:33:29,916  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_4f259404-5b9a-4a37-8d41-d4f10141d46d
2024-04-24T02:33:29,920  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:33:29,926  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,926  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:33:29,926  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:29,926  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_481299af-926f-421f-9db6-d35f463030ac): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:29,928  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:33:29,928  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:33:29,929  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:29,929  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:29,931  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:33:29,931  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:29,933  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:29,933  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,933  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,933  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,933  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=1, getValidWriteIds_(List, String)=2}
2024-04-24T02:33:29,933  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_481299af-926f-421f-9db6-d35f463030ac); Time taken: 0.007 seconds
2024-04-24T02:33:29,933  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023329_481299af-926f-421f-9db6-d35f463030ac
2024-04-24T02:33:29,934  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023329_481299af-926f-421f-9db6-d35f463030ac
2024-04-24T02:33:29,946  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023329_481299af-926f-421f-9db6-d35f463030ac LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:33:29,946  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:29,946  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_481299af-926f-421f-9db6-d35f463030ac): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:29,946  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,947  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951209, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFilesErasureCoded=0, rawDataSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFiles=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:29,952  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:33:29,966  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,966  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-24T02:33:29,966  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_481299af-926f-421f-9db6-d35f463030ac); Time taken: 0.02 seconds
2024-04-24T02:33:29,966  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_481299af-926f-421f-9db6-d35f463030ac
2024-04-24T02:33:29,970  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:33:29,975  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:29,975  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:33:29,975  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,975  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023329_5b968361-671e-44bb-a460-28e021106746): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,977  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:33:29,977  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:33:29,978  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:29,978  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:29,980  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:33:29,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:29,981  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:29,981  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:29,982  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:29,982  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:29,982  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=1}
2024-04-24T02:33:29,982  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023329_5b968361-671e-44bb-a460-28e021106746); Time taken: 0.007 seconds
2024-04-24T02:33:29,982  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023329_5b968361-671e-44bb-a460-28e021106746
2024-04-24T02:33:29,982  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023329_5b968361-671e-44bb-a460-28e021106746
2024-04-24T02:33:29,995  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023329_5b968361-671e-44bb-a460-28e021106746 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:33:29,995  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:29,995  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023329_5b968361-671e-44bb-a460-28e021106746): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:29,995  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:29,996  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6ccd320a-8363-4c1d-b762-f8cc1586a3ab/_tmp_space.db/c4bb0af5-f96e-444b-bb15-ad98b4eb27b8
2024-04-24T02:33:29,999  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:29,999  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-24T02:33:29,999  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023329_5b968361-671e-44bb-a460-28e021106746); Time taken: 0.004 seconds
2024-04-24T02:33:29,999  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023329_5b968361-671e-44bb-a460-28e021106746
2024-04-24T02:33:30,002  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:33:30,007  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,007  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:33:30,008  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:30,008  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_2d01cf30-8c9b-4981-bb45-d59a476dd6ed): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:30,010  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:33:30,010  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:33:30,010  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:30,010  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:30,012  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:33:30,012  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:30,014  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:30,014  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,014  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,014  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,014  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2}
2024-04-24T02:33:30,014  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_2d01cf30-8c9b-4981-bb45-d59a476dd6ed); Time taken: 0.006 seconds
2024-04-24T02:33:30,014  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023330_2d01cf30-8c9b-4981-bb45-d59a476dd6ed
2024-04-24T02:33:30,015  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023330_2d01cf30-8c9b-4981-bb45-d59a476dd6ed
2024-04-24T02:33:30,027  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023330_2d01cf30-8c9b-4981-bb45-d59a476dd6ed LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:33:30,027  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:30,027  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_2d01cf30-8c9b-4981-bb45-d59a476dd6ed): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:30,027  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:30,028  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951210, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numRows=0, totalSize=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:30,033  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:33:30,046  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:30,046  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:30,046  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_2d01cf30-8c9b-4981-bb45-d59a476dd6ed); Time taken: 0.019 seconds
2024-04-24T02:33:30,046  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_2d01cf30-8c9b-4981-bb45-d59a476dd6ed
2024-04-24T02:33:30,050  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:33:30,054  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,054  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:33:30,055  INFO [main] ql.TxnCommandsBaseForTests: Running the query: start transaction
2024-04-24T02:33:30,055  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_b8c044fe-dd41-482a-b6e8-57921503f891): start transaction
2024-04-24T02:33:30,057  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:33:30,057  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:33:30,057  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:30,058  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:30,058  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:30,058  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,058  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,058  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,058  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, flushCache_()=0}
2024-04-24T02:33:30,058  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_b8c044fe-dd41-482a-b6e8-57921503f891); Time taken: 0.003 seconds
2024-04-24T02:33:30,058  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023330_b8c044fe-dd41-482a-b6e8-57921503f891
2024-04-24T02:33:30,058  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-24T02:33:30,058  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_b8c044fe-dd41-482a-b6e8-57921503f891): start transaction
2024-04-24T02:33:30,058  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:30,059  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T02:33:30,059  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_b8c044fe-dd41-482a-b6e8-57921503f891); Time taken: 0.0 seconds
2024-04-24T02:33:30,059  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where a = 5
2024-04-24T02:33:30,059  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_cdec5bde-bbdd-4b80-855e-74e35a743a30): delete from acidTbl where a = 5
2024-04-24T02:33:30,060  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:33:30,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:30,077  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,077  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where a = 5> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-24T02:33:30,077  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:33:30,082  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:30,082  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:30,082  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:30,089  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,089  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:30,089  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:30,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:30,096  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,096  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:30,096  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:30,108  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:30,171  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:33:30,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:30,186  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,187  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:30,201  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:33:30,216  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-24T02:33:30,216  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-24T02:33:30,275  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:30,275  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:30,275  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:30,275  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:30,282  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,284 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:33:30,285 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:33:30,285  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:33:30,286 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:33:30,286  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,286  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=44, isCompatibleWith_(Configuration)=0, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=31, getTable_(GetTableRequest)=38, getValidWriteIds_(List, String)=5}
2024-04-24T02:33:30,287  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_cdec5bde-bbdd-4b80-855e-74e35a743a30); Time taken: 0.227 seconds
2024-04-24T02:33:30,287  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_b8c044fe-dd41-482a-b6e8-57921503f891
2024-04-24T02:33:30,290  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,296  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:30,296  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_30a1ada9-29db-4a53-9173-948753f91013): drop table if exists acidTbl
2024-04-24T02:33:30,298  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:33:30,298  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:33:30,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:30,305  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,305  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,305  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,305  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,305  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=6, flushCache_()=0}
2024-04-24T02:33:30,305  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_30a1ada9-29db-4a53-9173-948753f91013); Time taken: 0.009 seconds
2024-04-24T02:33:30,306  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023330_30a1ada9-29db-4a53-9173-948753f91013
2024-04-24T02:33:30,306  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023330_30a1ada9-29db-4a53-9173-948753f91013
2024-04-24T02:33:30,323  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023330_30a1ada9-29db-4a53-9173-948753f91013 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:33:30,323  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:30,323  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_30a1ada9-29db-4a53-9173-948753f91013): drop table if exists acidTbl
2024-04-24T02:33:30,323  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:30,323  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:30,329  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:30,335  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,336  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:30,432  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:30,432  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=103}
2024-04-24T02:33:30,433  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_30a1ada9-29db-4a53-9173-948753f91013); Time taken: 0.109 seconds
2024-04-24T02:33:30,433  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_30a1ada9-29db-4a53-9173-948753f91013
2024-04-24T02:33:30,436  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:33:30,442  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,442  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:33:30,442  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:30,443  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_e0392242-8b0a-4322-a191-6e9f5c23c651): drop table if exists acidTblPart
2024-04-24T02:33:30,444  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T02:33:30,445  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:33:30,445  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:30,452  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,452  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,452  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,452  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,452  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:30,452  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_e0392242-8b0a-4322-a191-6e9f5c23c651); Time taken: 0.009 seconds
2024-04-24T02:33:30,452  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023330_e0392242-8b0a-4322-a191-6e9f5c23c651
2024-04-24T02:33:30,453  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023330_e0392242-8b0a-4322-a191-6e9f5c23c651
2024-04-24T02:33:30,466  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023330_e0392242-8b0a-4322-a191-6e9f5c23c651 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:33:30,466  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:30,466  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_e0392242-8b0a-4322-a191-6e9f5c23c651): drop table if exists acidTblPart
2024-04-24T02:33:30,466  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:30,466  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:30,473  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,473  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:30,479  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,479  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:30,518  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:30,518  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=45}
2024-04-24T02:33:30,518  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_e0392242-8b0a-4322-a191-6e9f5c23c651); Time taken: 0.052 seconds
2024-04-24T02:33:30,518  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_e0392242-8b0a-4322-a191-6e9f5c23c651
2024-04-24T02:33:30,522  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T02:33:30,528  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,528  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:33:30,529  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:30,529  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_47dfa2f7-ce15-4d8c-8698-33e2f47ad87d): drop table if exists acidTbl2
2024-04-24T02:33:30,532  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T02:33:30,533  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:33:30,533  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,533  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,533  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,534  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=4}
2024-04-24T02:33:30,534  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_47dfa2f7-ce15-4d8c-8698-33e2f47ad87d); Time taken: 0.004 seconds
2024-04-24T02:33:30,534  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023330_47dfa2f7-ce15-4d8c-8698-33e2f47ad87d
2024-04-24T02:33:30,534  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:30,534  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_47dfa2f7-ce15-4d8c-8698-33e2f47ad87d): drop table if exists acidTbl2
2024-04-24T02:33:30,534  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:30,535  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:33:30,535  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:30,535  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=1}
2024-04-24T02:33:30,535  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_47dfa2f7-ce15-4d8c-8698-33e2f47ad87d); Time taken: 0.001 seconds
2024-04-24T02:33:30,535  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_47dfa2f7-ce15-4d8c-8698-33e2f47ad87d
2024-04-24T02:33:30,540  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:33:30,545  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,545  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:33:30,546  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:30,546  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_39e99066-351d-4fe9-90ca-7a90400758f7): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:30,548  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-24T02:33:30,548  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:33:30,549  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:30,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,570  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,570  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,570  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,570  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=21, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=3}
2024-04-24T02:33:30,570  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_39e99066-351d-4fe9-90ca-7a90400758f7); Time taken: 0.024 seconds
2024-04-24T02:33:30,571  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023330_39e99066-351d-4fe9-90ca-7a90400758f7
2024-04-24T02:33:30,571  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023330_39e99066-351d-4fe9-90ca-7a90400758f7
2024-04-24T02:33:30,587  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023330_39e99066-351d-4fe9-90ca-7a90400758f7 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:33:30,588  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:30,588  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_39e99066-351d-4fe9-90ca-7a90400758f7): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:30,588  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:30,588  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:30,596  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:30,604  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,605  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:30,699  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:30,699  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=103, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:30,700  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_39e99066-351d-4fe9-90ca-7a90400758f7); Time taken: 0.111 seconds
2024-04-24T02:33:30,700  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_39e99066-351d-4fe9-90ca-7a90400758f7
2024-04-24T02:33:30,704  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:33:30,711  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,711  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:33:30,712  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:30,712  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_7f74871e-764e-49e1-8959-9c3fc9414209): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:30,714  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 6
2024-04-24T02:33:30,714  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:33:30,715  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:30,724  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,724  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,724  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,724  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,724  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:33:30,724  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_7f74871e-764e-49e1-8959-9c3fc9414209); Time taken: 0.012 seconds
2024-04-24T02:33:30,724  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023330_7f74871e-764e-49e1-8959-9c3fc9414209
2024-04-24T02:33:30,725  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023330_7f74871e-764e-49e1-8959-9c3fc9414209
2024-04-24T02:33:30,739  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023330_7f74871e-764e-49e1-8959-9c3fc9414209 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:33:30,739  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:30,739  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_7f74871e-764e-49e1-8959-9c3fc9414209): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:30,739  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:30,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:30,748  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,748  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:30,756  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,756  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:30,791  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:30,791  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=42}
2024-04-24T02:33:30,791  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_7f74871e-764e-49e1-8959-9c3fc9414209); Time taken: 0.052 seconds
2024-04-24T02:33:30,791  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_7f74871e-764e-49e1-8959-9c3fc9414209
2024-04-24T02:33:30,797  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:33:30,806  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,806  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:33:30,807  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:30,807  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_c541e64a-f9ec-4cb0-8a3e-852d6376f737): drop table if exists nonAcidNonBucket
2024-04-24T02:33:30,810  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 8
2024-04-24T02:33:30,810  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:33:30,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:30,825  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,825  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,825  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,825  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,825  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=14, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:30,825  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_c541e64a-f9ec-4cb0-8a3e-852d6376f737); Time taken: 0.018 seconds
2024-04-24T02:33:30,826  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023330_c541e64a-f9ec-4cb0-8a3e-852d6376f737
2024-04-24T02:33:30,826  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023330_c541e64a-f9ec-4cb0-8a3e-852d6376f737
2024-04-24T02:33:30,848  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023330_c541e64a-f9ec-4cb0-8a3e-852d6376f737 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:33:30,848  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:30,848  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_c541e64a-f9ec-4cb0-8a3e-852d6376f737): drop table if exists nonAcidNonBucket
2024-04-24T02:33:30,848  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:30,848  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:30,857  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:30,866  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:30,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:30,899  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:30,900  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=42, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T02:33:30,900  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_c541e64a-f9ec-4cb0-8a3e-852d6376f737); Time taken: 0.051 seconds
2024-04-24T02:33:30,900  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_c541e64a-f9ec-4cb0-8a3e-852d6376f737
2024-04-24T02:33:30,904  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:33:30,909  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:30,909  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:33:30,909  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeOnTezEdges" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.515">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:33:30,966  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:33:30,967  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:33:30,969  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 6942e6d1-195c-46f5-acc5-061320db4d79
2024-04-24T02:33:30,971  INFO [main] SessionState: Hive Session ID = 6942e6d1-195c-46f5-acc5-061320db4d79
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:30,972  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:30,977  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6942e6d1-195c-46f5-acc5-061320db4d79
2024-04-24T02:33:30,979  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6942e6d1-195c-46f5-acc5-061320db4d79
2024-04-24T02:33:30,982  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6942e6d1-195c-46f5-acc5-061320db4d79/_tmp_space.db
2024-04-24T02:33:30,982  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=6942e6d1-195c-46f5-acc5-061320db4d79, clientType=HIVECLI]
2024-04-24T02:33:30,982  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:30,982  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023330_87d8abd7-35e5-4f76-bb3e-f4dcda9b7861): drop table if exists acidTbl
2024-04-24T02:33:30,990  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:33:30,991  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:33:30,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:30,996  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:30,996  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:30,996  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:30,996  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:33:30,996  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023330_87d8abd7-35e5-4f76-bb3e-f4dcda9b7861); Time taken: 0.014 seconds
2024-04-24T02:33:30,996  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023330_87d8abd7-35e5-4f76-bb3e-f4dcda9b7861
2024-04-24T02:33:30,996  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:30,996  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023330_87d8abd7-35e5-4f76-bb3e-f4dcda9b7861): drop table if exists acidTbl
2024-04-24T02:33:30,997  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:30,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,000  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,000  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,000  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023330_87d8abd7-35e5-4f76-bb3e-f4dcda9b7861); Time taken: 0.004 seconds
2024-04-24T02:33:31,000  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023330_87d8abd7-35e5-4f76-bb3e-f4dcda9b7861
2024-04-24T02:33:31,006  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:33:31,012  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,013  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:33:31,014  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:31,014  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_f8ad4244-2fa9-40e9-9cd3-5bcdb5364a57): drop table if exists acidTblPart
2024-04-24T02:33:31,016  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:33:31,016  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:33:31,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:31,019  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,019  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,019  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,019  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0}
2024-04-24T02:33:31,020  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_f8ad4244-2fa9-40e9-9cd3-5bcdb5364a57); Time taken: 0.005 seconds
2024-04-24T02:33:31,020  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023331_f8ad4244-2fa9-40e9-9cd3-5bcdb5364a57
2024-04-24T02:33:31,020  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:31,020  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_f8ad4244-2fa9-40e9-9cd3-5bcdb5364a57): drop table if exists acidTblPart
2024-04-24T02:33:31,020  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:31,023  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,023  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,024  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_f8ad4244-2fa9-40e9-9cd3-5bcdb5364a57); Time taken: 0.003 seconds
2024-04-24T02:33:31,024  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_f8ad4244-2fa9-40e9-9cd3-5bcdb5364a57
2024-04-24T02:33:31,028  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:33:31,034  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:33:31,035  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:31,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_241ce9a8-5344-4196-b504-d1becd132473): drop table if exists acidTbl2
2024-04-24T02:33:31,037  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:33:31,037  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:33:31,038  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:31,040  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,041  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,041  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,041  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,041  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_241ce9a8-5344-4196-b504-d1becd132473); Time taken: 0.006 seconds
2024-04-24T02:33:31,041  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023331_241ce9a8-5344-4196-b504-d1becd132473
2024-04-24T02:33:31,041  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:31,041  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_241ce9a8-5344-4196-b504-d1becd132473): drop table if exists acidTbl2
2024-04-24T02:33:31,041  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,042  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:31,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,045  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:31,045  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_241ce9a8-5344-4196-b504-d1becd132473); Time taken: 0.003 seconds
2024-04-24T02:33:31,045  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_241ce9a8-5344-4196-b504-d1becd132473
2024-04-24T02:33:31,050  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:33:31,055  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,056  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:33:31,056  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:31,056  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_20c8798d-99ba-4ac2-b1ac-8f1205d90e8f): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:31,059  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:33:31,059  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:33:31,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:31,062  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,062  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-24T02:33:31,062  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_20c8798d-99ba-4ac2-b1ac-8f1205d90e8f); Time taken: 0.006 seconds
2024-04-24T02:33:31,063  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023331_20c8798d-99ba-4ac2-b1ac-8f1205d90e8f
2024-04-24T02:33:31,063  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:31,063  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_20c8798d-99ba-4ac2-b1ac-8f1205d90e8f): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:31,063  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:31,066  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,066  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,066  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_20c8798d-99ba-4ac2-b1ac-8f1205d90e8f); Time taken: 0.003 seconds
2024-04-24T02:33:31,066  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_20c8798d-99ba-4ac2-b1ac-8f1205d90e8f
2024-04-24T02:33:31,071  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:33:31,077  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,077  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:33:31,077  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:31,078  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_04e62f7f-adc8-4504-ac77-544a7a20117a): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:31,079  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:33:31,080  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:33:31,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:31,083  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,083  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,083  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,083  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T02:33:31,083  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_04e62f7f-adc8-4504-ac77-544a7a20117a); Time taken: 0.005 seconds
2024-04-24T02:33:31,083  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023331_04e62f7f-adc8-4504-ac77-544a7a20117a
2024-04-24T02:33:31,084  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:31,084  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_04e62f7f-adc8-4504-ac77-544a7a20117a): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:31,084  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,084  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:31,087  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,087  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,087  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_04e62f7f-adc8-4504-ac77-544a7a20117a); Time taken: 0.003 seconds
2024-04-24T02:33:31,087  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_04e62f7f-adc8-4504-ac77-544a7a20117a
2024-04-24T02:33:31,092  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:33:31,097  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,097  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:33:31,098  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:31,098  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_d8447981-8a9e-4d2e-9928-93f912cce20f): drop table if exists nonAcidNonBucket
2024-04-24T02:33:31,100  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:33:31,100  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:33:31,101  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:31,104  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,104  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,104  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,104  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:33:31,104  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_d8447981-8a9e-4d2e-9928-93f912cce20f); Time taken: 0.006 seconds
2024-04-24T02:33:31,104  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023331_d8447981-8a9e-4d2e-9928-93f912cce20f
2024-04-24T02:33:31,104  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:31,104  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_d8447981-8a9e-4d2e-9928-93f912cce20f): drop table if exists nonAcidNonBucket
2024-04-24T02:33:31,104  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,105  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:31,108  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,108  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:31,108  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_d8447981-8a9e-4d2e-9928-93f912cce20f); Time taken: 0.004 seconds
2024-04-24T02:33:31,108  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_d8447981-8a9e-4d2e-9928-93f912cce20f
2024-04-24T02:33:31,113  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:33:31,118  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,118  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:33:31,119  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,119  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_c1c8e7c0-8ccc-4a79-b23d-46ee61fd25e1): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,121  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:33:31,121  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:33:31,122  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:31,122  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:31,127  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:33:31,127  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:31,129  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:31,129  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,129  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,129  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,129  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=1, flushCache_()=1}
2024-04-24T02:33:31,129  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_c1c8e7c0-8ccc-4a79-b23d-46ee61fd25e1); Time taken: 0.01 seconds
2024-04-24T02:33:31,129  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023331_c1c8e7c0-8ccc-4a79-b23d-46ee61fd25e1
2024-04-24T02:33:31,129  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_c1c8e7c0-8ccc-4a79-b23d-46ee61fd25e1
2024-04-24T02:33:31,146  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_c1c8e7c0-8ccc-4a79-b23d-46ee61fd25e1 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:33:31,146  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:31,147  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_c1c8e7c0-8ccc-4a79-b23d-46ee61fd25e1): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,147  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,148  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951211, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0, numFiles=0, transactional=true, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:31,153  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:31,194  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,194  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=47}
2024-04-24T02:33:31,194  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_c1c8e7c0-8ccc-4a79-b23d-46ee61fd25e1); Time taken: 0.047 seconds
2024-04-24T02:33:31,194  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_c1c8e7c0-8ccc-4a79-b23d-46ee61fd25e1
2024-04-24T02:33:31,198  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:33:31,205  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,205  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:33:31,205  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,206  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_ad37b552-4cdd-4e9f-84e4-aa618ac0293a): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,208  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:33:31,208  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:33:31,208  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:31,208  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:31,211  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:33:31,211  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:31,213  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:31,213  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,213  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,213  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,213  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:33:31,213  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_ad37b552-4cdd-4e9f-84e4-aa618ac0293a); Time taken: 0.007 seconds
2024-04-24T02:33:31,213  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023331_ad37b552-4cdd-4e9f-84e4-aa618ac0293a
2024-04-24T02:33:31,214  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_ad37b552-4cdd-4e9f-84e4-aa618ac0293a
2024-04-24T02:33:31,228  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_ad37b552-4cdd-4e9f-84e4-aa618ac0293a LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:33:31,228  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:31,228  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_ad37b552-4cdd-4e9f-84e4-aa618ac0293a): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,229  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,229  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951211, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:31,235  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:33:31,251  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,251  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-24T02:33:31,251  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_ad37b552-4cdd-4e9f-84e4-aa618ac0293a); Time taken: 0.023 seconds
2024-04-24T02:33:31,251  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_ad37b552-4cdd-4e9f-84e4-aa618ac0293a
2024-04-24T02:33:31,255  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:33:31,262  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,262  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:33:31,263  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,263  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_04a2fcfe-95ef-4418-88e4-86baa281bdb3): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,265  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:33:31,265  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:33:31,266  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:31,266  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:31,268  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:33:31,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:31,270  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:31,270  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,270  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,270  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,270  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=1, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=2, getValidTxns_(long)=0, getDatabase_(String)=2}
2024-04-24T02:33:31,270  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_04a2fcfe-95ef-4418-88e4-86baa281bdb3); Time taken: 0.007 seconds
2024-04-24T02:33:31,270  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023331_04a2fcfe-95ef-4418-88e4-86baa281bdb3
2024-04-24T02:33:31,271  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_04a2fcfe-95ef-4418-88e4-86baa281bdb3
2024-04-24T02:33:31,284  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_04a2fcfe-95ef-4418-88e4-86baa281bdb3 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:33:31,284  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:31,284  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_04a2fcfe-95ef-4418-88e4-86baa281bdb3): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,284  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951211, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numFiles=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:31,291  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:33:31,305  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,305  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,305  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_04a2fcfe-95ef-4418-88e4-86baa281bdb3); Time taken: 0.021 seconds
2024-04-24T02:33:31,305  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_04a2fcfe-95ef-4418-88e4-86baa281bdb3
2024-04-24T02:33:31,309  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:33:31,315  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,316  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:33:31,316  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,316  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_14724dd5-04d1-4bb8-a527-1a2355413468): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,318  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:33:31,319  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:33:31,319  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:31,319  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:31,321  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:33:31,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:31,323  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:31,323  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,323  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,323  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,323  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=1, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2}
2024-04-24T02:33:31,324  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_14724dd5-04d1-4bb8-a527-1a2355413468); Time taken: 0.007 seconds
2024-04-24T02:33:31,324  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023331_14724dd5-04d1-4bb8-a527-1a2355413468
2024-04-24T02:33:31,324  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_14724dd5-04d1-4bb8-a527-1a2355413468
2024-04-24T02:33:31,337  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_14724dd5-04d1-4bb8-a527-1a2355413468 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:33:31,338  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:31,338  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_14724dd5-04d1-4bb8-a527-1a2355413468): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,338  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951211, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, rawDataSize=0, totalSize=0, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:31,344  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:33:31,359  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,359  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-24T02:33:31,359  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_14724dd5-04d1-4bb8-a527-1a2355413468); Time taken: 0.021 seconds
2024-04-24T02:33:31,359  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_14724dd5-04d1-4bb8-a527-1a2355413468
2024-04-24T02:33:31,363  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:33:31,370  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,370  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:33:31,371  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,371  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_60db3c62-8b9a-4210-9bda-19409d469707): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,373  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:33:31,373  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:33:31,374  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:31,374  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:31,376  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:33:31,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:31,378  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:31,378  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,378  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,378  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,378  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-24T02:33:31,378  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_60db3c62-8b9a-4210-9bda-19409d469707); Time taken: 0.007 seconds
2024-04-24T02:33:31,378  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023331_60db3c62-8b9a-4210-9bda-19409d469707
2024-04-24T02:33:31,379  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_60db3c62-8b9a-4210-9bda-19409d469707
2024-04-24T02:33:31,392  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_60db3c62-8b9a-4210-9bda-19409d469707 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:33:31,392  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:31,393  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_60db3c62-8b9a-4210-9bda-19409d469707): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:31,393  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,394  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6942e6d1-195c-46f5-acc5-061320db4d79/_tmp_space.db/8f8070a4-efc8-4a70-942a-e5787765929f
2024-04-24T02:33:31,397  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,397  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,397  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_60db3c62-8b9a-4210-9bda-19409d469707); Time taken: 0.003 seconds
2024-04-24T02:33:31,397  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_60db3c62-8b9a-4210-9bda-19409d469707
2024-04-24T02:33:31,401  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:33:31,407  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,407  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:33:31,407  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,407  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_734aeff0-5d74-45db-8a65-a427ec856caf): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,409  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:33:31,410  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:33:31,410  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:31,410  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:31,412  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:33:31,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:31,414  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:31,414  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,414  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,414  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,414  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getDatabase_(String)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,415  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_734aeff0-5d74-45db-8a65-a427ec856caf); Time taken: 0.007 seconds
2024-04-24T02:33:31,415  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023331_734aeff0-5d74-45db-8a65-a427ec856caf
2024-04-24T02:33:31,415  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_734aeff0-5d74-45db-8a65-a427ec856caf
2024-04-24T02:33:31,430  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_734aeff0-5d74-45db-8a65-a427ec856caf LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:33:31,430  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:31,430  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_734aeff0-5d74-45db-8a65-a427ec856caf): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:31,430  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,431  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951211, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, totalSize=0, numRows=0, numFilesErasureCoded=0, transactional=false, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:31,436  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:33:31,450  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:31,450  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:31,450  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_734aeff0-5d74-45db-8a65-a427ec856caf); Time taken: 0.02 seconds
2024-04-24T02:33:31,450  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_734aeff0-5d74-45db-8a65-a427ec856caf
2024-04-24T02:33:31,454  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:33:31,461  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,461  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:33:31,463  INFO [main] ql.TxnCommandsBaseForTests: Running the query: explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-24T02:33:31,463  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-24T02:33:31,465  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:33:31,466  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:33:31,466  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,486  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-24T02:33:31,490  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6942e6d1-195c-46f5-acc5-061320db4d79/_tmp_space.db/merge_tmp_table
2024-04-24T02:33:31,492  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` > 8
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 7
   WHERE `t`.`a` = `s`.`a` AND NOT(`s`.`a` > 8)
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND NOT(`s`.`a` > 8)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-24T02:33:31,493  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:33:31,500  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:31,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:31,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:31,507  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:33:31,528  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,528  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:31,528  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:31,529  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,535  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,535  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,542  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,548  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,555  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,555  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:31,555  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:31,555  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:31,555  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:31,555  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:31,568  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:31,594  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-24T02:33:31,625  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:33:31,625  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:31,634  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:31,643  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:33:31,653  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-24T02:33:31,653  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-24T02:33:31,653  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:33:31,654  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:33:31,665  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,665  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-24T02:33:31,676  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-24T02:33:31,689  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: b, a
No Stats for default@nonacidorctbl, Columns: b, a
2024-04-24T02:33:31,689  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: b, a
2024-04-24T02:33:31,880  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:31,880  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:31,880  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:31,880  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:31,880  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:31,880  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:31,880  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:31,880  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:31,881  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:31,881  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:31,881  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:31,881  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:31,881  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,889  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,896  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,896  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,905  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,905  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,912  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,917 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.ExplainSemanticAnalyzer.analyzeInternal(ExplainSemanticAnalyzer.java:175) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:33:31,918 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:33:31,919 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.ExplainSemanticAnalyzer.analyzeInternal(ExplainSemanticAnalyzer.java:175)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:33:31,919  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,920  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=63, openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=31, flushCache_()=0, getTable_(GetTableRequest)=104, createTable_(Table)=3, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=7, getValidTxns_(long)=0}
2024-04-24T02:33:31,920  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.456 seconds
2024-04-24T02:33:31,920  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:31,926  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:31,934  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:31,934  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6942e6d1-195c-46f5-acc5-061320db4d79/hive_2024-04-24_02-33-31_492_419949767683640967-1
2024-04-24T02:33:31,934  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists acidTbl
2024-04-24T02:33:31,936  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:33:31,936  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:33:31,937  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,943  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,943  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:31,943  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:31,943  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:31,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=14, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=6, getValidTxns_(long)=0}
2024-04-24T02:33:31,944  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.009 seconds
2024-04-24T02:33:31,944  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:31,944  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:31,961  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:33:31,961  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:31,961  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists acidTbl
2024-04-24T02:33:31,962  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:31,962  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,968  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,968  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:31,974  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:31,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:32,066  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,066  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=98, getTable_(GetTableRequest)=6}
2024-04-24T02:33:32,067  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.105 seconds
2024-04-24T02:33:32,067  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,070  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:33:32,075  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,076  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:33:32,076  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:32,076  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists acidTblPart
2024-04-24T02:33:32,078  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 5
2024-04-24T02:33:32,078  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:33:32,079  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:32,085  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,085  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,085  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=1, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=6, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:33:32,085  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.009 seconds
2024-04-24T02:33:32,085  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,086  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,099  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:33:32,099  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:32,099  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists acidTblPart
2024-04-24T02:33:32,099  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:32,105  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,105  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:32,111  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,111  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:32,147  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,147  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=42, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:33:32,147  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.048 seconds
2024-04-24T02:33:32,147  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,151  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T02:33:32,156  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,156  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:33:32,157  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:32,157  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists acidTbl2
2024-04-24T02:33:32,159  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-24T02:33:32,160  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:33:32,160  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,160  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,160  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,161  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T02:33:32,161  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.003 seconds
2024-04-24T02:33:32,161  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,161  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,161  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists acidTbl2
2024-04-24T02:33:32,161  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,162  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:33:32,162  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,162  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=1}
2024-04-24T02:33:32,162  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.001 seconds
2024-04-24T02:33:32,162  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,167  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:33:32,172  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,173  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:33:32,173  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:32,173  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:32,175  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-24T02:33:32,176  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:33:32,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:32,196  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,196  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,196  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,196  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,196  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=20, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T02:33:32,196  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.023 seconds
2024-04-24T02:33:32,196  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,197  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,209  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:33:32,209  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:32,209  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:32,209  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:32,218  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:32,226  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,226  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:32,255  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,256  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=37, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:32,256  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.046 seconds
2024-04-24T02:33:32,256  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,259  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:33:32,265  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,265  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:33:32,265  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:32,265  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:32,267  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 10
2024-04-24T02:33:32,268  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:33:32,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:32,278  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,278  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,278  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,278  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,278  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=10, getValidTxns_(long)=0}
2024-04-24T02:33:32,278  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.013 seconds
2024-04-24T02:33:32,279  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,279  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,293  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:33:32,293  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:32,293  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:32,293  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,293  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:32,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:32,309  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:32,338  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,338  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=37}
2024-04-24T02:33:32,338  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.045 seconds
2024-04-24T02:33:32,338  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,342  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:33:32,347  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,347  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:33:32,347  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:32,347  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists nonAcidNonBucket
2024-04-24T02:33:32,349  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 11
2024-04-24T02:33:32,349  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:33:32,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:32,358  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,358  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,358  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,358  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,358  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-24T02:33:32,358  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.011 seconds
2024-04-24T02:33:32,359  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,359  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,372  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:33:32,372  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:32,372  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679): drop table if exists nonAcidNonBucket
2024-04-24T02:33:32,373  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,373  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:32,381  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,381  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:32,388  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:32,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:32,416  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,416  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=35, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,417  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679); Time taken: 0.044 seconds
2024-04-24T02:33:32,417  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023331_7f03f26f-d27e-4340-bd8c-e24124807679
2024-04-24T02:33:32,420  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:33:32,425  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,425  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:33:32,426  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeType2SCD01" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="6.699">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:33:32,480  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:33:32,480  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:33:32,480  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:33:32,480  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:33:32,481  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:33:32,481  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:33:32,481  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:33:32,481  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:33:32,481  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:33:32,481  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:33:32,481  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:33:32,483  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = ecf46847-a7a5-490e-b766-f0e419a93fd3
2024-04-24T02:33:32,486  INFO [main] SessionState: Hive Session ID = ecf46847-a7a5-490e-b766-f0e419a93fd3
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:32,486  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:32,492  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/ecf46847-a7a5-490e-b766-f0e419a93fd3
2024-04-24T02:33:32,494  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3
2024-04-24T02:33:32,496  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/ecf46847-a7a5-490e-b766-f0e419a93fd3/_tmp_space.db
2024-04-24T02:33:32,497  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=ecf46847-a7a5-490e-b766-f0e419a93fd3, clientType=HIVECLI]
2024-04-24T02:33:32,497  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:32,497  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_aad5d1e4-d23d-40fb-9aef-e3937638fe17): drop table if exists acidTbl
2024-04-24T02:33:32,505  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:33:32,506  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:33:32,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:32,511  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,511  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,511  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,511  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, openTxn_(String, TxnType)=9}
2024-04-24T02:33:32,511  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_aad5d1e4-d23d-40fb-9aef-e3937638fe17); Time taken: 0.014 seconds
2024-04-24T02:33:32,511  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023332_aad5d1e4-d23d-40fb-9aef-e3937638fe17
2024-04-24T02:33:32,511  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,511  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_aad5d1e4-d23d-40fb-9aef-e3937638fe17): drop table if exists acidTbl
2024-04-24T02:33:32,512  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:32,516  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,516  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,516  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_aad5d1e4-d23d-40fb-9aef-e3937638fe17); Time taken: 0.005 seconds
2024-04-24T02:33:32,516  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_aad5d1e4-d23d-40fb-9aef-e3937638fe17
2024-04-24T02:33:32,522  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:33:32,528  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,530  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:33:32,530  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:32,531  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_9925d94f-fb13-476f-9cc6-f1d4912b84ef): drop table if exists acidTblPart
2024-04-24T02:33:32,532  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:33:32,533  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:33:32,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:32,536  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,536  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,536  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_9925d94f-fb13-476f-9cc6-f1d4912b84ef); Time taken: 0.005 seconds
2024-04-24T02:33:32,536  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023332_9925d94f-fb13-476f-9cc6-f1d4912b84ef
2024-04-24T02:33:32,536  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,536  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_9925d94f-fb13-476f-9cc6-f1d4912b84ef): drop table if exists acidTblPart
2024-04-24T02:33:32,537  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,537  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:32,540  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,540  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,540  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_9925d94f-fb13-476f-9cc6-f1d4912b84ef); Time taken: 0.004 seconds
2024-04-24T02:33:32,540  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_9925d94f-fb13-476f-9cc6-f1d4912b84ef
2024-04-24T02:33:32,545  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:33:32,551  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,551  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:33:32,552  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:32,552  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_928d0526-c743-4e87-bcd0-176cab3b89b2): drop table if exists acidTbl2
2024-04-24T02:33:32,554  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:33:32,554  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:33:32,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:32,557  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,557  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,557  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_928d0526-c743-4e87-bcd0-176cab3b89b2); Time taken: 0.005 seconds
2024-04-24T02:33:32,558  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023332_928d0526-c743-4e87-bcd0-176cab3b89b2
2024-04-24T02:33:32,558  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,558  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_928d0526-c743-4e87-bcd0-176cab3b89b2): drop table if exists acidTbl2
2024-04-24T02:33:32,558  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,558  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:32,561  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,561  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,561  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_928d0526-c743-4e87-bcd0-176cab3b89b2); Time taken: 0.003 seconds
2024-04-24T02:33:32,561  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_928d0526-c743-4e87-bcd0-176cab3b89b2
2024-04-24T02:33:32,567  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:33:32,573  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,573  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:33:32,574  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:32,574  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_a5a5faf5-e829-441f-9ca1-8a92909665be): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:32,575  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:33:32,576  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:33:32,576  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:32,579  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,579  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,579  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,579  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:32,579  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_a5a5faf5-e829-441f-9ca1-8a92909665be); Time taken: 0.005 seconds
2024-04-24T02:33:32,579  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023332_a5a5faf5-e829-441f-9ca1-8a92909665be
2024-04-24T02:33:32,579  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,580  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_a5a5faf5-e829-441f-9ca1-8a92909665be): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:32,580  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,580  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:32,583  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,583  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,583  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_a5a5faf5-e829-441f-9ca1-8a92909665be); Time taken: 0.002 seconds
2024-04-24T02:33:32,583  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_a5a5faf5-e829-441f-9ca1-8a92909665be
2024-04-24T02:33:32,587  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:33:32,592  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,593  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:33:32,593  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:32,593  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_7397fc77-5131-49df-8f1e-991b1b32c375): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:32,595  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:33:32,595  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:33:32,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:32,598  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,598  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,598  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,598  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-24T02:33:32,599  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_7397fc77-5131-49df-8f1e-991b1b32c375); Time taken: 0.005 seconds
2024-04-24T02:33:32,599  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023332_7397fc77-5131-49df-8f1e-991b1b32c375
2024-04-24T02:33:32,599  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,599  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_7397fc77-5131-49df-8f1e-991b1b32c375): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:32,599  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:32,602  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,602  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,602  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_7397fc77-5131-49df-8f1e-991b1b32c375); Time taken: 0.003 seconds
2024-04-24T02:33:32,602  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_7397fc77-5131-49df-8f1e-991b1b32c375
2024-04-24T02:33:32,607  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:33:32,612  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,612  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:33:32,612  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:32,612  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_a2393923-5e7a-40b6-bca6-f627721a0944): drop table if exists nonAcidNonBucket
2024-04-24T02:33:32,614  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:33:32,614  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:33:32,615  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:32,617  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,617  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,617  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,617  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:32,618  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_a2393923-5e7a-40b6-bca6-f627721a0944); Time taken: 0.005 seconds
2024-04-24T02:33:32,618  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023332_a2393923-5e7a-40b6-bca6-f627721a0944
2024-04-24T02:33:32,618  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,618  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_a2393923-5e7a-40b6-bca6-f627721a0944): drop table if exists nonAcidNonBucket
2024-04-24T02:33:32,618  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:32,621  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,621  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,621  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_a2393923-5e7a-40b6-bca6-f627721a0944); Time taken: 0.003 seconds
2024-04-24T02:33:32,621  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_a2393923-5e7a-40b6-bca6-f627721a0944
2024-04-24T02:33:32,627  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:33:32,632  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,632  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:33:32,632  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,632  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_a4024534-0c23-44b9-bffe-45ba34a4c496): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,634  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:33:32,635  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:33:32,635  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:32,635  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:32,640  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:33:32,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:32,642  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:32,642  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,642  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,642  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,642  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2}
2024-04-24T02:33:32,642  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_a4024534-0c23-44b9-bffe-45ba34a4c496); Time taken: 0.01 seconds
2024-04-24T02:33:32,642  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023332_a4024534-0c23-44b9-bffe-45ba34a4c496
2024-04-24T02:33:32,642  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023332_a4024534-0c23-44b9-bffe-45ba34a4c496
2024-04-24T02:33:32,658  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023332_a4024534-0c23-44b9-bffe-45ba34a4c496 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:33:32,658  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:32,659  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_a4024534-0c23-44b9-bffe-45ba34a4c496): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,659  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951212, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true, rawDataSize=0, bucketing_version=2, totalSize=0, numFiles=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:32,665  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:32,701  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,701  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=41}
2024-04-24T02:33:32,701  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_a4024534-0c23-44b9-bffe-45ba34a4c496); Time taken: 0.042 seconds
2024-04-24T02:33:32,701  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_a4024534-0c23-44b9-bffe-45ba34a4c496
2024-04-24T02:33:32,705  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:33:32,710  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,710  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:33:32,710  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,710  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_a947f865-ad25-44fd-b364-649b8800f157): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,712  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:33:32,712  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:33:32,713  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:32,713  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:32,715  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:33:32,715  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:32,717  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:32,717  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,717  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,717  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,717  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:33:32,717  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_a947f865-ad25-44fd-b364-649b8800f157); Time taken: 0.007 seconds
2024-04-24T02:33:32,717  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023332_a947f865-ad25-44fd-b364-649b8800f157
2024-04-24T02:33:32,717  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023332_a947f865-ad25-44fd-b364-649b8800f157
2024-04-24T02:33:32,730  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023332_a947f865-ad25-44fd-b364-649b8800f157 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:33:32,730  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:32,731  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_a947f865-ad25-44fd-b364-649b8800f157): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,731  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951212, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:32,736  INFO [HiveClientCache-cleaner-0] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-24T02:33:32,736  INFO [HiveClientCache-cleaner-0] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -12
2024-04-24T02:33:32,737  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:33:32,751  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,751  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-24T02:33:32,751  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_a947f865-ad25-44fd-b364-649b8800f157); Time taken: 0.02 seconds
2024-04-24T02:33:32,751  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_a947f865-ad25-44fd-b364-649b8800f157
2024-04-24T02:33:32,755  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:33:32,760  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,760  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:33:32,761  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,761  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_08c3b8d8-1a0d-435a-9679-f80ef0c359f4): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,763  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:33:32,763  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:33:32,764  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:32,764  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:32,766  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:33:32,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:32,767  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:32,767  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,767  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,767  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,767  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=1, getValidTxns_(long)=1}
2024-04-24T02:33:32,768  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_08c3b8d8-1a0d-435a-9679-f80ef0c359f4); Time taken: 0.006 seconds
2024-04-24T02:33:32,768  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023332_08c3b8d8-1a0d-435a-9679-f80ef0c359f4
2024-04-24T02:33:32,768  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023332_08c3b8d8-1a0d-435a-9679-f80ef0c359f4
2024-04-24T02:33:32,781  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023332_08c3b8d8-1a0d-435a-9679-f80ef0c359f4 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:33:32,781  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:32,781  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_08c3b8d8-1a0d-435a-9679-f80ef0c359f4): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,781  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951212, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFilesErasureCoded=0, bucketing_version=2, totalSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:32,787  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:33:32,801  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,801  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,801  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_08c3b8d8-1a0d-435a-9679-f80ef0c359f4); Time taken: 0.019 seconds
2024-04-24T02:33:32,801  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_08c3b8d8-1a0d-435a-9679-f80ef0c359f4
2024-04-24T02:33:32,805  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:33:32,811  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,811  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:33:32,811  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,811  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_93f12105-8160-4315-8c08-7e9dc3745f29): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,813  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:33:32,813  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:33:32,814  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:32,814  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:32,816  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:33:32,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:32,817  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:32,817  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,818  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,818  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,818  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=1, getDatabase_(String)=1, flushCache_()=0, getValidWriteIds_(List, String)=2}
2024-04-24T02:33:32,818  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_93f12105-8160-4315-8c08-7e9dc3745f29); Time taken: 0.007 seconds
2024-04-24T02:33:32,818  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023332_93f12105-8160-4315-8c08-7e9dc3745f29
2024-04-24T02:33:32,818  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023332_93f12105-8160-4315-8c08-7e9dc3745f29
2024-04-24T02:33:32,832  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023332_93f12105-8160-4315-8c08-7e9dc3745f29 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:33:32,832  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:32,832  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_93f12105-8160-4315-8c08-7e9dc3745f29): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,832  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,833  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951212, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFiles=0, numFilesErasureCoded=0, numRows=0, totalSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:32,838  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:33:32,851  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,851  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,852  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_93f12105-8160-4315-8c08-7e9dc3745f29); Time taken: 0.019 seconds
2024-04-24T02:33:32,852  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_93f12105-8160-4315-8c08-7e9dc3745f29
2024-04-24T02:33:32,855  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:33:32,860  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,861  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:33:32,861  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,861  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_54ab93ec-7922-4092-91aa-0aae2a311f3a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,863  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:33:32,863  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:33:32,864  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:32,864  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:32,866  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:33:32,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:32,868  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:32,868  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,868  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,868  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,868  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, flushCache_()=0, getDatabase_(String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2}
2024-04-24T02:33:32,868  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_54ab93ec-7922-4092-91aa-0aae2a311f3a); Time taken: 0.007 seconds
2024-04-24T02:33:32,868  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023332_54ab93ec-7922-4092-91aa-0aae2a311f3a
2024-04-24T02:33:32,868  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023332_54ab93ec-7922-4092-91aa-0aae2a311f3a
2024-04-24T02:33:32,881  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023332_54ab93ec-7922-4092-91aa-0aae2a311f3a LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:33:32,881  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:32,882  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_54ab93ec-7922-4092-91aa-0aae2a311f3a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:32,882  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,883  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/ecf46847-a7a5-490e-b766-f0e419a93fd3/_tmp_space.db/674a8d85-34b3-4ce3-9d42-13927a96f36c
2024-04-24T02:33:32,885  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,885  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,885  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_54ab93ec-7922-4092-91aa-0aae2a311f3a); Time taken: 0.003 seconds
2024-04-24T02:33:32,885  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_54ab93ec-7922-4092-91aa-0aae2a311f3a
2024-04-24T02:33:32,889  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:33:32,894  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,894  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:33:32,895  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,895  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_849cf616-4351-4c52-af2e-fca7995adca7): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,897  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:33:32,897  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:33:32,897  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:32,897  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:32,899  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:33:32,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:32,901  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:32,901  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,901  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,901  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,901  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:33:32,901  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_849cf616-4351-4c52-af2e-fca7995adca7); Time taken: 0.006 seconds
2024-04-24T02:33:32,902  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023332_849cf616-4351-4c52-af2e-fca7995adca7
2024-04-24T02:33:32,902  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023332_849cf616-4351-4c52-af2e-fca7995adca7
2024-04-24T02:33:32,915  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023332_849cf616-4351-4c52-af2e-fca7995adca7 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:33:32,915  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:32,915  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_849cf616-4351-4c52-af2e-fca7995adca7): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:32,915  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,916  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951212, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, numFiles=0, numFilesErasureCoded=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:32,921  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:33:32,935  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,935  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,936  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_849cf616-4351-4c52-af2e-fca7995adca7); Time taken: 0.02 seconds
2024-04-24T02:33:32,936  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_849cf616-4351-4c52-af2e-fca7995adca7
2024-04-24T02:33:32,940  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:33:32,946  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,946  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:33:32,947  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists target
2024-04-24T02:33:32,947  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_411f4dac-c5fe-49eb-9abc-5649a90fb65d): drop table if exists target
2024-04-24T02:33:32,949  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:33:32,949  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:33:32,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:32,953  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,953  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,953  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,953  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,953  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_411f4dac-c5fe-49eb-9abc-5649a90fb65d); Time taken: 0.006 seconds
2024-04-24T02:33:32,953  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023332_411f4dac-c5fe-49eb-9abc-5649a90fb65d
2024-04-24T02:33:32,953  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,953  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_411f4dac-c5fe-49eb-9abc-5649a90fb65d): drop table if exists target
2024-04-24T02:33:32,954  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:32,957  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,957  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,957  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_411f4dac-c5fe-49eb-9abc-5649a90fb65d); Time taken: 0.004 seconds
2024-04-24T02:33:32,957  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_411f4dac-c5fe-49eb-9abc-5649a90fb65d
2024-04-24T02:33:32,963  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:33:32,969  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,969  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:33:32,969  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists source
2024-04-24T02:33:32,970  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_6d6bd053-ab6b-4f47-b351-6d09ebfde1b4): drop table if exists source
2024-04-24T02:33:32,972  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:33:32,972  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:33:32,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:32,975  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,975  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,975  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,975  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,976  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_6d6bd053-ab6b-4f47-b351-6d09ebfde1b4); Time taken: 0.005 seconds
2024-04-24T02:33:32,976  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023332_6d6bd053-ab6b-4f47-b351-6d09ebfde1b4
2024-04-24T02:33:32,976  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,976  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_6d6bd053-ab6b-4f47-b351-6d09ebfde1b4): drop table if exists source
2024-04-24T02:33:32,976  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,976  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:32,979  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:32,979  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:32,980  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_6d6bd053-ab6b-4f47-b351-6d09ebfde1b4); Time taken: 0.003 seconds
2024-04-24T02:33:32,980  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_6d6bd053-ab6b-4f47-b351-6d09ebfde1b4
2024-04-24T02:33:32,986  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:33:32,991  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:32,991  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:33:32,992  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists splitTable
2024-04-24T02:33:32,992  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023332_f2f2f907-1775-481c-a7fa-ba431964685c): drop table if exists splitTable
2024-04-24T02:33:32,994  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T02:33:32,994  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:33:32,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-24T02:33:32,997  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:32,997  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:32,997  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:32,997  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:33:32,997  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023332_f2f2f907-1775-481c-a7fa-ba431964685c); Time taken: 0.005 seconds
2024-04-24T02:33:32,998  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023332_f2f2f907-1775-481c-a7fa-ba431964685c
2024-04-24T02:33:32,998  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:32,998  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023332_f2f2f907-1775-481c-a7fa-ba431964685c): drop table if exists splitTable
2024-04-24T02:33:32,998  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:32,998  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-24T02:33:33,001  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:33,001  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:33,001  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023332_f2f2f907-1775-481c-a7fa-ba431964685c); Time taken: 0.003 seconds
2024-04-24T02:33:33,001  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023332_f2f2f907-1775-481c-a7fa-ba431964685c
2024-04-24T02:33:33,006  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T02:33:33,011  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:33,012  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:33:33,012  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table splitTable(op int)
2024-04-24T02:33:33,012  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023333_10f3755f-88d6-480a-9dc6-bc2f3499b916): create table splitTable(op int)
2024-04-24T02:33:33,015  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T02:33:33,015  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:33:33,016  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:33,016  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:33,020  INFO [main] parse.CalcitePlanner: Creating table default.splitTable position=13
2024-04-24T02:33:33,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:33,022  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:33,022  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:33,022  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:33,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:33,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1}
2024-04-24T02:33:33,022  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023333_10f3755f-88d6-480a-9dc6-bc2f3499b916); Time taken: 0.01 seconds
2024-04-24T02:33:33,022  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023333_10f3755f-88d6-480a-9dc6-bc2f3499b916
2024-04-24T02:33:33,023  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023333_10f3755f-88d6-480a-9dc6-bc2f3499b916
2024-04-24T02:33:33,039  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023333_10f3755f-88d6-480a-9dc6-bc2f3499b916 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:33:33,039  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:33,039  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023333_10f3755f-88d6-480a-9dc6-bc2f3499b916): create table splitTable(op int)
2024-04-24T02:33:33,039  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:33,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:splitTable, dbName:default, owner:alex, createTime:1713951213, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:op, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"op":"true"}}, bucketing_version=2, numFiles=0, totalSize=0, numFilesErasureCoded=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:33,045  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable
2024-04-24T02:33:33,073  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:33,073  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=34, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:33,073  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023333_10f3755f-88d6-480a-9dc6-bc2f3499b916); Time taken: 0.034 seconds
2024-04-24T02:33:33,073  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023333_10f3755f-88d6-480a-9dc6-bc2f3499b916
2024-04-24T02:33:33,077  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:33:33,082  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:33,082  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:33:33,083  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into splitTable values (0),(1)
2024-04-24T02:33:33,083  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c): insert into splitTable values (0),(1)
2024-04-24T02:33:33,085  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-24T02:33:33,085  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:33:33,085  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:33,085  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:33,088  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-24T02:33:33,119  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:33,119  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:33,119  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:33,119  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:33,119  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:33,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-24T02:33:33,127  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:33,128  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:33,128  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:33,147  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:33,218  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:33,218  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:33,218  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:33,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:33,220  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:33,220  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:33,221  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:33,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-24T02:33:33,229  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:33,231  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1
2024-04-24T02:33:33,233  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.splittable	
2024-04-24T02:33:33,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.splittable	
2024-04-24T02:33:33,235  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:33,238  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:33:33,238  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:33,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:33,256  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:33,256  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T02:33:33,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:33,266  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:33,282  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:33,282  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:33,282  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:33,282  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null)], properties:null)
2024-04-24T02:33:33,282  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:33,282  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=68, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=25, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-24T02:33:33,282  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c); Time taken: 0.199 seconds
2024-04-24T02:33:33,283  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c
2024-04-24T02:33:33,283  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c
2024-04-24T02:33:33,296  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:33:33,296  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:33,296  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c): insert into splitTable values (0),(1)
2024-04-24T02:33:33,296  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c
2024-04-24T02:33:33,296  INFO [main] ql.Driver: Query ID = alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c
Total jobs = 3
2024-04-24T02:33:33,297  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-24T02:33:33,297  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-24T02:33:33,438  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:33:33,438  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:33:33,440  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:33,440  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:33:33,440  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-33_083_1362431432067997612-1/dummy_path
2024-04-24T02:33:33,449  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:33,449  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,57KB
2024-04-24T02:33:33,450  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:33,454  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-33_083_1362431432067997612-1/-mr-10001
2024-04-24T02:33:33,457  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:33,464  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:33,468  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:33,469  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:33:33,469  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:33:33,469  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-33_083_1362431432067997612-1/dummy_path
2024-04-24T02:33:33,470  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:33:33,498  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:33:33,517  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2011217169_0067
2024-04-24T02:33:33,517  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:33,588  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:33,588  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:33,588  INFO [Thread-5733] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:33,589  INFO [Thread-5733] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:33,590  INFO [Thread-5733] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:33,590  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2011217169_0067_m_000000_0
2024-04-24T02:33:33,593  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:33,593  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-33_083_1362431432067997612-1/dummy_path/null:0+1
2024-04-24T02:33:33,595  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:33,595  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,57KB
2024-04-24T02:33:33,596  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T02:33:33,597  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:33,598  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:33,599  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:33,599  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:33,599  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:33:33,599  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:33:33,599  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:33,599  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int>
2024-04-24T02:33:33,599  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:33:33,599  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@56816c4b, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@4fe5c5, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [op] : [int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@41c0399b
2024-04-24T02:33:33,600  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1/_tmp.-ext-10002/000000_0
2024-04-24T02:33:33,600  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:33:33,600  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1/_tmp.-ext-10002/000000_0
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:33:33,609  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T02:33:33,614  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.splittable:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T02:33:33,615  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:33,617  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2011217169_0067_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:33,617  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:33:33,617  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2011217169_0067_m_000000_0' done.
2024-04-24T02:33:33,617  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2011217169_0067_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1374500
		FILE: Number of bytes written=78944599
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1409810432
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.splittable=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=5625
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:33,617  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2011217169_0067_m_000000_0
2024-04-24T02:33:33,618  INFO [Thread-5733] mapred.LocalJobRunner: map task executor complete.
2024-04-24 02:33:34,590 Stage-1 map = 100%,  reduce = 0%
2024-04-24T02:33:34,590  INFO [main] exec.Task: 2024-04-24 02:33:34,590 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local2011217169_0067
2024-04-24T02:33:34,591  INFO [main] exec.Task: Ended Job = job_local2011217169_0067
2024-04-24T02:33:34,593  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T02:33:34,594  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T02:33:34,594  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T02:33:34,594  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T02:33:34,594  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1/-ext-10000
2024-04-24T02:33:34,595  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1/-ext-10002
2024-04-24T02:33:34,595  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.splittable
2024-04-24T02:33:34,595  INFO [main] exec.Task: Loading data to table default.splittable from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1/-ext-10000
2024-04-24T02:33:34,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:34,604  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:34,604  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:34,613  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:34,615  WARN [main] metadata.Hive: Cannot get a table snapshot for splittable
2024-04-24T02:33:34,615  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.splittable newtbl=splittable	
2024-04-24T02:33:34,640  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:33:34,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:34,648  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:34,648  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:33:34,648  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-33_083_1362431432067997612-1/-mr-10001
2024-04-24T02:33:34,649  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:34,657  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:34,658  INFO [main] FileOperations: Read stats for default.splittable/, numRows, true, 2, false: 
2024-04-24T02:33:34,658  INFO [main] FileOperations: Read stats for default.splittable/, rawDataSize, true, 2, false: 
2024-04-24T02:33:34,658  WARN [main] metadata.Hive: Cannot get a table snapshot for splittable
2024-04-24T02:33:34,658  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.splittable newtbl=splittable	
2024-04-24T02:33:34,680  INFO [main] stats.BasicStatsTask: Table default.splittable stats: [numFiles=1, numRows=2, totalSize=4, rawDataSize=2, numFilesErasureCoded=0]
2024-04-24T02:33:34,681  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:34,681  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=34, isCompatibleWith_(Configuration)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=47}
MapReduce Jobs Launched: 
2024-04-24T02:33:34,681  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:34,681  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:34,681  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:34,681  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c); Time taken: 1.385 seconds
2024-04-24T02:33:34,681  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023333_bae82207-bde0-4062-8055-5ba93ff2c49c
2024-04-24T02:33:34,685  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:33:34,690  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:34,690  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:33:34,691  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table source (key int, data int)
2024-04-24T02:33:34,691  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-33_083_1362431432067997612-1
2024-04-24T02:33:34,691  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-33_083_1362431432067997612-1 on fs with scheme file
2024-04-24T02:33:34,692  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1
2024-04-24T02:33:34,692  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/splittable/.hive-staging_hive_2024-04-24_02-33-33_083_1362431432067997612-1 on fs with scheme file
2024-04-24T02:33:34,692  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023334_b877e2ab-c1e3-4fc8-81f1-904619d50a55): create table source (key int, data int)
2024-04-24T02:33:34,694  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T02:33:34,694  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:33:34,695  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:34,695  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:34,697  INFO [main] parse.CalcitePlanner: Creating table default.source position=13
2024-04-24T02:33:34,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:34,699  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:34,699  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:34,699  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:34,699  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:34,699  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=1, getDatabase_(String)=1, flushCache_()=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:34,699  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023334_b877e2ab-c1e3-4fc8-81f1-904619d50a55); Time taken: 0.007 seconds
2024-04-24T02:33:34,699  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023334_b877e2ab-c1e3-4fc8-81f1-904619d50a55
2024-04-24T02:33:34,699  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023334_b877e2ab-c1e3-4fc8-81f1-904619d50a55
2024-04-24T02:33:34,712  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023334_b877e2ab-c1e3-4fc8-81f1-904619d50a55 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:33:34,712  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:34,712  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023334_b877e2ab-c1e3-4fc8-81f1-904619d50a55): create table source (key int, data int)
2024-04-24T02:33:34,712  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:34,713  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:source, dbName:default, owner:alex, createTime:1713951214, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"data":"true","key":"true"}}, numFilesErasureCoded=0, totalSize=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:34,720  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source
2024-04-24T02:33:34,733  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:34,734  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:34,734  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023334_b877e2ab-c1e3-4fc8-81f1-904619d50a55); Time taken: 0.021 seconds
2024-04-24T02:33:34,734  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023334_b877e2ab-c1e3-4fc8-81f1-904619d50a55
2024-04-24T02:33:34,738  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:33:34,743  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:34,743  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:33:34,743  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:34,743  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023334_c60c6956-3271-4a59-a711-eb58371b500c): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:34,745  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T02:33:34,746  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:33:34,746  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:34,746  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:34,748  INFO [main] parse.CalcitePlanner: Creating table default.target position=13
2024-04-24T02:33:34,748  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:34,750  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:34,750  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:34,750  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:34,750  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:34,750  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:33:34,750  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023334_c60c6956-3271-4a59-a711-eb58371b500c); Time taken: 0.007 seconds
2024-04-24T02:33:34,751  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023334_c60c6956-3271-4a59-a711-eb58371b500c
2024-04-24T02:33:34,751  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023334_c60c6956-3271-4a59-a711-eb58371b500c
2024-04-24T02:33:34,765  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023334_c60c6956-3271-4a59-a711-eb58371b500c LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:33:34,765  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:34,765  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023334_c60c6956-3271-4a59-a711-eb58371b500c): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:34,766  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:34,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:target, dbName:default, owner:alex, createTime:1713951214, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null), FieldSchema(name:cur, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[key], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"cur":"true","data":"true","key":"true"}}, transactional=true, rawDataSize=0, bucketing_version=2, totalSize=0, numRows=0, numFilesErasureCoded=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:34,772  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:34,787  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:34,787  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:34,787  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023334_c60c6956-3271-4a59-a711-eb58371b500c); Time taken: 0.022 seconds
2024-04-24T02:33:34,787  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023334_c60c6956-3271-4a59-a711-eb58371b500c
2024-04-24T02:33:34,791  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:33:34,796  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:34,796  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:33:34,797  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-24T02:33:34,797  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-24T02:33:34,799  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T02:33:34,799  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:33:34,800  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:34,800  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:34,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:34,808  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:34,808  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:34,808  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:34,808  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:34,808  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:34,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:34,815  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:34,815  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:34,815  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:34,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:34,882  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:34,882  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:34,882  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:34,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:34,885  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:34,885  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:34,885  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:34,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:34,893  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:34,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.target	
2024-04-24T02:33:34,896  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.target	
2024-04-24T02:33:34,904  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T02:33:34,905  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=target (txnIds: [20])
2024-04-24T02:33:34,905  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:34,908  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col1=Column[_col2], VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:33:34,908  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2]}
2024-04-24T02:33:34,909  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:33:34,910  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:34,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:34,926  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:34,927  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:34,927  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:34,927  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:34,927  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null), FieldSchema(name:col3, type:int, comment:null)], properties:null)
2024-04-24T02:33:34,927  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:34,927  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=4, flushCache_()=0, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=28, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, allocateTableWriteId_(long, String, String)=8, commitTxn_(CommitTxnRequest)=9, getCheckConstraints_(CheckConstraintsRequest)=1, openTxn_(String, TxnType)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-24T02:33:34,928  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce); Time taken: 0.13 seconds
2024-04-24T02:33:34,928  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce
2024-04-24T02:33:34,928  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce
2024-04-24T02:33:34,945  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:33:34,945  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:34,948  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-24T02:33:34,948  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce
2024-04-24T02:33:34,948  INFO [main] ql.Driver: Query ID = alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce
Total jobs = 1
2024-04-24T02:33:34,948  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:33:34,948  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:33:35,098  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:33:35,098  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:33:35,098  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:33:35,098  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:33:35,098  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:33:35,098  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:33:35,098  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:33:35,098  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:33:35,101  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:35,101  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:33:35,101  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-34_797_3322403195265410867-1/dummy_path
2024-04-24T02:33:35,110  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:35,111  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,15KB
2024-04-24T02:33:35,116  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:33:35,116  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,16KB
2024-04-24T02:33:35,117  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:35,121  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-34_797_3322403195265410867-1/-mr-10000
2024-04-24T02:33:35,123  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:35,130  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:35,135  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:35,136  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:33:35,136  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:33:35,136  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-34_797_3322403195265410867-1/dummy_path
2024-04-24T02:33:35,136  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:33:35,154  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:33:35,174  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1119390526_0068
2024-04-24T02:33:35,174  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:35,234  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:35,234  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:35,234  INFO [Thread-5779] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:35,234  INFO [Thread-5779] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:35,236  INFO [Thread-5779] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:35,236  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1119390526_0068_m_000000_0
2024-04-24T02:33:35,237  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:35,237  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-34_797_3322403195265410867-1/dummy_path/null:0+1
2024-04-24T02:33:35,238  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:35,238  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,15KB
2024-04-24T02:33:35,238  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:33:35,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:33:35,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:33:35,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:33:35,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:33:35,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:33:35,244  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:33:35,244  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:35,244  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:35,245  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:35,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:35,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:33:35,245  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:33:35,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:35,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int,col3:int>
2024-04-24T02:33:35,245  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:33:35,246  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:33:35,246  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:33:35,246  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:33:35,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:35,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:3, 
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 3. abort - false
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:3, RECORDS_OUT_INTERMEDIATE:3, 
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 51; bufvoid = 104857600
2024-04-24T02:33:35,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214388(104857552); length = 9/6553600
2024-04-24T02:33:35,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:33:35,261  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1119390526_0068_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:35,261  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:33:35,261  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1119390526_0068_m_000000_0' done.
2024-04-24T02:33:35,261  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1119390526_0068_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1380196
		FILE: Number of bytes written=80125165
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=3
		Map output bytes=51
		Map output materialized bytes=69
		Input split bytes=361
		Combine input records=0
		Spilled Records=3
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1409810432
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=3
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=3
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=3
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=3
	File Input Format Counters 
		Bytes Read=5201
2024-04-24T02:33:35,261  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1119390526_0068_m_000000_0
2024-04-24T02:33:35,261  INFO [Thread-5779] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:33:35,263  INFO [Thread-5779] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:33:35,263  INFO [pool-340-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1119390526_0068_r_000000_0
2024-04-24T02:33:35,264  INFO [pool-340-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:35,264  INFO [pool-340-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4fb98a4a
2024-04-24T02:33:35,264  WARN [pool-340-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:35,265  INFO [pool-340-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:35,265  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1119390526_0068_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:35,268  INFO [localfetcher#93] reduce.LocalFetcher: localfetcher#93 about to shuffle output of map attempt_local1119390526_0068_m_000000_0 decomp: 21 len: 25 to MEMORY
2024-04-24T02:33:35,268  INFO [localfetcher#93] reduce.InMemoryMapOutput: Read 21 bytes from map-output for attempt_local1119390526_0068_m_000000_0
2024-04-24T02:33:35,268  INFO [localfetcher#93] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 21, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->21
2024-04-24T02:33:35,269  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:35,269  INFO [pool-340-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:35,269  INFO [pool-340-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:35,276  INFO [pool-340-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:35,276  INFO [pool-340-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-24T02:33:35,279  INFO [pool-340-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 21 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:35,279  INFO [pool-340-thread-1] reduce.MergeManagerImpl: Merging 1 files, 25 bytes from disk
2024-04-24T02:33:35,279  INFO [pool-340-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:35,279  INFO [pool-340-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:35,279  INFO [pool-340-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-24T02:33:35,279  INFO [pool-340-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:35,279  INFO [pool-340-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:35,280  INFO [pool-340-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-24T02:33:35,280  INFO [pool-340-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:35,280  INFO [pool-340-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:33:35,280  INFO [pool-340-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-24T02:33:35,280  INFO [pool-340-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:33:35,281  INFO [pool-340-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1119390526_0068/job_local1119390526_0068.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@600fe184
2024-04-24T02:33:35,281  INFO [pool-340-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:35,281  INFO [pool-340-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:35,281  INFO [pool-340-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:35,281  INFO [pool-340-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:35,282  INFO [pool-340-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:35,288  INFO [pool-340-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:35,293  INFO [pool-340-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:33:35,293  INFO [pool-340-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:33:35,293  INFO [pool-340-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:33:35,293  INFO [pool-340-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:35,294  INFO [pool-340-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:33:35,305  INFO [pool-340-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.target:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-24T02:33:35,305  INFO [pool-340-thread-1] mapred.Task: Task:attempt_local1119390526_0068_r_000000_0 is done. And is in the process of committing
2024-04-24T02:33:35,306  INFO [pool-340-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:35,306  INFO [pool-340-thread-1] mapred.Task: Task 'attempt_local1119390526_0068_r_000000_0' done.
2024-04-24T02:33:35,306  INFO [pool-340-thread-1] mapred.Task: Final Counters for attempt_local1119390526_0068_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1386570
		FILE: Number of bytes written=80126246
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=25
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1409810432
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:35,306  INFO [pool-340-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1119390526_0068_r_000000_0
2024-04-24T02:33:35,306  INFO [pool-340-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1119390526_0068_r_000001_0
2024-04-24T02:33:35,306  INFO [pool-340-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:35,306  INFO [pool-340-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@367c75a5
2024-04-24T02:33:35,306  WARN [pool-340-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:35,307  INFO [pool-340-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:35,307  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1119390526_0068_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:35,311  INFO [localfetcher#94] reduce.LocalFetcher: localfetcher#94 about to shuffle output of map attempt_local1119390526_0068_m_000000_0 decomp: 40 len: 44 to MEMORY
2024-04-24T02:33:35,311  INFO [localfetcher#94] reduce.InMemoryMapOutput: Read 40 bytes from map-output for attempt_local1119390526_0068_m_000000_0
2024-04-24T02:33:35,311  INFO [localfetcher#94] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 40, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->40
2024-04-24T02:33:35,312  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:35,313  INFO [pool-340-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:35,313  INFO [pool-340-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:35,327  INFO [pool-340-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:35,327  INFO [pool-340-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-24T02:33:35,333  INFO [pool-340-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 40 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:35,334  INFO [pool-340-thread-1] reduce.MergeManagerImpl: Merging 1 files, 44 bytes from disk
2024-04-24T02:33:35,334  INFO [pool-340-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:35,334  INFO [pool-340-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:35,334  INFO [pool-340-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-24T02:33:35,334  INFO [pool-340-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:35,335  INFO [pool-340-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:35,336  INFO [pool-340-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-24T02:33:35,338  INFO [pool-340-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:35,338  INFO [pool-340-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:33:35,338  INFO [pool-340-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-24T02:33:35,338  INFO [pool-340-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:33:35,339  INFO [pool-340-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1119390526_0068/job_local1119390526_0068.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@674d26ee
2024-04-24T02:33:35,340  INFO [pool-340-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:35,340  INFO [pool-340-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:35,340  INFO [pool-340-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:35,341  INFO [pool-340-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:35,341  INFO [pool-340-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:35,354  INFO [pool-340-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:35,355  INFO [pool-340-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:33:35,355  INFO [pool-340-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T02:33:35,355  INFO [pool-340-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:33:35,355  INFO [pool-340-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:33:35,359  INFO [pool-340-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:33:35,384  INFO [pool-340-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.target:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T02:33:35,385  INFO [pool-340-thread-1] mapred.Task: Task:attempt_local1119390526_0068_r_000001_0 is done. And is in the process of committing
2024-04-24T02:33:35,386  INFO [pool-340-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:35,386  INFO [pool-340-thread-1] mapred.Task: Task 'attempt_local1119390526_0068_r_000001_0' done.
2024-04-24T02:33:35,386  INFO [pool-340-thread-1] mapred.Task: Final Counters for attempt_local1119390526_0068_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1392938
		FILE: Number of bytes written=80127365
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=44
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1409810432
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:35,386  INFO [pool-340-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1119390526_0068_r_000001_0
2024-04-24T02:33:35,387  INFO [Thread-5779] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:33:36,237 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:33:36,237  INFO [main] exec.Task: 2024-04-24 02:33:36,237 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1119390526_0068
2024-04-24T02:33:36,239  INFO [main] exec.Task: Ended Job = job_local1119390526_0068
2024-04-24T02:33:36,241  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:33:36,241  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:33:36,241  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:33:36,241  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:33:36,241  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000
2024-04-24T02:33:36,242  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.target
2024-04-24T02:33:36,242  INFO [main] exec.Task: Loading data to table default.target from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:36,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:36,250  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,250  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:36,256  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-24T02:33:36,281  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:33:36,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:36,287  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,287  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:33:36,287  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-34_797_3322403195265410867-1/-mr-10000
2024-04-24T02:33:36,289  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:36,295  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,306  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:33:36,306  INFO [main] FileOperations: Read stats for default.target/, numRows, true, 3, false: 
2024-04-24T02:33:36,306  INFO [main] FileOperations: Read stats for default.target/, rawDataSize, true, 0, false: 
2024-04-24T02:33:36,307  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-24T02:33:36,327  INFO [main] FileOperations: Read stats for default.target/, insertCount, true, 3, false: 
2024-04-24T02:33:36,327  INFO [main] FileOperations: Read stats for default.target/, updateCount, true, 0, false: 
2024-04-24T02:33:36,327  INFO [main] FileOperations: Read stats for default.target/, deleteCount, true, 0, false: 
2024-04-24T02:33:36,329  INFO [main] stats.BasicStatsTask: Table default.target stats: [numFiles=2, numRows=3, totalSize=1460, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:33:36,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:36,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, getTable_(GetTableRequest)=26, alter_table_(String, String, String, Table, EnvironmentContext, String)=45, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:33:36,330  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:36,330  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:36,330  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:36,330  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce); Time taken: 1.381 seconds
2024-04-24T02:33:36,330  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023334_581e81c8-90c0-485e-9b09-89b21cc5d9ce
2024-04-24T02:33:36,340  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:36,340  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:33:36,341  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into source  values(1,7),(3,8)
2024-04-24T02:33:36,341  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-34_797_3322403195265410867-1
2024-04-24T02:33:36,341  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-34_797_3322403195265410867-1 on fs with scheme file
2024-04-24T02:33:36,341  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0): insert into source  values(1,7),(3,8)
2024-04-24T02:33:36,343  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-24T02:33:36,344  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:33:36,344  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:36,344  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:36,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:36,369  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,369  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:36,369  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:36,369  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:36,369  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:36,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:36,377  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,377  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:36,377  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:36,397  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:36,445  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:36,445  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:36,445  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:36,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:36,449  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:36,449  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:36,449  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:36,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:36,457  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,459  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1
2024-04-24T02:33:36,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.source	
2024-04-24T02:33:36,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.source	
2024-04-24T02:33:36,464  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:36,466  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:33:36,467  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:36,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:36,483  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,483  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T02:33:36,484  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:36,492  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:36,507  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:36,507  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:36,507  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:36,507  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:33:36,507  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:36,507  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, getTable_(GetTableRequest)=57, commitTxn_(CommitTxnRequest)=10, getCheckConstraints_(CheckConstraintsRequest)=0, openTxn_(String, TxnType)=2, getNotNullConstraints_(NotNullConstraintsRequest)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=5}
2024-04-24T02:33:36,508  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0); Time taken: 0.166 seconds
2024-04-24T02:33:36,508  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0
2024-04-24T02:33:36,508  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0
2024-04-24T02:33:36,521  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:33:36,521  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:36,521  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0): insert into source  values(1,7),(3,8)
2024-04-24T02:33:36,522  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0
2024-04-24T02:33:36,522  INFO [main] ql.Driver: Query ID = alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0
Total jobs = 3
2024-04-24T02:33:36,522  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-24T02:33:36,522  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-24T02:33:36,663  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:33:36,663  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:33:36,665  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:36,665  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:33:36,665  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-36_341_6813455380549732853-1/dummy_path
2024-04-24T02:33:36,674  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:36,675  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,68KB
2024-04-24T02:33:36,676  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:36,679  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-36_341_6813455380549732853-1/-mr-10001
2024-04-24T02:33:36,683  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:36,690  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:36,694  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:36,695  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:33:36,695  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:33:36,695  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-36_341_6813455380549732853-1/dummy_path
2024-04-24T02:33:36,696  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:33:36,712  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:33:36,730  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1364710237_0069
2024-04-24T02:33:36,730  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:36,788  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:36,788  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:36,788  INFO [Thread-5853] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:36,788  INFO [Thread-5853] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:36,790  INFO [Thread-5853] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:36,790  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1364710237_0069_m_000000_0
2024-04-24T02:33:36,790  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:36,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-36_341_6813455380549732853-1/dummy_path/null:0+1
2024-04-24T02:33:36,791  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:36,791  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,68KB
2024-04-24T02:33:36,792  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T02:33:36,792  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:36,792  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:36,793  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:36,793  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:36,793  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:33:36,793  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:33:36,793  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:36,793  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:33:36,793  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:33:36,794  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@36eb7825, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@55ec52ac, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [key, data] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@67894173
2024-04-24T02:33:36,794  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1/_tmp.-ext-10002/000000_0
2024-04-24T02:33:36,794  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:33:36,794  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1/_tmp.-ext-10002/000000_0
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:33:36,801  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T02:33:36,806  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_1_default.source:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T02:33:36,807  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:36,807  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1364710237_0069_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:36,808  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:33:36,808  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1364710237_0069_m_000000_0' done.
2024-04-24T02:33:36,808  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1364710237_0069_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1399712
		FILE: Number of bytes written=81300044
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1409810432
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.source=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=5735
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:36,808  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1364710237_0069_m_000000_0
2024-04-24T02:33:36,808  INFO [Thread-5853] mapred.LocalJobRunner: map task executor complete.
2024-04-24 02:33:37,790 Stage-1 map = 100%,  reduce = 0%
2024-04-24T02:33:37,790  INFO [main] exec.Task: 2024-04-24 02:33:37,790 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1364710237_0069
2024-04-24T02:33:37,791  INFO [main] exec.Task: Ended Job = job_local1364710237_0069
2024-04-24T02:33:37,795  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T02:33:37,796  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T02:33:37,796  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T02:33:37,796  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T02:33:37,796  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1/-ext-10000
2024-04-24T02:33:37,797  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1/-ext-10002
2024-04-24T02:33:37,798  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.source
2024-04-24T02:33:37,798  INFO [main] exec.Task: Loading data to table default.source from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1/-ext-10000
2024-04-24T02:33:37,799  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:37,827  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,827  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:37,841  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,842  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-24T02:33:37,843  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-24T02:33:37,865  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:33:37,865  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:37,873  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,873  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:33:37,873  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-36_341_6813455380549732853-1/-mr-10001
2024-04-24T02:33:37,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:37,882  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,883  INFO [main] FileOperations: Read stats for default.source/, numRows, true, 2, false: 
2024-04-24T02:33:37,883  INFO [main] FileOperations: Read stats for default.source/, rawDataSize, true, 6, false: 
2024-04-24T02:33:37,883  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-24T02:33:37,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-24T02:33:37,906  INFO [main] stats.BasicStatsTask: Table default.source stats: [numFiles=1, numRows=2, totalSize=8, rawDataSize=6, numFilesErasureCoded=0]
2024-04-24T02:33:37,906  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:37,906  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=59, isCompatibleWith_(Configuration)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=46}
MapReduce Jobs Launched: 
2024-04-24T02:33:37,907  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:37,907  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:37,907  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:37,907  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0); Time taken: 1.385 seconds
2024-04-24T02:33:37,907  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023336_2f73bbee-4a64-4b4e-bfd5-e64df3c2f5b0
2024-04-24T02:33:37,910  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:33:37,916  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:37,916  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:33:37,916  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-24T02:33:37,916  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-36_341_6813455380549732853-1
2024-04-24T02:33:37,917  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-36_341_6813455380549732853-1 on fs with scheme file
2024-04-24T02:33:37,917  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1
2024-04-24T02:33:37,917  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-36_341_6813455380549732853-1 on fs with scheme file
2024-04-24T02:33:37,917  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023337_bee5e15d-c10e-49a5-98a5-76daf7af73c2): merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-24T02:33:37,921  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T02:33:37,921  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T02:33:37,922  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:33:37,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:37,928  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,930  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-24T02:33:37,934  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/ecf46847-a7a5-490e-b766-f0e419a93fd3/_tmp_space.db/merge_tmp_table
2024-04-24T02:33:37,936  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)> as 
<FROM
  `default`.`target` `t`
  RIGHT OUTER JOIN
  (select `curMatch`.*, case when `splitTable`.`op` is null or `splitTable`.`op` = 0 then 0 else 1 end `o/p\n` from (select `s`.*, case when `t`.`cur` is null then 0 else 1 end `m` from `source` `s` left outer join (select * from `target` where `target`.`cur`=1) `t` on `s`.`key`=`t`.`key`) `curMatch` left outer join `splitTable` on `curMatch`.`m`=1) `s`
  ON `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
INSERT INTO `default`.`target`    -- update clause(insert part)
 SELECT `t`.`key`, `t`.`data`, 0
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
INSERT INTO `default`.`target`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`target`    -- insert clause
  SELECT `s`.`key`,`s`.`data`,1
   WHERE `t`.`key` IS NULL AND `t`.`cur` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1 GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-24T02:33:37,937  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:33:37,941  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:37,941  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:37,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:37,948  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,948  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:37,948  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:37,949  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:37,957  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,957  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:37,957  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:37,958  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:37,966  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,966  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:37,966  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:37,966  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:37,966  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:37,967  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:37,967  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:37,967  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:37,967  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:37,973  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:37,980  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:37,987  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:37,987  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:37,987  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:37,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:37,989  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:38,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-24T02:33:38,009  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-24T02:33:38,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.splittable	
2024-04-24T02:33:38,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-24T02:33:38,112  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T02:33:38,112  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:38,121  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:38,130  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.target	
2024-04-24T02:33:38,140  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: cur, data, key
No Stats for default@target, Columns: cur, data, key
2024-04-24T02:33:38,140  INFO [main] SessionState: No Stats for default@target, Columns: cur, data, key
2024-04-24T02:33:38,141  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:33:38,142  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:38,155  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:38,168  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.source	
2024-04-24T02:33:38,182  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: data, key
No Stats for default@source, Columns: data, key
2024-04-24T02:33:38,182  INFO [main] SessionState: No Stats for default@source, Columns: data, key
2024-04-24T02:33:38,182  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 2], allowMissingStats: true
2024-04-24T02:33:38,183  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: key, cur
No Stats for default@target, Columns: key, cur
2024-04-24T02:33:38,183  INFO [main] SessionState: No Stats for default@target, Columns: key, cur
2024-04-24T02:33:38,185  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.splittable, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:33:38,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:38,197  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,197  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-24T02:33:38,208  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,208  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.splittable	
2024-04-24T02:33:38,221  WARN [main] calcite.RelOptHiveTable: No Stats for default@splittable, Columns: op
No Stats for default@splittable, Columns: op
2024-04-24T02:33:38,221  INFO [main] SessionState: No Stats for default@splittable, Columns: op
2024-04-24T02:33:38,499  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:38,499  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:38,499  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:38,499  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:38,499  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:38,499  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:38,499  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:38,499  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:38,500  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:38,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:38,507  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:38,514  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:38,521  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,531 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:33:38,532 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:33:38,532  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:33:38,532 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:33:38,532  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:38,533  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, getValidWriteIds_(List, String)=6, getTable_(GetTableRequest)=70, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=19, openTxn_(String, TxnType)=2, getTableColumnStatistics_(String, String, List, String)=102, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:33:38,533  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023337_bee5e15d-c10e-49a5-98a5-76daf7af73c2); Time taken: 0.615 seconds
2024-04-24T02:33:38,533  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:33:38,536  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:38,543  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:38,543  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ecf46847-a7a5-490e-b766-f0e419a93fd3/hive_2024-04-24_02-33-37_936_3915326389159221013-1
2024-04-24T02:33:38,544  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023338_f78e6d63-b501-4406-807d-9e47cfaf31d1): drop table if exists acidTbl
2024-04-24T02:33:38,546  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T02:33:38,546  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T02:33:38,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:38,553  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,553  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:38,553  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:38,553  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:38,554  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, getValidTxns_(long)=1, flushCache_()=0, rollbackTxn_(long)=10}
2024-04-24T02:33:38,554  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023338_f78e6d63-b501-4406-807d-9e47cfaf31d1); Time taken: 0.009 seconds
2024-04-24T02:33:38,554  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424023338_f78e6d63-b501-4406-807d-9e47cfaf31d1
2024-04-24T02:33:38,554  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023338_f78e6d63-b501-4406-807d-9e47cfaf31d1
2024-04-24T02:33:38,570  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023338_f78e6d63-b501-4406-807d-9e47cfaf31d1 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:33:38,570  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:38,570  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023338_f78e6d63-b501-4406-807d-9e47cfaf31d1): drop table if exists acidTbl
2024-04-24T02:33:38,570  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:38,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:38,577  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:38,584  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,584  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:38,696  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:38,696  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=119, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-24T02:33:38,696  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023338_f78e6d63-b501-4406-807d-9e47cfaf31d1); Time taken: 0.126 seconds
2024-04-24T02:33:38,696  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023338_f78e6d63-b501-4406-807d-9e47cfaf31d1
2024-04-24T02:33:38,701  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T02:33:38,707  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:38,708  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T02:33:38,708  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:38,708  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023338_7b642e52-8c92-4587-8d68-248906933d17): drop table if exists acidTblPart
2024-04-24T02:33:38,715  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T02:33:38,715  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T02:33:38,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:38,726  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,726  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:38,726  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:38,726  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:38,726  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=6, getTable_(GetTableRequest)=8}
2024-04-24T02:33:38,727  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023338_7b642e52-8c92-4587-8d68-248906933d17); Time taken: 0.018 seconds
2024-04-24T02:33:38,727  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424023338_7b642e52-8c92-4587-8d68-248906933d17
2024-04-24T02:33:38,727  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023338_7b642e52-8c92-4587-8d68-248906933d17
2024-04-24T02:33:38,747  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023338_7b642e52-8c92-4587-8d68-248906933d17 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T02:33:38,747  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:38,747  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023338_7b642e52-8c92-4587-8d68-248906933d17): drop table if exists acidTblPart
2024-04-24T02:33:38,747  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:38,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:38,754  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:38,761  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:38,804  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:38,805  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=50, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-24T02:33:38,805  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023338_7b642e52-8c92-4587-8d68-248906933d17); Time taken: 0.057 seconds
2024-04-24T02:33:38,805  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023338_7b642e52-8c92-4587-8d68-248906933d17
2024-04-24T02:33:38,809  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-24T02:33:38,815  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:38,816  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-24T02:33:38,816  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:38,816  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023338_9faf9d58-6072-4721-a8fb-c993aa96da75): drop table if exists acidTbl2
2024-04-24T02:33:38,818  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T02:33:38,818  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T02:33:38,819  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:38,819  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:38,819  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:38,819  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0}
2024-04-24T02:33:38,819  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023338_9faf9d58-6072-4721-a8fb-c993aa96da75); Time taken: 0.003 seconds
2024-04-24T02:33:38,820  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424023338_9faf9d58-6072-4721-a8fb-c993aa96da75
2024-04-24T02:33:38,820  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:38,820  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023338_9faf9d58-6072-4721-a8fb-c993aa96da75): drop table if exists acidTbl2
2024-04-24T02:33:38,820  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:38,820  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:33:38,821  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:38,821  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:38,821  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023338_9faf9d58-6072-4721-a8fb-c993aa96da75); Time taken: 0.001 seconds
2024-04-24T02:33:38,821  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023338_9faf9d58-6072-4721-a8fb-c993aa96da75
2024-04-24T02:33:38,826  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T02:33:38,833  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:38,833  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T02:33:38,833  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:38,833  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023338_164dcc7e-5ed0-4e31-b0b2-46b3662a6ade): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:38,835  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-24T02:33:38,836  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T02:33:38,836  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:38,858  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,858  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:38,858  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:38,858  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:38,858  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=22}
2024-04-24T02:33:38,859  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023338_164dcc7e-5ed0-4e31-b0b2-46b3662a6ade); Time taken: 0.025 seconds
2024-04-24T02:33:38,859  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424023338_164dcc7e-5ed0-4e31-b0b2-46b3662a6ade
2024-04-24T02:33:38,859  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023338_164dcc7e-5ed0-4e31-b0b2-46b3662a6ade
2024-04-24T02:33:38,874  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023338_164dcc7e-5ed0-4e31-b0b2-46b3662a6ade LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T02:33:38,874  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:38,874  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023338_164dcc7e-5ed0-4e31-b0b2-46b3662a6ade): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:38,874  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:38,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:38,883  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:38,892  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,892  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:38,941  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:38,941  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=58}
2024-04-24T02:33:38,941  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023338_164dcc7e-5ed0-4e31-b0b2-46b3662a6ade); Time taken: 0.067 seconds
2024-04-24T02:33:38,941  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023338_164dcc7e-5ed0-4e31-b0b2-46b3662a6ade
2024-04-24T02:33:38,945  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T02:33:38,951  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:38,951  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T02:33:38,952  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:38,952  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023338_34b9c36f-7b8b-447c-bfd3-96e9e8067e7c): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:38,954  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 23
2024-04-24T02:33:38,954  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T02:33:38,955  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:38,963  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,963  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:38,963  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:38,963  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:38,963  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=8}
2024-04-24T02:33:38,964  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023338_34b9c36f-7b8b-447c-bfd3-96e9e8067e7c); Time taken: 0.011 seconds
2024-04-24T02:33:38,964  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:27 for queryId=alex_20240424023338_34b9c36f-7b8b-447c-bfd3-96e9e8067e7c
2024-04-24T02:33:38,964  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023338_34b9c36f-7b8b-447c-bfd3-96e9e8067e7c
2024-04-24T02:33:38,978  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023338_34b9c36f-7b8b-447c-bfd3-96e9e8067e7c LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T02:33:38,978  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:38,978  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023338_34b9c36f-7b8b-447c-bfd3-96e9e8067e7c): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:38,978  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:38,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:38,987  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,987  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:38,995  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:38,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:39,026  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,026  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=39, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,026  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023338_34b9c36f-7b8b-447c-bfd3-96e9e8067e7c); Time taken: 0.048 seconds
2024-04-24T02:33:39,026  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023338_34b9c36f-7b8b-447c-bfd3-96e9e8067e7c
2024-04-24T02:33:39,030  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T02:33:39,035  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,036  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T02:33:39,036  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:39,036  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_86f85f08-5d3f-457d-b067-38bd4f6ef6d7): drop table if exists nonAcidNonBucket
2024-04-24T02:33:39,038  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 23
2024-04-24T02:33:39,039  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T02:33:39,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:39,047  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,047  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,047  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,047  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,048  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T02:33:39,048  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_86f85f08-5d3f-457d-b067-38bd4f6ef6d7); Time taken: 0.011 seconds
2024-04-24T02:33:39,048  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424023339_86f85f08-5d3f-457d-b067-38bd4f6ef6d7
2024-04-24T02:33:39,048  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_86f85f08-5d3f-457d-b067-38bd4f6ef6d7
2024-04-24T02:33:39,062  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_86f85f08-5d3f-457d-b067-38bd4f6ef6d7 LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T02:33:39,063  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:39,063  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_86f85f08-5d3f-457d-b067-38bd4f6ef6d7): drop table if exists nonAcidNonBucket
2024-04-24T02:33:39,063  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:39,071  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,072  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:39,080  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:39,111  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,111  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=39, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,111  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_86f85f08-5d3f-457d-b067-38bd4f6ef6d7); Time taken: 0.048 seconds
2024-04-24T02:33:39,111  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_86f85f08-5d3f-457d-b067-38bd4f6ef6d7
2024-04-24T02:33:39,115  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T02:33:39,121  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,121  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T02:33:39,121  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeType2SCD02" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.213">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:33:39,183  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:33:39,183  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:33:39,183  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:33:39,183  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:33:39,183  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:33:39,183  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:33:39,183  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:33:39,184  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:33:39,184  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:33:39,184  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:33:39,184  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:33:39,186  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 0a86281f-2df3-40be-b2e4-8ce8a85be5b5
2024-04-24T02:33:39,188  INFO [main] SessionState: Hive Session ID = 0a86281f-2df3-40be-b2e4-8ce8a85be5b5
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:39,189  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:39,194  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0a86281f-2df3-40be-b2e4-8ce8a85be5b5
2024-04-24T02:33:39,196  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5
2024-04-24T02:33:39,198  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/_tmp_space.db
2024-04-24T02:33:39,199  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=0a86281f-2df3-40be-b2e4-8ce8a85be5b5, clientType=HIVECLI]
2024-04-24T02:33:39,199  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:39,199  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_e418c254-107a-4f0c-a37e-ef18ae12217a): drop table if exists acidTbl
2024-04-24T02:33:39,206  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:33:39,207  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:33:39,209  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:39,214  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,214  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,214  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,214  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=7}
2024-04-24T02:33:39,214  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_e418c254-107a-4f0c-a37e-ef18ae12217a); Time taken: 0.015 seconds
2024-04-24T02:33:39,215  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023339_e418c254-107a-4f0c-a37e-ef18ae12217a
2024-04-24T02:33:39,215  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:39,215  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_e418c254-107a-4f0c-a37e-ef18ae12217a): drop table if exists acidTbl
2024-04-24T02:33:39,215  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:39,218  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,218  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,218  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_e418c254-107a-4f0c-a37e-ef18ae12217a); Time taken: 0.003 seconds
2024-04-24T02:33:39,218  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_e418c254-107a-4f0c-a37e-ef18ae12217a
2024-04-24T02:33:39,224  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:33:39,230  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,230  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:33:39,230  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:39,230  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_16d19e0d-a356-4794-8cbb-30b6edd599ad): drop table if exists acidTblPart
2024-04-24T02:33:39,232  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:33:39,233  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:33:39,233  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:39,236  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,236  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,236  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,236  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:33:39,236  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_16d19e0d-a356-4794-8cbb-30b6edd599ad); Time taken: 0.006 seconds
2024-04-24T02:33:39,237  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023339_16d19e0d-a356-4794-8cbb-30b6edd599ad
2024-04-24T02:33:39,237  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:39,237  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_16d19e0d-a356-4794-8cbb-30b6edd599ad): drop table if exists acidTblPart
2024-04-24T02:33:39,237  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:39,240  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,240  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,240  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_16d19e0d-a356-4794-8cbb-30b6edd599ad); Time taken: 0.003 seconds
2024-04-24T02:33:39,240  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_16d19e0d-a356-4794-8cbb-30b6edd599ad
2024-04-24T02:33:39,246  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:33:39,251  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,252  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:33:39,252  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:39,252  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_f3e3874d-dc2e-4d76-89ba-70863c1f738e): drop table if exists acidTbl2
2024-04-24T02:33:39,254  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:33:39,254  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:33:39,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:39,258  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,258  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,258  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,258  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, flushCache_()=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:33:39,258  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_f3e3874d-dc2e-4d76-89ba-70863c1f738e); Time taken: 0.006 seconds
2024-04-24T02:33:39,258  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023339_f3e3874d-dc2e-4d76-89ba-70863c1f738e
2024-04-24T02:33:39,258  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:39,258  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_f3e3874d-dc2e-4d76-89ba-70863c1f738e): drop table if exists acidTbl2
2024-04-24T02:33:39,258  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:39,261  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,262  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:39,262  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_f3e3874d-dc2e-4d76-89ba-70863c1f738e); Time taken: 0.003 seconds
2024-04-24T02:33:39,262  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_f3e3874d-dc2e-4d76-89ba-70863c1f738e
2024-04-24T02:33:39,267  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:33:39,273  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,273  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:33:39,273  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:39,273  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_498e5bff-2abc-41a4-bdc3-eb318112fb99): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:39,275  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:33:39,276  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:33:39,276  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:39,279  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,279  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,279  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,279  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,279  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_498e5bff-2abc-41a4-bdc3-eb318112fb99); Time taken: 0.006 seconds
2024-04-24T02:33:39,279  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023339_498e5bff-2abc-41a4-bdc3-eb318112fb99
2024-04-24T02:33:39,279  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:39,279  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_498e5bff-2abc-41a4-bdc3-eb318112fb99): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:39,280  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,280  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:39,283  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,283  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,283  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_498e5bff-2abc-41a4-bdc3-eb318112fb99); Time taken: 0.004 seconds
2024-04-24T02:33:39,283  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_498e5bff-2abc-41a4-bdc3-eb318112fb99
2024-04-24T02:33:39,288  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:33:39,294  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,294  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:33:39,294  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:39,295  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_7ba5c536-5ccf-4797-beef-68b3bfe05621): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:39,296  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:33:39,297  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:33:39,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:39,300  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,300  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,300  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,300  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,300  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_7ba5c536-5ccf-4797-beef-68b3bfe05621); Time taken: 0.005 seconds
2024-04-24T02:33:39,301  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023339_7ba5c536-5ccf-4797-beef-68b3bfe05621
2024-04-24T02:33:39,301  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:39,301  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_7ba5c536-5ccf-4797-beef-68b3bfe05621): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:39,301  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:39,304  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,304  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,304  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_7ba5c536-5ccf-4797-beef-68b3bfe05621); Time taken: 0.003 seconds
2024-04-24T02:33:39,304  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_7ba5c536-5ccf-4797-beef-68b3bfe05621
2024-04-24T02:33:39,310  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:33:39,315  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,316  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:33:39,316  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:39,316  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_43c01c52-29d9-4f72-a4ed-79442c73c9ef): drop table if exists nonAcidNonBucket
2024-04-24T02:33:39,318  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:33:39,318  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:33:39,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:39,322  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,322  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,322  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,322  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=1, flushCache_()=0}
2024-04-24T02:33:39,322  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_43c01c52-29d9-4f72-a4ed-79442c73c9ef); Time taken: 0.006 seconds
2024-04-24T02:33:39,322  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023339_43c01c52-29d9-4f72-a4ed-79442c73c9ef
2024-04-24T02:33:39,322  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:39,322  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_43c01c52-29d9-4f72-a4ed-79442c73c9ef): drop table if exists nonAcidNonBucket
2024-04-24T02:33:39,322  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,323  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:39,325  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,326  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:39,326  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_43c01c52-29d9-4f72-a4ed-79442c73c9ef); Time taken: 0.003 seconds
2024-04-24T02:33:39,326  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_43c01c52-29d9-4f72-a4ed-79442c73c9ef
2024-04-24T02:33:39,331  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:33:39,336  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,337  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:33:39,337  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,337  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_38f5b64f-63e4-48fe-ba97-f646c8720f0b): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,339  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:33:39,340  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:33:39,340  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:39,340  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:39,345  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:33:39,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:39,347  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:39,347  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,347  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,347  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,347  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=5, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:39,348  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_38f5b64f-63e4-48fe-ba97-f646c8720f0b); Time taken: 0.01 seconds
2024-04-24T02:33:39,348  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023339_38f5b64f-63e4-48fe-ba97-f646c8720f0b
2024-04-24T02:33:39,348  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_38f5b64f-63e4-48fe-ba97-f646c8720f0b
2024-04-24T02:33:39,365  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_38f5b64f-63e4-48fe-ba97-f646c8720f0b LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:33:39,365  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:39,366  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_38f5b64f-63e4-48fe-ba97-f646c8720f0b): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,366  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951219, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, rawDataSize=0, numRows=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:39,372  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:39,410  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,410  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,411  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_38f5b64f-63e4-48fe-ba97-f646c8720f0b); Time taken: 0.044 seconds
2024-04-24T02:33:39,411  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_38f5b64f-63e4-48fe-ba97-f646c8720f0b
2024-04-24T02:33:39,414  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:33:39,420  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,420  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:33:39,421  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,421  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_de59da39-4e7a-4e56-acc5-f489e090a0bf): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,423  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:33:39,423  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:33:39,424  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:39,424  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:39,426  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:33:39,426  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:39,431  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:39,431  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,431  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,431  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,431  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=5, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:39,431  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_de59da39-4e7a-4e56-acc5-f489e090a0bf); Time taken: 0.01 seconds
2024-04-24T02:33:39,432  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023339_de59da39-4e7a-4e56-acc5-f489e090a0bf
2024-04-24T02:33:39,432  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_de59da39-4e7a-4e56-acc5-f489e090a0bf
2024-04-24T02:33:39,445  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_de59da39-4e7a-4e56-acc5-f489e090a0bf LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:33:39,445  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:39,446  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_de59da39-4e7a-4e56-acc5-f489e090a0bf): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,446  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951219, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:39,453  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:33:39,468  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,469  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,469  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_de59da39-4e7a-4e56-acc5-f489e090a0bf); Time taken: 0.022 seconds
2024-04-24T02:33:39,469  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_de59da39-4e7a-4e56-acc5-f489e090a0bf
2024-04-24T02:33:39,473  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:33:39,480  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,480  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:33:39,481  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,481  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_7a21a482-9958-4f51-9d59-4287ec69090b): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,483  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:33:39,484  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:33:39,484  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:39,484  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:39,487  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:33:39,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:39,488  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:39,488  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,488  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,489  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,489  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, flushCache_()=0}
2024-04-24T02:33:39,489  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_7a21a482-9958-4f51-9d59-4287ec69090b); Time taken: 0.007 seconds
2024-04-24T02:33:39,489  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023339_7a21a482-9958-4f51-9d59-4287ec69090b
2024-04-24T02:33:39,489  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_7a21a482-9958-4f51-9d59-4287ec69090b
2024-04-24T02:33:39,504  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_7a21a482-9958-4f51-9d59-4287ec69090b LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:33:39,504  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:39,504  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_7a21a482-9958-4f51-9d59-4287ec69090b): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,505  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951219, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=false, numRows=0, numFilesErasureCoded=0, numFiles=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:39,511  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:33:39,526  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,526  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-24T02:33:39,526  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_7a21a482-9958-4f51-9d59-4287ec69090b); Time taken: 0.022 seconds
2024-04-24T02:33:39,526  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_7a21a482-9958-4f51-9d59-4287ec69090b
2024-04-24T02:33:39,530  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:33:39,536  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,536  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:33:39,537  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,537  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_312d9f23-3665-438f-bd5a-b5d136a267c0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,540  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:33:39,540  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:33:39,540  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:39,540  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:39,543  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:33:39,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:39,544  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:39,544  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,544  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,544  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,544  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2}
2024-04-24T02:33:39,545  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_312d9f23-3665-438f-bd5a-b5d136a267c0); Time taken: 0.007 seconds
2024-04-24T02:33:39,545  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023339_312d9f23-3665-438f-bd5a-b5d136a267c0
2024-04-24T02:33:39,545  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_312d9f23-3665-438f-bd5a-b5d136a267c0
2024-04-24T02:33:39,560  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_312d9f23-3665-438f-bd5a-b5d136a267c0 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:33:39,560  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:39,560  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_312d9f23-3665-438f-bd5a-b5d136a267c0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,560  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,561  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951219, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, totalSize=0, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:39,567  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:33:39,581  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,581  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,582  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_312d9f23-3665-438f-bd5a-b5d136a267c0); Time taken: 0.021 seconds
2024-04-24T02:33:39,582  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_312d9f23-3665-438f-bd5a-b5d136a267c0
2024-04-24T02:33:39,586  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:33:39,592  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,592  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:33:39,593  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,593  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_baea38b0-6adb-4425-becf-da554086b017): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,596  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:33:39,596  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:33:39,596  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:39,596  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:39,599  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:33:39,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:39,600  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:39,601  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,601  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,601  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,601  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=2, getDatabase_(String)=1, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:39,601  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_baea38b0-6adb-4425-becf-da554086b017); Time taken: 0.008 seconds
2024-04-24T02:33:39,601  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023339_baea38b0-6adb-4425-becf-da554086b017
2024-04-24T02:33:39,601  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_baea38b0-6adb-4425-becf-da554086b017
2024-04-24T02:33:39,616  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_baea38b0-6adb-4425-becf-da554086b017 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:33:39,616  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:39,616  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_baea38b0-6adb-4425-becf-da554086b017): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:39,617  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,617  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/_tmp_space.db/b44fc46a-59d3-4b53-bc1a-d0d0785179ad
2024-04-24T02:33:39,620  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,620  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,621  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_baea38b0-6adb-4425-becf-da554086b017); Time taken: 0.004 seconds
2024-04-24T02:33:39,621  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_baea38b0-6adb-4425-becf-da554086b017
2024-04-24T02:33:39,625  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:33:39,632  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,632  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:33:39,632  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,632  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_1b2d53b3-43bd-4c7a-a277-c84324b19c86): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,634  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:33:39,635  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:33:39,635  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:39,635  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:39,637  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:33:39,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:39,639  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:39,639  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,639  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,639  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,640  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, getDatabase_(String)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:33:39,640  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_1b2d53b3-43bd-4c7a-a277-c84324b19c86); Time taken: 0.007 seconds
2024-04-24T02:33:39,640  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023339_1b2d53b3-43bd-4c7a-a277-c84324b19c86
2024-04-24T02:33:39,640  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_1b2d53b3-43bd-4c7a-a277-c84324b19c86
2024-04-24T02:33:39,655  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_1b2d53b3-43bd-4c7a-a277-c84324b19c86 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:33:39,655  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:39,655  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_1b2d53b3-43bd-4c7a-a277-c84324b19c86): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:39,655  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,656  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951219, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numFiles=0, bucketing_version=2, numRows=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:39,662  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:33:39,676  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,676  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:39,676  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_1b2d53b3-43bd-4c7a-a277-c84324b19c86); Time taken: 0.021 seconds
2024-04-24T02:33:39,676  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_1b2d53b3-43bd-4c7a-a277-c84324b19c86
2024-04-24T02:33:39,681  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:33:39,687  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,687  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:33:39,688  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists target
2024-04-24T02:33:39,688  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_c4f7ea68-6bcf-4288-a722-a33502dc9329): drop table if exists target
2024-04-24T02:33:39,690  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:33:39,690  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:33:39,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:39,713  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,713  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,713  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,713  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,713  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=22, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:33:39,714  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_c4f7ea68-6bcf-4288-a722-a33502dc9329); Time taken: 0.025 seconds
2024-04-24T02:33:39,714  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023339_c4f7ea68-6bcf-4288-a722-a33502dc9329
2024-04-24T02:33:39,714  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_c4f7ea68-6bcf-4288-a722-a33502dc9329
2024-04-24T02:33:39,735  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_c4f7ea68-6bcf-4288-a722-a33502dc9329 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:33:39,735  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:39,735  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_c4f7ea68-6bcf-4288-a722-a33502dc9329): drop table if exists target
2024-04-24T02:33:39,735  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:39,742  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:39,750  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.target	
2024-04-24T02:33:39,863  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target does not exist; Force to delete it.
2024-04-24T02:33:39,863 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:39,863  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,863  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=121}
2024-04-24T02:33:39,863  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_c4f7ea68-6bcf-4288-a722-a33502dc9329); Time taken: 0.128 seconds
2024-04-24T02:33:39,863  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_c4f7ea68-6bcf-4288-a722-a33502dc9329
2024-04-24T02:33:39,867  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:33:39,872  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,874  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:33:39,874  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists source
2024-04-24T02:33:39,875  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_a2f6826d-7e1a-4555-9e7e-5d11ffe7d522): drop table if exists source
2024-04-24T02:33:39,882  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:33:39,882  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:33:39,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:39,903  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,903  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,903  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,903  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,903  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=7, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=19}
2024-04-24T02:33:39,904  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_a2f6826d-7e1a-4555-9e7e-5d11ffe7d522); Time taken: 0.029 seconds
2024-04-24T02:33:39,904  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023339_a2f6826d-7e1a-4555-9e7e-5d11ffe7d522
2024-04-24T02:33:39,904  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_a2f6826d-7e1a-4555-9e7e-5d11ffe7d522
2024-04-24T02:33:39,917  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_a2f6826d-7e1a-4555-9e7e-5d11ffe7d522 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:33:39,917  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:39,917  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_a2f6826d-7e1a-4555-9e7e-5d11ffe7d522): drop table if exists source
2024-04-24T02:33:39,917  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:39,925  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:39,933  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:39,933  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.source	
2024-04-24T02:33:39,962  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source does not exist; Force to delete it.
2024-04-24T02:33:39,962 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source
2024-04-24T02:33:39,962  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:39,962  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=37}
2024-04-24T02:33:39,963  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_a2f6826d-7e1a-4555-9e7e-5d11ffe7d522); Time taken: 0.045 seconds
2024-04-24T02:33:39,963  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_a2f6826d-7e1a-4555-9e7e-5d11ffe7d522
2024-04-24T02:33:39,966  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:33:39,972  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:39,972  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:33:39,973  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table source (key int, data int)
2024-04-24T02:33:39,973  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023339_9ae93684-58e1-41fb-9244-bc8aa61f94ea): create table source (key int, data int)
2024-04-24T02:33:39,975  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T02:33:39,975  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:33:39,976  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:39,976  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:39,981  INFO [main] parse.CalcitePlanner: Creating table default.source position=13
2024-04-24T02:33:39,981  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:39,983  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:39,983  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:39,983  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:39,983  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:39,983  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, flushCache_()=0, getDatabase_(String)=2}
2024-04-24T02:33:39,983  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023339_9ae93684-58e1-41fb-9244-bc8aa61f94ea); Time taken: 0.01 seconds
2024-04-24T02:33:39,984  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023339_9ae93684-58e1-41fb-9244-bc8aa61f94ea
2024-04-24T02:33:39,984  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023339_9ae93684-58e1-41fb-9244-bc8aa61f94ea
2024-04-24T02:33:39,997  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023339_9ae93684-58e1-41fb-9244-bc8aa61f94ea LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:33:39,997  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:39,997  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023339_9ae93684-58e1-41fb-9244-bc8aa61f94ea): create table source (key int, data int)
2024-04-24T02:33:39,997  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:39,998  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:source, dbName:default, owner:alex, createTime:1713951219, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numRows=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"data":"true","key":"true"}}, rawDataSize=0, bucketing_version=2, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:40,003  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source
2024-04-24T02:33:40,034  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:40,034  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=36}
2024-04-24T02:33:40,035  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023339_9ae93684-58e1-41fb-9244-bc8aa61f94ea); Time taken: 0.037 seconds
2024-04-24T02:33:40,035  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023339_9ae93684-58e1-41fb-9244-bc8aa61f94ea
2024-04-24T02:33:40,038  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T02:33:40,043  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:40,044  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:33:40,044  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:40,044  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023340_ca621df6-6451-4fac-959c-f7b0586bbfc1): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:40,046  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T02:33:40,046  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:33:40,047  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:40,047  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:40,049  INFO [main] parse.CalcitePlanner: Creating table default.target position=13
2024-04-24T02:33:40,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:40,051  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:40,051  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:40,051  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:40,051  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:40,051  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=1, getDatabase_(String)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:40,051  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023340_ca621df6-6451-4fac-959c-f7b0586bbfc1); Time taken: 0.007 seconds
2024-04-24T02:33:40,051  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023340_ca621df6-6451-4fac-959c-f7b0586bbfc1
2024-04-24T02:33:40,051  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023340_ca621df6-6451-4fac-959c-f7b0586bbfc1
2024-04-24T02:33:40,068  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023340_ca621df6-6451-4fac-959c-f7b0586bbfc1 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:33:40,068  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:40,068  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023340_ca621df6-6451-4fac-959c-f7b0586bbfc1): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:40,068  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:40,069  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:target, dbName:default, owner:alex, createTime:1713951220, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null), FieldSchema(name:cur, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[key], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"cur":"true","data":"true","key":"true"}}, numFiles=0, rawDataSize=0, numRows=0, bucketing_version=2, totalSize=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:40,074  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:40,089  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:40,090  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:40,090  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023340_ca621df6-6451-4fac-959c-f7b0586bbfc1); Time taken: 0.021 seconds
2024-04-24T02:33:40,090  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023340_ca621df6-6451-4fac-959c-f7b0586bbfc1
2024-04-24T02:33:40,094  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:33:40,100  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:40,100  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:33:40,101  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-24T02:33:40,101  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-24T02:33:40,103  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-24T02:33:40,104  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:33:40,104  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:40,104  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:40,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:40,124  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:40,124  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:40,124  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:40,124  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:40,124  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:40,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:40,131  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:40,131  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:40,131  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:40,151  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:40,220  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:40,220  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:40,220  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:40,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:40,223  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:40,223  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:40,223  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:40,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:40,229  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:40,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.target	
2024-04-24T02:33:40,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.target	
2024-04-24T02:33:40,239  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 17
2024-04-24T02:33:40,239  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=target (txnIds: [17])
2024-04-24T02:33:40,240  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:40,243  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2], VALUE._col0=Column[_col1]}
2024-04-24T02:33:40,243  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], VALUE._col1=Column[_col2], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:33:40,244  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:33:40,244  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:40,252  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:40,258  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:40,259  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:40,259  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:40,259  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:40,259  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null), FieldSchema(name:col3, type:int, comment:null)], properties:null)
2024-04-24T02:33:40,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:40,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=8, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=25, flushCache_()=0, getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=37}
2024-04-24T02:33:40,259  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35); Time taken: 0.158 seconds
2024-04-24T02:33:40,260  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35
2024-04-24T02:33:40,260  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35
2024-04-24T02:33:40,274  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:33:40,274  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:40,276  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-24T02:33:40,277  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35
2024-04-24T02:33:40,277  INFO [main] ql.Driver: Query ID = alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35
Total jobs = 1
2024-04-24T02:33:40,277  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:33:40,277  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:33:40,418  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:33:40,418  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:33:40,418  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:33:40,418  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:33:40,418  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:33:40,418  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:33:40,418  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:33:40,418  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:33:40,420  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:40,421  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:33:40,421  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-40_101_8440898074215780626-1/dummy_path
2024-04-24T02:33:40,429  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:40,430  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,13KB
2024-04-24T02:33:40,434  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:33:40,435  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,16KB
2024-04-24T02:33:40,436  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:40,439  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-40_101_8440898074215780626-1/-mr-10000
2024-04-24T02:33:40,441  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:40,448  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:40,452  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:40,453  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:33:40,453  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:33:40,453  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-40_101_8440898074215780626-1/dummy_path
2024-04-24T02:33:40,454  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:33:40,470  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:33:40,488  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1292023025_0070
2024-04-24T02:33:40,488  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:40,543  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:40,543  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:40,544  INFO [Thread-5932] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:40,544  INFO [Thread-5932] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:40,545  INFO [Thread-5932] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:40,545  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1292023025_0070_m_000000_0
2024-04-24T02:33:40,548  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:40,549  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-40_101_8440898074215780626-1/dummy_path/null:0+1
2024-04-24T02:33:40,550  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:40,551  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,13KB
2024-04-24T02:33:40,551  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:33:40,555  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:33:40,555  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:33:40,555  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:33:40,555  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:33:40,555  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:33:40,556  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:33:40,556  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:40,556  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:40,557  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:40,557  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:40,557  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:33:40,558  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:33:40,558  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:40,558  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int,col3:int>
2024-04-24T02:33:40,558  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:33:40,558  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:40,559  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:33:40,560  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:33:40,560  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:3, 
2024-04-24T02:33:40,560  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:40,560  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:3, 
2024-04-24T02:33:40,560  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:33:40,560  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 3. abort - false
2024-04-24T02:33:40,560  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:3, RECORDS_OUT_INTERMEDIATE:3, 
2024-04-24T02:33:40,563  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:40,563  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:33:40,563  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:33:40,563  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 51; bufvoid = 104857600
2024-04-24T02:33:40,563  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214388(104857552); length = 9/6553600
2024-04-24T02:33:40,573  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:33:40,577  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1292023025_0070_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:40,578  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:33:40,578  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1292023025_0070_m_000000_0' done.
2024-04-24T02:33:40,578  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1292023025_0070_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1405384
		FILE: Number of bytes written=82480590
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=3
		Map output bytes=51
		Map output materialized bytes=69
		Input split bytes=361
		Combine input records=0
		Spilled Records=3
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1409810432
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=3
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=3
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=3
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=3
	File Input Format Counters 
		Bytes Read=5181
2024-04-24T02:33:40,578  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1292023025_0070_m_000000_0
2024-04-24T02:33:40,578  INFO [Thread-5932] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:33:40,579  INFO [Thread-5932] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:33:40,579  INFO [pool-349-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1292023025_0070_r_000000_0
2024-04-24T02:33:40,581  INFO [pool-349-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:40,581  INFO [pool-349-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1852f43a
2024-04-24T02:33:40,582  WARN [pool-349-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:40,582  INFO [pool-349-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:40,583  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1292023025_0070_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:40,586  INFO [localfetcher#95] reduce.LocalFetcher: localfetcher#95 about to shuffle output of map attempt_local1292023025_0070_m_000000_0 decomp: 21 len: 25 to MEMORY
2024-04-24T02:33:40,586  INFO [localfetcher#95] reduce.InMemoryMapOutput: Read 21 bytes from map-output for attempt_local1292023025_0070_m_000000_0
2024-04-24T02:33:40,586  INFO [localfetcher#95] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 21, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->21
2024-04-24T02:33:40,587  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:40,587  INFO [pool-349-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:40,587  INFO [pool-349-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:40,590  INFO [Metastore Scheduled Worker 4] metastore.HMSHandler: 13: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T02:33:40,591  INFO [Metastore Scheduled Worker 4] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15b4d95f, with PersistenceManager: null will be shutdown
2024-04-24T02:33:40,591  INFO [Metastore Scheduled Worker 4] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15b4d95f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@565a3488 created in the thread with id: 48
2024-04-24T02:33:40,593  INFO [pool-349-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:40,593  INFO [pool-349-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-24T02:33:40,596  INFO [pool-349-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 21 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:40,596  INFO [pool-349-thread-1] reduce.MergeManagerImpl: Merging 1 files, 25 bytes from disk
2024-04-24T02:33:40,596  INFO [pool-349-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:40,596  INFO [pool-349-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:40,596  INFO [pool-349-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-24T02:33:40,596  INFO [pool-349-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:40,597  INFO [pool-349-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:40,597  INFO [pool-349-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-24T02:33:40,598  INFO [pool-349-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:40,598  INFO [pool-349-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:33:40,598  INFO [pool-349-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-24T02:33:40,598  INFO [pool-349-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:33:40,598  INFO [pool-349-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1292023025_0070/job_local1292023025_0070.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@58e1b0c0
2024-04-24T02:33:40,599  INFO [pool-349-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:40,599  INFO [pool-349-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:40,599  INFO [pool-349-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:40,599  INFO [pool-349-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:40,600  INFO [pool-349-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:40,607  INFO [pool-349-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:40,612  INFO [pool-349-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:33:40,612  INFO [pool-349-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:33:40,612  INFO [pool-349-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:33:40,612  INFO [pool-349-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:40,614  INFO [pool-349-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:33:40,618  INFO [Metastore Scheduled Worker 4] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15b4d95f from thread id: 48
2024-04-24T02:33:40,626  INFO [pool-349-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.target:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:40,627  INFO [pool-349-thread-1] mapred.Task: Task:attempt_local1292023025_0070_r_000000_0 is done. And is in the process of committing
2024-04-24T02:33:40,627  INFO [pool-349-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:40,627  INFO [pool-349-thread-1] mapred.Task: Task 'attempt_local1292023025_0070_r_000000_0' done.
2024-04-24T02:33:40,627  INFO [pool-349-thread-1] mapred.Task: Final Counters for attempt_local1292023025_0070_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1411758
		FILE: Number of bytes written=82481671
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=25
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1409810432
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:40,627  INFO [pool-349-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1292023025_0070_r_000000_0
2024-04-24T02:33:40,627  INFO [pool-349-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1292023025_0070_r_000001_0
2024-04-24T02:33:40,628  INFO [pool-349-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:40,628  INFO [pool-349-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7fb026dd
2024-04-24T02:33:40,628  WARN [pool-349-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:40,629  INFO [pool-349-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:40,629  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1292023025_0070_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:40,632  INFO [localfetcher#96] reduce.LocalFetcher: localfetcher#96 about to shuffle output of map attempt_local1292023025_0070_m_000000_0 decomp: 40 len: 44 to MEMORY
2024-04-24T02:33:40,632  INFO [localfetcher#96] reduce.InMemoryMapOutput: Read 40 bytes from map-output for attempt_local1292023025_0070_m_000000_0
2024-04-24T02:33:40,632  INFO [localfetcher#96] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 40, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->40
2024-04-24T02:33:40,632  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:40,633  INFO [pool-349-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:40,633  INFO [pool-349-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:40,638  INFO [pool-349-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:40,638  INFO [pool-349-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-24T02:33:40,641  INFO [pool-349-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 40 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:40,641  INFO [pool-349-thread-1] reduce.MergeManagerImpl: Merging 1 files, 44 bytes from disk
2024-04-24T02:33:40,641  INFO [pool-349-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:40,641  INFO [pool-349-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:40,641  INFO [pool-349-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-24T02:33:40,641  INFO [pool-349-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:40,642  INFO [pool-349-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:40,642  INFO [pool-349-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-24T02:33:40,643  INFO [pool-349-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:40,643  INFO [pool-349-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:33:40,643  INFO [pool-349-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-24T02:33:40,643  INFO [pool-349-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:33:40,643  INFO [pool-349-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1292023025_0070/job_local1292023025_0070.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2176c920
2024-04-24T02:33:40,644  INFO [pool-349-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:40,644  INFO [pool-349-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:40,644  INFO [pool-349-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:40,644  INFO [pool-349-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:40,644  INFO [pool-349-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:40,649  INFO [pool-349-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:40,649  INFO [pool-349-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:33:40,649  INFO [pool-349-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:40,649  INFO [pool-349-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:33:40,649  INFO [pool-349-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:33:40,651  INFO [pool-349-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:33:40,660  INFO [pool-349-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.target:2, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-24T02:33:40,660  INFO [pool-349-thread-1] mapred.Task: Task:attempt_local1292023025_0070_r_000001_0 is done. And is in the process of committing
2024-04-24T02:33:40,661  INFO [pool-349-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:40,661  INFO [pool-349-thread-1] mapred.Task: Task 'attempt_local1292023025_0070_r_000001_0' done.
2024-04-24T02:33:40,661  INFO [pool-349-thread-1] mapred.Task: Final Counters for attempt_local1292023025_0070_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1418126
		FILE: Number of bytes written=82482790
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=44
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1409810432
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:40,661  INFO [pool-349-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1292023025_0070_r_000001_0
2024-04-24T02:33:40,661  INFO [Thread-5932] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:33:41,546 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:33:41,546  INFO [main] exec.Task: 2024-04-24 02:33:41,546 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1292023025_0070
2024-04-24T02:33:41,548  INFO [main] exec.Task: Ended Job = job_local1292023025_0070
2024-04-24T02:33:41,548  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:33:41,548  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:33:41,549  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:33:41,549  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:33:41,549  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target/_tmp.delta_0000001_0000001_0000
2024-04-24T02:33:41,550  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.target
2024-04-24T02:33:41,550  INFO [main] exec.Task: Loading data to table default.target from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/target
2024-04-24T02:33:41,550  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:41,557  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,557  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:41,564  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-24T02:33:41,593  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:33:41,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:41,599  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,599  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:33:41,600  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-40_101_8440898074215780626-1/-mr-10000
2024-04-24T02:33:41,601  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:41,607  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,618  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:33:41,618  INFO [main] FileOperations: Read stats for default.target/, numRows, true, 3, false: 
2024-04-24T02:33:41,618  INFO [main] FileOperations: Read stats for default.target/, rawDataSize, true, 0, false: 
2024-04-24T02:33:41,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-24T02:33:41,638  INFO [main] FileOperations: Read stats for default.target/, insertCount, true, 3, false: 
2024-04-24T02:33:41,638  INFO [main] FileOperations: Read stats for default.target/, updateCount, true, 0, false: 
2024-04-24T02:33:41,638  INFO [main] FileOperations: Read stats for default.target/, deleteCount, true, 0, false: 
2024-04-24T02:33:41,640  INFO [main] stats.BasicStatsTask: Table default.target stats: [numFiles=2, numRows=3, totalSize=1460, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:33:41,640  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:41,640  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=48, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=26, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-24T02:33:41,640  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:41,640  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:41,641  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:41,641  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35); Time taken: 1.364 seconds
2024-04-24T02:33:41,641  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023340_c67f4aa5-1031-4328-9287-875dd5a65d35
2024-04-24T02:33:41,650  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:41,651  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:33:41,652  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into source  values(1,7),(3,8)
2024-04-24T02:33:41,652  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-40_101_8440898074215780626-1
2024-04-24T02:33:41,653  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-40_101_8440898074215780626-1 on fs with scheme file
2024-04-24T02:33:41,653  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f): insert into source  values(1,7),(3,8)
2024-04-24T02:33:41,661  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T02:33:41,661  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:33:41,663  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:41,663  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:41,668  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:41,688  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,688  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:41,688  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:41,688  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:41,688  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:41,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:41,698  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,698  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:41,698  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:41,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:41,765  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:41,765  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:41,765  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:41,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:41,768  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:41,768  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:41,768  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:41,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:41,777  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,778  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1
2024-04-24T02:33:41,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.source	
2024-04-24T02:33:41,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.source	
2024-04-24T02:33:41,784  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:41,787  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:33:41,787  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:41,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:41,804  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,805  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T02:33:41,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:41,814  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:41,829  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:41,829  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:41,829  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:41,829  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:33:41,829  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:41,829  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, getNotNullConstraints_(NotNullConstraintsRequest)=1, getTable_(GetTableRequest)=58, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getAllTableConstraints_(AllTableConstraintsRequest)=5, isCompatibleWith_(Configuration)=1, getCheckConstraints_(CheckConstraintsRequest)=2, openTxn_(String, TxnType)=8, getValidTxns_(long)=2}
2024-04-24T02:33:41,829  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f); Time taken: 0.176 seconds
2024-04-24T02:33:41,829  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f
2024-04-24T02:33:41,830  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f
2024-04-24T02:33:41,842  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:33:41,843  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:41,843  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f): insert into source  values(1,7),(3,8)
2024-04-24T02:33:41,843  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f
2024-04-24T02:33:41,843  INFO [main] ql.Driver: Query ID = alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f
Total jobs = 3
2024-04-24T02:33:41,843  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-24T02:33:41,843  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-24T02:33:41,997  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:33:41,997  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T02:33:41,999  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:41,999  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:33:41,999  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-41_653_7980328549477148737-1/dummy_path
2024-04-24T02:33:42,008  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:42,009  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,68KB
2024-04-24T02:33:42,009  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:42,013  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-41_653_7980328549477148737-1/-mr-10001
2024-04-24T02:33:42,017  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:42,024  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:42,029  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:42,030  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:33:42,030  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:33:42,030  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-41_653_7980328549477148737-1/dummy_path
2024-04-24T02:33:42,030  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:33:42,047  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:33:42,066  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1489974867_0071
2024-04-24T02:33:42,066  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:42,150  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:42,150  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:42,150  INFO [Thread-6006] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:42,150  INFO [Thread-6006] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:42,152  INFO [Thread-6006] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:42,152  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1489974867_0071_m_000000_0
2024-04-24T02:33:42,152  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:42,153  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-41_653_7980328549477148737-1/dummy_path/null:0+1
2024-04-24T02:33:42,153  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:42,153  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,68KB
2024-04-24T02:33:42,154  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T02:33:42,154  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:42,154  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:42,155  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:42,155  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:42,155  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:33:42,155  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:33:42,155  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:42,155  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:33:42,155  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:33:42,156  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@6b362b44, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@51428517, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [key, data] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@3a89cf87
2024-04-24T02:33:42,156  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1/_tmp.-ext-10002/000000_0
2024-04-24T02:33:42,156  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:33:42,156  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1/_tmp.-ext-10002/000000_0
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:42,163  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T02:33:42,164  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:33:42,164  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T02:33:42,169  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.source:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T02:33:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1489974867_0071_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:33:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1489974867_0071_m_000000_0' done.
2024-04-24T02:33:42,170  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1489974867_0071_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1424900
		FILE: Number of bytes written=83655469
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1404567552
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.source=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=5735
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:42,170  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1489974867_0071_m_000000_0
2024-04-24T02:33:42,170  INFO [Thread-6006] mapred.LocalJobRunner: map task executor complete.
2024-04-24 02:33:43,152 Stage-1 map = 100%,  reduce = 0%
2024-04-24T02:33:43,152  INFO [main] exec.Task: 2024-04-24 02:33:43,152 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1489974867_0071
2024-04-24T02:33:43,153  INFO [main] exec.Task: Ended Job = job_local1489974867_0071
2024-04-24T02:33:43,155  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T02:33:43,156  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T02:33:43,156  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T02:33:43,156  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T02:33:43,156  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1/-ext-10000
2024-04-24T02:33:43,156  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1/-ext-10002
2024-04-24T02:33:43,156  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.source
2024-04-24T02:33:43,156  INFO [main] exec.Task: Loading data to table default.source from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1/-ext-10000
2024-04-24T02:33:43,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:43,165  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:43,174  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,175  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-24T02:33:43,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-24T02:33:43,200  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:33:43,200  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:43,208  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,208  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:33:43,209  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-41_653_7980328549477148737-1/-mr-10001
2024-04-24T02:33:43,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:43,218  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,218  INFO [main] FileOperations: Read stats for default.source/, numRows, true, 2, false: 
2024-04-24T02:33:43,218  INFO [main] FileOperations: Read stats for default.source/, rawDataSize, true, 6, false: 
2024-04-24T02:33:43,219  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-24T02:33:43,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-24T02:33:43,240  INFO [main] stats.BasicStatsTask: Table default.source stats: [numFiles=1, numRows=2, totalSize=8, rawDataSize=6, numFilesErasureCoded=0]
2024-04-24T02:33:43,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:43,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=46, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=34}
MapReduce Jobs Launched: 
2024-04-24T02:33:43,241  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:43,241  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:43,241  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:43,241  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f); Time taken: 1.398 seconds
2024-04-24T02:33:43,241  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023341_5c188704-f674-4421-b75d-0a37e29ebd6f
2024-04-24T02:33:43,245  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:33:43,250  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:43,251  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:33:43,251  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-24T02:33:43,251  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1
2024-04-24T02:33:43,251  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/source/.hive-staging_hive_2024-04-24_02-33-41_653_7980328549477148737-1 on fs with scheme file
2024-04-24T02:33:43,252  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-41_653_7980328549477148737-1
2024-04-24T02:33:43,252  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-41_653_7980328549477148737-1 on fs with scheme file
2024-04-24T02:33:43,252  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023343_72bbaff7-7432-43e5-82c7-4905b9091ea9): merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-24T02:33:43,255  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 19
2024-04-24T02:33:43,255  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:33:43,256  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:33:43,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,262  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-24T02:33:43,266  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/_tmp_space.db/merge_tmp_table
2024-04-24T02:33:43,268  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)> as 
<FROM
  `default`.`target` `t`
  RIGHT OUTER JOIN
  (select `source`.*, 0 `c` from `source` union all select `source`.*, 1 `c` from `source` inner join `target` on `source`.`key`=`target`.`key` where `target`.`cur`=1) `s`
  ON `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
INSERT INTO `default`.`target`    -- update clause(insert part)
 SELECT `t`.`key`, `t`.`data`, 0
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
INSERT INTO `default`.`target`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`target`    -- insert clause
  SELECT `s`.`key`,`s`.`data`,1
   WHERE `t`.`key` IS NULL AND `t`.`cur` IS NULL AND `t`.`cur` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1 GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-24T02:33:43,270  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:33:43,273  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:43,273  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,274  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,280  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,280  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,280  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,280  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,280  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:43,289  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,290  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,290  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,290  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,290  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,290  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,290  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,290  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,297  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,303  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,303  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,310  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,310  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:43,310  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:43,310  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,311  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,324  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-24T02:33:43,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-24T02:33:43,336  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-24T02:33:43,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-24T02:33:43,468  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T02:33:43,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,477  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,486  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.target	
2024-04-24T02:33:43,497  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: key, data, cur
No Stats for default@target, Columns: key, data, cur
2024-04-24T02:33:43,497  INFO [main] SessionState: No Stats for default@target, Columns: key, data, cur
2024-04-24T02:33:43,498  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:33:43,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:43,510  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,511  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-24T02:33:43,523  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,524  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.source	
2024-04-24T02:33:43,537  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: data, key
No Stats for default@source, Columns: data, key
2024-04-24T02:33:43,537  INFO [main] SessionState: No Stats for default@source, Columns: data, key
2024-04-24T02:33:43,538  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:33:43,539  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: key, data
No Stats for default@source, Columns: key, data
2024-04-24T02:33:43,539  INFO [main] SessionState: No Stats for default@source, Columns: key, data
2024-04-24T02:33:43,539  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 2], allowMissingStats: true
2024-04-24T02:33:43,540  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: key, cur
No Stats for default@target, Columns: key, cur
2024-04-24T02:33:43,541  INFO [main] SessionState: No Stats for default@target, Columns: key, cur
2024-04-24T02:33:43,772  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,772  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,772  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,772  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,773  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:43,774  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:43,774  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,774  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,774  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:43,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,780  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,787  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,787  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-24T02:33:43,793  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,802 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:33:43,803 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:33:43,803  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:33:43,804 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:33:43,804  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:43,804  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=58, isCompatibleWith_(Configuration)=4, createTable_(Table)=2, getTableColumnStatistics_(String, String, List, String)=66, getAllTableConstraints_(AllTableConstraintsRequest)=21}
2024-04-24T02:33:43,804  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023343_72bbaff7-7432-43e5-82c7-4905b9091ea9); Time taken: 0.552 seconds
2024-04-24T02:33:43,804  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:33:43,807  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:43,813  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:43,814  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0a86281f-2df3-40be-b2e4-8ce8a85be5b5/hive_2024-04-24_02-33-43_268_2228508349883772192-1
2024-04-24T02:33:43,814  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023343_86131244-23c3-4a70-8fbb-764bc1bfd1c8): drop table if exists acidTbl
2024-04-24T02:33:43,816  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 19
2024-04-24T02:33:43,816  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:33:43,817  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:43,823  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,823  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:43,823  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:43,823  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:43,824  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=6, rollbackTxn_(long)=9, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:43,824  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023343_86131244-23c3-4a70-8fbb-764bc1bfd1c8); Time taken: 0.009 seconds
2024-04-24T02:33:43,824  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023343_86131244-23c3-4a70-8fbb-764bc1bfd1c8
2024-04-24T02:33:43,824  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023343_86131244-23c3-4a70-8fbb-764bc1bfd1c8
2024-04-24T02:33:43,839  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023343_86131244-23c3-4a70-8fbb-764bc1bfd1c8 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:33:43,839  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:43,839  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023343_86131244-23c3-4a70-8fbb-764bc1bfd1c8): drop table if exists acidTbl
2024-04-24T02:33:43,839  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:43,840  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:43,846  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,846  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:43,853  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,853  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:43,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:43,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=98}
2024-04-24T02:33:43,944  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023343_86131244-23c3-4a70-8fbb-764bc1bfd1c8); Time taken: 0.105 seconds
2024-04-24T02:33:43,945  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023343_86131244-23c3-4a70-8fbb-764bc1bfd1c8
2024-04-24T02:33:43,948  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:33:43,954  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:43,955  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:33:43,955  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:43,956  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023343_1c8148b1-5859-43ba-8b02-9db10707877f): drop table if exists acidTblPart
2024-04-24T02:33:43,962  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 19
2024-04-24T02:33:43,962  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:33:43,964  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:43,970  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,971  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:43,971  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:43,971  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:43,971  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, getTable_(GetTableRequest)=7, flushCache_()=0, openTxn_(String, TxnType)=6, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:43,971  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023343_1c8148b1-5859-43ba-8b02-9db10707877f); Time taken: 0.015 seconds
2024-04-24T02:33:43,971  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023343_1c8148b1-5859-43ba-8b02-9db10707877f
2024-04-24T02:33:43,972  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023343_1c8148b1-5859-43ba-8b02-9db10707877f
2024-04-24T02:33:43,985  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023343_1c8148b1-5859-43ba-8b02-9db10707877f LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T02:33:43,985  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:43,985  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023343_1c8148b1-5859-43ba-8b02-9db10707877f): drop table if exists acidTblPart
2024-04-24T02:33:43,986  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:43,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:43,992  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,992  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:43,998  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:43,998  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:44,042  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,042  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=50, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,042  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023343_1c8148b1-5859-43ba-8b02-9db10707877f); Time taken: 0.057 seconds
2024-04-24T02:33:44,042  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023343_1c8148b1-5859-43ba-8b02-9db10707877f
2024-04-24T02:33:44,046  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:33:44,051  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,051  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:33:44,052  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:44,052  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_fbc0353b-04f2-46fd-8366-7ca0503b9ac8): drop table if exists acidTbl2
2024-04-24T02:33:44,054  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 19
2024-04-24T02:33:44,054  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T02:33:44,055  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,055  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,055  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,055  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:33:44,055  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_fbc0353b-04f2-46fd-8366-7ca0503b9ac8); Time taken: 0.003 seconds
2024-04-24T02:33:44,055  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424023344_fbc0353b-04f2-46fd-8366-7ca0503b9ac8
2024-04-24T02:33:44,055  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:44,055  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_fbc0353b-04f2-46fd-8366-7ca0503b9ac8): drop table if exists acidTbl2
2024-04-24T02:33:44,055  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,056  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:33:44,056  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,056  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=1}
2024-04-24T02:33:44,056  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_fbc0353b-04f2-46fd-8366-7ca0503b9ac8); Time taken: 0.001 seconds
2024-04-24T02:33:44,056  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_fbc0353b-04f2-46fd-8366-7ca0503b9ac8
2024-04-24T02:33:44,061  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T02:33:44,067  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,067  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T02:33:44,067  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:44,068  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_5503d5ef-af51-4c71-9aff-667e31dec1f4): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:44,069  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 19
2024-04-24T02:33:44,070  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T02:33:44,070  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:44,089  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,089  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,089  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,089  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,089  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getTable_(GetTableRequest)=19}
2024-04-24T02:33:44,090  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_5503d5ef-af51-4c71-9aff-667e31dec1f4); Time taken: 0.021 seconds
2024-04-24T02:33:44,090  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424023344_5503d5ef-af51-4c71-9aff-667e31dec1f4
2024-04-24T02:33:44,090  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_5503d5ef-af51-4c71-9aff-667e31dec1f4
2024-04-24T02:33:44,104  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_5503d5ef-af51-4c71-9aff-667e31dec1f4 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T02:33:44,104  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:44,104  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_5503d5ef-af51-4c71-9aff-667e31dec1f4): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:44,104  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,105  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:44,119  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:44,127  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,127  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:44,164  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,164  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=44, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=14}
2024-04-24T02:33:44,164  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_5503d5ef-af51-4c71-9aff-667e31dec1f4); Time taken: 0.06 seconds
2024-04-24T02:33:44,164  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_5503d5ef-af51-4c71-9aff-667e31dec1f4
2024-04-24T02:33:44,168  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T02:33:44,173  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,173  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T02:33:44,174  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:44,174  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_d8db1b75-022d-4c05-9d53-143146413264): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:44,176  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 19
2024-04-24T02:33:44,176  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T02:33:44,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:44,184  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,184  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,185  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,185  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,185  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=2}
2024-04-24T02:33:44,185  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_d8db1b75-022d-4c05-9d53-143146413264); Time taken: 0.011 seconds
2024-04-24T02:33:44,185  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424023344_d8db1b75-022d-4c05-9d53-143146413264
2024-04-24T02:33:44,186  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_d8db1b75-022d-4c05-9d53-143146413264
2024-04-24T02:33:44,198  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_d8db1b75-022d-4c05-9d53-143146413264 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T02:33:44,198  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:44,198  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_d8db1b75-022d-4c05-9d53-143146413264): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:44,199  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:44,207  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:44,215  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:44,243  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,243  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=36}
2024-04-24T02:33:44,244  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_d8db1b75-022d-4c05-9d53-143146413264); Time taken: 0.045 seconds
2024-04-24T02:33:44,244  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_d8db1b75-022d-4c05-9d53-143146413264
2024-04-24T02:33:44,247  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-24T02:33:44,252  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,253  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-24T02:33:44,253  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:44,253  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_635e3c17-a175-4cbd-8dfb-daf5fa261205): drop table if exists nonAcidNonBucket
2024-04-24T02:33:44,256  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 19
2024-04-24T02:33:44,256  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T02:33:44,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:44,267  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,267  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,267  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,268  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,268  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:44,268  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_635e3c17-a175-4cbd-8dfb-daf5fa261205); Time taken: 0.015 seconds
2024-04-24T02:33:44,268  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424023344_635e3c17-a175-4cbd-8dfb-daf5fa261205
2024-04-24T02:33:44,269  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_635e3c17-a175-4cbd-8dfb-daf5fa261205
2024-04-24T02:33:44,281  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_635e3c17-a175-4cbd-8dfb-daf5fa261205 LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T02:33:44,281  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:44,282  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_635e3c17-a175-4cbd-8dfb-daf5fa261205): drop table if exists nonAcidNonBucket
2024-04-24T02:33:44,282  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:44,290  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:44,297  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:44,325  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,325  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=35, getTable_(GetTableRequest)=8}
2024-04-24T02:33:44,325  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_635e3c17-a175-4cbd-8dfb-daf5fa261205); Time taken: 0.044 seconds
2024-04-24T02:33:44,326  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_635e3c17-a175-4cbd-8dfb-daf5fa261205
2024-04-24T02:33:44,329  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T02:33:44,335  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,335  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T02:33:44,335  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testQuotedIdentifier2" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.883">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: 
merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='∆∋', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1097)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:33:44,392  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:33:44,394  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = d604cd9f-95aa-43a3-91b1-2f985a1b50b6
2024-04-24T02:33:44,396  INFO [main] SessionState: Hive Session ID = d604cd9f-95aa-43a3-91b1-2f985a1b50b6
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:44,397  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:44,402  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d604cd9f-95aa-43a3-91b1-2f985a1b50b6
2024-04-24T02:33:44,404  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d604cd9f-95aa-43a3-91b1-2f985a1b50b6
2024-04-24T02:33:44,406  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d604cd9f-95aa-43a3-91b1-2f985a1b50b6/_tmp_space.db
2024-04-24T02:33:44,406  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=d604cd9f-95aa-43a3-91b1-2f985a1b50b6, clientType=HIVECLI]
2024-04-24T02:33:44,406  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:44,407  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_2db1b921-2f36-4163-86b6-ce2d3abca31b): drop table if exists acidTbl
2024-04-24T02:33:44,413  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:33:44,414  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:33:44,416  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:44,421  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,421  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,421  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,421  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=7, getValidTxns_(long)=2}
2024-04-24T02:33:44,421  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_2db1b921-2f36-4163-86b6-ce2d3abca31b); Time taken: 0.014 seconds
2024-04-24T02:33:44,421  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023344_2db1b921-2f36-4163-86b6-ce2d3abca31b
2024-04-24T02:33:44,421  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:44,421  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_2db1b921-2f36-4163-86b6-ce2d3abca31b): drop table if exists acidTbl
2024-04-24T02:33:44,421  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:44,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,424  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_2db1b921-2f36-4163-86b6-ce2d3abca31b); Time taken: 0.003 seconds
2024-04-24T02:33:44,425  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_2db1b921-2f36-4163-86b6-ce2d3abca31b
2024-04-24T02:33:44,430  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:33:44,436  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,436  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:33:44,436  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:44,436  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_a55cdb1b-d58f-4504-b452-9c4897800ee8): drop table if exists acidTblPart
2024-04-24T02:33:44,438  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:33:44,438  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:33:44,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:44,441  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,441  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,441  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,442  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=1, flushCache_()=1}
2024-04-24T02:33:44,442  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_a55cdb1b-d58f-4504-b452-9c4897800ee8); Time taken: 0.005 seconds
2024-04-24T02:33:44,442  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023344_a55cdb1b-d58f-4504-b452-9c4897800ee8
2024-04-24T02:33:44,442  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:44,442  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_a55cdb1b-d58f-4504-b452-9c4897800ee8): drop table if exists acidTblPart
2024-04-24T02:33:44,442  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:44,445  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,445  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,445  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_a55cdb1b-d58f-4504-b452-9c4897800ee8); Time taken: 0.003 seconds
2024-04-24T02:33:44,445  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_a55cdb1b-d58f-4504-b452-9c4897800ee8
2024-04-24T02:33:44,451  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:33:44,457  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,457  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:33:44,458  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:44,458  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_3f9fe787-bfc9-45fa-84ce-c09d175e9a20): drop table if exists acidTbl2
2024-04-24T02:33:44,460  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:33:44,460  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:33:44,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:44,463  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,463  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,463  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,463  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13}
2024-04-24T02:33:44,464  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_3f9fe787-bfc9-45fa-84ce-c09d175e9a20); Time taken: 0.005 seconds
2024-04-24T02:33:44,464  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023344_3f9fe787-bfc9-45fa-84ce-c09d175e9a20
2024-04-24T02:33:44,464  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:44,464  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_3f9fe787-bfc9-45fa-84ce-c09d175e9a20): drop table if exists acidTbl2
2024-04-24T02:33:44,464  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:44,467  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,467  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,467  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_3f9fe787-bfc9-45fa-84ce-c09d175e9a20); Time taken: 0.003 seconds
2024-04-24T02:33:44,467  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_3f9fe787-bfc9-45fa-84ce-c09d175e9a20
2024-04-24T02:33:44,472  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:33:44,478  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,478  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:33:44,478  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:44,479  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_95562dc8-9961-46eb-a2d8-197f1e32152b): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:44,480  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:33:44,481  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:33:44,481  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:44,484  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,484  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,484  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,484  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:33:44,484  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_95562dc8-9961-46eb-a2d8-197f1e32152b); Time taken: 0.005 seconds
2024-04-24T02:33:44,484  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023344_95562dc8-9961-46eb-a2d8-197f1e32152b
2024-04-24T02:33:44,484  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:44,485  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_95562dc8-9961-46eb-a2d8-197f1e32152b): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:44,485  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,485  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:44,487  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,488  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,488  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_95562dc8-9961-46eb-a2d8-197f1e32152b); Time taken: 0.003 seconds
2024-04-24T02:33:44,488  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_95562dc8-9961-46eb-a2d8-197f1e32152b
2024-04-24T02:33:44,493  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:33:44,498  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,498  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:33:44,499  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:44,499  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_885191d1-66aa-4b78-9e0d-62515cc380dd): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:44,501  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:33:44,501  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:33:44,501  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:44,504  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,504  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,504  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,504  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,505  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_885191d1-66aa-4b78-9e0d-62515cc380dd); Time taken: 0.005 seconds
2024-04-24T02:33:44,505  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023344_885191d1-66aa-4b78-9e0d-62515cc380dd
2024-04-24T02:33:44,505  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:44,505  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_885191d1-66aa-4b78-9e0d-62515cc380dd): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:44,505  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:44,508  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,508  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,508  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_885191d1-66aa-4b78-9e0d-62515cc380dd); Time taken: 0.003 seconds
2024-04-24T02:33:44,508  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_885191d1-66aa-4b78-9e0d-62515cc380dd
2024-04-24T02:33:44,513  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:33:44,518  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,519  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:33:44,519  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:44,519  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_51fc0593-4f4b-4d56-b8bd-17cf9ce2ce9b): drop table if exists nonAcidNonBucket
2024-04-24T02:33:44,521  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:33:44,521  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:33:44,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:44,524  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,524  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,524  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,525  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1}
2024-04-24T02:33:44,525  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_51fc0593-4f4b-4d56-b8bd-17cf9ce2ce9b); Time taken: 0.005 seconds
2024-04-24T02:33:44,525  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023344_51fc0593-4f4b-4d56-b8bd-17cf9ce2ce9b
2024-04-24T02:33:44,525  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:44,525  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_51fc0593-4f4b-4d56-b8bd-17cf9ce2ce9b): drop table if exists nonAcidNonBucket
2024-04-24T02:33:44,525  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:44,528  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_51fc0593-4f4b-4d56-b8bd-17cf9ce2ce9b); Time taken: 0.003 seconds
2024-04-24T02:33:44,529  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_51fc0593-4f4b-4d56-b8bd-17cf9ce2ce9b
2024-04-24T02:33:44,533  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:33:44,539  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,540  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:33:44,540  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,540  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_2674b78a-831d-452f-a67e-e239f627b0d0): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,542  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:33:44,543  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:33:44,543  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:44,543  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:44,549  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:33:44,549  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:44,551  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:44,551  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,551  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,551  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,551  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=6, getDatabase_(String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-24T02:33:44,551  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_2674b78a-831d-452f-a67e-e239f627b0d0); Time taken: 0.011 seconds
2024-04-24T02:33:44,552  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023344_2674b78a-831d-452f-a67e-e239f627b0d0
2024-04-24T02:33:44,552  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_2674b78a-831d-452f-a67e-e239f627b0d0
2024-04-24T02:33:44,570  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_2674b78a-831d-452f-a67e-e239f627b0d0 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:33:44,570  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:44,571  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_2674b78a-831d-452f-a67e-e239f627b0d0): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,571  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951224, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numFilesErasureCoded=0, bucketing_version=2, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:44,577  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:44,613  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,613  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=42}
2024-04-24T02:33:44,614  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_2674b78a-831d-452f-a67e-e239f627b0d0); Time taken: 0.042 seconds
2024-04-24T02:33:44,614  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_2674b78a-831d-452f-a67e-e239f627b0d0
2024-04-24T02:33:44,618  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:33:44,624  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,624  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:33:44,624  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,624  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_98237d29-e381-418b-bb25-1e97e7c3a9dd): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,627  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:33:44,627  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:33:44,629  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:44,629  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:44,632  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:33:44,632  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:44,636  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:44,636  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,636  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,636  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,636  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1, getDatabase_(String)=4, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:44,636  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_98237d29-e381-418b-bb25-1e97e7c3a9dd); Time taken: 0.012 seconds
2024-04-24T02:33:44,637  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023344_98237d29-e381-418b-bb25-1e97e7c3a9dd
2024-04-24T02:33:44,637  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_98237d29-e381-418b-bb25-1e97e7c3a9dd
2024-04-24T02:33:44,650  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_98237d29-e381-418b-bb25-1e97e7c3a9dd LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:33:44,650  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:44,651  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_98237d29-e381-418b-bb25-1e97e7c3a9dd): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,651  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,651  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951224, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:44,657  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:33:44,671  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,671  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:44,671  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_98237d29-e381-418b-bb25-1e97e7c3a9dd); Time taken: 0.02 seconds
2024-04-24T02:33:44,671  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_98237d29-e381-418b-bb25-1e97e7c3a9dd
2024-04-24T02:33:44,675  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:33:44,681  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,681  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:33:44,681  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,681  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_174bc13d-edd9-4fea-9fb0-5c14cac9141d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,683  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:33:44,684  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:33:44,684  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:44,684  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:44,686  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:33:44,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:44,688  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:44,688  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,688  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,688  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,688  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2}
2024-04-24T02:33:44,688  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_174bc13d-edd9-4fea-9fb0-5c14cac9141d); Time taken: 0.007 seconds
2024-04-24T02:33:44,688  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023344_174bc13d-edd9-4fea-9fb0-5c14cac9141d
2024-04-24T02:33:44,689  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_174bc13d-edd9-4fea-9fb0-5c14cac9141d
2024-04-24T02:33:44,702  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_174bc13d-edd9-4fea-9fb0-5c14cac9141d LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:33:44,702  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:44,702  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_174bc13d-edd9-4fea-9fb0-5c14cac9141d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,702  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,703  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951224, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFiles=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, totalSize=0, rawDataSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:44,708  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:33:44,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-24T02:33:44,721  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_174bc13d-edd9-4fea-9fb0-5c14cac9141d); Time taken: 0.019 seconds
2024-04-24T02:33:44,721  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_174bc13d-edd9-4fea-9fb0-5c14cac9141d
2024-04-24T02:33:44,725  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:33:44,731  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,731  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:33:44,731  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,731  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_cc6cddc3-9c54-458d-ab1f-cf535723fa72): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,733  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:33:44,734  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:33:44,734  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:44,734  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:44,736  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:33:44,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:44,739  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:44,739  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,739  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,739  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,739  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2}
2024-04-24T02:33:44,739  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_cc6cddc3-9c54-458d-ab1f-cf535723fa72); Time taken: 0.008 seconds
2024-04-24T02:33:44,739  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023344_cc6cddc3-9c54-458d-ab1f-cf535723fa72
2024-04-24T02:33:44,739  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_cc6cddc3-9c54-458d-ab1f-cf535723fa72
2024-04-24T02:33:44,752  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_cc6cddc3-9c54-458d-ab1f-cf535723fa72 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:33:44,752  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:44,752  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_cc6cddc3-9c54-458d-ab1f-cf535723fa72): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,752  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,753  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951224, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, rawDataSize=0, numFiles=0, bucketing_version=2, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:44,758  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:33:44,772  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,772  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-24T02:33:44,772  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_cc6cddc3-9c54-458d-ab1f-cf535723fa72); Time taken: 0.02 seconds
2024-04-24T02:33:44,772  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_cc6cddc3-9c54-458d-ab1f-cf535723fa72
2024-04-24T02:33:44,776  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:33:44,781  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,782  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:33:44,782  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,782  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_4dfe94c7-7c17-4d58-b0d3-5ccc1cc68da9): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,784  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:33:44,785  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:33:44,785  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:44,785  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:44,787  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:33:44,787  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:44,789  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:44,789  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,789  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,789  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,789  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T02:33:44,789  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_4dfe94c7-7c17-4d58-b0d3-5ccc1cc68da9); Time taken: 0.007 seconds
2024-04-24T02:33:44,789  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023344_4dfe94c7-7c17-4d58-b0d3-5ccc1cc68da9
2024-04-24T02:33:44,790  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_4dfe94c7-7c17-4d58-b0d3-5ccc1cc68da9
2024-04-24T02:33:44,804  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_4dfe94c7-7c17-4d58-b0d3-5ccc1cc68da9 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:33:44,804  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:44,804  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_4dfe94c7-7c17-4d58-b0d3-5ccc1cc68da9): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:44,804  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,805  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d604cd9f-95aa-43a3-91b1-2f985a1b50b6/_tmp_space.db/042de941-3cd2-4fdd-868e-af5654deb3b7
2024-04-24T02:33:44,808  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,808  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=3}
2024-04-24T02:33:44,809  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_4dfe94c7-7c17-4d58-b0d3-5ccc1cc68da9); Time taken: 0.004 seconds
2024-04-24T02:33:44,809  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_4dfe94c7-7c17-4d58-b0d3-5ccc1cc68da9
2024-04-24T02:33:44,813  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:33:44,818  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,819  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:33:44,819  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,819  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_db908a1d-6f33-4dce-948b-c70d94e058d1): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,822  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:33:44,822  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:33:44,822  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:44,822  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:44,825  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:33:44,825  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:44,826  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:44,826  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,826  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,826  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,826  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=1}
2024-04-24T02:33:44,827  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_db908a1d-6f33-4dce-948b-c70d94e058d1); Time taken: 0.007 seconds
2024-04-24T02:33:44,827  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023344_db908a1d-6f33-4dce-948b-c70d94e058d1
2024-04-24T02:33:44,827  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_db908a1d-6f33-4dce-948b-c70d94e058d1
2024-04-24T02:33:44,840  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_db908a1d-6f33-4dce-948b-c70d94e058d1 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:33:44,840  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:44,840  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_db908a1d-6f33-4dce-948b-c70d94e058d1): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:44,841  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,841  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951224, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=false, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:44,846  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:33:44,859  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:44,859  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=17}
2024-04-24T02:33:44,859  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_db908a1d-6f33-4dce-948b-c70d94e058d1); Time taken: 0.019 seconds
2024-04-24T02:33:44,859  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_db908a1d-6f33-4dce-948b-c70d94e058d1
2024-04-24T02:33:44,863  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:33:44,868  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:44,868  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:33:44,869  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `aci/d_u/ami`
2024-04-24T02:33:44,869  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023344_8fda04e4-7c2a-40e3-885e-32bd8fdde1ca): drop table if exists `aci/d_u/ami`
2024-04-24T02:33:44,871  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:33:44,871  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:33:44,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:44,889  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,889  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:44,889  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:44,889  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:44,889  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=18, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:44,889  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023344_8fda04e4-7c2a-40e3-885e-32bd8fdde1ca); Time taken: 0.02 seconds
2024-04-24T02:33:44,889  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023344_8fda04e4-7c2a-40e3-885e-32bd8fdde1ca
2024-04-24T02:33:44,890  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023344_8fda04e4-7c2a-40e3-885e-32bd8fdde1ca
2024-04-24T02:33:44,906  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023344_8fda04e4-7c2a-40e3-885e-32bd8fdde1ca LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:33:44,906  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:44,906  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023344_8fda04e4-7c2a-40e3-885e-32bd8fdde1ca): drop table if exists `aci/d_u/ami`
2024-04-24T02:33:44,906  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:44,907  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:44,912  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,913  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:44,919  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:44,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,015  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/aci-47-d_u-47-ami does not exist; Force to delete it.
2024-04-24T02:33:45,015 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/aci-47-d_u-47-ami
2024-04-24T02:33:45,016  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:45,016  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=102, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-24T02:33:45,016  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023344_8fda04e4-7c2a-40e3-885e-32bd8fdde1ca); Time taken: 0.11 seconds
2024-04-24T02:33:45,016  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023344_8fda04e4-7c2a-40e3-885e-32bd8fdde1ca
2024-04-24T02:33:45,019  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T02:33:45,025  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:45,025  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:33:45,025  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `src/name`
2024-04-24T02:33:45,026  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023345_f1de0179-fa5e-4fd9-a5bd-d1c115e37ec4): drop table if exists `src/name`
2024-04-24T02:33:45,027  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:33:45,028  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:33:45,028  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:33:45,047  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,047  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:45,047  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:45,047  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:45,048  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=19, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:45,048  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023345_f1de0179-fa5e-4fd9-a5bd-d1c115e37ec4); Time taken: 0.021 seconds
2024-04-24T02:33:45,048  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023345_f1de0179-fa5e-4fd9-a5bd-d1c115e37ec4
2024-04-24T02:33:45,048  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023345_f1de0179-fa5e-4fd9-a5bd-d1c115e37ec4
2024-04-24T02:33:45,061  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023345_f1de0179-fa5e-4fd9-a5bd-d1c115e37ec4 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:33:45,061  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:45,061  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023345_f1de0179-fa5e-4fd9-a5bd-d1c115e37ec4): drop table if exists `src/name`
2024-04-24T02:33:45,061  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:45,061  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:33:45,069  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,069  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:33:45,077  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.src/name	
2024-04-24T02:33:45,107  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/src-47-name does not exist; Force to delete it.
2024-04-24T02:33:45,107 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/src-47-name
2024-04-24T02:33:45,107  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:45,107  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=38, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-24T02:33:45,107  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023345_f1de0179-fa5e-4fd9-a5bd-d1c115e37ec4); Time taken: 0.046 seconds
2024-04-24T02:33:45,107  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023345_f1de0179-fa5e-4fd9-a5bd-d1c115e37ec4
2024-04-24T02:33:45,111  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:33:45,116  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:45,116  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:33:45,117  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:45,117  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023345_7a703d19-93ec-4e3b-935b-fd934eb162df): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:45,119  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T02:33:45,119  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:33:45,120  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:45,120  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:45,125  INFO [main] parse.CalcitePlanner: Creating table default.aci/d_u/ami position=13
2024-04-24T02:33:45,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:45,126  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:45,126  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:45,126  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:45,126  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:45,126  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, flushCache_()=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=1, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0}
2024-04-24T02:33:45,127  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023345_7a703d19-93ec-4e3b-935b-fd934eb162df); Time taken: 0.009 seconds
2024-04-24T02:33:45,127  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023345_7a703d19-93ec-4e3b-935b-fd934eb162df
2024-04-24T02:33:45,127  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023345_7a703d19-93ec-4e3b-935b-fd934eb162df
2024-04-24T02:33:45,140  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023345_7a703d19-93ec-4e3b-935b-fd934eb162df LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:33:45,140  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:45,140  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023345_7a703d19-93ec-4e3b-935b-fd934eb162df): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:45,140  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:45,141  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:aci/d_u/ami, dbName:default, owner:alex, createTime:1713951225, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:i, type:int, comment:null), FieldSchema(name:d?*de e, type:decimal(5,2), comment:null), FieldSchema(name:vc, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[i], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numRows=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"d?*de e":"true","i":"true","vc":"true"}}, numFiles=0, rawDataSize=0, bucketing_version=2, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:45,146  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/aci-47-d_u-47-ami
2024-04-24T02:33:45,178  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:45,178  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=37, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:45,179  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023345_7a703d19-93ec-4e3b-935b-fd934eb162df); Time taken: 0.038 seconds
2024-04-24T02:33:45,179  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023345_7a703d19-93ec-4e3b-935b-fd934eb162df
2024-04-24T02:33:45,182  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T02:33:45,188  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:45,188  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:33:45,188  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-24T02:33:45,189  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023345_b8e60598-23bf-4d61-a6ec-2ff122a83071): create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-24T02:33:45,195  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T02:33:45,195  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:33:45,197  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:45,197  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:45,199  INFO [main] parse.CalcitePlanner: Creating table default.src/name position=13
2024-04-24T02:33:45,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:45,201  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:45,201  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:45,201  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:45,201  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:45,201  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, openTxn_(String, TxnType)=6, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, flushCache_()=0}
2024-04-24T02:33:45,201  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023345_b8e60598-23bf-4d61-a6ec-2ff122a83071); Time taken: 0.012 seconds
2024-04-24T02:33:45,201  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023345_b8e60598-23bf-4d61-a6ec-2ff122a83071
2024-04-24T02:33:45,201  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023345_b8e60598-23bf-4d61-a6ec-2ff122a83071
2024-04-24T02:33:45,218  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023345_b8e60598-23bf-4d61-a6ec-2ff122a83071 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:33:45,218  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:45,218  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023345_b8e60598-23bf-4d61-a6ec-2ff122a83071): create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-24T02:33:45,218  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:45,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:src/name, dbName:default, owner:alex, createTime:1713951225, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:g/h, type:int, comment:null), FieldSchema(name:j, type:decimal(5,2), comment:null), FieldSchema(name:k, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"g/h":"true","j":"true","k":"true"}}, totalSize=0, numFiles=0, numFilesErasureCoded=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:45,224  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/src-47-name
2024-04-24T02:33:45,237  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:45,238  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:45,238  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023345_b8e60598-23bf-4d61-a6ec-2ff122a83071); Time taken: 0.019 seconds
2024-04-24T02:33:45,238  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023345_b8e60598-23bf-4d61-a6ec-2ff122a83071
2024-04-24T02:33:45,242  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:33:45,248  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:45,249  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:33:45,249  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='∆∋', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-24T02:33:45,249  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023345_db3242e6-2571-499c-b4b4-1eb79f42661c): merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='∆∋', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-24T02:33:45,254  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-24T02:33:45,255  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:33:45,255  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:33:45,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,275  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,276  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-24T02:33:45,279  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d604cd9f-95aa-43a3-91b1-2f985a1b50b6/_tmp_space.db/merge_tmp_table
2024-04-24T02:33:45,281  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='∆∋', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)> as 
<FROM
  `default`.`aci/d_u/ami` `d/8`
  RIGHT OUTER JOIN
  `default`.`src/name` `a/b`
  ON `i`=`g/h`
INSERT INTO `default`.`aci/d_u/ami`    -- delete clause
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`g/h` AND `g/h` > 5
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- update clause(insert part)
 SELECT `d/8`.`i`, `d?*de e` * `j` + 1, '∆∋'
   WHERE `i`=`g/h` AND `g/h` < 0 AND NOT(`g/h` > 5)
INSERT INTO `default`.`aci/d_u/ami`    -- update clause (delete part)
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`g/h` AND `g/h` < 0 AND NOT(`g/h` > 5)
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- insert clause
  SELECT `a/b`.`g/h`,`a/b`.`j`,`a/b`.`k`
   WHERE `d/8`.`i` IS NULL AND `d?*de e` <> 0
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`d/8`.ROW__ID)
 WHERE `i`=`g/h` GROUP BY `d/8`.ROW__ID HAVING count(*) > 1>
2024-04-24T02:33:45,283  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:33:45,286  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:45,286  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:45,286  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,293  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,293  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:33:45,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,302  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:45,302  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:45,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,308  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,314  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,315  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,321  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,327  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,327  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:45,327  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:45,328  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:45,328  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:45,328  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:45,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.src/name	
2024-04-24T02:33:45,398  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.aci/d_u/ami, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:33:45,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,407  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,408  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,416  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,416  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,426  WARN [main] calcite.RelOptHiveTable: No Stats for default@aci/d_u/ami, Columns: i, d?*de e
No Stats for default@aci/d_u/ami, Columns: i, d?*de e
2024-04-24T02:33:45,426  INFO [main] SessionState: No Stats for default@aci/d_u/ami, Columns: i, d?*de e
2024-04-24T02:33:45,427  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.src/name, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T02:33:45,427  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:33:45,438  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-24T02:33:45,449  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.src/name	
2024-04-24T02:33:45,463  WARN [main] calcite.RelOptHiveTable: No Stats for default@src/name, Columns: k, g/h, j
No Stats for default@src/name, Columns: k, g/h, j
2024-04-24T02:33:45,463  INFO [main] SessionState: No Stats for default@src/name, Columns: k, g/h, j
2024-04-24T02:33:45,639  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:45,639  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:45,639  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:45,639  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:45,639  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:45,640  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:45,640  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:45,640  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:45,640  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:45,640  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:45,640  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:45,640  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:45,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,647  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,647  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,653  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,661  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-24T02:33:45,668  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,674 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1097) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:33:45,675 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:33:45,675  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:33:45,675 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1097)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:33:45,675  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:45,675  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=86, getAllTableConstraints_(AllTableConstraintsRequest)=31, openTxn_(String, TxnType)=3, getTableColumnStatistics_(String, String, List, String)=63, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=4, createTable_(Table)=2}
2024-04-24T02:33:45,676  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023345_db3242e6-2571-499c-b4b4-1eb79f42661c); Time taken: 0.426 seconds
2024-04-24T02:33:45,676  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:33:45,679  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:45,687  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:45,687  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d604cd9f-95aa-43a3-91b1-2f985a1b50b6/hive_2024-04-24_02-33-45_281_9026333221915137316-1
2024-04-24T02:33:45,688  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023345_90124a99-4e0a-4006-9786-130db33637bc): drop table if exists acidTbl
2024-04-24T02:33:45,690  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 10
2024-04-24T02:33:45,691  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:33:45,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:45,699  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,699  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:45,699  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:45,699  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:45,700  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=11, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:45,700  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023345_90124a99-4e0a-4006-9786-130db33637bc); Time taken: 0.011 seconds
2024-04-24T02:33:45,700  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023345_90124a99-4e0a-4006-9786-130db33637bc
2024-04-24T02:33:45,700  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023345_90124a99-4e0a-4006-9786-130db33637bc
2024-04-24T02:33:45,715  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023345_90124a99-4e0a-4006-9786-130db33637bc LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:33:45,715  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:45,715  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023345_90124a99-4e0a-4006-9786-130db33637bc): drop table if exists acidTbl
2024-04-24T02:33:45,715  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:45,716  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:45,722  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,722  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:45,728  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,728  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:45,822  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:45,822  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=100, getTable_(GetTableRequest)=6}
2024-04-24T02:33:45,822  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023345_90124a99-4e0a-4006-9786-130db33637bc); Time taken: 0.107 seconds
2024-04-24T02:33:45,822  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023345_90124a99-4e0a-4006-9786-130db33637bc
2024-04-24T02:33:45,826  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:33:45,831  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:45,833  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:33:45,833  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:45,833  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023345_090ced13-8f55-4e72-86b2-15d2e6eaca32): drop table if exists acidTblPart
2024-04-24T02:33:45,841  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 13
2024-04-24T02:33:45,841  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:33:45,843  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:45,849  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,849  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:45,849  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:45,849  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:45,850  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=7, commitTxn_(CommitTxnRequest)=11, flushCache_()=1, getTable_(GetTableRequest)=6, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:45,850  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023345_090ced13-8f55-4e72-86b2-15d2e6eaca32); Time taken: 0.016 seconds
2024-04-24T02:33:45,850  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023345_090ced13-8f55-4e72-86b2-15d2e6eaca32
2024-04-24T02:33:45,850  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023345_090ced13-8f55-4e72-86b2-15d2e6eaca32
2024-04-24T02:33:45,863  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023345_090ced13-8f55-4e72-86b2-15d2e6eaca32 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:33:45,863  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:45,863  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023345_090ced13-8f55-4e72-86b2-15d2e6eaca32): drop table if exists acidTblPart
2024-04-24T02:33:45,864  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:45,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:45,870  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,870  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:45,876  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:45,912  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:45,912  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=42, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:33:45,912  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023345_090ced13-8f55-4e72-86b2-15d2e6eaca32); Time taken: 0.049 seconds
2024-04-24T02:33:45,912  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023345_090ced13-8f55-4e72-86b2-15d2e6eaca32
2024-04-24T02:33:45,916  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:33:45,921  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:45,921  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:33:45,922  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:45,922  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023345_f93ec2a4-0446-4454-bd38-7f52f327d761): drop table if exists acidTbl2
2024-04-24T02:33:45,924  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 14
2024-04-24T02:33:45,924  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:33:45,925  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:45,925  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:45,925  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:45,925  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:45,925  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023345_f93ec2a4-0446-4454-bd38-7f52f327d761); Time taken: 0.003 seconds
2024-04-24T02:33:45,925  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023345_f93ec2a4-0446-4454-bd38-7f52f327d761
2024-04-24T02:33:45,925  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:45,925  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023345_f93ec2a4-0446-4454-bd38-7f52f327d761): drop table if exists acidTbl2
2024-04-24T02:33:45,925  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:45,926  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:33:45,926  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:45,926  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=1}
2024-04-24T02:33:45,926  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023345_f93ec2a4-0446-4454-bd38-7f52f327d761); Time taken: 0.001 seconds
2024-04-24T02:33:45,926  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023345_f93ec2a4-0446-4454-bd38-7f52f327d761
2024-04-24T02:33:45,932  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:33:45,938  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:45,938  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:33:45,938  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:45,938  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023345_0896e2de-792e-4ed5-ac30-0021deccbc01): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:45,940  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 14
2024-04-24T02:33:45,940  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:33:45,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:45,961  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,961  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:45,961  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:45,961  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:45,961  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, getTable_(GetTableRequest)=20, flushCache_()=0}
2024-04-24T02:33:45,961  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023345_0896e2de-792e-4ed5-ac30-0021deccbc01); Time taken: 0.023 seconds
2024-04-24T02:33:45,961  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023345_0896e2de-792e-4ed5-ac30-0021deccbc01
2024-04-24T02:33:45,962  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023345_0896e2de-792e-4ed5-ac30-0021deccbc01
2024-04-24T02:33:45,976  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023345_0896e2de-792e-4ed5-ac30-0021deccbc01 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:33:45,976  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:45,976  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023345_0896e2de-792e-4ed5-ac30-0021deccbc01): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:45,976  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:45,976  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:45,984  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:45,992  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:45,992  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:46,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,044  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=60, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:46,044  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023345_0896e2de-792e-4ed5-ac30-0021deccbc01); Time taken: 0.068 seconds
2024-04-24T02:33:46,045  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023345_0896e2de-792e-4ed5-ac30-0021deccbc01
2024-04-24T02:33:46,048  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:33:46,054  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,054  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:33:46,054  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:46,054  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_81471f9b-5eba-4442-b7f2-df06781c485f): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:46,056  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 15
2024-04-24T02:33:46,057  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T02:33:46,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:46,065  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,066  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,066  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,066  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,066  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T02:33:46,066  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_81471f9b-5eba-4442-b7f2-df06781c485f); Time taken: 0.012 seconds
2024-04-24T02:33:46,066  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424023346_81471f9b-5eba-4442-b7f2-df06781c485f
2024-04-24T02:33:46,067  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_81471f9b-5eba-4442-b7f2-df06781c485f
2024-04-24T02:33:46,080  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_81471f9b-5eba-4442-b7f2-df06781c485f LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T02:33:46,080  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:46,080  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_81471f9b-5eba-4442-b7f2-df06781c485f): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:46,080  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:46,089  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:46,097  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:46,126  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,126  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=37, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T02:33:46,126  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_81471f9b-5eba-4442-b7f2-df06781c485f); Time taken: 0.046 seconds
2024-04-24T02:33:46,126  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_81471f9b-5eba-4442-b7f2-df06781c485f
2024-04-24T02:33:46,130  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T02:33:46,135  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,135  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T02:33:46,136  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:46,136  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_6337a78a-b09d-41b9-af75-e45943844689): drop table if exists nonAcidNonBucket
2024-04-24T02:33:46,138  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 16
2024-04-24T02:33:46,138  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T02:33:46,139  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:46,147  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,147  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,147  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,147  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,147  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=1, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:46,147  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_6337a78a-b09d-41b9-af75-e45943844689); Time taken: 0.011 seconds
2024-04-24T02:33:46,148  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424023346_6337a78a-b09d-41b9-af75-e45943844689
2024-04-24T02:33:46,148  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_6337a78a-b09d-41b9-af75-e45943844689
2024-04-24T02:33:46,163  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_6337a78a-b09d-41b9-af75-e45943844689 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T02:33:46,163  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:46,163  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_6337a78a-b09d-41b9-af75-e45943844689): drop table if exists nonAcidNonBucket
2024-04-24T02:33:46,163  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,164  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:46,172  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:46,180  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,180  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:46,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,208  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=36}
2024-04-24T02:33:46,209  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_6337a78a-b09d-41b9-af75-e45943844689); Time taken: 0.045 seconds
2024-04-24T02:33:46,209  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_6337a78a-b09d-41b9-af75-e45943844689
2024-04-24T02:33:46,212  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T02:33:46,218  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,218  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T02:33:46,219  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.265">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 4 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:33:46,277  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:33:46,278  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:33:46,280  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = d5811b0a-a676-4b8b-b56f-60527caaa21c
2024-04-24T02:33:46,282  INFO [main] SessionState: Hive Session ID = d5811b0a-a676-4b8b-b56f-60527caaa21c
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:46,282  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:46,287  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d5811b0a-a676-4b8b-b56f-60527caaa21c
2024-04-24T02:33:46,290  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c
2024-04-24T02:33:46,292  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d5811b0a-a676-4b8b-b56f-60527caaa21c/_tmp_space.db
2024-04-24T02:33:46,292  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=d5811b0a-a676-4b8b-b56f-60527caaa21c, clientType=HIVECLI]
2024-04-24T02:33:46,293  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:46,293  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_952246b1-7189-4ab2-9018-0ffe2568656d): drop table if exists acidTbl
2024-04-24T02:33:46,300  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:33:46,300  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:33:46,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:46,305  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,305  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,305  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,305  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=7, flushCache_()=0, getValidTxns_(long)=2}
2024-04-24T02:33:46,305  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_952246b1-7189-4ab2-9018-0ffe2568656d); Time taken: 0.012 seconds
2024-04-24T02:33:46,305  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023346_952246b1-7189-4ab2-9018-0ffe2568656d
2024-04-24T02:33:46,305  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:46,305  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_952246b1-7189-4ab2-9018-0ffe2568656d): drop table if exists acidTbl
2024-04-24T02:33:46,305  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:46,308  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,308  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:46,309  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_952246b1-7189-4ab2-9018-0ffe2568656d); Time taken: 0.003 seconds
2024-04-24T02:33:46,309  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_952246b1-7189-4ab2-9018-0ffe2568656d
2024-04-24T02:33:46,314  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:33:46,319  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,320  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:33:46,320  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:46,320  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_e85c1dfe-f96d-4f03-a460-66875897d312): drop table if exists acidTblPart
2024-04-24T02:33:46,322  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:33:46,322  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:33:46,323  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:46,325  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,325  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,325  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,325  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=1, flushCache_()=0}
2024-04-24T02:33:46,325  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_e85c1dfe-f96d-4f03-a460-66875897d312); Time taken: 0.005 seconds
2024-04-24T02:33:46,326  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023346_e85c1dfe-f96d-4f03-a460-66875897d312
2024-04-24T02:33:46,326  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:46,326  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_e85c1dfe-f96d-4f03-a460-66875897d312): drop table if exists acidTblPart
2024-04-24T02:33:46,326  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:46,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:46,329  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_e85c1dfe-f96d-4f03-a460-66875897d312); Time taken: 0.003 seconds
2024-04-24T02:33:46,329  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_e85c1dfe-f96d-4f03-a460-66875897d312
2024-04-24T02:33:46,334  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:33:46,339  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,339  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:33:46,340  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:46,340  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_dbe7f5db-b80c-4f59-9f5c-f8ed71b4835b): drop table if exists acidTbl2
2024-04-24T02:33:46,343  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:33:46,343  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:33:46,343  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:46,346  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,346  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,346  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,347  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-24T02:33:46,347  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_dbe7f5db-b80c-4f59-9f5c-f8ed71b4835b); Time taken: 0.006 seconds
2024-04-24T02:33:46,347  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023346_dbe7f5db-b80c-4f59-9f5c-f8ed71b4835b
2024-04-24T02:33:46,347  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:46,347  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_dbe7f5db-b80c-4f59-9f5c-f8ed71b4835b): drop table if exists acidTbl2
2024-04-24T02:33:46,347  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:46,350  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:46,350  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_dbe7f5db-b80c-4f59-9f5c-f8ed71b4835b); Time taken: 0.003 seconds
2024-04-24T02:33:46,350  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_dbe7f5db-b80c-4f59-9f5c-f8ed71b4835b
2024-04-24T02:33:46,355  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:33:46,360  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,361  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:33:46,361  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:46,361  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_d9cb74e6-3a0a-4254-960b-e05673343e92): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:46,363  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:33:46,363  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:33:46,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:46,366  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,366  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,366  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,366  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=1, getValidTxns_(long)=1}
2024-04-24T02:33:46,367  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_d9cb74e6-3a0a-4254-960b-e05673343e92); Time taken: 0.005 seconds
2024-04-24T02:33:46,367  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023346_d9cb74e6-3a0a-4254-960b-e05673343e92
2024-04-24T02:33:46,367  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:46,367  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_d9cb74e6-3a0a-4254-960b-e05673343e92): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:46,367  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:46,370  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,370  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:46,370  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_d9cb74e6-3a0a-4254-960b-e05673343e92); Time taken: 0.003 seconds
2024-04-24T02:33:46,370  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_d9cb74e6-3a0a-4254-960b-e05673343e92
2024-04-24T02:33:46,375  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:33:46,381  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,381  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:33:46,381  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:46,381  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_5fe47f5d-da3d-4133-90e8-53d85a884720): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:46,383  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:33:46,383  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:33:46,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:46,387  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,387  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,387  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,387  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=1}
2024-04-24T02:33:46,387  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_5fe47f5d-da3d-4133-90e8-53d85a884720); Time taken: 0.006 seconds
2024-04-24T02:33:46,387  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023346_5fe47f5d-da3d-4133-90e8-53d85a884720
2024-04-24T02:33:46,387  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:46,387  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_5fe47f5d-da3d-4133-90e8-53d85a884720): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:46,387  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,387  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:46,390  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,390  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:46,390  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_5fe47f5d-da3d-4133-90e8-53d85a884720); Time taken: 0.003 seconds
2024-04-24T02:33:46,390  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_5fe47f5d-da3d-4133-90e8-53d85a884720
2024-04-24T02:33:46,395  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:33:46,401  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,401  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:33:46,401  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:46,401  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_0df6b630-4208-4211-9788-353c4c7e5735): drop table if exists nonAcidNonBucket
2024-04-24T02:33:46,403  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:33:46,403  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:33:46,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:46,406  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,406  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,406  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,406  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=1}
2024-04-24T02:33:46,407  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_0df6b630-4208-4211-9788-353c4c7e5735); Time taken: 0.005 seconds
2024-04-24T02:33:46,407  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023346_0df6b630-4208-4211-9788-353c4c7e5735
2024-04-24T02:33:46,407  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:46,407  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_0df6b630-4208-4211-9788-353c4c7e5735): drop table if exists nonAcidNonBucket
2024-04-24T02:33:46,407  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:46,410  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,410  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:46,410  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_0df6b630-4208-4211-9788-353c4c7e5735); Time taken: 0.003 seconds
2024-04-24T02:33:46,410  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_0df6b630-4208-4211-9788-353c4c7e5735
2024-04-24T02:33:46,415  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:33:46,420  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,420  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:33:46,421  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,421  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_9a5c630e-2453-49b6-9bbb-ba3f8a215036): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,423  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:33:46,423  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:33:46,423  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:46,423  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:46,428  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:33:46,429  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:46,430  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:46,430  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,430  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, getDatabase_(String)=1, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T02:33:46,430  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_9a5c630e-2453-49b6-9bbb-ba3f8a215036); Time taken: 0.009 seconds
2024-04-24T02:33:46,431  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023346_9a5c630e-2453-49b6-9bbb-ba3f8a215036
2024-04-24T02:33:46,431  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_9a5c630e-2453-49b6-9bbb-ba3f8a215036
2024-04-24T02:33:46,447  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_9a5c630e-2453-49b6-9bbb-ba3f8a215036 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:33:46,447  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:46,448  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_9a5c630e-2453-49b6-9bbb-ba3f8a215036): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,448  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951226, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, rawDataSize=0, bucketing_version=2, numFilesErasureCoded=0, numRows=0, totalSize=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:46,454  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:46,499  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,499  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=51, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:46,499  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_9a5c630e-2453-49b6-9bbb-ba3f8a215036); Time taken: 0.051 seconds
2024-04-24T02:33:46,499  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_9a5c630e-2453-49b6-9bbb-ba3f8a215036
2024-04-24T02:33:46,503  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:33:46,508  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,508  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:33:46,509  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,509  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_cd904d3c-dc64-4fbd-a074-d14a1df4ad2a): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,511  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:33:46,511  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:33:46,511  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:46,512  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:46,514  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:33:46,514  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:46,515  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:46,515  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,515  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,515  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,515  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T02:33:46,516  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_cd904d3c-dc64-4fbd-a074-d14a1df4ad2a); Time taken: 0.006 seconds
2024-04-24T02:33:46,516  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023346_cd904d3c-dc64-4fbd-a074-d14a1df4ad2a
2024-04-24T02:33:46,516  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_cd904d3c-dc64-4fbd-a074-d14a1df4ad2a
2024-04-24T02:33:46,532  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_cd904d3c-dc64-4fbd-a074-d14a1df4ad2a LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:33:46,532  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:46,533  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_cd904d3c-dc64-4fbd-a074-d14a1df4ad2a): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,533  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,534  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951226, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:46,539  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:33:46,556  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,556  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-24T02:33:46,556  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_cd904d3c-dc64-4fbd-a074-d14a1df4ad2a); Time taken: 0.023 seconds
2024-04-24T02:33:46,556  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_cd904d3c-dc64-4fbd-a074-d14a1df4ad2a
2024-04-24T02:33:46,560  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:33:46,565  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,565  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:33:46,566  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,566  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_4ad7c3b0-9369-46ee-872f-02bf7867e353): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,568  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:33:46,568  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:33:46,569  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:46,569  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:46,571  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:33:46,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:46,573  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:46,573  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,573  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,573  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,573  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=2, getDatabase_(String)=1, openTxn_(String, TxnType)=1, getValidTxns_(long)=0}
2024-04-24T02:33:46,573  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_4ad7c3b0-9369-46ee-872f-02bf7867e353); Time taken: 0.007 seconds
2024-04-24T02:33:46,573  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023346_4ad7c3b0-9369-46ee-872f-02bf7867e353
2024-04-24T02:33:46,573  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_4ad7c3b0-9369-46ee-872f-02bf7867e353
2024-04-24T02:33:46,586  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_4ad7c3b0-9369-46ee-872f-02bf7867e353 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:33:46,586  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:46,586  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_4ad7c3b0-9369-46ee-872f-02bf7867e353): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,587  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951226, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numRows=0, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:46,593  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:33:46,606  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,606  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:46,606  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_4ad7c3b0-9369-46ee-872f-02bf7867e353); Time taken: 0.02 seconds
2024-04-24T02:33:46,606  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_4ad7c3b0-9369-46ee-872f-02bf7867e353
2024-04-24T02:33:46,610  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:33:46,615  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,615  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:33:46,616  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,616  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_5532602e-1e08-43de-8108-680a67bddec3): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,618  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:33:46,618  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:33:46,619  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:46,619  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:46,621  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:33:46,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:46,623  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:46,623  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,623  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,623  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,623  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, flushCache_()=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=1}
2024-04-24T02:33:46,623  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_5532602e-1e08-43de-8108-680a67bddec3); Time taken: 0.007 seconds
2024-04-24T02:33:46,623  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023346_5532602e-1e08-43de-8108-680a67bddec3
2024-04-24T02:33:46,623  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_5532602e-1e08-43de-8108-680a67bddec3
2024-04-24T02:33:46,637  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_5532602e-1e08-43de-8108-680a67bddec3 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:33:46,637  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:46,637  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_5532602e-1e08-43de-8108-680a67bddec3): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,637  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951226, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, bucketing_version=2, totalSize=0, numFilesErasureCoded=0, numFiles=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:46,643  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:33:46,656  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,656  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-24T02:33:46,656  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_5532602e-1e08-43de-8108-680a67bddec3); Time taken: 0.019 seconds
2024-04-24T02:33:46,656  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_5532602e-1e08-43de-8108-680a67bddec3
2024-04-24T02:33:46,660  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:33:46,666  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,666  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:33:46,666  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,666  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_b07811d8-5488-418f-928f-761dd36fb87f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,669  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:33:46,669  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:33:46,670  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:46,670  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:46,672  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:33:46,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:46,674  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:46,674  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,674  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,674  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,674  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:46,674  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_b07811d8-5488-418f-928f-761dd36fb87f); Time taken: 0.008 seconds
2024-04-24T02:33:46,675  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023346_b07811d8-5488-418f-928f-761dd36fb87f
2024-04-24T02:33:46,675  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_b07811d8-5488-418f-928f-761dd36fb87f
2024-04-24T02:33:46,688  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_b07811d8-5488-418f-928f-761dd36fb87f LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:33:46,688  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:46,689  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_b07811d8-5488-418f-928f-761dd36fb87f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:46,689  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,690  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d5811b0a-a676-4b8b-b56f-60527caaa21c/_tmp_space.db/02887ba5-ef37-4bc7-ac14-396563fe0145
2024-04-24T02:33:46,692  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,693  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=2}
2024-04-24T02:33:46,693  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_b07811d8-5488-418f-928f-761dd36fb87f); Time taken: 0.003 seconds
2024-04-24T02:33:46,693  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_b07811d8-5488-418f-928f-761dd36fb87f
2024-04-24T02:33:46,697  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:33:46,702  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,702  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:33:46,703  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,703  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_9e331583-c27e-45fb-822c-b4944cf58b39): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,705  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:33:46,706  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:33:46,706  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:46,706  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:46,709  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:33:46,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:46,710  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:46,710  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,710  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:46,710  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,710  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, getDatabase_(String)=1}
2024-04-24T02:33:46,711  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_9e331583-c27e-45fb-822c-b4944cf58b39); Time taken: 0.007 seconds
2024-04-24T02:33:46,711  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023346_9e331583-c27e-45fb-822c-b4944cf58b39
2024-04-24T02:33:46,711  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_9e331583-c27e-45fb-822c-b4944cf58b39
2024-04-24T02:33:46,725  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_9e331583-c27e-45fb-822c-b4944cf58b39 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:33:46,725  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:46,725  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_9e331583-c27e-45fb-822c-b4944cf58b39): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:46,726  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:46,726  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951226, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, transactional=false, numFilesErasureCoded=0, numRows=0, rawDataSize=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:46,732  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:33:46,745  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:46,745  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-24T02:33:46,745  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_9e331583-c27e-45fb-822c-b4944cf58b39); Time taken: 0.02 seconds
2024-04-24T02:33:46,745  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_9e331583-c27e-45fb-822c-b4944cf58b39
2024-04-24T02:33:46,749  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:33:46,755  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:46,755  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:33:46,755  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:33:46,756  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:33:46,757  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:33:46,758  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:33:46,758  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:46,758  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:46,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:46,779  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,779  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:46,779  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:46,779  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:46,779  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:46,779  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:46,785  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,785  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:46,785  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:46,806  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:46,873  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:46,873  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:46,873  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:46,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:46,875  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:46,875  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:46,875  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:46,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:46,882  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:46,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:46,892  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-24T02:33:46,892  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-24T02:33:46,893  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:46,896  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:33:46,896  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:33:46,897  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:33:46,897  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:46,905  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:46,911  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:46,912  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:46,912  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:46,912  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:46,912  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-24T02:33:46,912  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:46,912  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=38, isCompatibleWith_(Configuration)=0, allocateTableWriteId_(long, String, String)=8, commitTxn_(CommitTxnRequest)=10, getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=0, flushCache_()=0, getValidWriteIds_(List, String)=3, getAllTableConstraints_(AllTableConstraintsRequest)=25}
2024-04-24T02:33:46,912  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6); Time taken: 0.157 seconds
2024-04-24T02:33:46,913  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6
2024-04-24T02:33:46,913  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6
2024-04-24T02:33:46,931  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:33:46,931  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:46,934  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-24T02:33:46,934  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6
2024-04-24T02:33:46,934  INFO [main] ql.Driver: Query ID = alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6
Total jobs = 1
2024-04-24T02:33:46,934  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:33:46,934  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:33:47,074  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T02:33:47,074  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T02:33:47,074  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:33:47,074  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:33:47,074  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:33:47,074  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:33:47,074  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:33:47,074  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:33:47,076  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:47,076  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:33:47,076  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-46_755_8481968583512059428-1/dummy_path
2024-04-24T02:33:47,085  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:47,086  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:33:47,090  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:33:47,092  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:33:47,093  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:47,096  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-46_755_8481968583512059428-1/-mr-10000
2024-04-24T02:33:47,098  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:47,105  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:47,109  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:47,110  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:33:47,110  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:33:47,110  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-46_755_8481968583512059428-1/dummy_path
2024-04-24T02:33:47,110  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:33:47,127  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:33:47,145  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local151899254_0072
2024-04-24T02:33:47,145  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:47,200  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:47,200  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:47,200  INFO [Thread-6116] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:47,200  INFO [Thread-6116] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:47,202  INFO [Thread-6116] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:47,202  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local151899254_0072_m_000000_0
2024-04-24T02:33:47,205  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:47,205  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-46_755_8481968583512059428-1/dummy_path/null:0+1
2024-04-24T02:33:47,207  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:47,208  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:33:47,208  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T02:33:47,212  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:33:47,212  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:33:47,212  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:33:47,212  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:33:47,212  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:33:47,213  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:33:47,213  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:47,213  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:47,214  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:47,214  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:47,214  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:33:47,214  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:33:47,214  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:47,214  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:33:47,214  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:33:47,214  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:47,215  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:47,216  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:33:47,216  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:33:47,216  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:47,216  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:47,216  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T02:33:47,216  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:33:47,216  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T02:33:47,216  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T02:33:47,218  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:47,218  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:33:47,218  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:33:47,218  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T02:33:47,218  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:33:47,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:33:47,232  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local151899254_0072_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:47,233  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:33:47,233  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local151899254_0072_m_000000_0' done.
2024-04-24T02:33:47,233  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local151899254_0072_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1430410
		FILE: Number of bytes written=84830691
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1405616128
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5019
2024-04-24T02:33:47,233  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local151899254_0072_m_000000_0
2024-04-24T02:33:47,233  INFO [Thread-6116] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:33:47,234  INFO [Thread-6116] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:33:47,234  INFO [pool-358-thread-1] mapred.LocalJobRunner: Starting task: attempt_local151899254_0072_r_000000_0
2024-04-24T02:33:47,236  INFO [pool-358-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:47,236  INFO [pool-358-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@38362041
2024-04-24T02:33:47,236  WARN [pool-358-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:47,237  INFO [pool-358-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:47,238  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local151899254_0072_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:47,240  INFO [localfetcher#97] reduce.LocalFetcher: localfetcher#97 about to shuffle output of map attempt_local151899254_0072_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:33:47,241  INFO [localfetcher#97] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local151899254_0072_m_000000_0
2024-04-24T02:33:47,241  INFO [localfetcher#97] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:33:47,241  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:47,241  INFO [pool-358-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:47,241  INFO [pool-358-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:47,247  INFO [pool-358-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:47,247  INFO [pool-358-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:33:47,253  INFO [pool-358-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:47,253  INFO [pool-358-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:33:47,253  INFO [pool-358-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:47,253  INFO [pool-358-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:47,253  INFO [pool-358-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:33:47,253  INFO [pool-358-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:47,254  INFO [pool-358-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:47,255  INFO [pool-358-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:33:47,256  INFO [pool-358-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:47,257  INFO [pool-358-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:33:47,257  INFO [pool-358-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:33:47,257  INFO [pool-358-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:33:47,257  INFO [pool-358-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local151899254_0072/job_local151899254_0072.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@69937561
2024-04-24T02:33:47,258  INFO [pool-358-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:47,258  INFO [pool-358-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:47,258  INFO [pool-358-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:47,259  INFO [pool-358-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:47,259  INFO [pool-358-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:47,274  INFO [pool-358-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:47,284  INFO [pool-358-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:33:47,284  INFO [pool-358-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:33:47,284  INFO [pool-358-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:33:47,284  INFO [pool-358-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:47,287  INFO [pool-358-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-24T02:33:47,311  INFO [pool-358-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-24T02:33:47,312  INFO [pool-358-thread-1] mapred.Task: Task:attempt_local151899254_0072_r_000000_0 is done. And is in the process of committing
2024-04-24T02:33:47,313  INFO [pool-358-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:47,313  INFO [pool-358-thread-1] mapred.Task: Task 'attempt_local151899254_0072_r_000000_0' done.
2024-04-24T02:33:47,313  INFO [pool-358-thread-1] mapred.Task: Final Counters for attempt_local151899254_0072_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1436515
		FILE: Number of bytes written=84831730
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1405616128
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:47,313  INFO [pool-358-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local151899254_0072_r_000000_0
2024-04-24T02:33:47,313  INFO [pool-358-thread-1] mapred.LocalJobRunner: Starting task: attempt_local151899254_0072_r_000001_0
2024-04-24T02:33:47,314  INFO [pool-358-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:47,314  INFO [pool-358-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@23b4039c
2024-04-24T02:33:47,314  WARN [pool-358-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:47,316  INFO [pool-358-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:47,317  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local151899254_0072_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:47,321  INFO [localfetcher#98] reduce.LocalFetcher: localfetcher#98 about to shuffle output of map attempt_local151899254_0072_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:33:47,322  INFO [localfetcher#98] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local151899254_0072_m_000000_0
2024-04-24T02:33:47,322  INFO [localfetcher#98] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:33:47,323  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:47,323  INFO [pool-358-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:47,323  INFO [pool-358-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:47,333  INFO [pool-358-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:47,333  INFO [pool-358-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:33:47,338  INFO [pool-358-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:47,338  INFO [pool-358-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:33:47,338  INFO [pool-358-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:47,338  INFO [pool-358-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:47,338  INFO [pool-358-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:33:47,339  INFO [pool-358-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:47,339  INFO [pool-358-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:47,340  INFO [pool-358-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:33:47,342  INFO [pool-358-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:47,342  INFO [pool-358-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:33:47,342  INFO [pool-358-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:33:47,342  INFO [pool-358-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:33:47,342  INFO [pool-358-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local151899254_0072/job_local151899254_0072.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6eb8e428
2024-04-24T02:33:47,343  INFO [pool-358-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:47,343  INFO [pool-358-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:47,343  INFO [pool-358-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:47,344  INFO [pool-358-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:47,344  INFO [pool-358-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:47,354  INFO [pool-358-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:47,355  INFO [pool-358-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:33:47,355  INFO [pool-358-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:47,355  INFO [pool-358-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:33:47,355  INFO [pool-358-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:47,357  INFO [pool-358-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:33:47,377  INFO [pool-358-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-24T02:33:47,378  INFO [pool-358-thread-1] mapred.Task: Task:attempt_local151899254_0072_r_000001_0 is done. And is in the process of committing
2024-04-24T02:33:47,379  INFO [pool-358-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:47,379  INFO [pool-358-thread-1] mapred.Task: Task 'attempt_local151899254_0072_r_000001_0' done.
2024-04-24T02:33:47,379  INFO [pool-358-thread-1] mapred.Task: Final Counters for attempt_local151899254_0072_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1442596
		FILE: Number of bytes written=84832758
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1405616128
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:47,380  INFO [pool-358-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local151899254_0072_r_000001_0
2024-04-24T02:33:47,380  INFO [Thread-6116] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:33:48,203 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:33:48,203  INFO [main] exec.Task: 2024-04-24 02:33:48,203 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local151899254_0072
2024-04-24T02:33:48,204  INFO [main] exec.Task: Ended Job = job_local151899254_0072
2024-04-24T02:33:48,205  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T02:33:48,205  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:33:48,205  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:33:48,205  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T02:33:48,205  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:33:48,206  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:33:48,206  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:48,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:48,213  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:48,213  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:48,219  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:48,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:33:48,253  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:33:48,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:48,259  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:48,259  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:33:48,259  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-46_755_8481968583512059428-1/-mr-10000
2024-04-24T02:33:48,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:48,267  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:48,277  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:33:48,277  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-24T02:33:48,277  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:33:48,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:33:48,297  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-24T02:33:48,297  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:33:48,297  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:33:48,299  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:33:48,299  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:48,299  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=53, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=26, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-24T02:33:48,300  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:48,300  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:48,300  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:48,300  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6); Time taken: 1.366 seconds
2024-04-24T02:33:48,300  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023346_bdd7462d-2f84-4e03-88c7-d9b6f33b61e6
2024-04-24T02:33:48,309  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:48,310  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:33:48,310  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-24T02:33:48,310  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-46_755_8481968583512059428-1
2024-04-24T02:33:48,311  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-46_755_8481968583512059428-1 on fs with scheme file
2024-04-24T02:33:48,311  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a): select a,b from acidTbl order by a,b
2024-04-24T02:33:48,313  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:33:48,313  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:33:48,313  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:48,313  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:48,316  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:48,316  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:48,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:48,322  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:48,323  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:48,323  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:48,323  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:48,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:48,355  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-24T02:33:48,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:48,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:48,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:48,373  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:48,373  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:33:48,384  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:33:48,384  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-24T02:33:48,426  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:48,426  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:48,426  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:48,427  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-48_311_8660521230282817155-1/-mr-10001/.hive-staging_hive_2024-04-24_02-33-48_311_8660521230282817155-1
2024-04-24T02:33:48,434  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:48,436  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T02:33:48,436  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T02:33:48,438  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:48,446  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:48,446  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:48,446  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:48,446  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T02:33:48,447  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T02:33:48,447  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:48,447  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=5, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTableColumnStatistics_(String, String, List, String)=27, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=6}
2024-04-24T02:33:48,448  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a); Time taken: 0.136 seconds
2024-04-24T02:33:48,448  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a
2024-04-24T02:33:48,448  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a
2024-04-24T02:33:48,463  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:33:48,463  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:48,463  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a): select a,b from acidTbl order by a,b
2024-04-24T02:33:48,463  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a
2024-04-24T02:33:48,464  INFO [main] ql.Driver: Query ID = alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a
Total jobs = 1
2024-04-24T02:33:48,464  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:33:48,464  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:33:48,604  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:33:48,604  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:33:48,604  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:33:48,604  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:33:48,604  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:33:48,604  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:33:48,604  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:33:48,604  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:33:48,607  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:48,607  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-24T02:33:48,607  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:48,615  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:48,616  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:33:48,621  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:33:48,621  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-24T02:33:48,622  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:48,627  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:48,634  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:48,639  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:48,640  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T02:33:48,640  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T02:33:48,640  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:48,640  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T02:33:48,640  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T02:33:48,640  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T02:33:48,652  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T02:33:48,652  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 12 ms
2024-04-24T02:33:48,652  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T02:33:48,668  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T02:33:48,686  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local195750500_0073
2024-04-24T02:33:48,686  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:48,744  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:48,744  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:48,744  INFO [Thread-6193] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:48,744  INFO [Thread-6193] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:48,746  INFO [Thread-6193] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:48,746  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local195750500_0073_m_000000_0
2024-04-24T02:33:48,747  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:48,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:33:48,747  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:48,748  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:33:48,749  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:33:48,749  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:33:48,749  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:33:48,749  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:33:48,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:33:48,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:33:48,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:33:48,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:33:48,753  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:33:48,754  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:33:48,754  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:48,755  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:48,756  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:48,756  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:48,756  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:33:48,756  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:33:48,756  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:33:48,756  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:33:48,757  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:33:48,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:33:48,771  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local195750500_0073_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:48,772  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:33:48,772  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local195750500_0073_m_000000_0' done.
2024-04-24T02:33:48,772  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local195750500_0073_m_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1451775
		FILE: Number of bytes written=86004713
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1405616128
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7474
2024-04-24T02:33:48,772  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local195750500_0073_m_000000_0
2024-04-24T02:33:48,772  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local195750500_0073_m_000001_0
2024-04-24T02:33:48,772  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:48,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:33:48,773  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:48,773  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-24T02:33:48,774  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:33:48,774  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:33:48,775  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:33:48,775  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:33:48,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:33:48,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:33:48,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:33:48,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:33:48,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:33:48,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:33:48,792  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:48,793  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:48,793  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:48,793  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:48,793  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-24T02:33:48,793  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T02:33:48,793  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:33:48,794  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:48,795  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:33:48,795  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:33:48,795  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-24T02:33:48,795  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:33:48,807  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:33:48,815  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local195750500_0073_m_000001_0 is done. And is in the process of committing
2024-04-24T02:33:48,817  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:33:48,817  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local195750500_0073_m_000001_0' done.
2024-04-24T02:33:48,817  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local195750500_0073_m_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1460254
		FILE: Number of bytes written=86004772
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=11
		Total committed heap usage (bytes)=1401946112
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7466
2024-04-24T02:33:48,817  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local195750500_0073_m_000001_0
2024-04-24T02:33:48,817  INFO [Thread-6193] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:33:48,819  INFO [Thread-6193] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:33:48,819  INFO [pool-363-thread-1] mapred.LocalJobRunner: Starting task: attempt_local195750500_0073_r_000000_0
2024-04-24T02:33:48,820  INFO [pool-363-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:48,820  INFO [pool-363-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5309b7fc
2024-04-24T02:33:48,820  WARN [pool-363-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:48,822  INFO [pool-363-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:48,823  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local195750500_0073_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:48,824  INFO [localfetcher#99] reduce.LocalFetcher: localfetcher#99 about to shuffle output of map attempt_local195750500_0073_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:33:48,825  INFO [localfetcher#99] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local195750500_0073_m_000001_0
2024-04-24T02:33:48,825  INFO [localfetcher#99] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-24T02:33:48,827  INFO [localfetcher#99] reduce.LocalFetcher: localfetcher#99 about to shuffle output of map attempt_local195750500_0073_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-24T02:33:48,828  INFO [localfetcher#99] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local195750500_0073_m_000000_0
2024-04-24T02:33:48,828  INFO [localfetcher#99] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-24T02:33:48,828  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:48,828  INFO [pool-363-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T02:33:48,828  INFO [pool-363-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:48,836  INFO [pool-363-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T02:33:48,836  INFO [pool-363-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-24T02:33:48,839  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:48,839  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-24T02:33:48,839  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:48,839  INFO [pool-363-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:48,839  INFO [pool-363-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-24T02:33:48,839  INFO [pool-363-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T02:33:48,840  INFO [pool-363-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:48,840  INFO [pool-363-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-24T02:33:48,841  INFO [pool-363-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:48,841  INFO [pool-363-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:48,841  INFO [pool-363-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-24T02:33:48,841  INFO [pool-363-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T02:33:48,841  INFO [pool-363-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@23079e42, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@696d28ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@24ae156d, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@6163b42f
2024-04-24T02:33:48,842  INFO [pool-363-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-48_311_8660521230282817155-1/-mr-10001/.hive-staging_hive_2024-04-24_02-33-48_311_8660521230282817155-1/_tmp.-ext-10002/000000_0
2024-04-24T02:33:48,842  INFO [pool-363-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-48_311_8660521230282817155-1/-mr-10001/.hive-staging_hive_2024-04-24_02-33-48_311_8660521230282817155-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T02:33:48,842  INFO [pool-363-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-48_311_8660521230282817155-1/-mr-10001/.hive-staging_hive_2024-04-24_02-33-48_311_8660521230282817155-1/_tmp.-ext-10002/000000_0
2024-04-24T02:33:48,849  INFO [pool-363-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T02:33:48,849  INFO [pool-363-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:48,849  INFO [pool-363-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:48,849  INFO [pool-363-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T02:33:48,849  INFO [pool-363-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T02:33:48,850  INFO [pool-363-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:2, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:48,850  INFO [pool-363-thread-1] mapred.Task: Task:attempt_local195750500_0073_r_000000_0 is done. And is in the process of committing
2024-04-24T02:33:48,850  INFO [pool-363-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:48,850  INFO [pool-363-thread-1] mapred.Task: Task 'attempt_local195750500_0073_r_000000_0' done.
2024-04-24T02:33:48,850  INFO [pool-363-thread-1] mapred.Task: Final Counters for attempt_local195750500_0073_r_000000_0: Counters: 34
	File System Counters
		FILE: Number of bytes read=1466067
		FILE: Number of bytes written=86004951
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1401946112
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:48,850  INFO [pool-363-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local195750500_0073_r_000000_0
2024-04-24T02:33:48,850  INFO [Thread-6193] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:33:49,746 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:33:49,746  INFO [main] exec.Task: 2024-04-24 02:33:49,746 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local195750500_0073
2024-04-24T02:33:49,746  INFO [main] exec.Task: Ended Job = job_local195750500_0073
2024-04-24T02:33:49,749  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:49,749  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T02:33:49,749  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:49,749  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:49,749  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:49,749  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a); Time taken: 1.286 seconds
2024-04-24T02:33:49,749  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023348_e612bb96-fe8c-410a-9b0e-0b4a391bb05a
2024-04-24T02:33:49,754  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:33:49,761  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:49,762  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:33:49,765  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T02:33:49,766  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T02:33:49,766  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:49,766  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-24T02:33:49,767  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-48_311_8660521230282817155-1
2024-04-24T02:33:49,767  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d5811b0a-a676-4b8b-b56f-60527caaa21c/hive_2024-04-24_02-33-48_311_8660521230282817155-1 on fs with scheme file
2024-04-24T02:33:49,767  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023349_3cb9e86b-886d-40d9-b424-804c002418b1): START TRANSACTION
2024-04-24T02:33:49,769  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-24T02:33:49,770  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:33:49,770  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:49,770  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:49,770  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:49,770  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:49,770  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:49,770  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:49,771  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=0, flushCache_()=1, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:49,771  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023349_3cb9e86b-886d-40d9-b424-804c002418b1); Time taken: 0.003 seconds
2024-04-24T02:33:49,771  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023349_3cb9e86b-886d-40d9-b424-804c002418b1
2024-04-24T02:33:49,771  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-24T02:33:49,771  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023349_3cb9e86b-886d-40d9-b424-804c002418b1): START TRANSACTION
2024-04-24T02:33:49,771  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:49,771  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T02:33:49,771  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023349_3cb9e86b-886d-40d9-b424-804c002418b1); Time taken: 0.0 seconds
2024-04-24T02:33:49,771  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 4
2024-04-24T02:33:49,772  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023349_b12efd57-3308-4ec9-ad4d-678317673bba): delete from acidTbl where b = 4
2024-04-24T02:33:49,772  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:33:49,772  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:49,780  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,780  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 4> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-24T02:33:49,781  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:33:49,783  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:49,783  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:49,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:49,791  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,791  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:49,791  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:49,791  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:49,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,798  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:49,798  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:49,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:49,837  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-24T02:33:49,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:49,847  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:49,857  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:33:49,867  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-24T02:33:49,867  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-24T02:33:49,923  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:49,924  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:49,924  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:49,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:49,931  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,933 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:33:49,934 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:33:49,934  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:33:49,934 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:33:49,934  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:49,935  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTableColumnStatistics_(String, String, List, String)=30, flushCache_()=0, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=29, getAllTableConstraints_(AllTableConstraintsRequest)=4}
2024-04-24T02:33:49,935  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023349_b12efd57-3308-4ec9-ad4d-678317673bba); Time taken: 0.162 seconds
2024-04-24T02:33:49,935  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023349_3cb9e86b-886d-40d9-b424-804c002418b1
2024-04-24T02:33:49,939  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:49,946  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:49,946  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023349_614a5862-22d5-4baa-bc1b-23fe4e97b2ff): drop table if exists acidTbl
2024-04-24T02:33:49,949  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-24T02:33:49,949  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:33:49,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:49,956  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,957  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:49,957  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:49,957  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:49,957  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, rollbackTxn_(long)=11, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-24T02:33:49,957  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023349_614a5862-22d5-4baa-bc1b-23fe4e97b2ff); Time taken: 0.011 seconds
2024-04-24T02:33:49,957  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023349_614a5862-22d5-4baa-bc1b-23fe4e97b2ff
2024-04-24T02:33:49,958  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023349_614a5862-22d5-4baa-bc1b-23fe4e97b2ff
2024-04-24T02:33:49,973  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023349_614a5862-22d5-4baa-bc1b-23fe4e97b2ff LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:33:49,973  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:49,973  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023349_614a5862-22d5-4baa-bc1b-23fe4e97b2ff): drop table if exists acidTbl
2024-04-24T02:33:49,973  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:49,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:49,979  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:49,986  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:49,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:50,080  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:50,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=101, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:50,081  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023349_614a5862-22d5-4baa-bc1b-23fe4e97b2ff); Time taken: 0.107 seconds
2024-04-24T02:33:50,081  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023349_614a5862-22d5-4baa-bc1b-23fe4e97b2ff
2024-04-24T02:33:50,084  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:33:50,090  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:50,092  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:33:50,092  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:50,092  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023350_6843c75a-54e1-4bb4-b3f9-7654c4d68e4f): drop table if exists acidTblPart
2024-04-24T02:33:50,101  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-24T02:33:50,101  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:33:50,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:50,113  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,113  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:50,113  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:50,113  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:50,113  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=2, openTxn_(String, TxnType)=8, getTable_(GetTableRequest)=10, flushCache_()=0}
2024-04-24T02:33:50,113  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023350_6843c75a-54e1-4bb4-b3f9-7654c4d68e4f); Time taken: 0.021 seconds
2024-04-24T02:33:50,113  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023350_6843c75a-54e1-4bb4-b3f9-7654c4d68e4f
2024-04-24T02:33:50,114  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023350_6843c75a-54e1-4bb4-b3f9-7654c4d68e4f
2024-04-24T02:33:50,130  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023350_6843c75a-54e1-4bb4-b3f9-7654c4d68e4f LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:33:50,130  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:50,130  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023350_6843c75a-54e1-4bb4-b3f9-7654c4d68e4f): drop table if exists acidTblPart
2024-04-24T02:33:50,130  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:50,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:50,137  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:50,143  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:50,183  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:50,183  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=46, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:50,183  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023350_6843c75a-54e1-4bb4-b3f9-7654c4d68e4f); Time taken: 0.053 seconds
2024-04-24T02:33:50,183  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023350_6843c75a-54e1-4bb4-b3f9-7654c4d68e4f
2024-04-24T02:33:50,187  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:33:50,192  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:50,193  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:33:50,193  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:50,193  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023350_4b9af48d-a65b-42a6-9e01-469483160064): drop table if exists acidTbl2
2024-04-24T02:33:50,195  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-24T02:33:50,195  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:33:50,196  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:50,196  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:50,196  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:50,196  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, getTable_(GetTableRequest)=0, flushCache_()=0, openTxn_(String, TxnType)=1}
2024-04-24T02:33:50,196  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023350_4b9af48d-a65b-42a6-9e01-469483160064); Time taken: 0.003 seconds
2024-04-24T02:33:50,196  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023350_4b9af48d-a65b-42a6-9e01-469483160064
2024-04-24T02:33:50,196  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:50,196  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023350_4b9af48d-a65b-42a6-9e01-469483160064): drop table if exists acidTbl2
2024-04-24T02:33:50,197  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:50,197  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:33:50,197  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:50,197  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-24T02:33:50,198  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023350_4b9af48d-a65b-42a6-9e01-469483160064); Time taken: 0.001 seconds
2024-04-24T02:33:50,198  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023350_4b9af48d-a65b-42a6-9e01-469483160064
2024-04-24T02:33:50,203  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:33:50,208  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:50,208  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:33:50,209  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:50,209  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023350_a191871d-f329-4b58-8722-8092dc8d478e): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:50,211  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-24T02:33:50,211  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:33:50,211  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:50,231  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,231  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:50,231  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:50,231  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:50,231  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=20, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:50,231  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023350_a191871d-f329-4b58-8722-8092dc8d478e); Time taken: 0.022 seconds
2024-04-24T02:33:50,232  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023350_a191871d-f329-4b58-8722-8092dc8d478e
2024-04-24T02:33:50,232  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023350_a191871d-f329-4b58-8722-8092dc8d478e
2024-04-24T02:33:50,246  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023350_a191871d-f329-4b58-8722-8092dc8d478e LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:33:50,246  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:50,246  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023350_a191871d-f329-4b58-8722-8092dc8d478e): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:50,246  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:50,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:50,255  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:50,264  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,264  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:50,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:50,315  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=60, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T02:33:50,316  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023350_a191871d-f329-4b58-8722-8092dc8d478e); Time taken: 0.069 seconds
2024-04-24T02:33:50,316  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023350_a191871d-f329-4b58-8722-8092dc8d478e
2024-04-24T02:33:50,319  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:33:50,325  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:50,325  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:33:50,326  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:50,326  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023350_fdede2f2-af83-4ace-bd1c-bac304b1dd7d): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:50,328  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-24T02:33:50,328  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:33:50,328  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:50,336  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,336  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:50,336  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:50,336  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:50,336  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T02:33:50,336  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023350_fdede2f2-af83-4ace-bd1c-bac304b1dd7d); Time taken: 0.01 seconds
2024-04-24T02:33:50,337  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023350_fdede2f2-af83-4ace-bd1c-bac304b1dd7d
2024-04-24T02:33:50,337  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023350_fdede2f2-af83-4ace-bd1c-bac304b1dd7d
2024-04-24T02:33:50,350  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023350_fdede2f2-af83-4ace-bd1c-bac304b1dd7d LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:33:50,350  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:50,350  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023350_fdede2f2-af83-4ace-bd1c-bac304b1dd7d): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:50,351  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:50,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:50,359  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,359  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:50,367  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:50,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:50,395  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=36, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:50,396  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023350_fdede2f2-af83-4ace-bd1c-bac304b1dd7d); Time taken: 0.045 seconds
2024-04-24T02:33:50,396  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023350_fdede2f2-af83-4ace-bd1c-bac304b1dd7d
2024-04-24T02:33:50,399  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:33:50,405  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:50,405  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:33:50,406  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:50,406  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023350_32496bbc-d842-40ee-b827-dff499e09033): drop table if exists nonAcidNonBucket
2024-04-24T02:33:50,408  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-24T02:33:50,408  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:33:50,408  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:50,416  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,416  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:50,416  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:50,416  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:50,416  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2}
2024-04-24T02:33:50,416  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023350_32496bbc-d842-40ee-b827-dff499e09033); Time taken: 0.01 seconds
2024-04-24T02:33:50,417  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023350_32496bbc-d842-40ee-b827-dff499e09033
2024-04-24T02:33:50,417  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023350_32496bbc-d842-40ee-b827-dff499e09033
2024-04-24T02:33:50,430  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023350_32496bbc-d842-40ee-b827-dff499e09033 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:33:50,430  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:33:50,430  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023350_32496bbc-d842-40ee-b827-dff499e09033): drop table if exists nonAcidNonBucket
2024-04-24T02:33:50,430  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:50,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:50,438  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:50,446  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:50,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:50,475  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:50,475  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=37}
2024-04-24T02:33:50,475  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023350_32496bbc-d842-40ee-b827-dff499e09033); Time taken: 0.045 seconds
2024-04-24T02:33:50,475  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023350_32496bbc-d842-40ee-b827-dff499e09033
2024-04-24T02:33:50,479  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:33:50,485  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:50,485  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:33:50,485  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testErrors" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.626"/>
  <testcase name="testMoreBucketsThanReducers" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.718">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = -1 failed: (responseCode = 2, errorMessage = FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask, SQLState = 08S01)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMoreBucketsThanReducers(TestTxnCommands.java:1429)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:33:56,166  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:33:56,166  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:33:56,166  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:33:56,166  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:33:56,167  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:33:56,167  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:33:56,167  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:33:56,167  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:33:56,167  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:33:56,167  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:33:56,167  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:33:56,169  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 641f7f6f-7e79-4565-a763-e4ba68314f6c
2024-04-24T02:33:56,171  INFO [main] SessionState: Hive Session ID = 641f7f6f-7e79-4565-a763-e4ba68314f6c
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:56,171  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:33:56,176  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/641f7f6f-7e79-4565-a763-e4ba68314f6c
2024-04-24T02:33:56,179  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c
2024-04-24T02:33:56,181  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/641f7f6f-7e79-4565-a763-e4ba68314f6c/_tmp_space.db
2024-04-24T02:33:56,181  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=641f7f6f-7e79-4565-a763-e4ba68314f6c, clientType=HIVECLI]
2024-04-24T02:33:56,181  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:33:56,182  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_6c7b3486-e88b-43c1-9067-1177befe40a5): drop table if exists acidTbl
2024-04-24T02:33:56,189  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:33:56,189  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:33:56,191  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:56,194  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,194  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,194  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,194  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, flushCache_()=0, openTxn_(String, TxnType)=7, commitTxn_(CommitTxnRequest)=13}
2024-04-24T02:33:56,194  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_6c7b3486-e88b-43c1-9067-1177befe40a5); Time taken: 0.012 seconds
2024-04-24T02:33:56,194  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023356_6c7b3486-e88b-43c1-9067-1177befe40a5
2024-04-24T02:33:56,194  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:56,194  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_6c7b3486-e88b-43c1-9067-1177befe40a5): drop table if exists acidTbl
2024-04-24T02:33:56,195  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:56,197  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,197  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,198  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_6c7b3486-e88b-43c1-9067-1177befe40a5); Time taken: 0.003 seconds
2024-04-24T02:33:56,198  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_6c7b3486-e88b-43c1-9067-1177befe40a5
2024-04-24T02:33:56,203  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:33:56,209  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,209  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:33:56,210  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:33:56,210  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_a7b81019-99b2-488d-9575-3f585eb9cb5b): drop table if exists acidTblPart
2024-04-24T02:33:56,212  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:33:56,212  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:33:56,213  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:56,215  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,215  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,215  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,216  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,216  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_a7b81019-99b2-488d-9575-3f585eb9cb5b); Time taken: 0.005 seconds
2024-04-24T02:33:56,216  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023356_a7b81019-99b2-488d-9575-3f585eb9cb5b
2024-04-24T02:33:56,216  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:56,216  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_a7b81019-99b2-488d-9575-3f585eb9cb5b): drop table if exists acidTblPart
2024-04-24T02:33:56,216  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,216  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:33:56,220  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,220  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,220  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_a7b81019-99b2-488d-9575-3f585eb9cb5b); Time taken: 0.004 seconds
2024-04-24T02:33:56,220  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_a7b81019-99b2-488d-9575-3f585eb9cb5b
2024-04-24T02:33:56,225  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:33:56,231  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,231  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:33:56,232  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:33:56,232  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_ef2927ef-1e24-4834-ba1d-75c6ffde50e7): drop table if exists acidTbl2
2024-04-24T02:33:56,234  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:33:56,234  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:33:56,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:56,237  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,237  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,237  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,237  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T02:33:56,237  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_ef2927ef-1e24-4834-ba1d-75c6ffde50e7); Time taken: 0.005 seconds
2024-04-24T02:33:56,238  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023356_ef2927ef-1e24-4834-ba1d-75c6ffde50e7
2024-04-24T02:33:56,238  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:56,238  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_ef2927ef-1e24-4834-ba1d-75c6ffde50e7): drop table if exists acidTbl2
2024-04-24T02:33:56,238  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,238  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:33:56,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,242  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,242  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_ef2927ef-1e24-4834-ba1d-75c6ffde50e7); Time taken: 0.003 seconds
2024-04-24T02:33:56,242  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_ef2927ef-1e24-4834-ba1d-75c6ffde50e7
2024-04-24T02:33:56,247  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:33:56,253  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,253  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:33:56,253  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:33:56,253  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_d9301a51-0ab9-4456-94c2-6147473000ef): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:56,255  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:33:56,256  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:33:56,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:56,259  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,259  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,259  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_d9301a51-0ab9-4456-94c2-6147473000ef); Time taken: 0.006 seconds
2024-04-24T02:33:56,259  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023356_d9301a51-0ab9-4456-94c2-6147473000ef
2024-04-24T02:33:56,259  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:56,259  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_d9301a51-0ab9-4456-94c2-6147473000ef): drop table if exists nonAcidOrcTbl
2024-04-24T02:33:56,260  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:33:56,263  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,263  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,263  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_d9301a51-0ab9-4456-94c2-6147473000ef); Time taken: 0.004 seconds
2024-04-24T02:33:56,263  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_d9301a51-0ab9-4456-94c2-6147473000ef
2024-04-24T02:33:56,268  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:33:56,274  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,274  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:33:56,274  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:56,275  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_ae99e0ba-4739-45f4-b8a9-0488ecc8898e): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:56,276  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:33:56,277  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:33:56,277  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:56,280  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,280  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,280  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,280  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0}
2024-04-24T02:33:56,280  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_ae99e0ba-4739-45f4-b8a9-0488ecc8898e); Time taken: 0.005 seconds
2024-04-24T02:33:56,280  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023356_ae99e0ba-4739-45f4-b8a9-0488ecc8898e
2024-04-24T02:33:56,280  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:56,280  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_ae99e0ba-4739-45f4-b8a9-0488ecc8898e): drop table if exists nonAcidOrcTbl2
2024-04-24T02:33:56,280  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:33:56,283  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,284  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:56,284  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_ae99e0ba-4739-45f4-b8a9-0488ecc8898e); Time taken: 0.003 seconds
2024-04-24T02:33:56,284  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_ae99e0ba-4739-45f4-b8a9-0488ecc8898e
2024-04-24T02:33:56,289  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:33:56,294  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,294  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:33:56,295  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:33:56,295  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_5d52cef9-c596-4de4-868b-6a1db4a7d499): drop table if exists nonAcidNonBucket
2024-04-24T02:33:56,297  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:33:56,297  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:33:56,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:56,300  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,300  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,300  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,300  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,300  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_5d52cef9-c596-4de4-868b-6a1db4a7d499); Time taken: 0.005 seconds
2024-04-24T02:33:56,301  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023356_5d52cef9-c596-4de4-868b-6a1db4a7d499
2024-04-24T02:33:56,301  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:33:56,301  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_5d52cef9-c596-4de4-868b-6a1db4a7d499): drop table if exists nonAcidNonBucket
2024-04-24T02:33:56,301  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:33:56,304  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,304  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,304  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_5d52cef9-c596-4de4-868b-6a1db4a7d499); Time taken: 0.003 seconds
2024-04-24T02:33:56,304  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_5d52cef9-c596-4de4-868b-6a1db4a7d499
2024-04-24T02:33:56,309  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:33:56,315  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,315  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:33:56,315  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,315  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_bb41c3c8-2352-4799-a645-bcb6258ce3f8): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,318  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:33:56,318  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:33:56,318  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:56,318  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:56,324  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:33:56,324  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:56,325  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:56,325  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,325  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,325  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,325  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6}
2024-04-24T02:33:56,326  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_bb41c3c8-2352-4799-a645-bcb6258ce3f8); Time taken: 0.01 seconds
2024-04-24T02:33:56,326  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023356_bb41c3c8-2352-4799-a645-bcb6258ce3f8
2024-04-24T02:33:56,326  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_bb41c3c8-2352-4799-a645-bcb6258ce3f8
2024-04-24T02:33:56,343  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_bb41c3c8-2352-4799-a645-bcb6258ce3f8 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:33:56,343  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:56,344  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_bb41c3c8-2352-4799-a645-bcb6258ce3f8): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,344  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951236, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, transactional=true, numFiles=0, totalSize=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:56,350  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:56,382  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,382  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=38}
2024-04-24T02:33:56,383  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_bb41c3c8-2352-4799-a645-bcb6258ce3f8); Time taken: 0.038 seconds
2024-04-24T02:33:56,383  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_bb41c3c8-2352-4799-a645-bcb6258ce3f8
2024-04-24T02:33:56,387  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:33:56,393  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,393  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:33:56,393  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,393  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_348358e0-e94d-403f-9759-9f5317896226): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,396  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:33:56,396  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:33:56,398  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:56,398  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:56,400  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:33:56,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:56,402  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:56,402  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,402  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,402  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,402  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, flushCache_()=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:56,402  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_348358e0-e94d-403f-9759-9f5317896226); Time taken: 0.009 seconds
2024-04-24T02:33:56,402  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023356_348358e0-e94d-403f-9759-9f5317896226
2024-04-24T02:33:56,403  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_348358e0-e94d-403f-9759-9f5317896226
2024-04-24T02:33:56,428  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_348358e0-e94d-403f-9759-9f5317896226 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:33:56,428  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:56,429  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_348358e0-e94d-403f-9759-9f5317896226): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,429  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951236, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:33:56,436  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:33:56,453  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,453  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=23}
2024-04-24T02:33:56,453  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_348358e0-e94d-403f-9759-9f5317896226); Time taken: 0.024 seconds
2024-04-24T02:33:56,453  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_348358e0-e94d-403f-9759-9f5317896226
2024-04-24T02:33:56,457  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:33:56,463  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,463  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:33:56,464  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,464  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_58b649d1-afcf-4fa9-898f-443a5bf2f1d1): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,466  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:33:56,466  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:33:56,467  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:56,467  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:56,469  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:33:56,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:56,471  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:56,471  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,471  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=3, getValidTxns_(long)=0}
2024-04-24T02:33:56,471  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_58b649d1-afcf-4fa9-898f-443a5bf2f1d1); Time taken: 0.007 seconds
2024-04-24T02:33:56,471  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023356_58b649d1-afcf-4fa9-898f-443a5bf2f1d1
2024-04-24T02:33:56,472  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_58b649d1-afcf-4fa9-898f-443a5bf2f1d1
2024-04-24T02:33:56,485  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_58b649d1-afcf-4fa9-898f-443a5bf2f1d1 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:33:56,485  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:56,485  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_58b649d1-afcf-4fa9-898f-443a5bf2f1d1): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,485  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951236, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, transactional=false, rawDataSize=0, totalSize=0, bucketing_version=2, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:56,491  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:33:56,504  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,504  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:56,504  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_58b649d1-afcf-4fa9-898f-443a5bf2f1d1); Time taken: 0.019 seconds
2024-04-24T02:33:56,504  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_58b649d1-afcf-4fa9-898f-443a5bf2f1d1
2024-04-24T02:33:56,508  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:33:56,514  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,514  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:33:56,515  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,515  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_690f135c-35cf-4fff-b886-330c5a69d8d2): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,517  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:33:56,517  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:33:56,518  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:56,518  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:56,520  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:33:56,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:56,521  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:56,521  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,521  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,522  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,522  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getDatabase_(String)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=9}
2024-04-24T02:33:56,522  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_690f135c-35cf-4fff-b886-330c5a69d8d2); Time taken: 0.006 seconds
2024-04-24T02:33:56,522  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023356_690f135c-35cf-4fff-b886-330c5a69d8d2
2024-04-24T02:33:56,522  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_690f135c-35cf-4fff-b886-330c5a69d8d2
2024-04-24T02:33:56,536  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_690f135c-35cf-4fff-b886-330c5a69d8d2 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:33:56,536  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:56,536  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_690f135c-35cf-4fff-b886-330c5a69d8d2): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,536  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,537  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951236, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numRows=0, bucketing_version=2, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:56,542  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:33:56,555  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,555  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,555  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_690f135c-35cf-4fff-b886-330c5a69d8d2); Time taken: 0.019 seconds
2024-04-24T02:33:56,555  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_690f135c-35cf-4fff-b886-330c5a69d8d2
2024-04-24T02:33:56,559  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:33:56,565  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,565  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:33:56,566  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,566  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_d5a76ced-8947-487a-b997-2c10cdb656c3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,568  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:33:56,569  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:33:56,569  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:56,569  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:56,571  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:33:56,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:56,573  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:56,573  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,573  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,573  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,574  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, getDatabase_(String)=1, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:56,574  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_d5a76ced-8947-487a-b997-2c10cdb656c3); Time taken: 0.007 seconds
2024-04-24T02:33:56,574  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023356_d5a76ced-8947-487a-b997-2c10cdb656c3
2024-04-24T02:33:56,574  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_d5a76ced-8947-487a-b997-2c10cdb656c3
2024-04-24T02:33:56,588  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_d5a76ced-8947-487a-b997-2c10cdb656c3 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:33:56,588  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:56,588  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_d5a76ced-8947-487a-b997-2c10cdb656c3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:33:56,588  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,589  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/641f7f6f-7e79-4565-a763-e4ba68314f6c/_tmp_space.db/d4ae8a84-e3c3-4c1a-855f-eabdada81e81
2024-04-24T02:33:56,592  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,592  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=1}
2024-04-24T02:33:56,592  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_d5a76ced-8947-487a-b997-2c10cdb656c3); Time taken: 0.004 seconds
2024-04-24T02:33:56,592  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_d5a76ced-8947-487a-b997-2c10cdb656c3
2024-04-24T02:33:56,596  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:33:56,602  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,602  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:33:56,603  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,603  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_bebb842f-ebea-440c-b59f-c284c0400155): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,605  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:33:56,605  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:33:56,605  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:33:56,605  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:56,608  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:33:56,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:33:56,609  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:33:56,609  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,609  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:33:56,609  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,609  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0}
2024-04-24T02:33:56,610  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_bebb842f-ebea-440c-b59f-c284c0400155); Time taken: 0.006 seconds
2024-04-24T02:33:56,610  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023356_bebb842f-ebea-440c-b59f-c284c0400155
2024-04-24T02:33:56,610  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_bebb842f-ebea-440c-b59f-c284c0400155
2024-04-24T02:33:56,624  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_bebb842f-ebea-440c-b59f-c284c0400155 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:33:56,624  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:33:56,624  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_bebb842f-ebea-440c-b59f-c284c0400155): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:33:56,625  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:33:56,625  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951236, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0, transactional=false, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:33:56,631  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:33:56,644  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:56,645  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-24T02:33:56,645  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_bebb842f-ebea-440c-b59f-c284c0400155); Time taken: 0.02 seconds
2024-04-24T02:33:56,645  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_bebb842f-ebea-440c-b59f-c284c0400155
2024-04-24T02:33:56,649  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:33:56,654  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:56,655  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:33:56,656  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl values(1,1)
2024-04-24T02:33:56,657  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): insert into acidTbl values(1,1)
2024-04-24T02:33:56,659  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:33:56,659  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:33:56,659  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:56,659  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:56,662  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:56,680  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:56,680  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:56,680  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:56,681  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:56,681  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:56,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:56,687  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:56,687  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:56,687  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:56,707  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:56,774  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:56,774  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:56,774  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:56,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:56,777  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:56,777  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:56,777  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:56,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:56,779  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:56,787  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-24T02:33:56,787  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-24T02:33:56,788  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:56,791  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:33:56,791  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:33:56,792  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:33:56,792  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:56,800  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:56,807  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:56,807  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:56,807  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:56,807  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:56,807  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:33:56,807  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:56,808  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getCheckConstraints_(CheckConstraintsRequest)=1, openTxn_(String, TxnType)=2, allocateTableWriteId_(long, String, String)=8, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=26, getNotNullConstraints_(NotNullConstraintsRequest)=1, getTable_(GetTableRequest)=31, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:56,808  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.151 seconds
2024-04-24T02:33:56,808  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:56,808  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:56,827  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:33:56,827  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:56,830  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): insert into acidTbl values(1,1)
2024-04-24T02:33:56,830  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:56,830  INFO [main] ql.Driver: Query ID = alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
Total jobs = 1
2024-04-24T02:33:56,830  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:33:56,830  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:33:56,970  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:33:56,970  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:33:56,970  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:33:56,970  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:33:56,970  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:33:56,970  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:33:56,970  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:33:56,970  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:33:56,973  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:56,973  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:33:56,973  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-56_656_173531853093581635-1/dummy_path
2024-04-24T02:33:56,982  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:56,982  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,94KB
2024-04-24T02:33:56,987  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:33:56,987  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T02:33:56,988  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:56,992  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-56_656_173531853093581635-1/-mr-10000
2024-04-24T02:33:56,994  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:57,001  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:57,005  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:57,006  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:33:57,007  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:33:57,007  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-56_656_173531853093581635-1/dummy_path
2024-04-24T02:33:57,007  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:33:57,024  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:33:57,041  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1808097053_0077
2024-04-24T02:33:57,041  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:57,101  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:57,101  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:57,102  INFO [Thread-6477] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:57,102  INFO [Thread-6477] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:57,104  INFO [Thread-6477] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:57,104  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1808097053_0077_m_000000_0
2024-04-24T02:33:57,106  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:57,107  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-56_656_173531853093581635-1/dummy_path/null:0+1
2024-04-24T02:33:57,109  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:57,110  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,94KB
2024-04-24T02:33:57,110  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:33:57,115  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:33:57,115  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:33:57,115  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:33:57,115  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:33:57,115  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:33:57,116  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:33:57,116  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:57,116  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:57,117  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:57,117  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:57,117  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:33:57,117  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:33:57,117  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:57,117  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:33:57,117  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:33:57,117  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:33:57,118  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:57,119  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:57,119  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:57,119  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:33:57,119  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 1. abort - false
2024-04-24T02:33:57,119  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-24T02:33:57,121  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:57,121  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:33:57,121  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:33:57,121  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 16; bufvoid = 104857600
2024-04-24T02:33:57,121  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-24T02:33:57,131  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:33:57,136  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1808097053_0077_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:57,136  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:33:57,136  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1808097053_0077_m_000000_0' done.
2024-04-24T02:33:57,137  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1808097053_0077_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1518010
		FILE: Number of bytes written=90720184
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=1
		Map output bytes=16
		Map output materialized bytes=24
		Input split bytes=360
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1394606080
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
	File Input Format Counters 
		Bytes Read=4990
2024-04-24T02:33:57,137  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1808097053_0077_m_000000_0
2024-04-24T02:33:57,137  INFO [Thread-6477] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:33:57,137  INFO [Thread-6477] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:33:57,138  INFO [pool-377-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1808097053_0077_r_000000_0
2024-04-24T02:33:57,140  INFO [pool-377-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:57,140  INFO [pool-377-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@23a81e86
2024-04-24T02:33:57,140  WARN [pool-377-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:57,141  INFO [pool-377-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:57,141  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1808097053_0077_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:57,144  INFO [localfetcher#104] reduce.LocalFetcher: localfetcher#104 about to shuffle output of map attempt_local1808097053_0077_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-24T02:33:57,144  INFO [localfetcher#104] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1808097053_0077_m_000000_0
2024-04-24T02:33:57,144  INFO [localfetcher#104] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-24T02:33:57,144  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:57,145  INFO [pool-377-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:57,145  INFO [pool-377-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:57,151  INFO [pool-377-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:57,151  INFO [pool-377-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:33:57,154  INFO [pool-377-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:57,154  INFO [pool-377-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-24T02:33:57,154  INFO [pool-377-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:57,154  INFO [pool-377-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:57,154  INFO [pool-377-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-24T02:33:57,154  INFO [pool-377-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:57,154  INFO [pool-377-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:57,155  INFO [pool-377-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T02:33:57,156  INFO [pool-377-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:57,156  INFO [pool-377-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:33:57,156  INFO [pool-377-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:33:57,156  INFO [pool-377-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:33:57,156  INFO [pool-377-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1808097053_0077/job_local1808097053_0077.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@708b06d3
2024-04-24T02:33:57,156  INFO [pool-377-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:57,156  INFO [pool-377-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:57,156  INFO [pool-377-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:57,157  INFO [pool-377-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:57,157  INFO [pool-377-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:57,157  INFO [pool-377-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:57,157  INFO [pool-377-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:57,157  INFO [pool-377-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:57,164  INFO [pool-377-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:57,168  INFO [pool-377-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:33:57,168  INFO [pool-377-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-24T02:33:57,168  INFO [pool-377-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:33:57,168  INFO [pool-377-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:57,170  INFO [pool-377-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T02:33:57,181  INFO [pool-377-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-24T02:33:57,181  INFO [pool-377-thread-1] mapred.Task: Task:attempt_local1808097053_0077_r_000000_0 is done. And is in the process of committing
2024-04-24T02:33:57,181  INFO [pool-377-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:57,181  INFO [pool-377-thread-1] mapred.Task: Task 'attempt_local1808097053_0077_r_000000_0' done.
2024-04-24T02:33:57,181  INFO [pool-377-thread-1] mapred.Task: Final Counters for attempt_local1808097053_0077_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1524041
		FILE: Number of bytes written=90721211
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1394606080
	HIVE
		CREATED_FILES=2
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:57,181  INFO [pool-377-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1808097053_0077_r_000000_0
2024-04-24T02:33:57,182  INFO [Thread-6477] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:33:58,104 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:33:58,104  INFO [main] exec.Task: 2024-04-24 02:33:58,104 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1808097053_0077
2024-04-24T02:33:58,105  INFO [main] exec.Task: Ended Job = job_local1808097053_0077
2024-04-24T02:33:58,106  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:33:58,106  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-24T02:33:58,106  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-24T02:33:58,107  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:33:58,107  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:58,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:58,114  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:58,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:58,121  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:58,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:33:58,160  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:33:58,160  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:58,166  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:58,166  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:33:58,167  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-56_656_173531853093581635-1/-mr-10000
2024-04-24T02:33:58,167  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:58,174  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:58,182  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:33:58,182  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 1, false: 
2024-04-24T02:33:58,182  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:33:58,183  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:33:58,202  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 1, false: 
2024-04-24T02:33:58,202  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:33:58,202  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:33:58,204  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=1, numRows=1, totalSize=659, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:33:58,204  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:58,204  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, alter_table_(String, String, String, Table, EnvironmentContext, String)=59, getTable_(GetTableRequest)=27, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:33:58,205  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:58,205  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:58,205  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:58,205  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 1.374 seconds
2024-04-24T02:33:58,205  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:58,215  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:58,215  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T02:33:58,215  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl values(0,0),(3,3)
2024-04-24T02:33:58,216  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-56_656_173531853093581635-1
2024-04-24T02:33:58,216  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-56_656_173531853093581635-1 on fs with scheme file
2024-04-24T02:33:58,216  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): insert into acidTbl values(0,0),(3,3)
2024-04-24T02:33:58,219  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-24T02:33:58,219  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:33:58,219  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:58,219  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:33:58,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:58,228  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:58,228  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:58,228  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:58,228  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:58,228  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:58,229  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:58,235  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:58,235  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:58,235  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:58,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:58,303  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:58,303  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:58,303  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T02:33:58,304  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T02:33:58,306  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T02:33:58,306  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:58,306  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T02:33:58,307  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:58,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:58,316  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 14
2024-04-24T02:33:58,316  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-24T02:33:58,317  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:58,320  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:33:58,320  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:33:58,321  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T02:33:58,322  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:58,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:58,337  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:58,338  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T02:33:58,338  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:58,338  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:58,338  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T02:33:58,338  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:58,338  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=4, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, allocateTableWriteId_(long, String, String)=8, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=19}
2024-04-24T02:33:58,338  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.122 seconds
2024-04-24T02:33:58,338  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:58,338  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:58,354  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:33:58,354  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:58,357  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): insert into acidTbl values(0,0),(3,3)
2024-04-24T02:33:58,357  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:58,357  INFO [main] ql.Driver: Query ID = alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
Total jobs = 1
2024-04-24T02:33:58,357  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:33:58,357  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:33:58,500  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:33:58,500  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:33:58,500  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:33:58,500  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:33:58,500  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:33:58,500  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:33:58,500  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:33:58,500  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:33:58,502  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:33:58,502  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T02:33:58,502  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-58_216_5733514110219724702-1/dummy_path
2024-04-24T02:33:58,511  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:33:58,512  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,98KB
2024-04-24T02:33:58,516  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:33:58,517  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:33:58,518  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:58,521  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-58_216_5733514110219724702-1/-mr-10000
2024-04-24T02:33:58,523  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:58,530  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:33:58,534  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:33:58,535  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T02:33:58,535  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T02:33:58,535  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-58_216_5733514110219724702-1/dummy_path
2024-04-24T02:33:58,535  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T02:33:58,552  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T02:33:58,570  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2011983966_0078
2024-04-24T02:33:58,570  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:33:58,628  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:33:58,628  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:33:58,628  INFO [Thread-6537] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:58,628  INFO [Thread-6537] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:33:58,630  INFO [Thread-6537] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:33:58,630  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2011983966_0078_m_000000_0
2024-04-24T02:33:58,630  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:58,631  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-58_216_5733514110219724702-1/dummy_path/null:0+1
2024-04-24T02:33:58,631  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:33:58,631  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,98KB
2024-04-24T02:33:58,632  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:33:58,636  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:33:58,636  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:33:58,636  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:33:58,636  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:33:58,636  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:33:58,636  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:33:58,636  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:33:58,637  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:33:58,637  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:33:58,637  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:33:58,637  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T02:33:58,637  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T02:33:58,638  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T02:33:58,638  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T02:33:58,638  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:33:58,638  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:33:58,638  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:33:58,638  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T02:33:58,638  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T02:33:58,639  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T02:33:58,640  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T02:33:58,640  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T02:33:58,640  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T02:33:58,640  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T02:33:58,640  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T02:33:58,651  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T02:33:58,653  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2011983966_0078_m_000000_0 is done. And is in the process of committing
2024-04-24T02:33:58,654  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T02:33:58,654  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2011983966_0078_m_000000_0' done.
2024-04-24T02:33:58,654  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2011983966_0078_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1529799
		FILE: Number of bytes written=91902631
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=42
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1394606080
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5034
2024-04-24T02:33:58,654  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2011983966_0078_m_000000_0
2024-04-24T02:33:58,654  INFO [Thread-6537] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:33:58,655  INFO [Thread-6537] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T02:33:58,655  INFO [pool-382-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2011983966_0078_r_000000_0
2024-04-24T02:33:58,656  INFO [pool-382-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:33:58,656  INFO [pool-382-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@ed28b85
2024-04-24T02:33:58,656  WARN [pool-382-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:33:58,656  INFO [pool-382-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T02:33:58,657  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2011983966_0078_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T02:33:58,658  INFO [localfetcher#105] reduce.LocalFetcher: localfetcher#105 about to shuffle output of map attempt_local2011983966_0078_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T02:33:58,658  INFO [localfetcher#105] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local2011983966_0078_m_000000_0
2024-04-24T02:33:58,658  INFO [localfetcher#105] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T02:33:58,658  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T02:33:58,658  INFO [pool-382-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:58,658  INFO [pool-382-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T02:33:58,665  INFO [pool-382-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:58,665  INFO [pool-382-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:33:58,667  INFO [pool-382-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T02:33:58,668  INFO [pool-382-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T02:33:58,668  INFO [pool-382-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T02:33:58,668  INFO [pool-382-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T02:33:58,668  INFO [pool-382-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T02:33:58,668  INFO [pool-382-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T02:33:58,668  INFO [pool-382-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T02:33:58,669  INFO [pool-382-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-24T02:33:58,669  INFO [pool-382-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T02:33:58,669  INFO [pool-382-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T02:33:58,669  INFO [pool-382-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T02:33:58,669  INFO [pool-382-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T02:33:58,670  INFO [pool-382-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@5c52563d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2011983966_0078/job_local2011983966_0078.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@38599fe4
2024-04-24T02:33:58,670  INFO [pool-382-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:58,670  INFO [pool-382-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:58,670  INFO [pool-382-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:58,671  INFO [pool-382-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:58,671  INFO [pool-382-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:58,671  INFO [pool-382-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse
2024-04-24T02:33:58,671  INFO [pool-382-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T02:33:58,671  INFO [pool-382-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:58,678  INFO [pool-382-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:58,682  INFO [pool-382-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T02:33:58,687  INFO [pool-382-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T02:33:58,687  INFO [pool-382-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T02:33:58,687  INFO [pool-382-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:33:58,687  INFO [pool-382-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T02:33:58,687  INFO [pool-382-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T02:33:58,690  INFO [pool-382-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-24T02:33:58,701  INFO [pool-382-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-24T02:33:58,702  INFO [pool-382-thread-1] mapred.Task: Task:attempt_local2011983966_0078_r_000000_0 is done. And is in the process of committing
2024-04-24T02:33:58,702  INFO [pool-382-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T02:33:58,702  INFO [pool-382-thread-1] mapred.Task: Task 'attempt_local2011983966_0078_r_000000_0' done.
2024-04-24T02:33:58,702  INFO [pool-382-thread-1] mapred.Task: Final Counters for attempt_local2011983966_0078_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1535891
		FILE: Number of bytes written=91904517
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1394606080
	HIVE
		CREATED_FILES=2
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T02:33:58,702  INFO [pool-382-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2011983966_0078_r_000000_0
2024-04-24T02:33:58,702  INFO [Thread-6537] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 02:33:59,630 Stage-1 map = 100%,  reduce = 100%
2024-04-24T02:33:59,630  INFO [main] exec.Task: 2024-04-24 02:33:59,630 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2011983966_0078
2024-04-24T02:33:59,632  INFO [main] exec.Task: Ended Job = job_local2011983966_0078
2024-04-24T02:33:59,633  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-24T02:33:59,633  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-24T02:33:59,633  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-24T02:33:59,634  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-24T02:33:59,634  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:33:59,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,641  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,650  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,651  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:33:59,672  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T02:33:59,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,677  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,678  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T02:33:59,678  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-58_216_5733514110219724702-1/-mr-10000
2024-04-24T02:33:59,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,685  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,703  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T02:33:59,704  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-24T02:33:59,704  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-24T02:33:59,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-24T02:33:59,723  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-24T02:33:59,723  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-24T02:33:59,723  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-24T02:33:59,724  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=3, numRows=3, totalSize=1978, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T02:33:59,724  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:33:59,724  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=1, getTable_(GetTableRequest)=28, alter_table_(String, String, String, Table, EnvironmentContext, String)=39, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T02:33:59,724  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T02:33:59,724  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:59,724  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:33:59,725  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 1.367 seconds
2024-04-24T02:33:59,725  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:59,735  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:33:59,735  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:33:59,736  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = -1
2024-04-24T02:33:59,736  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-58_216_5733514110219724702-1
2024-04-24T02:33:59,736  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-58_216_5733514110219724702-1 on fs with scheme file
2024-04-24T02:33:59,736  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): update acidTbl set b = -1
2024-04-24T02:33:59,739  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-24T02:33:59,739  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:33:59,739  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:59,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:59,745  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,746  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = -1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-24T02:33:59,746  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:33:59,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:33:59,755  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,756  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:33:59,756  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:59,756  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,763  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,763  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:59,763  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:59,763  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:33:59,763  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:33:59,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,783  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,802  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:33:59,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,812  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,821  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,821  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:33:59,830  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-24T02:33:59,830  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-24T02:33:59,887  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:33:59,887  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:33:59,887  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:33:59,895  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 15
2024-04-24T02:33:59,895  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [15])
2024-04-24T02:33:59,898  INFO [main] parse.UpdateDeleteSemanticAnalyzer: CBO Succeeded; optimized logical plan.
2024-04-24T02:33:59,901  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2]}
2024-04-24T02:33:59,901  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1], VALUE._col1=Column[_col2]}
2024-04-24T02:33:59,901  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:33:59,901  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T02:33:59,902  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:33:59,902  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T02:33:59,905  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T02:33:59,913  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:33:59,919  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:33:59,920  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed plan generation
2024-04-24T02:33:59,920  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:59,920  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:33:59,920  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:_c2, type:int, comment:null)], properties:null)
2024-04-24T02:33:59,920  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:33:59,920  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=5, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=27, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, getCheckConstraints_(CheckConstraintsRequest)=1, getTableColumnStatistics_(String, String, List, String)=28, getNotNullConstraints_(NotNullConstraintsRequest)=1, allocateTableWriteId_(long, String, String)=6, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:33:59,920  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.184 seconds
2024-04-24T02:33:59,921  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:59,921  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:59,936  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:33:59,936  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T02:33:59,942  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): update acidTbl set b = -1
2024-04-24T02:33:59,942  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:33:59,942  INFO [main] ql.Driver: Query ID = alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
Total jobs = 1
2024-04-24T02:33:59,942  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T02:33:59,942  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T02:34:00,084  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T02:34:00,084  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T02:34:00,084  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T02:34:00,084  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T02:34:00,084  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T02:34:00,084  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T02:34:00,084  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T02:34:00,084  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T02:34:00,089  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T02:34:00,089  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-24T02:34:00,089  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:34:00,098  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T02:34:00,098  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:34:00,103  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T02:34:00,104  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,62KB
2024-04-24T02:34:00,105  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:34:00,109  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-59_746_4675719956266327742-1/-mr-10000
2024-04-24T02:34:00,110  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T02:34:00,117  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T02:34:00,121  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T02:34:00,122  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0
2024-04-24T02:34:00,122  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a
2024-04-24T02:34:00,122  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:34:00,122  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T02:34:00,122  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:3:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T02:34:00,122  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T02:34:00,141  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/3
2024-04-24T02:34:00,141  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 19 ms
2024-04-24T02:34:00,141  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T02:34:00,157  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T02:34:00,176  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local789738945_0079
2024-04-24T02:34:00,176  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T02:34:00,235  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T02:34:00,235  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T02:34:00,235  INFO [Thread-6608] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:34:00,235  INFO [Thread-6608] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T02:34:00,237  INFO [Thread-6608] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T02:34:00,237  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local789738945_0079_m_000000_0
2024-04-24T02:34:00,238  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:34:00,238  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=664, isOriginal=false, fileLength=664, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:34:00,239  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:34:00,239  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:34:00,240  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:34:00,240  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with {include: [true, true, false], offset: 0, length: 664, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:34:00,241  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:34:00,241  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:34:00,245  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:34:00,245  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:34:00,245  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:34:00,245  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:34:00,245  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:34:00,245  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:34:00,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:34:00,247  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:34:00,247  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:34:00,247  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:34:00,247  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>>
2024-04-24T02:34:00,247  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:34:00,247  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:34:00,248  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:34:00,249 ERROR [LocalJobRunner Map Task Executor #0] mr.ExecMapper: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row
	at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:573)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:184)
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1073)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:307)
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:888)
	at org.apache.hadoop.hive.ql.exec.SelectOperator.process(SelectOperator.java:94)
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:888)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:173)
	at org.apache.hadoop.hive.ql.exec.MapOperator$MapOpCtx.forward(MapOperator.java:154)
	at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:552)
	... 11 more

2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 0. abort - true
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 0. abort - true
2024-04-24T02:34:00,249  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_4:0, 
2024-04-24T02:34:00,250  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local789738945_0079_m_000001_0
2024-04-24T02:34:00,250  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:34:00,251  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=659, isOriginal=false, fileLength=659, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:34:00,251  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:34:00,251  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:34:00,252  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:34:00,252  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, false], offset: 0, length: 659, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:34:00,253  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:34:00,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:34:00,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:34:00,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:34:00,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:34:00,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:34:00,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:34:00,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:34:00,259  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:34:00,259  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:34:00,260  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:34:00,260  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:34:00,260  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>>
2024-04-24T02:34:00,260  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:34:00,260  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:34:00,261  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:34:00,261 ERROR [LocalJobRunner Map Task Executor #0] mr.ExecMapper: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row
	at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:573)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: cannot set field private int org.apache.hadoop.hive.ql.io.RecordIdentifier.bucketId of class org.apache.hadoop.hive.ql.io.RecordIdentifier RecordIdentifier(1, 0(0.0.0),536936448)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:384)
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:888)
	at org.apache.hadoop.hive.ql.exec.SelectOperator.process(SelectOperator.java:94)
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:888)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:173)
	at org.apache.hadoop.hive.ql.exec.MapOperator$MapOpCtx.forward(MapOperator.java:154)
	at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:552)
	... 11 more
Caused by: java.lang.RuntimeException: cannot set field private int org.apache.hadoop.hive.ql.io.RecordIdentifier.bucketId of class org.apache.hadoop.hive.ql.io.RecordIdentifier RecordIdentifier(1, 0(0.0.0),536936448)
	at org.apache.hadoop.hive.serde2.objectinspector.ReflectionStructObjectInspector.setStructFieldData(ReflectionStructObjectInspector.java:245)
	at org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters$StructConverter.convert(ObjectInspectorConverters.java:422)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFUtils$ConversionHelper.convertIfNecessary(GenericUDFUtils.java:438)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.evaluate(GenericUDFBridge.java:196)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator._evaluate(ExprNodeGenericFuncEvaluator.java:235)
	at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator.evaluate(ExprNodeEvaluator.java:80)
	at org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator.evaluate(ExprNodeEvaluator.java:68)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.computeHashCode(ReduceSinkOperator.java:448)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:343)
	... 17 more
Caused by: java.lang.IllegalArgumentException: Can not set int field org.apache.hadoop.hive.ql.io.RecordIdentifier.bucketId to java.lang.Long
	at sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:167)
	at sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:171)
	at sun.reflect.UnsafeIntegerFieldAccessorImpl.set(UnsafeIntegerFieldAccessorImpl.java:98)
	at java.lang.reflect.Field.set(Field.java:764)
	at org.apache.hadoop.hive.serde2.objectinspector.ReflectionStructObjectInspector.setStructFieldData(ReflectionStructObjectInspector.java:242)
	... 25 more

2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 0. abort - true
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 0. abort - true
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_4:0, 
2024-04-24T02:34:00,262  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local789738945_0079_m_000002_0
2024-04-24T02:34:00,263  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T02:34:00,263  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=655, isOriginal=false, fileLength=655, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T02:34:00,264  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T02:34:00,264  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-24T02:34:00,265  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T02:34:00,265  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with {include: [true, true, false], offset: 0, length: 655, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T02:34:00,265  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T02:34:00,265  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T02:34:00,270  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T02:34:00,270  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T02:34:00,270  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T02:34:00,270  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T02:34:00,270  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T02:34:00,270  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T02:34:00,270  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T02:34:00,271  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T02:34:00,272  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T02:34:00,272  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T02:34:00,272  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>>
2024-04-24T02:34:00,272  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T02:34:00,272  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T02:34:00,272  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T02:34:00,273 ERROR [LocalJobRunner Map Task Executor #0] mr.ExecMapper: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row
	at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:573)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:184)
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1073)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:307)
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:888)
	at org.apache.hadoop.hive.ql.exec.SelectOperator.process(SelectOperator.java:94)
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:888)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:173)
	at org.apache.hadoop.hive.ql.exec.MapOperator$MapOpCtx.forward(MapOperator.java:154)
	at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:552)
	... 11 more

2024-04-24T02:34:00,273  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T02:34:00,273  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 0. abort - true
2024-04-24T02:34:00,273  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:0, 
2024-04-24T02:34:00,273  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T02:34:00,273  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:34:00,274  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T02:34:00,274  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:34:00,274  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T02:34:00,274  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 0. abort - true
2024-04-24T02:34:00,274  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T02:34:00,274  INFO [Thread-6608] mapred.LocalJobRunner: map task executor complete.
2024-04-24T02:34:00,274  WARN [Thread-6608] mapred.LocalJobRunner: job_local789738945_0079
java.lang.Exception: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row
	at org.apache.hadoop.mapred.LocalJobRunner$Job.runTasks(LocalJobRunner.java:492) ~[hadoop-mapreduce-client-common-3.1.0.jar:?]
	at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:552) [hadoop-mapreduce-client-common-3.1.0.jar:?]
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:157) ~[classes/:?]
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37) ~[classes/:?]
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271) ~[hadoop-mapreduce-client-common-3.1.0.jar:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row
	at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:573) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148) ~[classes/:?]
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37) ~[classes/:?]
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271) ~[hadoop-mapreduce-client-common-3.1.0.jar:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
Caused by: org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:184) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1073) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:307) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:888) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.SelectOperator.process(SelectOperator.java:94) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:888) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:173) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MapOperator$MapOpCtx.forward(MapOperator.java:154) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:552) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148) ~[classes/:?]
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37) ~[classes/:?]
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271) ~[hadoop-mapreduce-client-common-3.1.0.jar:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-24T02:34:01,236  WARN [main] mapreduce.Counters: Group org.apache.hadoop.mapred.Task$Counter is deprecated. Use org.apache.hadoop.mapreduce.TaskCounter instead
2024-04-24 02:34:01,236 Stage-1 map = 0%,  reduce = 0%
2024-04-24T02:34:01,237  INFO [main] exec.Task: 2024-04-24 02:34:01,236 Stage-1 map = 0%,  reduce = 0%
2024-04-24T02:34:01,237  WARN [main] mapreduce.Counters: Group org.apache.hadoop.mapred.Task$Counter is deprecated. Use org.apache.hadoop.mapreduce.TaskCounter instead
Ended Job = job_local789738945_0079 with errors
2024-04-24T02:34:01,237 ERROR [main] exec.Task: Ended Job = job_local789738945_0079 with errors
Error during job, obtaining debugging information...
2024-04-24T02:34:01,241 ERROR [Thread-6615] exec.Task: Error during job, obtaining debugging information...
2024-04-24T02:34:01,243  INFO [main] FileOperations: Deleting file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl/_tmp.delta_0000003_0000003_0000 on failure
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
2024-04-24T02:34:01,243 ERROR [main] ql.Driver: FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
2024-04-24T02:34:01,243  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:01,243  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T02:34:01,244  INFO [main] ql.Driver: MapReduce Jobs Launched: 
2024-04-24T02:34:01,244  WARN [main] mapreduce.Counters: Group FileSystemCounters is deprecated. Use org.apache.hadoop.mapreduce.FileSystemCounter instead
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 FAIL
2024-04-24T02:34:01,244  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 FAIL
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:34:01,244  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T02:34:01,244  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 1.301 seconds
2024-04-24T02:34:01,244  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,246  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:01,253  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:34:01,253  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-59_746_4675719956266327742-1
2024-04-24T02:34:01,254  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-59_746_4675719956266327742-1 on fs with scheme file
2024-04-24T02:34:01,254  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-59_736_1433995311429976942-1
2024-04-24T02:34:01,254  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/641f7f6f-7e79-4565-a763-e4ba68314f6c/hive_2024-04-24_02-33-59_736_1433995311429976942-1 on fs with scheme file
2024-04-24T02:34:01,254  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists acidTbl
2024-04-24T02:34:01,257  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-24T02:34:01,257  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:34:01,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:01,264  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,264  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:01,264  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:01,264  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:01,264  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=7, flushCache_()=0}
2024-04-24T02:34:01,264  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.01 seconds
2024-04-24T02:34:01,265  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,265  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,279  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:34:01,279  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:01,279  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists acidTbl
2024-04-24T02:34:01,279  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:01,280  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:01,285  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,286  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:01,291  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:01,387  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:01,387  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=101, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=6}
2024-04-24T02:34:01,387  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.108 seconds
2024-04-24T02:34:01,387  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,391  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:34:01,397  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:01,399  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:34:01,399  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:34:01,399  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists acidTblPart
2024-04-24T02:34:01,401  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-24T02:34:01,402  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:34:01,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:01,418  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,418  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:01,418  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:01,418  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:01,418  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=14}
2024-04-24T02:34:01,418  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.019 seconds
2024-04-24T02:34:01,418  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,419  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,436  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:34:01,436  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:01,436  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists acidTblPart
2024-04-24T02:34:01,437  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:01,437  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:01,443  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,443  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:01,449  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:01,486  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:01,486  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=43, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T02:34:01,486  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.05 seconds
2024-04-24T02:34:01,486  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,490  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:34:01,496  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:01,496  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:34:01,497  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:34:01,497  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists acidTbl2
2024-04-24T02:34:01,499  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-24T02:34:01,499  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:34:01,500  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:01,500  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:01,500  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:01,500  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:34:01,500  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.003 seconds
2024-04-24T02:34:01,500  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,501  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:34:01,501  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists acidTbl2
2024-04-24T02:34:01,501  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:01,501  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:34:01,501  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:01,502  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:01,502  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.0 seconds
2024-04-24T02:34:01,502  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,507  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:34:01,513  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:01,513  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:34:01,513  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:34:01,514  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists nonAcidOrcTbl
2024-04-24T02:34:01,516  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-24T02:34:01,516  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:34:01,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:01,536  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,536  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:01,536  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:01,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:01,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=20, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:01,537  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.022 seconds
2024-04-24T02:34:01,537  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,537  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,551  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T02:34:01,551  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:01,551  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists nonAcidOrcTbl
2024-04-24T02:34:01,551  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:01,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:01,561  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,562  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:01,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:01,641  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:01,641  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=80, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:01,642  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.09 seconds
2024-04-24T02:34:01,642  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,646  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:34:01,652  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:01,652  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:34:01,652  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:01,652  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:01,654  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-24T02:34:01,654  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T02:34:01,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:01,663  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,663  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:01,663  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:01,663  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:01,663  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=1, getTable_(GetTableRequest)=8}
2024-04-24T02:34:01,663  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.011 seconds
2024-04-24T02:34:01,664  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,664  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,678  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T02:34:01,678  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:01,678  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:01,678  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:01,678  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:01,686  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:01,694  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:01,727  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:01,728  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=41, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:01,728  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.049 seconds
2024-04-24T02:34:01,728  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,732  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T02:34:01,739  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:01,740  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T02:34:01,740  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:34:01,740  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists nonAcidNonBucket
2024-04-24T02:34:01,742  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-24T02:34:01,743  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T02:34:01,743  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:01,751  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,751  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:01,751  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:01,751  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:01,751  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, getTable_(GetTableRequest)=8, getValidTxns_(long)=0}
2024-04-24T02:34:01,752  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.011 seconds
2024-04-24T02:34:01,752  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,752  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,766  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T02:34:01,766  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:01,767  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e): drop table if exists nonAcidNonBucket
2024-04-24T02:34:01,767  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:01,767  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:01,775  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,776  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:01,784  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:01,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:01,814  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:01,815  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=39, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:01,815  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e); Time taken: 0.047 seconds
2024-04-24T02:34:01,815  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023356_c7d1f2e3-ce9c-46f6-b1bd-d1b80a86237e
2024-04-24T02:34:01,819  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T02:34:01,826  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:01,826  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T02:34:01,827  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testInsertOverwrite" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="10.506"/>
  <testcase name="testMergeNegative" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.041"/>
  <testcase name="testParallelInsertStats" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="9.908"/>
  <testcase name="testDeleteIn" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.371">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where a IN (SELECT A.a from acidTbl  A) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:929)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T02:34:23,342  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T02:34:23,344  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = f3a64e50-0087-4249-86e7-d6ac7b7e165a
2024-04-24T02:34:23,346  INFO [main] SessionState: Hive Session ID = f3a64e50-0087-4249-86e7-d6ac7b7e165a
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:34:23,347  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T02:34:23,352  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/f3a64e50-0087-4249-86e7-d6ac7b7e165a
2024-04-24T02:34:23,354  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/f3a64e50-0087-4249-86e7-d6ac7b7e165a
2024-04-24T02:34:23,357  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/f3a64e50-0087-4249-86e7-d6ac7b7e165a/_tmp_space.db
2024-04-24T02:34:23,357  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=f3a64e50-0087-4249-86e7-d6ac7b7e165a, clientType=HIVECLI]
2024-04-24T02:34:23,357  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:34:23,357  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_db7c5d51-5b62-4cbc-b79e-5e03f26cd3b1): drop table if exists acidTbl
2024-04-24T02:34:23,364  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T02:34:23,364  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T02:34:23,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:23,369  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,369  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,369  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,369  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=8, openTxn_(String, TxnType)=6}
2024-04-24T02:34:23,370  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_db7c5d51-5b62-4cbc-b79e-5e03f26cd3b1); Time taken: 0.012 seconds
2024-04-24T02:34:23,370  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424023423_db7c5d51-5b62-4cbc-b79e-5e03f26cd3b1
2024-04-24T02:34:23,370  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:34:23,370  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_db7c5d51-5b62-4cbc-b79e-5e03f26cd3b1): drop table if exists acidTbl
2024-04-24T02:34:23,370  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:23,373  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,373  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:23,373  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_db7c5d51-5b62-4cbc-b79e-5e03f26cd3b1); Time taken: 0.003 seconds
2024-04-24T02:34:23,373  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_db7c5d51-5b62-4cbc-b79e-5e03f26cd3b1
2024-04-24T02:34:23,378  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T02:34:23,383  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,385  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T02:34:23,385  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:34:23,385  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_c9b516a0-e43c-406e-9b66-e7a58e8d83ab): drop table if exists acidTblPart
2024-04-24T02:34:23,387  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T02:34:23,387  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T02:34:23,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:23,390  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,390  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,390  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,390  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=12}
2024-04-24T02:34:23,391  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_c9b516a0-e43c-406e-9b66-e7a58e8d83ab); Time taken: 0.005 seconds
2024-04-24T02:34:23,391  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424023423_c9b516a0-e43c-406e-9b66-e7a58e8d83ab
2024-04-24T02:34:23,391  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:34:23,391  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_c9b516a0-e43c-406e-9b66-e7a58e8d83ab): drop table if exists acidTblPart
2024-04-24T02:34:23,391  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,391  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:23,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,395  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:23,395  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_c9b516a0-e43c-406e-9b66-e7a58e8d83ab); Time taken: 0.004 seconds
2024-04-24T02:34:23,395  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_c9b516a0-e43c-406e-9b66-e7a58e8d83ab
2024-04-24T02:34:23,399  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T02:34:23,404  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,404  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T02:34:23,404  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:34:23,405  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_a2d79e60-c2f8-487c-80de-9bf1ff92bf74): drop table if exists acidTbl2
2024-04-24T02:34:23,406  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T02:34:23,406  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T02:34:23,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:34:23,410  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,410  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,410  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,410  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T02:34:23,410  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_a2d79e60-c2f8-487c-80de-9bf1ff92bf74); Time taken: 0.005 seconds
2024-04-24T02:34:23,410  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424023423_a2d79e60-c2f8-487c-80de-9bf1ff92bf74
2024-04-24T02:34:23,410  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:34:23,410  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_a2d79e60-c2f8-487c-80de-9bf1ff92bf74): drop table if exists acidTbl2
2024-04-24T02:34:23,410  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,411  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T02:34:23,413  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,414  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:23,414  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_a2d79e60-c2f8-487c-80de-9bf1ff92bf74); Time taken: 0.003 seconds
2024-04-24T02:34:23,414  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_a2d79e60-c2f8-487c-80de-9bf1ff92bf74
2024-04-24T02:34:23,418  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T02:34:23,423  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,423  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T02:34:23,423  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:34:23,423  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_32754005-567a-44b0-b021-6c08bf570aec): drop table if exists nonAcidOrcTbl
2024-04-24T02:34:23,425  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T02:34:23,425  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T02:34:23,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:23,428  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,428  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,428  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,429  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=1, openTxn_(String, TxnType)=1}
2024-04-24T02:34:23,429  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_32754005-567a-44b0-b021-6c08bf570aec); Time taken: 0.005 seconds
2024-04-24T02:34:23,429  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424023423_32754005-567a-44b0-b021-6c08bf570aec
2024-04-24T02:34:23,429  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:34:23,429  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_32754005-567a-44b0-b021-6c08bf570aec): drop table if exists nonAcidOrcTbl
2024-04-24T02:34:23,429  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,429  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:23,432  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,432  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:23,432  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_32754005-567a-44b0-b021-6c08bf570aec); Time taken: 0.003 seconds
2024-04-24T02:34:23,432  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_32754005-567a-44b0-b021-6c08bf570aec
2024-04-24T02:34:23,437  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T02:34:23,441  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,441  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T02:34:23,442  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:23,442  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_5c5cc40f-7d23-4381-99d5-ca3fa7441d65): drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:23,444  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T02:34:23,444  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T02:34:23,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:23,447  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,447  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,447  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,447  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T02:34:23,447  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_5c5cc40f-7d23-4381-99d5-ca3fa7441d65); Time taken: 0.005 seconds
2024-04-24T02:34:23,447  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424023423_5c5cc40f-7d23-4381-99d5-ca3fa7441d65
2024-04-24T02:34:23,447  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:34:23,448  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_5c5cc40f-7d23-4381-99d5-ca3fa7441d65): drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:23,448  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:23,451  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,451  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:23,451  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_5c5cc40f-7d23-4381-99d5-ca3fa7441d65); Time taken: 0.003 seconds
2024-04-24T02:34:23,451  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_5c5cc40f-7d23-4381-99d5-ca3fa7441d65
2024-04-24T02:34:23,456  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T02:34:23,461  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,461  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T02:34:23,461  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:34:23,461  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_6c0f5219-8955-4673-9494-a0f79684fb0f): drop table if exists nonAcidNonBucket
2024-04-24T02:34:23,463  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T02:34:23,463  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T02:34:23,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:23,466  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,467  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,467  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,467  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=1}
2024-04-24T02:34:23,467  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_6c0f5219-8955-4673-9494-a0f79684fb0f); Time taken: 0.006 seconds
2024-04-24T02:34:23,467  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424023423_6c0f5219-8955-4673-9494-a0f79684fb0f
2024-04-24T02:34:23,467  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:34:23,467  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_6c0f5219-8955-4673-9494-a0f79684fb0f): drop table if exists nonAcidNonBucket
2024-04-24T02:34:23,467  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,467  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:23,470  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,470  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:23,470  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_6c0f5219-8955-4673-9494-a0f79684fb0f); Time taken: 0.003 seconds
2024-04-24T02:34:23,470  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_6c0f5219-8955-4673-9494-a0f79684fb0f
2024-04-24T02:34:23,475  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T02:34:23,479  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,479  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T02:34:23,480  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,480  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_54228d99-f94b-4e5f-86a2-b16330d46b78): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,482  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T02:34:23,482  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T02:34:23,482  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:34:23,482  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:34:23,487  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T02:34:23,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:34:23,488  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:34:23,488  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,489  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,489  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,489  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getDatabase_(String)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T02:34:23,489  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_54228d99-f94b-4e5f-86a2-b16330d46b78); Time taken: 0.009 seconds
2024-04-24T02:34:23,489  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424023423_54228d99-f94b-4e5f-86a2-b16330d46b78
2024-04-24T02:34:23,489  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023423_54228d99-f94b-4e5f-86a2-b16330d46b78
2024-04-24T02:34:23,504  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023423_54228d99-f94b-4e5f-86a2-b16330d46b78 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T02:34:23,504  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:34:23,505  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_54228d99-f94b-4e5f-86a2-b16330d46b78): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,505  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713951263, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=true, numFiles=0, totalSize=0, numRows=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:34:23,511  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtbl
2024-04-24T02:34:23,541  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,541  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=36}
2024-04-24T02:34:23,542  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_54228d99-f94b-4e5f-86a2-b16330d46b78); Time taken: 0.036 seconds
2024-04-24T02:34:23,542  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_54228d99-f94b-4e5f-86a2-b16330d46b78
2024-04-24T02:34:23,545  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T02:34:23,550  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,550  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T02:34:23,550  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,550  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_c5dc4a07-888c-4679-91d1-e644819c326e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,552  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T02:34:23,553  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T02:34:23,553  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:34:23,553  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:34:23,555  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T02:34:23,556  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:34:23,557  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:34:23,557  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,557  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=8, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getDatabase_(String)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2}
2024-04-24T02:34:23,558  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_c5dc4a07-888c-4679-91d1-e644819c326e); Time taken: 0.007 seconds
2024-04-24T02:34:23,558  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424023423_c5dc4a07-888c-4679-91d1-e644819c326e
2024-04-24T02:34:23,558  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023423_c5dc4a07-888c-4679-91d1-e644819c326e
2024-04-24T02:34:23,570  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023423_c5dc4a07-888c-4679-91d1-e644819c326e LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T02:34:23,570  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:34:23,571  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_c5dc4a07-888c-4679-91d1-e644819c326e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,571  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713951263, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T02:34:23,577  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/acidtblpart
2024-04-24T02:34:23,594  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,594  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:23,594  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_c5dc4a07-888c-4679-91d1-e644819c326e); Time taken: 0.023 seconds
2024-04-24T02:34:23,594  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_c5dc4a07-888c-4679-91d1-e644819c326e
2024-04-24T02:34:23,598  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T02:34:23,602  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,602  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T02:34:23,603  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,603  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_57ab267d-da4e-4708-b82a-bf22d6af2f99): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,605  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T02:34:23,605  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T02:34:23,605  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:34:23,606  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:34:23,607  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T02:34:23,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:34:23,609  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:34:23,609  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,609  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,609  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,610  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, openTxn_(String, TxnType)=1, flushCache_()=0, getValidWriteIds_(List, String)=1, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1}
2024-04-24T02:34:23,610  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_57ab267d-da4e-4708-b82a-bf22d6af2f99); Time taken: 0.006 seconds
2024-04-24T02:34:23,610  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424023423_57ab267d-da4e-4708-b82a-bf22d6af2f99
2024-04-24T02:34:23,610  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023423_57ab267d-da4e-4708-b82a-bf22d6af2f99
2024-04-24T02:34:23,622  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023423_57ab267d-da4e-4708-b82a-bf22d6af2f99 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T02:34:23,622  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:34:23,622  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_57ab267d-da4e-4708-b82a-bf22d6af2f99): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,623  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,623  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713951263, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, bucketing_version=2, numFiles=0, rawDataSize=0, transactional=false, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:34:23,629  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl
2024-04-24T02:34:23,643  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,643  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-24T02:34:23,644  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_57ab267d-da4e-4708-b82a-bf22d6af2f99); Time taken: 0.021 seconds
2024-04-24T02:34:23,644  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_57ab267d-da4e-4708-b82a-bf22d6af2f99
2024-04-24T02:34:23,647  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T02:34:23,652  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,652  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T02:34:23,653  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,653  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_a93e33bf-fe93-450e-94eb-3d758878fec7): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,655  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T02:34:23,655  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T02:34:23,655  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:34:23,655  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:34:23,657  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T02:34:23,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:34:23,659  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:34:23,659  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,659  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,659  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,659  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=8, getDatabase_(String)=2}
2024-04-24T02:34:23,659  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_a93e33bf-fe93-450e-94eb-3d758878fec7); Time taken: 0.006 seconds
2024-04-24T02:34:23,660  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424023423_a93e33bf-fe93-450e-94eb-3d758878fec7
2024-04-24T02:34:23,660  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023423_a93e33bf-fe93-450e-94eb-3d758878fec7
2024-04-24T02:34:23,672  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023423_a93e33bf-fe93-450e-94eb-3d758878fec7 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T02:34:23,672  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:34:23,672  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_a93e33bf-fe93-450e-94eb-3d758878fec7): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,672  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,673  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713951263, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, bucketing_version=2, transactional=false, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:34:23,679  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidorctbl2
2024-04-24T02:34:23,692  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,692  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:23,692  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_a93e33bf-fe93-450e-94eb-3d758878fec7); Time taken: 0.02 seconds
2024-04-24T02:34:23,692  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_a93e33bf-fe93-450e-94eb-3d758878fec7
2024-04-24T02:34:23,696  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T02:34:23,701  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,701  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T02:34:23,702  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,702  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_2567b5d2-e3a9-4bff-af08-ef8ff2619984): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,704  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T02:34:23,704  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T02:34:23,705  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:34:23,705  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:34:23,707  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T02:34:23,707  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:34:23,708  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:34:23,708  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,708  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,708  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,708  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=1, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:34:23,709  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_2567b5d2-e3a9-4bff-af08-ef8ff2619984); Time taken: 0.006 seconds
2024-04-24T02:34:23,709  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424023423_2567b5d2-e3a9-4bff-af08-ef8ff2619984
2024-04-24T02:34:23,709  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023423_2567b5d2-e3a9-4bff-af08-ef8ff2619984
2024-04-24T02:34:23,722  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023423_2567b5d2-e3a9-4bff-af08-ef8ff2619984 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T02:34:23,722  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:34:23,722  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_2567b5d2-e3a9-4bff-af08-ef8ff2619984): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T02:34:23,722  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,723  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/f3a64e50-0087-4249-86e7-d6ac7b7e165a/_tmp_space.db/939e66d0-3a70-41f0-a247-79c9224b8790
2024-04-24T02:34:23,726  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,726  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-24T02:34:23,726  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_2567b5d2-e3a9-4bff-af08-ef8ff2619984); Time taken: 0.004 seconds
2024-04-24T02:34:23,726  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_2567b5d2-e3a9-4bff-af08-ef8ff2619984
2024-04-24T02:34:23,729  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T02:34:23,734  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,734  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T02:34:23,735  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,735  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_19aec8db-2e4e-459f-a747-d21eb56ed8b3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,737  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T02:34:23,737  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T02:34:23,737  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T02:34:23,737  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T02:34:23,739  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T02:34:23,740  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T02:34:23,741  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T02:34:23,741  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:23,741  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:23,741  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:23,741  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, getDatabase_(String)=2}
2024-04-24T02:34:23,741  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_19aec8db-2e4e-459f-a747-d21eb56ed8b3); Time taken: 0.006 seconds
2024-04-24T02:34:23,742  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424023423_19aec8db-2e4e-459f-a747-d21eb56ed8b3
2024-04-24T02:34:23,742  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023423_19aec8db-2e4e-459f-a747-d21eb56ed8b3
2024-04-24T02:34:23,754  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023423_19aec8db-2e4e-459f-a747-d21eb56ed8b3 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T02:34:23,754  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T02:34:23,754  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023423_19aec8db-2e4e-459f-a747-d21eb56ed8b3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T02:34:23,754  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:23,755  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713951263, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, totalSize=0, numRows=0, rawDataSize=0, numFiles=0, transactional=false, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T02:34:23,761  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713951035032/warehouse/nonacidnonbucket
2024-04-24T02:34:23,774  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:23,775  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=1}
2024-04-24T02:34:23,775  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023423_19aec8db-2e4e-459f-a747-d21eb56ed8b3); Time taken: 0.02 seconds
2024-04-24T02:34:23,775  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023423_19aec8db-2e4e-459f-a747-d21eb56ed8b3
2024-04-24T02:34:23,778  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T02:34:23,783  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:23,783  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T02:34:23,783  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where a IN (SELECT A.a from acidTbl  A)
2024-04-24T02:34:23,784  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023423_b252e8d9-cf14-4fae-b1b8-8eccefbb0995): delete from acidTbl where a IN (SELECT A.a from acidTbl  A)
2024-04-24T02:34:23,786  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T02:34:23,786  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T02:34:23,786  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-24T02:34:23,787  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:23,803  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:23,803  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where a IN (SELECT A.a from acidTbl  A)> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-24T02:34:23,804  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-24T02:34:23,808  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-24T02:34:23,808  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:34:23,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:34:23,815  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:23,816  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:34:23,816  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:34:23,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:23,822  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:23,822  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-24T02:34:23,822  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-24T02:34:23,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:34:23,863  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:34:23,863  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:34:23,863  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:34:23,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-24T02:34:23,965  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:34:23,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:34:23,975  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:23,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-24T02:34:23,984  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:23,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-24T02:34:23,994  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-24T02:34:23,994  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-24T02:34:23,995  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-24T02:34:23,995  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-24T02:34:23,995  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:34:24,102  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-24T02:34:24,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:24,109  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,112 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:929) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T02:34:24,113 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-24T02:34:24,113  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-24T02:34:24,114 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:int,rowid:bigint,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:929)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T02:34:24,114  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:24,114  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getTableColumnStatistics_(String, String, List, String)=29, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=35, getValidWriteIds_(List, String)=6, getAllTableConstraints_(AllTableConstraintsRequest)=30, commitTxn_(CommitTxnRequest)=8, flushCache_()=0}
2024-04-24T02:34:24,114  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023423_b252e8d9-cf14-4fae-b1b8-8eccefbb0995); Time taken: 0.33 seconds
2024-04-24T02:34:24,114  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T02:34:24,117  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:24,122  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T02:34:24,123  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023424_c4a2257e-1929-4836-8c61-0bbc4d0ccac3): drop table if exists acidTbl
2024-04-24T02:34:24,124  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T02:34:24,124  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T02:34:24,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:24,131  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,131  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:24,131  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:24,131  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:24,131  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, getValidTxns_(long)=0, rollbackTxn_(long)=8, flushCache_()=0, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:24,131  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023424_c4a2257e-1929-4836-8c61-0bbc4d0ccac3); Time taken: 0.009 seconds
2024-04-24T02:34:24,132  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424023424_c4a2257e-1929-4836-8c61-0bbc4d0ccac3
2024-04-24T02:34:24,132  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023424_c4a2257e-1929-4836-8c61-0bbc4d0ccac3
2024-04-24T02:34:24,147  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023424_c4a2257e-1929-4836-8c61-0bbc4d0ccac3 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T02:34:24,147  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:24,147  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023424_c4a2257e-1929-4836-8c61-0bbc4d0ccac3): drop table if exists acidTbl
2024-04-24T02:34:24,147  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:24,147  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:24,154  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:24,160  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,160  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T02:34:24,251  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:24,251  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=97, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:24,251  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023424_c4a2257e-1929-4836-8c61-0bbc4d0ccac3); Time taken: 0.104 seconds
2024-04-24T02:34:24,251  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023424_c4a2257e-1929-4836-8c61-0bbc4d0ccac3
2024-04-24T02:34:24,254  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T02:34:24,259  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:24,261  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T02:34:24,261  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T02:34:24,261  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023424_9f7320cf-6bf2-4a2f-816f-9757e66b1a0c): drop table if exists acidTblPart
2024-04-24T02:34:24,263  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T02:34:24,263  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T02:34:24,264  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:24,270  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,270  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:24,270  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:24,270  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:24,270  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=7, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:24,270  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023424_9f7320cf-6bf2-4a2f-816f-9757e66b1a0c); Time taken: 0.009 seconds
2024-04-24T02:34:24,271  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424023424_9f7320cf-6bf2-4a2f-816f-9757e66b1a0c
2024-04-24T02:34:24,271  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023424_9f7320cf-6bf2-4a2f-816f-9757e66b1a0c
2024-04-24T02:34:24,284  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023424_9f7320cf-6bf2-4a2f-816f-9757e66b1a0c LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T02:34:24,284  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:24,284  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023424_9f7320cf-6bf2-4a2f-816f-9757e66b1a0c): drop table if exists acidTblPart
2024-04-24T02:34:24,284  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:24,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:24,290  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,291  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:24,297  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T02:34:24,338  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:24,338  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=47}
2024-04-24T02:34:24,338  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023424_9f7320cf-6bf2-4a2f-816f-9757e66b1a0c); Time taken: 0.054 seconds
2024-04-24T02:34:24,338  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023424_9f7320cf-6bf2-4a2f-816f-9757e66b1a0c
2024-04-24T02:34:24,342  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T02:34:24,348  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:24,348  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T02:34:24,348  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T02:34:24,349  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023424_cd3fb2b8-1ce3-41da-9f9b-6f251e2d845d): drop table if exists acidTbl2
2024-04-24T02:34:24,351  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T02:34:24,351  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T02:34:24,352  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:24,352  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:24,352  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:24,352  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T02:34:24,352  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023424_cd3fb2b8-1ce3-41da-9f9b-6f251e2d845d); Time taken: 0.003 seconds
2024-04-24T02:34:24,352  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424023424_cd3fb2b8-1ce3-41da-9f9b-6f251e2d845d
2024-04-24T02:34:24,352  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T02:34:24,352  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023424_cd3fb2b8-1ce3-41da-9f9b-6f251e2d845d): drop table if exists acidTbl2
2024-04-24T02:34:24,353  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:24,353  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T02:34:24,353  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:24,353  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:24,353  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023424_cd3fb2b8-1ce3-41da-9f9b-6f251e2d845d); Time taken: 0.001 seconds
2024-04-24T02:34:24,353  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023424_cd3fb2b8-1ce3-41da-9f9b-6f251e2d845d
2024-04-24T02:34:24,358  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T02:34:24,363  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:24,364  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T02:34:24,364  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T02:34:24,364  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023424_923aa598-96b3-41f5-ae62-06615a13607b): drop table if exists nonAcidOrcTbl
2024-04-24T02:34:24,366  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 2
2024-04-24T02:34:24,366  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T02:34:24,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:24,386  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,386  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:24,386  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:24,386  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:24,386  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=1, flushCache_()=0, getTable_(GetTableRequest)=19}
2024-04-24T02:34:24,386  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023424_923aa598-96b3-41f5-ae62-06615a13607b); Time taken: 0.022 seconds
2024-04-24T02:34:24,386  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424023424_923aa598-96b3-41f5-ae62-06615a13607b
2024-04-24T02:34:24,387  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023424_923aa598-96b3-41f5-ae62-06615a13607b
2024-04-24T02:34:24,401  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023424_923aa598-96b3-41f5-ae62-06615a13607b LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T02:34:24,401  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:24,401  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023424_923aa598-96b3-41f5-ae62-06615a13607b): drop table if exists nonAcidOrcTbl
2024-04-24T02:34:24,401  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:24,401  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:24,409  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,409  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:24,417  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,417  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T02:34:24,494  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:24,494  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=85, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:24,494  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023424_923aa598-96b3-41f5-ae62-06615a13607b); Time taken: 0.093 seconds
2024-04-24T02:34:24,494  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023424_923aa598-96b3-41f5-ae62-06615a13607b
2024-04-24T02:34:24,497  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T02:34:24,502  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:24,502  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T02:34:24,502  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:24,502  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023424_8f0a146f-9b18-4fcb-880f-6df3c5a5ca7d): drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:24,504  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 8
2024-04-24T02:34:24,504  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T02:34:24,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:24,513  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,513  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:24,513  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:24,513  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:24,513  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=8}
2024-04-24T02:34:24,513  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023424_8f0a146f-9b18-4fcb-880f-6df3c5a5ca7d); Time taken: 0.011 seconds
2024-04-24T02:34:24,513  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424023424_8f0a146f-9b18-4fcb-880f-6df3c5a5ca7d
2024-04-24T02:34:24,514  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023424_8f0a146f-9b18-4fcb-880f-6df3c5a5ca7d
2024-04-24T02:34:24,525  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023424_8f0a146f-9b18-4fcb-880f-6df3c5a5ca7d LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T02:34:24,525  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:24,525  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023424_8f0a146f-9b18-4fcb-880f-6df3c5a5ca7d): drop table if exists nonAcidOrcTbl2
2024-04-24T02:34:24,525  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:24,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:24,533  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:24,541  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,541  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T02:34:24,570  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:24,570  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=37, isCompatibleWith_(Configuration)=0}
2024-04-24T02:34:24,570  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023424_8f0a146f-9b18-4fcb-880f-6df3c5a5ca7d); Time taken: 0.045 seconds
2024-04-24T02:34:24,570  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023424_8f0a146f-9b18-4fcb-880f-6df3c5a5ca7d
2024-04-24T02:34:24,573  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T02:34:24,577  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:24,578  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T02:34:24,578  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T02:34:24,578  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424023424_528e8215-97b3-4c51-a6fa-604d08c2dda4): drop table if exists nonAcidNonBucket
2024-04-24T02:34:24,580  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 9
2024-04-24T02:34:24,580  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T02:34:24,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:24,588  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,588  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T02:34:24,588  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T02:34:24,588  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T02:34:24,589  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=8, flushCache_()=0}
2024-04-24T02:34:24,589  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424023424_528e8215-97b3-4c51-a6fa-604d08c2dda4); Time taken: 0.01 seconds
2024-04-24T02:34:24,589  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424023424_528e8215-97b3-4c51-a6fa-604d08c2dda4
2024-04-24T02:34:24,589  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424023424_528e8215-97b3-4c51-a6fa-604d08c2dda4
2024-04-24T02:34:24,601  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424023424_528e8215-97b3-4c51-a6fa-604d08c2dda4 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T02:34:24,601  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T02:34:24,601  INFO [main] ql.Driver: Executing command(queryId=alex_20240424023424_528e8215-97b3-4c51-a6fa-604d08c2dda4): drop table if exists nonAcidNonBucket
2024-04-24T02:34:24,601  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T02:34:24,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:24,610  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:24,618  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T02:34:24,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T02:34:24,648  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T02:34:24,649  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=38, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T02:34:24,649  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424023424_528e8215-97b3-4c51-a6fa-604d08c2dda4); Time taken: 0.047 seconds
2024-04-24T02:34:24,649  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424023424_528e8215-97b3-4c51-a6fa-604d08c2dda4
2024-04-24T02:34:24,652  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T02:34:24,657  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T02:34:24,657  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T02:34:24,657  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMmExim" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="9.863"/>
  <testcase name="testExplicitRollback" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.016"/>
  <testcase name="testNonAcidInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="0">
    <skipped message="not needed but useful for testing"/>
  </testcase>
</testsuite>