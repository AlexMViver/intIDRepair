-------------------------------------------------------------------------------
Test set: org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool
-------------------------------------------------------------------------------
Tests run: 6, Failures: 2, Errors: 3, Skipped: 0, Time elapsed: 61.82 s <<< FAILURE! - in org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool
org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testUpgradeExternalTableNoReadPermissionForTable  Time elapsed: 10.717 s  <<< FAILURE!
java.lang.AssertionError
	at org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testUpgradeExternalTableNoReadPermissionForTable(TestPreUpgradeTool.java:338)

org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testOnlyFilteredTablesAreUpgradedWhenRegexIsGiven  Time elapsed: 3.32 s  <<< ERROR!
java.lang.RuntimeException: update TInclude set a = 1 where b = 2 failed: (40000,FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<transactionid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,transactionid:bigint,bucketid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  ,42000No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<transactionid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,transactionid:bigint,bucketid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.runStatementOnDriver(TestPreUpgradeTool.java:422)
	at org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testOnlyFilteredTablesAreUpgradedWhenRegexIsGiven(TestPreUpgradeTool.java:228)

org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testUpgrade  Time elapsed: 3.264 s  <<< ERROR!
java.lang.RuntimeException: update TAcid set a = 1 where b = 2 failed: (40000,FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<transactionid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,transactionid:bigint,bucketid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  ,42000No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<transactionid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,transactionid:bigint,bucketid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.runStatementOnDriver(TestPreUpgradeTool.java:422)
	at org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testUpgrade(TestPreUpgradeTool.java:100)

org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testUpgradeExternalTableNoReadPermissionForDatabase  Time elapsed: 6.64 s  <<< FAILURE!
java.lang.AssertionError
	at org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testUpgradeExternalTableNoReadPermissionForDatabase(TestPreUpgradeTool.java:303)

org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testOnlyFilteredDatabasesAreUpgradedWhenRegexIsGiven  Time elapsed: 2.485 s  <<< ERROR!
java.lang.RuntimeException: update TInclude set a = 1 where b = 2 failed: (40000,FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<transactionid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,transactionid:bigint,bucketid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  ,42000No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<transactionid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,transactionid:bigint,bucketid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.runStatementOnDriver(TestPreUpgradeTool.java:422)
	at org.apache.hadoop.hive.upgrade.acid.TestPreUpgradeTool.testOnlyFilteredDatabasesAreUpgradedWhenRegexIsGiven(TestPreUpgradeTool.java:179)

