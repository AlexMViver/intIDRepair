DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,050996 seconds to load 241 plugins from sun.misc.Launcher$AppClassLoader@7f31245a
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=7f31245a, org.apache.logging.log4j.core.LoggerContext@169e6180]...
DEBUG StatusLogger Reconfiguration started for context[name=7f31245a] at URI null (org.apache.logging.log4j.core.LoggerContext@169e6180) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Missing dependencies for Yaml support, ConfigurationFactory org.apache.logging.log4j.core.config.yaml.YamlConfigurationFactory is inactive
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@5b03b9fe
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@2d52216b
DEBUG StatusLogger Installed 1 script engine
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,003779 seconds to load 0 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 124 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/llap-tez/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/llap-tez/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null, Configuration(HiveLog4j2Test), Replace=null, charset="null", alwaysWriteExceptions="null", disableAnsi="null", noConsoleNoAnsi="null", header="null", footer="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(target="SYSTEM_ERR", follow="null", direct="null", bufferedIo="null", bufferSize="null", immediateFlush="null", ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="console", Configuration(HiveLog4j2Test), Filter=null, ={})
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null, Configuration(HiveLog4j2Test), Replace=null, charset="null", alwaysWriteExceptions="null", disableAnsi="null", noConsoleNoAnsi="null", header="null", footer="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(interval="1", modulate="true", maxRandomDelay="null")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(max="30", min="null", fileIndex="null", compressionLevel="null", ={}, stopCustomActionsOnError="null", tempCompressedFilePattern="null", Configuration(HiveLog4j2Test))
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(fileName="/home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log", filePattern="/home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log.%d{yyyy-MM-dd}", append="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), advertise="null", advertiseURI="null", filePermissions="null", fileOwner="null", fileGroup="null", bufferedIo="null", bufferSize="null", immediateFlush="null", ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="DRFA", Configuration(HiveLog4j2Test), Filter=null, ={})
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log seek to 0
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 2 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T14:43:41.743-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-14:43:41.749, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-14:43:41.749, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@2d52216b initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@2d52216b
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@2d52216b OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@36902638...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@36902638 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@1fde5d22
TRACE StatusLogger Reregistering context (1/1): '7f31245a' org.apache.logging.log4j.core.LoggerContext@169e6180
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=7f31245a] at URI /home/alex/Repositories/hive/llap-tez/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@169e6180) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=7f31245a, org.apache.logging.log4j.core.LoggerContext@169e6180] started OK.
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T14:43:42,427  INFO [Time-limited test] resource.ResourceUtils: Unable to find 'resource-types.xml'.
2024-04-23T14:43:42,771  INFO [Time-limited test] common.TezClassLoader: Created TezClassLoader with parent classloader: sun.misc.Launcher$AppClassLoader@7f31245a, thread: 13, system classloader: sun.misc.Launcher$AppClassLoader@7f31245a
2024-04-23T14:43:42,775  INFO [Time-limited test] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/llap-tez/target/testconf/hive-site.xml
2024-04-23T14:43:42,783  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3,host4, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:42,801  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3,host4
2024-04-23T14:43:42,812  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:42,813  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:42,837  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=4
2024-04-23T14:43:42,837  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:42,837  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,837  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=4
2024-04-23T14:43:42,838  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:42,838  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=4
2024-04-23T14:43:42,838  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host4, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:42,838  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host4, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=4. activeInstances.size=4
2024-04-23T14:43:42,842  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:43:42,845  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,846  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:43:42,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000000_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,848  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,849  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000001_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,849  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,849  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,849  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000002_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,849  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,850  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:43:42,851  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:42,868  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000000_0, priority=1, startTime=0, containerId=null, uniqueId=2, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:42,869  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000000_0; false
2024-04-23T14:43:42,870  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000000_0, true
2024-04-23T14:43:42,871  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host4:0, id=host-host4, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:43:42,871  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000001_0, priority=1, startTime=0, containerId=null, uniqueId=3, localityDelayTimeout=0} on node={host4:0, id=host-host4, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:42,871  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000001_0; false
2024-04-23T14:43:42,872  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000001_0, true
2024-04-23T14:43:42,872  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:43:42,873  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000002_0, priority=1, startTime=0, containerId=null, uniqueId=4, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:42,873  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000002_0; false
2024-04-23T14:43:42,873  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000002_0, true
2024-04-23T14:43:42,873  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,874  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:43:42,885  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:42,886  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:42,886  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:42,886  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:42,886  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:42,886  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:42,886  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:42,886  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:43:42,900  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:43:42,901  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:42,902  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:42,902  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:42,903  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:42,903  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:42,903  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,903  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:42,905  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,905  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000003_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,905  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,905  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000004_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,905  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,905  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000005_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,905  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,906  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:42,906  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000003_0, priority=1, startTime=0, containerId=null, uniqueId=5, localityDelayTimeout=78857758} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:42,906  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000003_0; false
2024-04-23T14:43:42,906  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000003_0, true
2024-04-23T14:43:42,907  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:42,907  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000004_0, priority=1, startTime=0, containerId=null, uniqueId=6, localityDelayTimeout=78857758} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:42,907  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000004_0; false
2024-04-23T14:43:42,907  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000004_0, true
2024-04-23T14:43:42,908  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,912  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:43:42,913  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000005_0, priority=1, startTime=0, containerId=null, uniqueId=7, localityDelayTimeout=78857758} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:42,913  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000005_0; false
2024-04-23T14:43:42,913  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000005_0, true
2024-04-23T14:43:42,913  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,914  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:42,914  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:42,914  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:42,914  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:42,914  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:42,914  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:42,914  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:42,915 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:42,928  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:43:42,929  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:42,929  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:42,930  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=2} with available capacity=2, pendingQueueSize=0, memory=4096
2024-04-23T14:43:42,930  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=2}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:42,930  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,930  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=2} with available capacity=2, pendingQueueSize=0, memory=4096
2024-04-23T14:43:42,930  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=2}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:42,931  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,931  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000006_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,931  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,931  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000007_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,932  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,932  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000008_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,932  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,933  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:42,933  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000006_0, priority=2, startTime=0, containerId=null, uniqueId=8, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:42,933  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000006_0; false
2024-04-23T14:43:42,933  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000006_0, true
2024-04-23T14:43:42,934  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:42,935  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000007_0, priority=2, startTime=0, containerId=null, uniqueId=9, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:42,935  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000007_0; false
2024-04-23T14:43:42,935  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000007_0, true
2024-04-23T14:43:42,936  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,936  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000009_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:42,937  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=2. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:42,937  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,938  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:43:42,939  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000007_0, priority=2, startTime=78847788, containerId=container_11111_0001_01_000005, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=9, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:43:42,940  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:42,940  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000006_0; false
2024-04-23T14:43:42,941  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000006_0, state=ASSIGNED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:43:42,941  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=false, disabled=true} for 2000 milli-seconds. commFailure=false
2024-04-23T14:43:42,948  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,942  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=false, disabled=true}
2024-04-23T14:43:44,943  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,944  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:44,945  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000009_0, priority=1, startTime=0, containerId=null, uniqueId=11, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:44,945  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000009_0; false
2024-04-23T14:43:44,946  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000009_0, true
2024-04-23T14:43:44,949  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:44,949  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:44,950  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:44,950  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:44,950  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:44,950  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:44,950  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:44,950  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:43:44,965  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:43:44,966  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:44,967  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:44,967  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:44,968  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:44,968  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:44,968  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,968  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:44,969  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,969  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000010_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:44,969  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:44,969  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000011_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:44,969  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:44,969  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000012_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:44,969  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:44,970  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:44,970  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000010_0, priority=1, startTime=0, containerId=null, uniqueId=12, localityDelayTimeout=78859822} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:44,970  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000010_0; false
2024-04-23T14:43:44,970  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000010_0, true
2024-04-23T14:43:44,972  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:44,972  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000011_0, priority=1, startTime=0, containerId=null, uniqueId=13, localityDelayTimeout=78859822} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:44,972  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000011_0; false
2024-04-23T14:43:44,972  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000011_0, true
2024-04-23T14:43:44,973  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,973  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.TestLlapTaskSchedulerService: Triggered getTask but the first element is not ready to execute
2024-04-23T14:43:44,974  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000010_0; false
2024-04-23T14:43:44,974  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000010_0, state=ASSIGNED, endReason=null
2024-04-23T14:43:44,975  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:44,975  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000012_0, priority=1, startTime=0, containerId=null, uniqueId=14, localityDelayTimeout=78859822} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:44,975  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000012_0; false
2024-04-23T14:43:44,975  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000012_0, true
2024-04-23T14:43:44,975  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,976  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:44,976  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:44,977  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:44,977  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:44,977  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:44,977  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:44,977  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:44,977 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:44,989  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:44,990  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:44,991  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:44,991  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:44,992  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:44,992  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:44,992  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,992  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:44,992  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:44,992  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:44,993  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,993  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:43:44,993  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000013_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:44,993  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:44,993  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,993  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000014_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:44,993  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:44,994  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:44,994  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000013_0, priority=1, startTime=0, containerId=null, uniqueId=15, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:44,994  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000013_0; false
2024-04-23T14:43:44,994  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:43:44,995  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:44,996  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000014_0, priority=2, startTime=0, containerId=null, uniqueId=16, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:44,996  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000014_0; false
2024-04-23T14:43:44,996  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:43:44,996  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:44,996  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:43:44,996  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:43:44,996  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 2 (internal version -9223372036854775805); the delta to adjust by is 1
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:44,997  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:43:44,998  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:43:44,998  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is -1
2024-04-23T14:43:44,998  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 2 levels
2024-04-23T14:43:44,998  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:43:44,998  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:43:44,998  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:43:44,998  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is 1
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:44,999  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775801); the delta to adjust by is -1
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000013_0 to update - already pending
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Sending update to the same task in response handling attempt_1_0001_0_00_000013_0, false
2024-04-23T14:43:45,000  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775800); the delta to adjust by is 1
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000013_0 to update - already pending
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Sending update to the same task in response handling attempt_1_0001_0_00_000013_0, true
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000013_0; true
2024-04-23T14:43:45,001  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000013_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:45,001  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:43:45,002  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:43:45,002  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:43:45,002  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000014_0; true
2024-04-23T14:43:45,002  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000014_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:45,002  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:43:45,002  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:43:45,003  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:45,003  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:45,003  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:45,003  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:45,003  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:45,003  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:45,003  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:45,003 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:45,023  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=5000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:43:45,023  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:45,024  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:45,024  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:45,024  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:45,024  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:45,024  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:45,025  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:45,025  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:45,025  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000015_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:45,025  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:45,025  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000016_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:45,025  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:45,026  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000017_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:45,026  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:45,026  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:45,026  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000015_0, priority=1, startTime=0, containerId=null, uniqueId=17, localityDelayTimeout=78859878} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:45,027  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000015_0; false
2024-04-23T14:43:45,027  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000015_0, true
2024-04-23T14:43:45,029  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:45,029  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000016_0, priority=1, startTime=0, containerId=null, uniqueId=18, localityDelayTimeout=78859878} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:45,029  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000016_0; false
2024-04-23T14:43:45,030  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000016_0, true
2024-04-23T14:43:45,030  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:45,031  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000015_0; false
2024-04-23T14:43:45,031  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000015_0, state=ASSIGNED, endReason=COMMUNICATION_ERROR
2024-04-23T14:43:45,031  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=true, disabled=true} for 5000 milli-seconds. commFailure=true
2024-04-23T14:43:45,032  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,033  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,032  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,035  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,035  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,035  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,035  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,036  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,036  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:43:47,056  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=20000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=9000} consistentSplits=true
2024-04-23T14:43:47,057  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:47,059  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,059  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,059  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:47,060  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,060  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,060  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:47,060  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,060  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000018_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,060  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,061  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000019_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,061  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,061  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000020_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,061  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,061  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,062  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000018_0, priority=1, startTime=0, containerId=null, uniqueId=20, localityDelayTimeout=78860914} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,062  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000018_0; false
2024-04-23T14:43:47,062  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000018_0, true
2024-04-23T14:43:47,063  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,063  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000019_0, priority=1, startTime=0, containerId=null, uniqueId=21, localityDelayTimeout=78860916} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,063  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000019_0; false
2024-04-23T14:43:47,063  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000019_0, true
2024-04-23T14:43:47,064  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,065  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000018_0; false
2024-04-23T14:43:47,065  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000018_0, state=ASSIGNED, endReason=COMMUNICATION_ERROR
2024-04-23T14:43:47,065  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=true, disabled=true} for 10000 milli-seconds. commFailure=true
2024-04-23T14:43:47,065  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,066  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:43:47,066  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000020_0, priority=1, startTime=0, containerId=null, uniqueId=22, localityDelayTimeout=78860916} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:47,066  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000020_0; false
2024-04-23T14:43:47,066  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000020_0, true
2024-04-23T14:43:47,067  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,067  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,067  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,067  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,067  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,067  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,068  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,068  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:43:47,080  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:43:47,080  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:47,082  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,082  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,082  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:47,082  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,082  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,082  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:47,083  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,083  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000021_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,083  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,083  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000022_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,083  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,083  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000023_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,083  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,084  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,084  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000021_0, priority=1, startTime=0, containerId=null, uniqueId=23, localityDelayTimeout=78861936} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,084  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000021_0; false
2024-04-23T14:43:47,084  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000021_0, true
2024-04-23T14:43:47,085  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,085  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000022_0, priority=1, startTime=0, containerId=null, uniqueId=24, localityDelayTimeout=78861936} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,085  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000022_0; false
2024-04-23T14:43:47,085  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000022_0, true
2024-04-23T14:43:47,086  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,086  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.TestLlapTaskSchedulerService: Triggered getTask but the first element is not ready to execute
2024-04-23T14:43:47,086  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000021_0; false
2024-04-23T14:43:47,086  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000021_0, state=ASSIGNED, endReason=null
2024-04-23T14:43:47,087  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,087  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000023_0, priority=1, startTime=0, containerId=null, uniqueId=25, localityDelayTimeout=78861936} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:47,087  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000023_0; false
2024-04-23T14:43:47,087  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000023_0, true
2024-04-23T14:43:47,088  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,088  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,088  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,088  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,088  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,089  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,089  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,089  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,089 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,100  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=1000} consistentSplits=true
2024-04-23T14:43:47,101  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:43:47,102  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,102  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:47,102  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:43:47,102  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,102  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000024_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,103  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,103  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000025_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,103  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,103  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,103  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,103  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000024_0, priority=1, startTime=0, containerId=null, uniqueId=26, localityDelayTimeout=78852956} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,103  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000024_0; false
2024-04-23T14:43:47,103  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000024_0, true
2024-04-23T14:43:47,105  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,105  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,105  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,105  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,105  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,105  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,105  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,105  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,105 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,118  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:43:47,119  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:47,120  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,120  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,120  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:47,120  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,120  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,120  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:47,121  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,121  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000026_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,121  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,121  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000027_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,121  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,121  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,121  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000026_0, priority=2, startTime=0, containerId=null, uniqueId=28, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,122  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000026_0; false
2024-04-23T14:43:47,122  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000026_0, true
2024-04-23T14:43:47,123  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,123  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000027_0, priority=2, startTime=0, containerId=null, uniqueId=29, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,123  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000027_0; false
2024-04-23T14:43:47,123  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000027_0, true
2024-04-23T14:43:47,123  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,124  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000028_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,124  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=2. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,124  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000029_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,124  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=2. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,125  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,125  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:43:47,126  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000027_0, priority=2, startTime=78851976, containerId=container_11111_0001_01_000005, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=29, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:43:47,127  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,127  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000027_0; false
2024-04-23T14:43:47,127  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000027_0, state=PREEMPTED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:43:47,127  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,128  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000028_0, priority=1, startTime=0, containerId=null, uniqueId=30, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:47,128  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000028_0; false
2024-04-23T14:43:47,128  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000028_0, true
2024-04-23T14:43:47,128  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,129  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000026_0, priority=2, startTime=78851975, containerId=container_11111_0001_01_000003, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=28, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:43:47,129  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,129  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000026_0; false
2024-04-23T14:43:47,129  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000026_0, state=PREEMPTED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:43:47,130  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,130  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000029_0, priority=1, startTime=0, containerId=null, uniqueId=31, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:43:47,130  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000029_0; false
2024-04-23T14:43:47,130  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000029_0, true
2024-04-23T14:43:47,130  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,131  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,131  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,131  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,131  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,131  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,131  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,131  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,131 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,143  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,143  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,144  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,144  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,145  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,145  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,145  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,145  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,145  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,145  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,145  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,146  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000030_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,146  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,146  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,146  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000030_0, priority=1, startTime=0, containerId=null, uniqueId=32, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,146  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000030_0; false
2024-04-23T14:43:47,146  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000030_0, true
2024-04-23T14:43:47,147  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,147  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,147  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,147  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,148  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,148  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,148  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,148  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,148 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,158  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,159  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,160  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,160  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,160  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,160  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,160  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,160  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,160  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,161  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,161  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,161  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:43:47,161  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000031_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,161  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,161  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000032_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,161  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,161  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,161  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000033_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,162  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=2]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,162  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,162  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000031_0, priority=1, startTime=0, containerId=null, uniqueId=33, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,162  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000031_0; false
2024-04-23T14:43:47,162  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000031_0, true
2024-04-23T14:43:47,163  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,163  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000032_0, priority=2, startTime=0, containerId=null, uniqueId=34, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,163  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000032_0; false
2024-04-23T14:43:47,163  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000032_0, true
2024-04-23T14:43:47,164  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,164  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000033_0, priority=2, startTime=0, containerId=null, uniqueId=35, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:47,164  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000033_0; false
2024-04-23T14:43:47,164  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000033_0, true
2024-04-23T14:43:47,164  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,164  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 2 (internal version -9223372036854775806); the delta to adjust by is 2
2024-04-23T14:43:47,164  INFO [Time-limited test] GuaranteedTasks: Distributing 2 among 2 levels
2024-04-23T14:43:47,164  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,164  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000031_0 to update
2024-04-23T14:43:47,164  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 2
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000033_0 to update
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Distributed 2
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Sending updates to 2 tasks
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 4 (internal version -9223372036854775805); the delta to adjust by is 2
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Distributing 2 among 1 levels
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000032_0 to update
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 6 (internal version -9223372036854775804); the delta to adjust by is 2
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Setting unused to 3 based on remaining delta 2
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 5 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Setting unused to 2 based on full delta 1
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is -4
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Revoking 2 from 2 levels
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 2
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000032_0 to update - already pending
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000033_0 to update - already pending
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 2 / 2
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775801); the delta to adjust by is -1
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,165  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000031_0 to update - already pending
2024-04-23T14:43:47,166  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:43:47,166  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:47,166  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000031_0; false
2024-04-23T14:43:47,166  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000031_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,166  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000032_0; false
2024-04-23T14:43:47,166  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000032_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,166  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000033_0; false
2024-04-23T14:43:47,166  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000033_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,166  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,166  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,167  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,167  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,167  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,167  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,167  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,167 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,180  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,180  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,181  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,181  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,182  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,182  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,182  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,182  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,182  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,182  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,182  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,182  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775807); the delta to adjust by is 1
2024-04-23T14:43:47,182  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:43:47,182  INFO [Time-limited test] GuaranteedTasks: Distributed 0
2024-04-23T14:43:47,182  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:43:47,183  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:47,183  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000034_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,183  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,183  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,183  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,183  INFO [LlapScheduler] GuaranteedTasks: Using an unused duck for attempt_1_0001_0_00_000034_0; unused is now 0
2024-04-23T14:43:47,183  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000034_0, priority=2, startTime=0, containerId=null, uniqueId=36, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000002
2024-04-23T14:43:47,183  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000034_0; true
2024-04-23T14:43:47,183  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000034_0, true
2024-04-23T14:43:47,184  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000035_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,185  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,185  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,185  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,185  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000035_0, priority=1, startTime=0, containerId=null, uniqueId=37, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000004
2024-04-23T14:43:47,185  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000035_0; true
2024-04-23T14:43:47,185  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000035_0, true
2024-04-23T14:43:47,185  INFO [LlapScheduler] GuaranteedTasks: Downgrading attempt_1_0001_0_00_000034_0
2024-04-23T14:43:47,185  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000035_0; true
2024-04-23T14:43:47,186  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000035_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,186  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:43:47,186  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,186  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:43:47,186  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000034_0 to update - already pending
2024-04-23T14:43:47,186  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000034_0; true
2024-04-23T14:43:47,186  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000034_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,186  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:43:47,186  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:43:47,186  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,186  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,187  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,187  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,187  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,187  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,187  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,187 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,202  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,202  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:43:47,203  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,203  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:43:47,204  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000036_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,204  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000037_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000038_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,205  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,205  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000036_0, priority=1, startTime=0, containerId=null, uniqueId=38, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,205  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000036_0; false
2024-04-23T14:43:47,205  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000036_0, true
2024-04-23T14:43:47,206  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,206  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000037_0, priority=1, startTime=0, containerId=null, uniqueId=39, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,206  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000037_0; false
2024-04-23T14:43:47,206  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000037_0, true
2024-04-23T14:43:47,206  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,206  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,207  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,207  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,207  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,207  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,207  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,207 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,218  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,218  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,219  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,220  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,220  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,220  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,220  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,220  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,220  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,220  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,220  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,220  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:43:47,221  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000039_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,221  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,221  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,221  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,221  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000039_0, priority=1, startTime=0, containerId=null, uniqueId=41, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,222  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000039_0; false
2024-04-23T14:43:47,222  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000039_0, true
2024-04-23T14:43:47,223  INFO [Time-limited test] GuaranteedTasks: Sending an update based on inconsistent state from heartbeat for attempt_1_0001_0_00_000039_0, false
2024-04-23T14:43:47,223  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000039_0, true
2024-04-23T14:43:47,223  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000039_0; false
2024-04-23T14:43:47,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000039_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,223  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,223  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,223  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,223  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,223 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,235  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,236  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,237  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:47,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:47,237  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,238  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,238  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:47,238  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,239  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,239  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000040_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,240  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,240  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000041_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,240  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,240  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000042_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,240  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,240  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,241  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000040_0, priority=1, startTime=0, containerId=null, uniqueId=42, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,241  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000040_0; false
2024-04-23T14:43:47,241  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000040_0, true
2024-04-23T14:43:47,241  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:43:47,241  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000041_0, priority=1, startTime=0, containerId=null, uniqueId=43, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,241  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000041_0; false
2024-04-23T14:43:47,241  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000041_0, true
2024-04-23T14:43:47,242  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:43:47,242  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000042_0, priority=1, startTime=0, containerId=null, uniqueId=44, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:47,242  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000042_0; false
2024-04-23T14:43:47,242  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000042_0, true
2024-04-23T14:43:47,242  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,243  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,243  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,243  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,243  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,243  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,243  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,243  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,243 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,254  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:43:47,255  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:47,256  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,256  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,256  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:47,256  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,256  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,256  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:47,257  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,257  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000043_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,257  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,257  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,257  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,257  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000043_0, priority=2, startTime=0, containerId=null, uniqueId=45, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,257  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000043_0; false
2024-04-23T14:43:47,257  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000043_0, true
2024-04-23T14:43:47,258  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000044_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,258  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,259  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,259  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,259  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000044_0, priority=2, startTime=0, containerId=null, uniqueId=46, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,259  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000044_0; false
2024-04-23T14:43:47,259  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000044_0, true
2024-04-23T14:43:47,259  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000045_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,259  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=2. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,259  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,260  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:43:47,261  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,261  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000043_0, priority=2, startTime=10000, containerId=container_11111_0001_01_000003, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=45, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:43:47,261  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,261  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,261  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,261  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,261  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,261  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,262  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:43:47,262  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,269  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,271  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,272  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,272  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,272  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,272  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,272  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,272  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,273  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,273  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,273  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,273  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:43:47,273  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000046_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,273  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,273  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000047_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,273  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,273  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,274  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,274  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000046_0, priority=1, startTime=0, containerId=null, uniqueId=48, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,274  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000046_0; false
2024-04-23T14:43:47,274  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000046_0, true
2024-04-23T14:43:47,275  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,275  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000047_0, priority=2, startTime=0, containerId=null, uniqueId=49, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,275  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000047_0; false
2024-04-23T14:43:47,275  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000047_0, true
2024-04-23T14:43:47,275  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000046_0 to update
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000046_0; true
2024-04-23T14:43:47,275  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000046_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:43:47,275  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000047_0 to update
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000046_0, false
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000047_0, false
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000047_0, true
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels; on failure
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: Adding failed attempt_1_0001_0_00_000047_0 to update
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000047_0; true
2024-04-23T14:43:47,276  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000047_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:43:47,276  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:43:47,276  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,276  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,276  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,276  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,276  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,276  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,276  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,276 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,285  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:43:47,285  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:47,286  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,286  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,286  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:47,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,287  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:47,287  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000048_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000049_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000050_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,288  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,288  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000048_0, priority=1, startTime=0, containerId=null, uniqueId=50, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,288  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000048_0; false
2024-04-23T14:43:47,288  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000048_0, true
2024-04-23T14:43:47,289  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,289  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000049_0, priority=1, startTime=0, containerId=null, uniqueId=51, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,289  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000049_0; false
2024-04-23T14:43:47,289  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000049_0, true
2024-04-23T14:43:47,289  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,289  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,289  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,289  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,289  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,289  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,289  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,289 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,298  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=10000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,299  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,300  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,300  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,300  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,300  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,300  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,300  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,300  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,300  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,301  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,301  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000051_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,301  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,301  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,301  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000051_0, priority=1, startTime=0, containerId=null, uniqueId=53, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,301  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000051_0; false
2024-04-23T14:43:47,301  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000051_0, true
2024-04-23T14:43:47,302  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,302  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000051_0; false
2024-04-23T14:43:47,302  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000051_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:43:47,302  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 10000 milli-seconds. commFailure=false
2024-04-23T14:43:47,302  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000052_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,302  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,303  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host1]
2024-04-23T14:43:47,303  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000052_0, priority=1, startTime=0, containerId=null, uniqueId=54, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,303  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000052_0; false
2024-04-23T14:43:47,303  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000052_0, true
2024-04-23T14:43:47,303  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,303  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,303  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,303  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,303 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,313  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:43:47,314  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:47,315  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,315  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,315  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:47,315  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,315  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,315  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:47,315  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,315  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000053_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000054_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000055_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000056_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,316  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=2
2024-04-23T14:43:47,316  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000053_0, priority=1, startTime=0, containerId=null, uniqueId=58, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,316  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000053_0; false
2024-04-23T14:43:47,317  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000053_0, true
2024-04-23T14:43:47,317  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=2
2024-04-23T14:43:47,317  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000054_0, priority=1, startTime=0, containerId=null, uniqueId=59, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,317  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000054_0; false
2024-04-23T14:43:47,317  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000054_0, true
2024-04-23T14:43:47,317  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:43:47,317  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000055_0, priority=1, startTime=0, containerId=null, uniqueId=60, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:47,318  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000055_0; false
2024-04-23T14:43:47,318  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000055_0, true
2024-04-23T14:43:47,318  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:43:47,318  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000056_0, priority=1, startTime=0, containerId=null, uniqueId=61, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:43:47,318  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000056_0; false
2024-04-23T14:43:47,318  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000056_0, true
2024-04-23T14:43:47,318  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,318  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,318  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,319  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,319  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,319  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,319  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,319  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,319 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,329  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,329  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,329  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,330  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,330  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,330  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:43:47,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000057_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,330  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000058_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,331  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,331  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000057_0, priority=1, startTime=0, containerId=null, uniqueId=62, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,331  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000057_0; false
2024-04-23T14:43:47,331  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000057_0, true
2024-04-23T14:43:47,332  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,332  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000058_0, priority=2, startTime=0, containerId=null, uniqueId=63, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,332  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000058_0; false
2024-04-23T14:43:47,332  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000058_0, true
2024-04-23T14:43:47,332  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,333  INFO [test-update-thread] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:43:47,333  INFO [test-update-thread] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:43:47,333  INFO [test-update-thread] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,333  INFO [test-update-thread] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:43:47,333  INFO [test-update-thread] GuaranteedTasks: Distributed 1
2024-04-23T14:43:47,333  INFO [test-update-thread] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:47,333  INFO [test-update-thread] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:47,333  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:43:47,333  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:43:47,333  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,333  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000057_0 to update - already pending
2024-04-23T14:43:47,333  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:43:47,333  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:47,333  INFO [test-update-thread] GuaranteedTasks: Not sending update to attempt_1_0001_0_00_000057_0
2024-04-23T14:43:47,334  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is 1
2024-04-23T14:43:47,334  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:43:47,334  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,334  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:43:47,334  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:47,334  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:47,334  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:47,334  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000057_0, true
2024-04-23T14:43:47,334  INFO [test-update-thread] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:43:47,334  INFO [test-update-thread] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:43:47,334  INFO [test-update-thread] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,334  INFO [test-update-thread] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:43:47,334  INFO [test-update-thread] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:43:47,335  INFO [test-update-thread] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is 1
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000057_0 to update - already pending
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:47,335  INFO [test-update-thread] GuaranteedTasks: Not sending update to attempt_1_0001_0_00_000057_0
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000057_0; true
2024-04-23T14:43:47,335  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000057_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000058_0 to update
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000058_0; true
2024-04-23T14:43:47,335  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000058_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,335  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:43:47,336  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:43:47,336  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,336  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,336  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,336  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,336  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,336  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,336  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,336 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,345  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:43:47,346  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:43:47,347  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:47,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:43:47,347  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000059_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000060_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,347  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,348  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:43:47,348  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000059_0, priority=1, startTime=0, containerId=null, uniqueId=64, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,348  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000059_0; false
2024-04-23T14:43:47,348  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000059_0, true
2024-04-23T14:43:47,349  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,349  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000060_0, priority=1, startTime=0, containerId=null, uniqueId=65, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,349  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000060_0; false
2024-04-23T14:43:47,349  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000060_0, true
2024-04-23T14:43:47,349  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,349  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,349  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,349  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,349  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,349  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,349  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,349  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,349 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,359  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,359  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,360  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,360  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,360  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,360  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,360  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,360  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,361  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,361  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,361  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,361  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:43:47,361  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000061_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,361  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,361  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,361  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,361  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000061_0, priority=1, startTime=0, containerId=null, uniqueId=66, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,361  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000061_0; false
2024-04-23T14:43:47,361  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000061_0, true
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000061_0 to update
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,362  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000061_0 to update - already pending
2024-04-23T14:43:47,363  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:43:47,363  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:47,363  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000061_0, false
2024-04-23T14:43:47,363  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000061_0; false
2024-04-23T14:43:47,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000061_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,363  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,363  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,363  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,363  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,363 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,375  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,376  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,377  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,377  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,377  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,377  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,377  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,378  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,378  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775807); the delta to adjust by is 1
2024-04-23T14:43:47,378  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:43:47,378  INFO [Time-limited test] GuaranteedTasks: Distributed 0
2024-04-23T14:43:47,378  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:43:47,378  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:47,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000062_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,378  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,379  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,379  INFO [LlapScheduler] GuaranteedTasks: Using an unused duck for attempt_1_0001_0_00_000062_0; unused is now 0
2024-04-23T14:43:47,379  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000062_0, priority=1, startTime=0, containerId=null, uniqueId=67, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000002
2024-04-23T14:43:47,379  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000062_0; true
2024-04-23T14:43:47,379  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000062_0, true
2024-04-23T14:43:47,380  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000063_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,380  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,380  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,380  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:47,380  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000063_0, priority=1, startTime=0, containerId=null, uniqueId=68, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,380  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000063_0; false
2024-04-23T14:43:47,380  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000063_0, true
2024-04-23T14:43:47,381  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000062_0; true
2024-04-23T14:43:47,381  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000062_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,381  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:43:47,381  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,381  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:47,381  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000063_0 to update
2024-04-23T14:43:47,381  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000063_0; true
2024-04-23T14:43:47,381  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000063_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:47,381  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:43:47,381  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:43:47,381  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:47,381  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:47,381  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:47,381  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:47,382  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:47,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:47,382 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:47,398  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=1000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:47,399  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:47,400  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:47,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:47,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,400  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:47,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:47,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:47,401  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000064_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000065_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,401  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000066_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,401  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,401  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000064_0, priority=1, startTime=0, containerId=null, uniqueId=69, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:47,401  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000064_0; false
2024-04-23T14:43:47,401  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000064_0, true
2024-04-23T14:43:47,402  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,402  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000065_0, priority=1, startTime=0, containerId=null, uniqueId=70, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:47,402  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000065_0; false
2024-04-23T14:43:47,402  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000065_0, true
2024-04-23T14:43:47,402  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host3. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:47,402  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000066_0, priority=1, startTime=0, containerId=null, uniqueId=71, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:47,402  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000066_0; false
2024-04-23T14:43:47,402  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000066_0, true
2024-04-23T14:43:47,402  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:47,403  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000064_0; false
2024-04-23T14:43:47,403  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000064_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:43:47,403  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:43:47,403  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000065_0; false
2024-04-23T14:43:47,403  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000065_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:43:47,403  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host2:0, id=host-host2, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:43:47,404  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000066_0; false
2024-04-23T14:43:47,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000066_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:43:47,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host3:0, id=host-host3, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:43:47,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000067_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000068_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000069_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:47,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:47,404  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,403  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:43:48,403  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host2:0, id=host-host2, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:43:48,403  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,404  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,404  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000067_0, priority=1, startTime=0, containerId=null, uniqueId=72, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:43:48,404  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000067_0; false
2024-04-23T14:43:48,404  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000067_0, true
2024-04-23T14:43:48,404  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,404  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000068_0, priority=1, startTime=0, containerId=null, uniqueId=73, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:43:48,404  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000068_0; false
2024-04-23T14:43:48,404  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000068_0, true
2024-04-23T14:43:48,404  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host3]
2024-04-23T14:43:48,405  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #6, task=TaskInfo{task=attempt_1_0001_0_00_000069_0, priority=1, startTime=0, containerId=null, uniqueId=74, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000013
2024-04-23T14:43:48,405  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000069_0; false
2024-04-23T14:43:48,405  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000069_0, true
2024-04-23T14:43:48,405  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,405  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host3:0, id=host-host3, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:43:48,405  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:48,405  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:48,405  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:48,405  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,405  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:48,405  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,405  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:48,405 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:48,415  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:48,416  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:48,417  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:48,417  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:48,417  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:48,417  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:48,417  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:48,418  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000070_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000071_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000072_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000073_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000074_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,418  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=5]. runningTasks=0. totalPendingTasks=5. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,419  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,419  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000070_0, priority=1, startTime=0, containerId=null, uniqueId=75, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:48,419  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000070_0; false
2024-04-23T14:43:48,419  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000070_0, true
2024-04-23T14:43:48,419  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,419  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000071_0, priority=1, startTime=0, containerId=null, uniqueId=76, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:48,419  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000071_0; false
2024-04-23T14:43:48,420  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000071_0, true
2024-04-23T14:43:48,420  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:43:48,420  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000072_0, priority=1, startTime=0, containerId=null, uniqueId=77, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:48,420  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000072_0; false
2024-04-23T14:43:48,420  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000072_0, true
2024-04-23T14:43:48,420  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,420  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000073_0, priority=1, startTime=0, containerId=null, uniqueId=78, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:43:48,420  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000073_0; false
2024-04-23T14:43:48,420  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000073_0, true
2024-04-23T14:43:48,420  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,421  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000070_0; false
2024-04-23T14:43:48,421  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000070_0, state=ASSIGNED, endReason=null
2024-04-23T14:43:48,421  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:43:48,421  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000074_0, priority=1, startTime=0, containerId=null, uniqueId=79, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:43:48,421  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000074_0; false
2024-04-23T14:43:48,421  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000074_0, true
2024-04-23T14:43:48,421  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,422  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:48,422  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:48,422  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:48,422  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,422  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:48,422  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,422  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:48,422 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:48,430  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:48,430  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:48,431  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:48,431  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:48,431  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:48,431  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:48,431  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:48,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:48,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:48,432  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000075_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,432  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:48,432  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000075_0, priority=1, startTime=0, containerId=null, uniqueId=80, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:48,432  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000075_0; false
2024-04-23T14:43:48,432  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000075_0, true
2024-04-23T14:43:48,433  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,433  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:48,433  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:48,433  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:48,433  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,433  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:48,433  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,433  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:48,433 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:48,442  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:43:48,443  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:48,445  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:48,445  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:48,445  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:48,445  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:48,445  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:48,446  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000076_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,446  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000077_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000078_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000079_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000080_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,446  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=5]. runningTasks=0. totalPendingTasks=5. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,447  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,447  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000076_0, priority=1, startTime=0, containerId=null, uniqueId=81, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:48,447  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000076_0; false
2024-04-23T14:43:48,447  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000076_0, true
2024-04-23T14:43:48,448  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,448  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000077_0, priority=1, startTime=0, containerId=null, uniqueId=82, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:48,448  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000077_0; false
2024-04-23T14:43:48,448  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000077_0, true
2024-04-23T14:43:48,448  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,448  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000079_0, priority=1, startTime=0, containerId=null, uniqueId=84, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:48,448  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000079_0; false
2024-04-23T14:43:48,448  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000079_0, true
2024-04-23T14:43:48,448  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:43:48,448  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000080_0, priority=1, startTime=0, containerId=null, uniqueId=85, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:43:48,449  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000080_0; false
2024-04-23T14:43:48,449  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000080_0, true
2024-04-23T14:43:48,449  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,449  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000076_0; false
2024-04-23T14:43:48,449  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000076_0, state=ASSIGNED, endReason=null
2024-04-23T14:43:48,450  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:48,450  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000078_0, priority=1, startTime=0, containerId=null, uniqueId=83, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:43:48,450  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000078_0; false
2024-04-23T14:43:48,450  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000078_0, true
2024-04-23T14:43:48,450  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,450  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:48,450  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:48,451  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:48,451  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,451  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:48,451  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,451  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:48,451 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:48,459  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:48,460  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:43:48,461  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:48,461  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:48,461  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:43:48,461  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:48,461  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,461  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:43:48,461  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:43:48,462  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:43:48,462  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,462  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:43:48,462  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000081_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,462  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,462  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000082_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,462  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,462  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,462  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:48,462  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000081_0, priority=1, startTime=0, containerId=null, uniqueId=86, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:48,463  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000081_0; false
2024-04-23T14:43:48,463  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, true
2024-04-23T14:43:48,463  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:48,463  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000082_0, priority=1, startTime=0, containerId=null, uniqueId=87, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:48,463  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000082_0; false
2024-04-23T14:43:48,463  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000082_0, true
2024-04-23T14:43:48,463  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,463  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:43:48,463  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:43:48,463  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 2
2024-04-23T14:43:48,463  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000082_0 to update
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000082_0, false
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000082_0, true
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels; on failure
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 2
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000081_0 to update - already pending
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, false
2024-04-23T14:43:48,464  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000082_0; false
2024-04-23T14:43:48,464  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000082_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:43:48,464  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000083_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:48,464  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:48,464  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:43:48,465  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000083_0, priority=2, startTime=0, containerId=null, uniqueId=88, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:48,465  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000083_0; false
2024-04-23T14:43:48,465  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000083_0, true
2024-04-23T14:43:48,465  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is 1
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, false
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000081_0, true
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels; on failure
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:43:48,465  INFO [Time-limited test] GuaranteedTasks: Adding failed attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:43:48,465  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:48,465  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:48,465  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:48,465  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,465  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:48,465  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:48,465  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:48,465 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
