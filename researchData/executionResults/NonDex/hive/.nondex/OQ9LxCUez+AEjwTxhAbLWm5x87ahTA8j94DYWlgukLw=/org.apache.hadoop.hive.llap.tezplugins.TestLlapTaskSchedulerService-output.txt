DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,052169 seconds to load 241 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@36916eb0]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@36916eb0) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Missing dependencies for Yaml support, ConfigurationFactory org.apache.logging.log4j.core.config.yaml.YamlConfigurationFactory is inactive
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@5a45133e
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2
DEBUG StatusLogger Installed 1 script engine
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,003809 seconds to load 0 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 124 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/llap-tez/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/llap-tez/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={DRFA, console}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(noConsoleNoAnsi="null", disableAnsi="null", Configuration(HiveLog4j2Test), pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", header="null", alwaysWriteExceptions="null", Replace=null, PatternSelector=null, charset="null", footer="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(direct="null", follow="null", target="SYSTEM_ERR", immediateFlush="null", bufferSize="null", bufferedIo="null", name="console", Configuration(HiveLog4j2Test), ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ={}, Filter=null)
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(Configuration(HiveLog4j2Test), footer="null", Replace=null, PatternSelector=null, noConsoleNoAnsi="null", alwaysWriteExceptions="null", disableAnsi="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", charset="null", header="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(modulate="true", maxRandomDelay="null", interval="1")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(compressionLevel="null", fileIndex="null", min="null", stopCustomActionsOnError="null", Configuration(HiveLog4j2Test), tempCompressedFilePattern="null", max="30", ={})
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(filePattern="/home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log.%d{yyyy-MM-dd}", advertiseURI="null", advertise="null", filePermissions="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), fileOwner="null", fileGroup="null", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), fileName="/home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log", append="null", bufferSize="null", immediateFlush="null", bufferedIo="null", ignoreExceptions="null", Configuration(HiveLog4j2Test), PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="DRFA", ={}, Filter=null)
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log seek to 996224
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 2 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T14:44:13.131-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-14:44:14.845, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-14:44:14.845, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@235834f2...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@235834f2 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@7862f56
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@36916eb0
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/llap-tez/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@36916eb0) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@36916eb0] started OK.
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T14:44:15,645  INFO [Time-limited test] resource.ResourceUtils: Unable to find 'resource-types.xml'.
2024-04-23T14:44:15,961  INFO [Time-limited test] common.TezClassLoader: Created TezClassLoader with parent classloader: sun.misc.Launcher$AppClassLoader@330bedb4, thread: 14, system classloader: sun.misc.Launcher$AppClassLoader@330bedb4
2024-04-23T14:44:15,963  INFO [Time-limited test] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/llap-tez/target/testconf/hive-site.xml
2024-04-23T14:44:15,970  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3,host4, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:15,988  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3,host4
2024-04-23T14:44:15,998  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:15,999  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:16,019  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=4
2024-04-23T14:44:16,020  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,020  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:16,020  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=4
2024-04-23T14:44:16,021  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:16,021  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=4
2024-04-23T14:44:16,021  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host4, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:16,021  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host4, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=4. activeInstances.size=4
2024-04-23T14:44:16,024  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:44:16,026  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,026  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:44:16,027  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000000_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,028  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,028  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000001_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,029  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,029  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,029  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000002_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,029  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,030  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:44:16,031  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:16,042  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000000_0, priority=1, startTime=0, containerId=null, uniqueId=2, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:16,043  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000000_0; false
2024-04-23T14:44:16,043  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000000_0, true
2024-04-23T14:44:16,044  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host4:0, id=host-host4, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:44:16,045  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000001_0, priority=1, startTime=0, containerId=null, uniqueId=3, localityDelayTimeout=0} on node={host4:0, id=host-host4, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:16,045  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000001_0; false
2024-04-23T14:44:16,045  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000001_0, true
2024-04-23T14:44:16,046  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:16,046  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000002_0, priority=1, startTime=0, containerId=null, uniqueId=4, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:16,047  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000002_0; false
2024-04-23T14:44:16,047  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000002_0, true
2024-04-23T14:44:16,047  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,048  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:44:16,067  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:16,068  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:16,068  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:16,068  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:16,068  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:16,069  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:16,069  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:16,069  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:16,082  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:16,083  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:16,084  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:16,084  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:16,085  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:16,085  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,085  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:16,085  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:16,086  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,086  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000003_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,087  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,087  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000004_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,087  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,087  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000005_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,087  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,088  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:16,088  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000003_0, priority=1, startTime=0, containerId=null, uniqueId=5, localityDelayTimeout=78890939} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:16,088  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000003_0; false
2024-04-23T14:44:16,088  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000003_0, true
2024-04-23T14:44:16,089  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:16,089  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000004_0, priority=1, startTime=0, containerId=null, uniqueId=6, localityDelayTimeout=78890939} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:16,090  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000004_0; false
2024-04-23T14:44:16,090  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000004_0, true
2024-04-23T14:44:16,091  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,094  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:44:16,094  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000005_0, priority=1, startTime=0, containerId=null, uniqueId=7, localityDelayTimeout=78890939} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:16,095  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000005_0; false
2024-04-23T14:44:16,095  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000005_0, true
2024-04-23T14:44:16,095  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,096  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:16,096  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:16,096  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:16,096  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:16,097  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:16,097  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:16,097  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:16,097 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:16,109  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:16,110  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:16,111  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:16,111  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=2} with available capacity=2, pendingQueueSize=0, memory=4096
2024-04-23T14:44:16,111  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=2}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:16,112  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,112  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=2} with available capacity=2, pendingQueueSize=0, memory=4096
2024-04-23T14:44:16,112  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=2}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:16,113  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,113  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000006_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,113  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,113  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000007_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,113  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,113  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000008_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,113  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,114  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:16,114  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000006_0, priority=2, startTime=0, containerId=null, uniqueId=8, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:16,114  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000006_0; false
2024-04-23T14:44:16,114  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000006_0, true
2024-04-23T14:44:16,115  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:16,116  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000007_0, priority=2, startTime=0, containerId=null, uniqueId=9, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:16,116  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000007_0; false
2024-04-23T14:44:16,116  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000007_0, true
2024-04-23T14:44:16,116  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,118  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000009_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:16,118  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=2. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:16,119  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,119  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:44:16,120  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000007_0, priority=2, startTime=78880969, containerId=container_11111_0001_01_000005, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=9, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:16,121  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:16,122  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000006_0; false
2024-04-23T14:44:16,122  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000006_0, state=ASSIGNED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:44:16,122  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=false, disabled=true} for 2000 milli-seconds. commFailure=false
2024-04-23T14:44:16,130  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,122  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=false, disabled=true}
2024-04-23T14:44:18,123  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,125  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:18,125  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000009_0, priority=1, startTime=0, containerId=null, uniqueId=11, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:18,126  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000009_0; false
2024-04-23T14:44:18,126  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000009_0, true
2024-04-23T14:44:18,129  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:18,129  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:18,129  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:18,129  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:18,129  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:18,129  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:18,130  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:18,130  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:18,145  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:18,146  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:18,153  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:18,154  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:18,154  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:18,155  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,155  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:18,155  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:18,156  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,156  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000010_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:18,156  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:18,156  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000011_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:18,156  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:18,156  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000012_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:18,157  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:18,157  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:18,157  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000010_0, priority=1, startTime=0, containerId=null, uniqueId=12, localityDelayTimeout=78893009} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:18,157  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000010_0; false
2024-04-23T14:44:18,158  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000010_0, true
2024-04-23T14:44:18,159  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:18,159  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000011_0, priority=1, startTime=0, containerId=null, uniqueId=13, localityDelayTimeout=78893009} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:18,159  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000011_0; false
2024-04-23T14:44:18,159  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000011_0, true
2024-04-23T14:44:18,160  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,161  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.TestLlapTaskSchedulerService: Triggered getTask but the first element is not ready to execute
2024-04-23T14:44:18,161  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000010_0; false
2024-04-23T14:44:18,162  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000010_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:18,162  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:18,162  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000012_0, priority=1, startTime=0, containerId=null, uniqueId=14, localityDelayTimeout=78893009} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:18,162  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000012_0; false
2024-04-23T14:44:18,163  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000012_0, true
2024-04-23T14:44:18,163  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,164  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:18,164  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:18,165  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:18,165  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:18,165  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:18,165  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:18,165  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:18,165 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:18,177  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:18,178  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:18,179  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:18,179  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:18,179  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:18,180  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,180  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:18,180  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:18,180  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:18,181  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:18,181  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,181  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:18,181  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000013_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:18,181  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:18,182  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,182  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000014_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:18,182  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:18,182  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:18,183  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000013_0, priority=1, startTime=0, containerId=null, uniqueId=15, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:18,183  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000013_0; false
2024-04-23T14:44:18,183  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:18,184  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:18,184  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000014_0, priority=2, startTime=0, containerId=null, uniqueId=16, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:18,184  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000014_0; false
2024-04-23T14:44:18,184  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:18,185  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 2 (internal version -9223372036854775805); the delta to adjust by is 1
2024-04-23T14:44:18,185  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is -1
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 2 levels
2024-04-23T14:44:18,186  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:18,187  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is 1
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775801); the delta to adjust by is -1
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:18,188  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000013_0 to update - already pending
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Sending update to the same task in response handling attempt_1_0001_0_00_000013_0, false
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775800); the delta to adjust by is 1
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000013_0 to update - already pending
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Sending update to the same task in response handling attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:18,189  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:18,190  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000013_0; true
2024-04-23T14:44:18,190  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000013_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:18,190  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:18,190  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:18,190  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:18,190  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000014_0; true
2024-04-23T14:44:18,190  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000014_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:18,190  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:18,191  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:18,191  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:18,191  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:18,191  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:18,191  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:18,191  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:18,191  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:18,192  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:18,192 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:18,203  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=5000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:18,203  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:18,204  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:18,205  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:18,205  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:18,205  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,205  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:18,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:18,206  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000015_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:18,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:18,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000016_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:18,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:18,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000017_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:18,207  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:18,207  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:18,207  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000015_0, priority=1, startTime=0, containerId=null, uniqueId=17, localityDelayTimeout=78893059} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:18,207  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000015_0; false
2024-04-23T14:44:18,207  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000015_0, true
2024-04-23T14:44:18,208  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:18,209  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000016_0, priority=1, startTime=0, containerId=null, uniqueId=18, localityDelayTimeout=78893059} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:18,209  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000016_0; false
2024-04-23T14:44:18,209  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000016_0, true
2024-04-23T14:44:18,210  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:18,211  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000015_0; false
2024-04-23T14:44:18,211  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000015_0, state=ASSIGNED, endReason=COMMUNICATION_ERROR
2024-04-23T14:44:18,211  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=true, disabled=true} for 5000 milli-seconds. commFailure=true
2024-04-23T14:44:18,212  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,213  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,213  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,215  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,215  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,215  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,215  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,216  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:20,216  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,233  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=20000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=9000} consistentSplits=true
2024-04-23T14:44:20,234  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:20,235  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,235  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,236  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:20,236  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,236  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,236  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:20,237  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000018_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000019_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000020_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,238  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,238  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000018_0, priority=1, startTime=0, containerId=null, uniqueId=20, localityDelayTimeout=78894091} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,238  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000018_0; false
2024-04-23T14:44:20,238  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000018_0, true
2024-04-23T14:44:20,239  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,239  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000019_0, priority=1, startTime=0, containerId=null, uniqueId=21, localityDelayTimeout=78894092} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,239  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000019_0; false
2024-04-23T14:44:20,239  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000019_0, true
2024-04-23T14:44:20,240  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,242  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000018_0; false
2024-04-23T14:44:20,242  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000018_0, state=ASSIGNED, endReason=COMMUNICATION_ERROR
2024-04-23T14:44:20,242  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=true, disabled=true} for 10000 milli-seconds. commFailure=true
2024-04-23T14:44:20,242  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,243  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:44:20,243  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000020_0, priority=1, startTime=0, containerId=null, uniqueId=22, localityDelayTimeout=78894092} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:20,243  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000020_0; false
2024-04-23T14:44:20,243  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000020_0, true
2024-04-23T14:44:20,244  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,244  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,245  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,245  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,245  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,245  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,245  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:20,245  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,256  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:20,257  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:20,258  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,259  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,259  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:20,259  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,259  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,259  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:20,259  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,259  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000021_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,260  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,260  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000022_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,260  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,260  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000023_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,260  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,260  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,261  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000021_0, priority=1, startTime=0, containerId=null, uniqueId=23, localityDelayTimeout=78895112} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,261  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000021_0; false
2024-04-23T14:44:20,261  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000021_0, true
2024-04-23T14:44:20,262  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,262  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000022_0, priority=1, startTime=0, containerId=null, uniqueId=24, localityDelayTimeout=78895112} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,262  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000022_0; false
2024-04-23T14:44:20,262  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000022_0, true
2024-04-23T14:44:20,263  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,263  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.TestLlapTaskSchedulerService: Triggered getTask but the first element is not ready to execute
2024-04-23T14:44:20,264  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000021_0; false
2024-04-23T14:44:20,264  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000021_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:20,264  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,264  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000023_0, priority=1, startTime=0, containerId=null, uniqueId=25, localityDelayTimeout=78895112} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:20,265  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000023_0; false
2024-04-23T14:44:20,265  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000023_0, true
2024-04-23T14:44:20,265  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,266  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,266  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,266  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,266  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,266  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,266  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,267  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,267 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,278  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=1000} consistentSplits=true
2024-04-23T14:44:20,279  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:20,280  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,280  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:20,280  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:20,280  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,281  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000024_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,281  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,281  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,281  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000025_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,281  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,281  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,281  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000024_0, priority=1, startTime=0, containerId=null, uniqueId=26, localityDelayTimeout=78886134} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,282  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000024_0; false
2024-04-23T14:44:20,282  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000024_0, true
2024-04-23T14:44:20,283  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,283  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,283  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,283  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,283  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,283  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,284  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,283  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,284 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,299  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:20,300  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:20,302  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,302  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,302  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:20,303  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:20,303  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000026_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,304  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,304  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000027_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,304  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,304  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,304  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000026_0, priority=2, startTime=0, containerId=null, uniqueId=28, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,304  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000026_0; false
2024-04-23T14:44:20,305  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000026_0, true
2024-04-23T14:44:20,305  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,305  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000027_0, priority=2, startTime=0, containerId=null, uniqueId=29, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,306  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000027_0; false
2024-04-23T14:44:20,306  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000027_0, true
2024-04-23T14:44:20,306  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,307  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000028_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,307  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=2. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,307  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000029_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,308  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=2. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,308  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,309  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:44:20,310  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000027_0, priority=2, startTime=78885159, containerId=container_11111_0001_01_000005, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=29, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:20,310  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,311  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000027_0; false
2024-04-23T14:44:20,311  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000027_0, state=PREEMPTED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:44:20,311  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,311  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000028_0, priority=1, startTime=0, containerId=null, uniqueId=30, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:20,311  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000028_0; false
2024-04-23T14:44:20,312  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000028_0, true
2024-04-23T14:44:20,312  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,313  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000026_0, priority=2, startTime=78885157, containerId=container_11111_0001_01_000003, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=28, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:20,313  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,314  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000026_0; false
2024-04-23T14:44:20,314  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000026_0, state=PREEMPTED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:44:20,314  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,314  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000029_0, priority=1, startTime=0, containerId=null, uniqueId=31, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:20,314  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000029_0; false
2024-04-23T14:44:20,315  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000029_0, true
2024-04-23T14:44:20,315  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,316  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,316  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,316  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,316  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,316 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,329  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,330  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,330  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,330  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,331  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000030_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,332  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,332  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000030_0, priority=1, startTime=0, containerId=null, uniqueId=32, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,332  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000030_0; false
2024-04-23T14:44:20,332  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000030_0, true
2024-04-23T14:44:20,333  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,334  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,334  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,334  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,334  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,334  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,334  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,334  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,334 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,346  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,347  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,348  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,348  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,349  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,349  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,349  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,349  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,349  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,350  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,350  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,350  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:20,350  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000031_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,351  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,351  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000032_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,351  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,351  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,351  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000033_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,351  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=2]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,351  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,352  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000031_0, priority=1, startTime=0, containerId=null, uniqueId=33, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,352  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000031_0; false
2024-04-23T14:44:20,352  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000031_0, true
2024-04-23T14:44:20,353  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,353  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000032_0, priority=2, startTime=0, containerId=null, uniqueId=34, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,353  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000032_0; false
2024-04-23T14:44:20,353  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000032_0, true
2024-04-23T14:44:20,353  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,353  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000033_0, priority=2, startTime=0, containerId=null, uniqueId=35, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:20,354  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000033_0; false
2024-04-23T14:44:20,354  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000033_0, true
2024-04-23T14:44:20,354  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 2 (internal version -9223372036854775806); the delta to adjust by is 2
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: Distributing 2 among 2 levels
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000031_0 to update
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 2
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000033_0 to update
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: Distributed 2
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:20,354  INFO [Time-limited test] GuaranteedTasks: Sending updates to 2 tasks
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 4 (internal version -9223372036854775805); the delta to adjust by is 2
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Distributing 2 among 1 levels
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000032_0 to update
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 6 (internal version -9223372036854775804); the delta to adjust by is 2
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Setting unused to 3 based on remaining delta 2
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 5 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Setting unused to 2 based on full delta 1
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is -4
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Revoking 2 from 2 levels
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 2
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000032_0 to update - already pending
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000033_0 to update - already pending
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 2 / 2
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775801); the delta to adjust by is -1
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:20,355  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,356  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000031_0 to update - already pending
2024-04-23T14:44:20,356  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:20,356  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:20,356  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000031_0; false
2024-04-23T14:44:20,356  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000031_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,356  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000032_0; false
2024-04-23T14:44:20,356  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000032_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,356  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000033_0; false
2024-04-23T14:44:20,356  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000033_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,357  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,357  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,357  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,357  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,357  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,357  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,357  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,358 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,373  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,374  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,376  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,376  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,376  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,376  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,376  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,377  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,377  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,377  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,377  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,377  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775807); the delta to adjust by is 1
2024-04-23T14:44:20,378  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:20,378  INFO [Time-limited test] GuaranteedTasks: Distributed 0
2024-04-23T14:44:20,378  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:20,378  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:20,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000034_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,378  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,378  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,378  INFO [LlapScheduler] GuaranteedTasks: Using an unused duck for attempt_1_0001_0_00_000034_0; unused is now 0
2024-04-23T14:44:20,379  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000034_0, priority=2, startTime=0, containerId=null, uniqueId=36, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000002
2024-04-23T14:44:20,379  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000034_0; true
2024-04-23T14:44:20,379  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000034_0, true
2024-04-23T14:44:20,380  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000035_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,380  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,380  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,380  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,380  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000035_0, priority=1, startTime=0, containerId=null, uniqueId=37, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000004
2024-04-23T14:44:20,380  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000035_0; true
2024-04-23T14:44:20,381  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000035_0, true
2024-04-23T14:44:20,381  INFO [LlapScheduler] GuaranteedTasks: Downgrading attempt_1_0001_0_00_000034_0
2024-04-23T14:44:20,381  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000035_0; true
2024-04-23T14:44:20,381  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000035_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,381  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:20,381  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,381  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:20,381  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000034_0 to update - already pending
2024-04-23T14:44:20,382  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000034_0; true
2024-04-23T14:44:20,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000034_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,382  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:20,382  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:20,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,382  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,382  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,382  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,383 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,394  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,395  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:20,396  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,396  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,396  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:20,397  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,397  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000036_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,397  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,397  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000037_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,397  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,397  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,397  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000038_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,397  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,398  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,398  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000036_0, priority=1, startTime=0, containerId=null, uniqueId=38, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,398  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000036_0; false
2024-04-23T14:44:20,398  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000036_0, true
2024-04-23T14:44:20,399  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,399  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000037_0, priority=1, startTime=0, containerId=null, uniqueId=39, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,399  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000037_0; false
2024-04-23T14:44:20,399  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000037_0, true
2024-04-23T14:44:20,399  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,399  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,400  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,400  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,400  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,400 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,410  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,411  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,412  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,412  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,412  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,413  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,413  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,413  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,413  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,413  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,413  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,413  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:20,413  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000039_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,414  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,414  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,414  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,414  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000039_0, priority=1, startTime=0, containerId=null, uniqueId=41, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,414  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000039_0; false
2024-04-23T14:44:20,414  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000039_0, true
2024-04-23T14:44:20,415  INFO [Time-limited test] GuaranteedTasks: Sending an update based on inconsistent state from heartbeat for attempt_1_0001_0_00_000039_0, false
2024-04-23T14:44:20,415  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000039_0, true
2024-04-23T14:44:20,415  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000039_0; false
2024-04-23T14:44:20,415  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000039_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,415  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,416  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,416  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,416  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,416  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,416  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,416  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,416  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,416 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,427  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,428  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,429  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,429  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:20,429  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,430  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,430  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:20,430  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,430  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:20,430  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,431  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,431  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000040_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000041_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000042_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,433  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,433  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000040_0, priority=1, startTime=0, containerId=null, uniqueId=42, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,433  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000040_0; false
2024-04-23T14:44:20,433  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000040_0, true
2024-04-23T14:44:20,433  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:44:20,433  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000041_0, priority=1, startTime=0, containerId=null, uniqueId=43, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,434  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000041_0; false
2024-04-23T14:44:20,434  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000041_0, true
2024-04-23T14:44:20,434  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:44:20,434  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000042_0, priority=1, startTime=0, containerId=null, uniqueId=44, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:20,434  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000042_0; false
2024-04-23T14:44:20,434  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000042_0, true
2024-04-23T14:44:20,435  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,436  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,436  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,436  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,436  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,437  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,437  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,437  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,437 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,447  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:20,447  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:20,448  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,449  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,449  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:20,449  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,449  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,449  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:20,449  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,449  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000043_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,449  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,449  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,450  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,450  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000043_0, priority=2, startTime=0, containerId=null, uniqueId=45, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,450  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000043_0; false
2024-04-23T14:44:20,450  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000043_0, true
2024-04-23T14:44:20,451  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000044_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,451  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,452  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,452  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,452  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000044_0, priority=2, startTime=0, containerId=null, uniqueId=46, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,452  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000044_0; false
2024-04-23T14:44:20,452  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000044_0, true
2024-04-23T14:44:20,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000045_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=2. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,453  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,454  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:44:20,454  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,455  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000043_0, priority=2, startTime=10000, containerId=container_11111_0001_01_000003, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=45, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:20,455  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,455  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,455  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,455  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,455  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,455  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,456  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,456  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:20,465  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,466  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,467  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,467  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,467  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,468  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,468  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,468  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,468  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,468  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,469  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,469  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:20,469  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000046_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,469  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,469  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000047_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,469  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,469  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000046_0, priority=1, startTime=0, containerId=null, uniqueId=48, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,469  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000046_0; false
2024-04-23T14:44:20,469  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000046_0, true
2024-04-23T14:44:20,470  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,470  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,470  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,471  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000047_0, priority=2, startTime=0, containerId=null, uniqueId=49, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,471  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000047_0; false
2024-04-23T14:44:20,471  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000047_0, true
2024-04-23T14:44:20,471  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000046_0 to update
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000046_0; true
2024-04-23T14:44:20,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000046_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:20,471  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000047_0 to update
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000046_0, false
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000047_0, false
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000047_0, true
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels; on failure
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Adding failed attempt_1_0001_0_00_000047_0 to update
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000047_0; true
2024-04-23T14:44:20,472  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000047_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:20,472  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:20,473  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,473  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,473  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,473  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,473  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,473  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,473  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,473 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,482  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:20,483  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:20,484  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,484  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,484  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:20,485  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,485  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,485  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:20,485  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,485  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000048_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,485  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,486  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000049_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,486  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,486  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000050_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,486  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,486  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,486  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000048_0, priority=1, startTime=0, containerId=null, uniqueId=50, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,486  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000048_0; false
2024-04-23T14:44:20,487  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000048_0, true
2024-04-23T14:44:20,487  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,487  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000049_0, priority=1, startTime=0, containerId=null, uniqueId=51, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,487  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000049_0; false
2024-04-23T14:44:20,487  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000049_0, true
2024-04-23T14:44:20,488  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,488  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,488  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,488  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,488 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,498  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=10000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,499  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,500  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,500  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,500  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,501  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,501  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000051_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,502  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,502  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000051_0, priority=1, startTime=0, containerId=null, uniqueId=53, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,502  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000051_0; false
2024-04-23T14:44:20,502  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000051_0, true
2024-04-23T14:44:20,503  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,503  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000051_0; false
2024-04-23T14:44:20,503  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000051_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:20,503  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 10000 milli-seconds. commFailure=false
2024-04-23T14:44:20,504  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000052_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,504  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,504  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host1]
2024-04-23T14:44:20,504  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000052_0, priority=1, startTime=0, containerId=null, uniqueId=54, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,504  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000052_0; false
2024-04-23T14:44:20,504  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000052_0, true
2024-04-23T14:44:20,504  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,505  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,505  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,505  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,505  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,505  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,505  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,505  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,505 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,516  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:20,516  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:20,517  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,517  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:20,518  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:20,518  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000053_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000054_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000055_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000056_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,519  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,519  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=2
2024-04-23T14:44:20,519  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000053_0, priority=1, startTime=0, containerId=null, uniqueId=58, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,519  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000053_0; false
2024-04-23T14:44:20,519  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000053_0, true
2024-04-23T14:44:20,520  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=2
2024-04-23T14:44:20,520  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000054_0, priority=1, startTime=0, containerId=null, uniqueId=59, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,520  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000054_0; false
2024-04-23T14:44:20,520  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000054_0, true
2024-04-23T14:44:20,520  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:20,520  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000055_0, priority=1, startTime=0, containerId=null, uniqueId=60, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:20,520  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000055_0; false
2024-04-23T14:44:20,520  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000055_0, true
2024-04-23T14:44:20,520  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:20,520  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000056_0, priority=1, startTime=0, containerId=null, uniqueId=61, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:20,521  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000056_0; false
2024-04-23T14:44:20,521  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000056_0, true
2024-04-23T14:44:20,521  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,523  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,523  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,523  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,523  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,523  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,523  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,523  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,523 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,533  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,533  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,534  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,535  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,535  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,535  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,535  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,535  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,535  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,535  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,536  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,536  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:20,536  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000057_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,536  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,536  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,536  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000058_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,536  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,537  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,537  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000057_0, priority=1, startTime=0, containerId=null, uniqueId=62, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,537  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000057_0; false
2024-04-23T14:44:20,537  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000057_0, true
2024-04-23T14:44:20,537  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,537  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000058_0, priority=2, startTime=0, containerId=null, uniqueId=63, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,538  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000058_0; false
2024-04-23T14:44:20,538  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000058_0, true
2024-04-23T14:44:20,538  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,538  INFO [test-update-thread] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:20,538  INFO [test-update-thread] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:20,538  INFO [test-update-thread] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,539  INFO [test-update-thread] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:20,539  INFO [test-update-thread] GuaranteedTasks: Distributed 1
2024-04-23T14:44:20,539  INFO [test-update-thread] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:20,539  INFO [test-update-thread] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000057_0 to update - already pending
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:20,539  INFO [test-update-thread] GuaranteedTasks: Not sending update to attempt_1_0001_0_00_000057_0
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is 1
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:20,539  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000057_0, true
2024-04-23T14:44:20,540  INFO [test-update-thread] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:20,540  INFO [test-update-thread] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:20,540  INFO [test-update-thread] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,540  INFO [test-update-thread] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:20,540  INFO [test-update-thread] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:20,540  INFO [test-update-thread] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is 1
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000057_0 to update - already pending
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:20,540  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:20,541  INFO [test-update-thread] GuaranteedTasks: Not sending update to attempt_1_0001_0_00_000057_0
2024-04-23T14:44:20,541  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000057_0; true
2024-04-23T14:44:20,541  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000057_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,541  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:20,541  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:20,541  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000058_0 to update
2024-04-23T14:44:20,541  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000058_0; true
2024-04-23T14:44:20,541  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000058_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,541  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:20,541  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:20,541  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,541  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,541  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,542  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,542  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,542  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,542  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,542 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,551  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:20,552  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:20,553  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,553  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:20,553  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:20,553  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,558  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000059_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,559  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,559  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,559  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000060_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,560  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,560  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:20,560  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000059_0, priority=1, startTime=0, containerId=null, uniqueId=64, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,560  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000059_0; false
2024-04-23T14:44:20,560  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000059_0, true
2024-04-23T14:44:20,561  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,561  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000060_0, priority=1, startTime=0, containerId=null, uniqueId=65, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,561  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000060_0; false
2024-04-23T14:44:20,561  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000060_0, true
2024-04-23T14:44:20,561  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,562  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,563  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,563  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,563  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,563  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,563 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,573  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,574  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,575  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,575  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,575  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,575  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,575  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,575  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,576  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,576  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,576  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,576  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:20,576  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000061_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,576  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,576  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,576  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,576  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000061_0, priority=1, startTime=0, containerId=null, uniqueId=66, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,577  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000061_0; false
2024-04-23T14:44:20,577  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000061_0, true
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000061_0 to update
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,577  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000061_0 to update - already pending
2024-04-23T14:44:20,578  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:20,578  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:20,578  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000061_0, false
2024-04-23T14:44:20,578  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000061_0; false
2024-04-23T14:44:20,578  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000061_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,578  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,578  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,578  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,578  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,578  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,578  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,578  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,578  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,578 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,587  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,587  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,588  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,588  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,588  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,589  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,589  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,589  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775807); the delta to adjust by is 1
2024-04-23T14:44:20,589  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:20,589  INFO [Time-limited test] GuaranteedTasks: Distributed 0
2024-04-23T14:44:20,589  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:20,589  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:20,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000062_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,590  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,590  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,590  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,590  INFO [LlapScheduler] GuaranteedTasks: Using an unused duck for attempt_1_0001_0_00_000062_0; unused is now 0
2024-04-23T14:44:20,590  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000062_0, priority=1, startTime=0, containerId=null, uniqueId=67, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000002
2024-04-23T14:44:20,590  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000062_0; true
2024-04-23T14:44:20,590  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000062_0, true
2024-04-23T14:44:20,591  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000063_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,591  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,591  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,591  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:20,591  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000063_0, priority=1, startTime=0, containerId=null, uniqueId=68, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,591  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000063_0; false
2024-04-23T14:44:20,591  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000063_0, true
2024-04-23T14:44:20,591  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000062_0; true
2024-04-23T14:44:20,591  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000062_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,591  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:20,591  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,591  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:20,592  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000063_0 to update
2024-04-23T14:44:20,592  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000063_0; true
2024-04-23T14:44:20,592  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000063_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:20,592  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:20,592  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:20,592  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:20,592  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:20,592  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:20,592  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,592  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:20,592  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:20,592  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:20,592 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:20,601  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=1000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:20,601  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:20,602  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:20,602  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,602  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:20,603  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:20,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:20,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:20,603  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000064_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,604  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,604  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,604  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000065_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,604  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,604  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000066_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,604  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,604  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,604  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000064_0, priority=1, startTime=0, containerId=null, uniqueId=69, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:20,604  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000064_0; false
2024-04-23T14:44:20,604  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000064_0, true
2024-04-23T14:44:20,605  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,605  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000065_0, priority=1, startTime=0, containerId=null, uniqueId=70, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:20,605  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000065_0; false
2024-04-23T14:44:20,605  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000065_0, true
2024-04-23T14:44:20,605  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host3. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:20,605  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000066_0, priority=1, startTime=0, containerId=null, uniqueId=71, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:20,605  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000066_0; false
2024-04-23T14:44:20,605  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000066_0, true
2024-04-23T14:44:20,606  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:20,607  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000064_0; false
2024-04-23T14:44:20,607  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000064_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:20,607  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:20,607  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000065_0; false
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000065_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host2:0, id=host-host2, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:20,608  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000066_0; false
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000066_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host3:0, id=host-host3, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000067_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000068_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000069_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:20,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:20,609  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,608  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:21,608  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host3:0, id=host-host3, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:21,608  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,608  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host2:0, id=host-host2, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:21,609  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,609  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000067_0, priority=1, startTime=0, containerId=null, uniqueId=72, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:21,609  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000067_0; false
2024-04-23T14:44:21,610  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000067_0, true
2024-04-23T14:44:21,610  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,610  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000068_0, priority=1, startTime=0, containerId=null, uniqueId=73, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:21,611  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000068_0; false
2024-04-23T14:44:21,611  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000068_0, true
2024-04-23T14:44:21,611  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host3. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,612  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #6, task=TaskInfo{task=attempt_1_0001_0_00_000069_0, priority=1, startTime=0, containerId=null, uniqueId=74, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000013
2024-04-23T14:44:21,612  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000069_0; false
2024-04-23T14:44:21,612  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000069_0, true
2024-04-23T14:44:21,612  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,616  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:21,616  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:21,616  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:21,616  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,616  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:21,616  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,616  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:21,617 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:21,630  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:21,631  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:21,632  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:21,632  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:21,632  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:21,632  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,632  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:21,632  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:21,633  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000070_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000071_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,633  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000072_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000073_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000074_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=5]. runningTasks=0. totalPendingTasks=5. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,634  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,634  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000070_0, priority=1, startTime=0, containerId=null, uniqueId=75, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:21,634  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000070_0; false
2024-04-23T14:44:21,634  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000070_0, true
2024-04-23T14:44:21,634  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,634  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000071_0, priority=1, startTime=0, containerId=null, uniqueId=76, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:21,635  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000071_0; false
2024-04-23T14:44:21,635  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000071_0, true
2024-04-23T14:44:21,635  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:44:21,635  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000072_0, priority=1, startTime=0, containerId=null, uniqueId=77, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:21,635  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000072_0; false
2024-04-23T14:44:21,635  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000072_0, true
2024-04-23T14:44:21,635  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,635  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000073_0, priority=1, startTime=0, containerId=null, uniqueId=78, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:21,635  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000073_0; false
2024-04-23T14:44:21,635  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000073_0, true
2024-04-23T14:44:21,635  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,637  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000070_0; false
2024-04-23T14:44:21,637  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000070_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:21,637  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:21,637  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000074_0, priority=1, startTime=0, containerId=null, uniqueId=79, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:21,638  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000074_0; false
2024-04-23T14:44:21,638  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000074_0, true
2024-04-23T14:44:21,638  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,638  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:21,638  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:21,638  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:21,638  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,638  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:21,638  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,639  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:21,639 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:21,647  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:21,647  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:21,649  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:21,649  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:21,649  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:21,649  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,649  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:21,649  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:21,649  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:21,649  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:21,650  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,650  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000075_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,650  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,650  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:21,650  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000075_0, priority=1, startTime=0, containerId=null, uniqueId=80, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:21,650  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000075_0; false
2024-04-23T14:44:21,650  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000075_0, true
2024-04-23T14:44:21,651  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,651  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:21,651  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:21,651  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:21,651  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,651  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:21,651  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,651  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:21,651 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:21,660  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:21,661  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:21,661  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:21,662  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:21,662  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000076_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,662  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000077_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,662  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000078_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,663  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,663  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000079_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,663  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,663  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000080_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,663  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=5]. runningTasks=0. totalPendingTasks=5. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,663  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,663  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000076_0, priority=1, startTime=0, containerId=null, uniqueId=81, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:21,663  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000076_0; false
2024-04-23T14:44:21,663  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000076_0, true
2024-04-23T14:44:21,664  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,664  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000077_0, priority=1, startTime=0, containerId=null, uniqueId=82, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:21,664  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000077_0; false
2024-04-23T14:44:21,664  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000077_0, true
2024-04-23T14:44:21,664  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,664  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000079_0, priority=1, startTime=0, containerId=null, uniqueId=84, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:21,664  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000079_0; false
2024-04-23T14:44:21,664  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000079_0, true
2024-04-23T14:44:21,664  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:21,664  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000080_0, priority=1, startTime=0, containerId=null, uniqueId=85, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:21,664  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000080_0; false
2024-04-23T14:44:21,665  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000080_0, true
2024-04-23T14:44:21,665  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,666  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000076_0; false
2024-04-23T14:44:21,666  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000076_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:21,666  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:21,667  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000078_0, priority=1, startTime=0, containerId=null, uniqueId=83, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:21,667  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000078_0; false
2024-04-23T14:44:21,667  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000078_0, true
2024-04-23T14:44:21,667  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,667  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:21,667  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:21,667  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:21,667  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,667  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:21,667  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,667  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:21,667 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:21,676  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:21,677  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:21,677  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:21,678  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:21,678  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:21,678  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,678  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:21,678  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:21,678  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:21,678  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:21,679  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,679  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:21,679  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000081_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,679  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,679  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000082_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,679  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:21,679  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000081_0, priority=1, startTime=0, containerId=null, uniqueId=86, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:21,679  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000081_0; false
2024-04-23T14:44:21,679  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, true
2024-04-23T14:44:21,680  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,680  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,680  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:21,680  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000082_0, priority=1, startTime=0, containerId=null, uniqueId=87, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:21,680  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000082_0; false
2024-04-23T14:44:21,680  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000082_0, true
2024-04-23T14:44:21,680  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 2
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000082_0 to update
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000082_0, false
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000082_0, true
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels; on failure
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 2
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:21,680  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:21,681  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:21,681  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:21,681  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000081_0 to update - already pending
2024-04-23T14:44:21,681  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:21,681  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:21,681  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, false
2024-04-23T14:44:21,681  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000082_0; false
2024-04-23T14:44:21,681  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000082_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:21,681  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000083_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:21,681  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:21,681  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:21,681  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000083_0, priority=2, startTime=0, containerId=null, uniqueId=88, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:21,681  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000083_0; false
2024-04-23T14:44:21,681  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000083_0, true
2024-04-23T14:44:21,682  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is 1
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, false
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000081_0, true
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels; on failure
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:21,682  INFO [Time-limited test] GuaranteedTasks: Adding failed attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:21,682  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:21,682  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:21,682  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:21,682  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,682  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:21,682  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:21,682  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:21,682 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
