DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,052985 seconds to load 241 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@36916eb0]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@36916eb0) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Missing dependencies for Yaml support, ConfigurationFactory org.apache.logging.log4j.core.config.yaml.YamlConfigurationFactory is inactive
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@5a45133e
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2
DEBUG StatusLogger Installed 1 script engine
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,004167 seconds to load 0 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 124 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/llap-tez/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/llap-tez/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(Replace=null, PatternSelector=null, alwaysWriteExceptions="null", charset="null", footer="null", noConsoleNoAnsi="null", header="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", disableAnsi="null", Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(follow="null", target="SYSTEM_ERR", direct="null", bufferedIo="null", bufferSize="null", immediateFlush="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), Configuration(HiveLog4j2Test), name="console", ignoreExceptions="null", Filter=null, ={})
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(noConsoleNoAnsi="null", alwaysWriteExceptions="null", header="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", charset="null", disableAnsi="null", Replace=null, footer="null", Configuration(HiveLog4j2Test), PatternSelector=null)
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(modulate="true", interval="1", maxRandomDelay="null")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(={}, stopCustomActionsOnError="null", compressionLevel="null", fileIndex="null", max="30", min="null", Configuration(HiveLog4j2Test), tempCompressedFilePattern="null")
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(fileName="/home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log", filePattern="/home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log.%d{yyyy-MM-dd}", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), fileGroup="null", append="null", advertiseURI="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), fileOwner="null", advertise="null", filePermissions="null", bufferSize="null", bufferedIo="null", immediateFlush="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="DRFA", ignoreExceptions="null", Configuration(HiveLog4j2Test), ={}, Filter=null)
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log seek to 1494658
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 2 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T14:44:30.315-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-14:44:32.053, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-14:44:32.054, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@235834f2...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@235834f2 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@7862f56
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@36916eb0
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/llap-tez/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@36916eb0) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@36916eb0] started OK.
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T14:44:32,837  INFO [Time-limited test] resource.ResourceUtils: Unable to find 'resource-types.xml'.
2024-04-23T14:44:33,168  INFO [Time-limited test] common.TezClassLoader: Created TezClassLoader with parent classloader: sun.misc.Launcher$AppClassLoader@330bedb4, thread: 14, system classloader: sun.misc.Launcher$AppClassLoader@330bedb4
2024-04-23T14:44:33,171  INFO [Time-limited test] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/llap-tez/target/testconf/hive-site.xml
2024-04-23T14:44:33,178  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3,host4, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:33,195  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3,host4
2024-04-23T14:44:33,205  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:33,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:33,227  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=4
2024-04-23T14:44:33,228  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,228  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:33,229  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=4
2024-04-23T14:44:33,229  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:33,229  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=4
2024-04-23T14:44:33,229  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host4, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:33,230  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host4, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=4. activeInstances.size=4
2024-04-23T14:44:33,233  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:44:33,235  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,236  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:44:33,237  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000000_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,238  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,239  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,239  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000001_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,239  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,239  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000002_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,239  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,240  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:44:33,241  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:33,258  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000000_0, priority=1, startTime=0, containerId=null, uniqueId=2, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:33,259  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000000_0; false
2024-04-23T14:44:33,259  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000000_0, true
2024-04-23T14:44:33,261  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host4:0, id=host-host4, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:44:33,261  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000001_0, priority=1, startTime=0, containerId=null, uniqueId=3, localityDelayTimeout=0} on node={host4:0, id=host-host4, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:33,261  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000001_0; false
2024-04-23T14:44:33,262  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000001_0, true
2024-04-23T14:44:33,263  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:33,263  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000002_0, priority=1, startTime=0, containerId=null, uniqueId=4, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:33,263  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000002_0; false
2024-04-23T14:44:33,263  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000002_0, true
2024-04-23T14:44:33,264  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,264  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:44:33,282  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:33,283  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:33,283  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:33,284  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:33,284  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:33,284  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:33,284  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:33,284  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:33,298  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:33,299  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:33,300  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:33,300  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:33,301  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:33,301  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,301  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:33,301  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:33,302  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,302  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000003_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000004_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000005_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,303  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,304  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:33,304  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000003_0, priority=1, startTime=0, containerId=null, uniqueId=5, localityDelayTimeout=78908155} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:33,304  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000003_0; false
2024-04-23T14:44:33,304  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000003_0, true
2024-04-23T14:44:33,305  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:33,305  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000004_0, priority=1, startTime=0, containerId=null, uniqueId=6, localityDelayTimeout=78908155} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:33,305  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000004_0; false
2024-04-23T14:44:33,306  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000004_0, true
2024-04-23T14:44:33,306  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,309  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:44:33,309  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000005_0, priority=1, startTime=0, containerId=null, uniqueId=7, localityDelayTimeout=78908155} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:33,310  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000005_0; false
2024-04-23T14:44:33,310  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000005_0, true
2024-04-23T14:44:33,310  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,311  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:33,311  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:33,311  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:33,311  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:33,312  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:33,312  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:33,312  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:33,312 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:33,324  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:33,325  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:33,326  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:33,326  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=2} with available capacity=2, pendingQueueSize=0, memory=4096
2024-04-23T14:44:33,327  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=2}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:33,327  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,327  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=2} with available capacity=2, pendingQueueSize=0, memory=4096
2024-04-23T14:44:33,327  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=2}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:33,328  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000006_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000007_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000008_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,329  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,329  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:33,329  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000006_0, priority=2, startTime=0, containerId=null, uniqueId=8, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:33,329  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000006_0; false
2024-04-23T14:44:33,330  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000006_0, true
2024-04-23T14:44:33,330  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:33,331  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000007_0, priority=2, startTime=0, containerId=null, uniqueId=9, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:33,331  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000007_0; false
2024-04-23T14:44:33,331  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000007_0, true
2024-04-23T14:44:33,332  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,333  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000009_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:33,333  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=2. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:33,334  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,334  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:44:33,335  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000007_0, priority=2, startTime=78898184, containerId=container_11111_0001_01_000005, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=9, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:33,337  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:33,337  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000006_0; false
2024-04-23T14:44:33,337  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000006_0, state=ASSIGNED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:44:33,338  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=false, disabled=true} for 2000 milli-seconds. commFailure=false
2024-04-23T14:44:33,345  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,339  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=false, disabled=true}
2024-04-23T14:44:35,340  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,341  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:35,342  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000009_0, priority=1, startTime=0, containerId=null, uniqueId=11, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:35,342  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000009_0; false
2024-04-23T14:44:35,343  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000009_0, true
2024-04-23T14:44:35,346  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:35,346  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:35,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:35,353  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:35,353  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:35,353  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:35,353  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:35,353  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:35,365  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:35,366  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:35,367  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:35,367  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:35,368  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:35,368  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,368  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:35,368  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:35,369  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,369  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000010_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:35,369  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:35,369  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000011_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:35,369  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:35,369  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000012_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:35,369  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:35,370  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:35,370  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000010_0, priority=1, startTime=0, containerId=null, uniqueId=12, localityDelayTimeout=78910222} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:35,370  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000010_0; false
2024-04-23T14:44:35,371  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000010_0, true
2024-04-23T14:44:35,372  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:35,372  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000011_0, priority=1, startTime=0, containerId=null, uniqueId=13, localityDelayTimeout=78910222} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:35,372  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000011_0; false
2024-04-23T14:44:35,372  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000011_0, true
2024-04-23T14:44:35,373  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,374  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.TestLlapTaskSchedulerService: Triggered getTask but the first element is not ready to execute
2024-04-23T14:44:35,375  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000010_0; false
2024-04-23T14:44:35,375  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000010_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:35,375  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:35,376  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000012_0, priority=1, startTime=0, containerId=null, uniqueId=14, localityDelayTimeout=78910222} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:35,376  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000012_0; false
2024-04-23T14:44:35,376  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000012_0, true
2024-04-23T14:44:35,376  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,378  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:35,377  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:35,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:35,378  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:35,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:35,378  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:35,379  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:35,379 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:35,392  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:35,393  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:35,394  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:35,395  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:35,395  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:35,395  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,395  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:35,396  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:35,396  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:35,396  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:35,397  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,397  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:35,397  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000013_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:35,397  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:35,398  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,398  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000014_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:35,398  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:35,399  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:35,399  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000013_0, priority=1, startTime=0, containerId=null, uniqueId=15, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:35,399  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000013_0; false
2024-04-23T14:44:35,399  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:35,400  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:35,401  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000014_0, priority=2, startTime=0, containerId=null, uniqueId=16, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:35,401  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000014_0; false
2024-04-23T14:44:35,401  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:35,401  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,401  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:35,401  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:35,401  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:35,401  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:35,401  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 2 (internal version -9223372036854775805); the delta to adjust by is 1
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:35,402  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:35,403  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is -1
2024-04-23T14:44:35,403  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 2 levels
2024-04-23T14:44:35,403  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:35,403  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:35,403  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:35,403  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:35,403  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:35,403  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is 1
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:35,404  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775801); the delta to adjust by is -1
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000013_0 to update - already pending
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Sending update to the same task in response handling attempt_1_0001_0_00_000013_0, false
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775800); the delta to adjust by is 1
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:35,405  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000013_0 to update - already pending
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Sending update to the same task in response handling attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000013_0; true
2024-04-23T14:44:35,406  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000013_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:35,406  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:35,407  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000014_0; true
2024-04-23T14:44:35,407  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000014_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:35,407  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:35,407  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:35,407  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:35,407  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:35,408  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:35,408  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:35,408  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:35,408  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:35,408  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:35,408 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:35,421  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=5000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:35,422  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:35,423  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:35,423  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:35,423  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:35,423  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,423  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:35,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:35,424  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000015_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:35,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:35,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000016_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:35,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:35,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000017_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:35,425  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:35,425  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:35,425  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000015_0, priority=1, startTime=0, containerId=null, uniqueId=17, localityDelayTimeout=78910277} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:35,425  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000015_0; false
2024-04-23T14:44:35,426  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000015_0, true
2024-04-23T14:44:35,427  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:35,427  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000016_0, priority=1, startTime=0, containerId=null, uniqueId=18, localityDelayTimeout=78910277} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:35,427  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000016_0; false
2024-04-23T14:44:35,427  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000016_0, true
2024-04-23T14:44:35,428  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:35,429  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000015_0; false
2024-04-23T14:44:35,430  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000015_0, state=ASSIGNED, endReason=COMMUNICATION_ERROR
2024-04-23T14:44:35,430  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=true, disabled=true} for 5000 milli-seconds. commFailure=true
2024-04-23T14:44:35,430  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,431  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,431  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,432  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,432  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,433  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,433  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,434  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,434  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:37,450  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=20000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=9000} consistentSplits=true
2024-04-23T14:44:37,450  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:37,452  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,452  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,452  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:37,452  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:37,453  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000018_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,454  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000019_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,454  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,454  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000020_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,454  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,454  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,455  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000018_0, priority=1, startTime=0, containerId=null, uniqueId=20, localityDelayTimeout=78911307} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,455  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000018_0; false
2024-04-23T14:44:37,455  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000018_0, true
2024-04-23T14:44:37,456  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,456  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000019_0, priority=1, startTime=0, containerId=null, uniqueId=21, localityDelayTimeout=78911309} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,456  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000019_0; false
2024-04-23T14:44:37,456  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000019_0, true
2024-04-23T14:44:37,456  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,458  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000018_0; false
2024-04-23T14:44:37,458  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000018_0, state=ASSIGNED, endReason=COMMUNICATION_ERROR
2024-04-23T14:44:37,458  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=true, disabled=true} for 10000 milli-seconds. commFailure=true
2024-04-23T14:44:37,459  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,459  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:44:37,459  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000020_0, priority=1, startTime=0, containerId=null, uniqueId=22, localityDelayTimeout=78911309} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:37,459  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000020_0; false
2024-04-23T14:44:37,459  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000020_0, true
2024-04-23T14:44:37,460  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,460  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,461  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,461  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,461  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,461  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,461  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:37,461  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,473  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:37,473  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:37,475  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,475  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,475  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:37,475  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,475  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,475  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:37,476  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,476  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000021_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,476  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,476  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000022_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,476  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,476  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000023_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,476  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,477  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,477  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000021_0, priority=1, startTime=0, containerId=null, uniqueId=23, localityDelayTimeout=78912329} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,477  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000021_0; false
2024-04-23T14:44:37,477  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000021_0, true
2024-04-23T14:44:37,478  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,478  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000022_0, priority=1, startTime=0, containerId=null, uniqueId=24, localityDelayTimeout=78912329} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,479  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000022_0; false
2024-04-23T14:44:37,479  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000022_0, true
2024-04-23T14:44:37,479  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,481  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.TestLlapTaskSchedulerService: Triggered getTask but the first element is not ready to execute
2024-04-23T14:44:37,481  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000021_0; false
2024-04-23T14:44:37,481  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000021_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:37,482  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,482  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000023_0, priority=1, startTime=0, containerId=null, uniqueId=25, localityDelayTimeout=78912329} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:37,482  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000023_0; false
2024-04-23T14:44:37,482  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000023_0, true
2024-04-23T14:44:37,483  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,484  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,484  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,484  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,484  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,484  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,484  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,484  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,484 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,496  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=1000} consistentSplits=true
2024-04-23T14:44:37,497  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:37,497  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,498  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:37,498  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:37,498  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,498  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000024_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,498  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,498  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,498  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000025_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,499  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,499  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,499  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000024_0, priority=1, startTime=0, containerId=null, uniqueId=26, localityDelayTimeout=78903352} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,499  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000024_0; false
2024-04-23T14:44:37,499  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000024_0, true
2024-04-23T14:44:37,501  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,501  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,501  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,501  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,501  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,502  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,503 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,515  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:37,516  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:37,517  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,517  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,517  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:37,517  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,517  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:37,518  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000026_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,518  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000027_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,518  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,519  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,519  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000026_0, priority=2, startTime=0, containerId=null, uniqueId=28, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,519  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000026_0; false
2024-04-23T14:44:37,519  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000026_0, true
2024-04-23T14:44:37,520  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,520  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000027_0, priority=2, startTime=0, containerId=null, uniqueId=29, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,520  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000027_0; false
2024-04-23T14:44:37,520  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000027_0, true
2024-04-23T14:44:37,520  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,522  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000028_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,522  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=2. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,522  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000029_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,522  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=2. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,523  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,523  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:44:37,524  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000027_0, priority=2, startTime=78902373, containerId=container_11111_0001_01_000005, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=29, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:37,524  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,525  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000027_0; false
2024-04-23T14:44:37,525  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000027_0, state=PREEMPTED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:44:37,526  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,526  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000028_0, priority=1, startTime=0, containerId=null, uniqueId=30, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:37,526  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000028_0; false
2024-04-23T14:44:37,526  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000028_0, true
2024-04-23T14:44:37,526  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,527  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000026_0, priority=2, startTime=78902372, containerId=container_11111_0001_01_000003, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=28, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:37,527  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,528  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000026_0; false
2024-04-23T14:44:37,528  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000026_0, state=PREEMPTED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:44:37,528  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,529  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000029_0, priority=1, startTime=0, containerId=null, uniqueId=31, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:37,529  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000029_0; false
2024-04-23T14:44:37,529  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000029_0, true
2024-04-23T14:44:37,529  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,530  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,530  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,530  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,530  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,530  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,530  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,530  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,530 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,542  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,543  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,544  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,544  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,544  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,544  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,544  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,545  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,545  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,545  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,545  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,545  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000030_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,545  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,546  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,546  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000030_0, priority=1, startTime=0, containerId=null, uniqueId=32, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,546  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000030_0; false
2024-04-23T14:44:37,546  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000030_0, true
2024-04-23T14:44:37,547  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,548  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,548  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,548  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,548  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,548  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,548  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,548 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,548  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,560  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,560  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,561  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,561  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,562  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,562  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,563  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:37,563  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000031_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,563  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,563  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000032_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,563  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,563  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,563  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000033_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,563  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=2]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,564  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,564  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000031_0, priority=1, startTime=0, containerId=null, uniqueId=33, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,564  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000031_0; false
2024-04-23T14:44:37,564  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000031_0, true
2024-04-23T14:44:37,565  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,565  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000032_0, priority=2, startTime=0, containerId=null, uniqueId=34, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,565  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000032_0; false
2024-04-23T14:44:37,565  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000032_0, true
2024-04-23T14:44:37,565  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,566  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000033_0, priority=2, startTime=0, containerId=null, uniqueId=35, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:37,566  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000033_0; false
2024-04-23T14:44:37,566  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000033_0, true
2024-04-23T14:44:37,566  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 2 (internal version -9223372036854775806); the delta to adjust by is 2
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Distributing 2 among 2 levels
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000031_0 to update
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 2
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000033_0 to update
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Distributed 2
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Sending updates to 2 tasks
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 4 (internal version -9223372036854775805); the delta to adjust by is 2
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: Distributing 2 among 1 levels
2024-04-23T14:44:37,566  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000032_0 to update
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 6 (internal version -9223372036854775804); the delta to adjust by is 2
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Setting unused to 3 based on remaining delta 2
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 5 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Setting unused to 2 based on full delta 1
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is -4
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Revoking 2 from 2 levels
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 2
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000032_0 to update - already pending
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000033_0 to update - already pending
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 2 / 2
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775801); the delta to adjust by is -1
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000031_0 to update - already pending
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:37,567  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000031_0; false
2024-04-23T14:44:37,567  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000031_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,568  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000032_0; false
2024-04-23T14:44:37,568  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000032_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,568  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000033_0; false
2024-04-23T14:44:37,568  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000033_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,568  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,568  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,568  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,568  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,568  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,568  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,568  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,568 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,579  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,580  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,581  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,581  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,581  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,581  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,581  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,581  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,581  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,582  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,582  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,582  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775807); the delta to adjust by is 1
2024-04-23T14:44:37,582  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:37,582  INFO [Time-limited test] GuaranteedTasks: Distributed 0
2024-04-23T14:44:37,582  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:37,582  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:37,582  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000034_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,582  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,582  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,583  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,583  INFO [LlapScheduler] GuaranteedTasks: Using an unused duck for attempt_1_0001_0_00_000034_0; unused is now 0
2024-04-23T14:44:37,583  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000034_0, priority=2, startTime=0, containerId=null, uniqueId=36, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000002
2024-04-23T14:44:37,583  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000034_0; true
2024-04-23T14:44:37,583  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000034_0, true
2024-04-23T14:44:37,584  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000035_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,584  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,584  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,584  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,585  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000035_0, priority=1, startTime=0, containerId=null, uniqueId=37, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000004
2024-04-23T14:44:37,585  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000035_0; true
2024-04-23T14:44:37,585  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000035_0, true
2024-04-23T14:44:37,585  INFO [LlapScheduler] GuaranteedTasks: Downgrading attempt_1_0001_0_00_000034_0
2024-04-23T14:44:37,585  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000035_0; true
2024-04-23T14:44:37,585  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000035_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,585  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:37,585  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,585  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:37,585  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000034_0 to update - already pending
2024-04-23T14:44:37,586  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000034_0; true
2024-04-23T14:44:37,586  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000034_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,586  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:37,586  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:37,586  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,586  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,586  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,586  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,586  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,586  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,586  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,586 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,597  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,598  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:37,599  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,600  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,600  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:37,600  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,600  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000036_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,600  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,600  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,600  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000037_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,601  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,601  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000038_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,601  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,601  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,601  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000036_0, priority=1, startTime=0, containerId=null, uniqueId=38, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,601  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000036_0; false
2024-04-23T14:44:37,601  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000036_0, true
2024-04-23T14:44:37,602  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,602  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000037_0, priority=1, startTime=0, containerId=null, uniqueId=39, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,602  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000037_0; false
2024-04-23T14:44:37,602  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000037_0, true
2024-04-23T14:44:37,603  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,603  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,603  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,603  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,603  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,603 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,614  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,615  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,616  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,616  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,616  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,616  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,616  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,616  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,617  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,617  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,617  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,617  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:37,617  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000039_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,617  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,617  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,618  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,618  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000039_0, priority=1, startTime=0, containerId=null, uniqueId=41, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,618  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000039_0; false
2024-04-23T14:44:37,618  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000039_0, true
2024-04-23T14:44:37,619  INFO [Time-limited test] GuaranteedTasks: Sending an update based on inconsistent state from heartbeat for attempt_1_0001_0_00_000039_0, false
2024-04-23T14:44:37,619  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000039_0, true
2024-04-23T14:44:37,619  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000039_0; false
2024-04-23T14:44:37,619  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000039_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,619  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,619  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,619  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,619  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,619  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,619  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,620  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,620  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,620 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,631  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,632  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,633  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:37,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,633  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:37,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,634  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:37,634  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,635  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,635  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000040_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,635  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,635  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000041_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,635  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,635  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000042_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,635  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,636  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,637  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000040_0, priority=1, startTime=0, containerId=null, uniqueId=42, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,637  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000040_0; false
2024-04-23T14:44:37,637  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000040_0, true
2024-04-23T14:44:37,637  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:44:37,637  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000041_0, priority=1, startTime=0, containerId=null, uniqueId=43, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,637  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000041_0; false
2024-04-23T14:44:37,637  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000041_0, true
2024-04-23T14:44:37,638  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:44:37,638  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000042_0, priority=1, startTime=0, containerId=null, uniqueId=44, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:37,638  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000042_0; false
2024-04-23T14:44:37,638  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000042_0, true
2024-04-23T14:44:37,638  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,640  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,640  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,640  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,640  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,640  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,640  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,640  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,640 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,652  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:37,652  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:37,653  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,654  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,654  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:37,654  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,654  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,654  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:37,654  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,655  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000043_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,655  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,655  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,655  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000043_0, priority=2, startTime=0, containerId=null, uniqueId=45, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,655  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000043_0; false
2024-04-23T14:44:37,656  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000043_0, true
2024-04-23T14:44:37,657  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,657  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000044_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,658  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,658  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,658  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000044_0, priority=2, startTime=0, containerId=null, uniqueId=46, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,658  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000044_0; false
2024-04-23T14:44:37,658  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000044_0, true
2024-04-23T14:44:37,658  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,659  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000045_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,659  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=2. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,660  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,662  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:44:37,662  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,662  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000043_0, priority=2, startTime=10000, containerId=container_11111_0001_01_000003, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=45, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:37,663  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,671  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,671  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,671  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,672  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,672  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,672  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:37,672  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,690  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,691  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,692  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,692  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,693  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,693  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,693  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,693  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,693  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,694  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,694  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,694  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:37,694  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000046_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,694  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,694  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,694  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000047_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,694  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,695  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,695  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000046_0, priority=1, startTime=0, containerId=null, uniqueId=48, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,695  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000046_0; false
2024-04-23T14:44:37,695  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000046_0, true
2024-04-23T14:44:37,696  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,696  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000047_0, priority=2, startTime=0, containerId=null, uniqueId=49, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,696  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000047_0; false
2024-04-23T14:44:37,696  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000047_0, true
2024-04-23T14:44:37,696  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,696  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:37,696  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:37,696  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,696  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000046_0 to update
2024-04-23T14:44:37,697  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:37,697  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:37,697  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:37,697  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000046_0; true
2024-04-23T14:44:37,697  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000046_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,697  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:37,697  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:37,697  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000047_0 to update
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000046_0, false
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000047_0, false
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000047_0, true
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels; on failure
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: Adding failed attempt_1_0001_0_00_000047_0 to update
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000047_0; true
2024-04-23T14:44:37,698  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000047_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:37,698  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:37,699  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,699  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,699  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,699  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,699  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,699  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,699  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,699 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,714  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:37,715  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:37,716  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,716  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,716  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:37,716  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,716  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,716  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:37,717  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,717  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000048_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,717  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,717  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000049_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,717  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,717  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000050_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,717  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,718  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,718  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000048_0, priority=1, startTime=0, containerId=null, uniqueId=50, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,718  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000048_0; false
2024-04-23T14:44:37,718  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000048_0, true
2024-04-23T14:44:37,719  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,719  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000049_0, priority=1, startTime=0, containerId=null, uniqueId=51, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,719  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000049_0; false
2024-04-23T14:44:37,719  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000049_0, true
2024-04-23T14:44:37,719  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,719  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,719  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,720  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,720  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,720  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,720  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,720  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,720 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,730  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=10000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,731  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,732  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,732  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,732  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,732  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,732  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,733  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,733  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,733  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,733  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,733  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000051_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,733  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,734  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,734  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000051_0, priority=1, startTime=0, containerId=null, uniqueId=53, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,734  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000051_0; false
2024-04-23T14:44:37,734  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000051_0, true
2024-04-23T14:44:37,734  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,735  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000051_0; false
2024-04-23T14:44:37,735  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000051_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:37,735  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 10000 milli-seconds. commFailure=false
2024-04-23T14:44:37,735  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000052_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,736  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,736  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host1]
2024-04-23T14:44:37,736  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000052_0, priority=1, startTime=0, containerId=null, uniqueId=54, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,736  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000052_0; false
2024-04-23T14:44:37,736  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000052_0, true
2024-04-23T14:44:37,736  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,737  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,737  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,737  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,737  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,737  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,737  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,737  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,737 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,748  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:37,749  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:37,750  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,750  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,750  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:37,750  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,750  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,750  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:37,751  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,751  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000053_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,751  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,751  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000054_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,751  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,751  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000055_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,751  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,751  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000056_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,751  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,752  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=2
2024-04-23T14:44:37,752  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000053_0, priority=1, startTime=0, containerId=null, uniqueId=58, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,752  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000053_0; false
2024-04-23T14:44:37,752  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000053_0, true
2024-04-23T14:44:37,753  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=2
2024-04-23T14:44:37,753  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000054_0, priority=1, startTime=0, containerId=null, uniqueId=59, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,753  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000054_0; false
2024-04-23T14:44:37,753  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000054_0, true
2024-04-23T14:44:37,753  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:37,753  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000055_0, priority=1, startTime=0, containerId=null, uniqueId=60, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:37,753  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000055_0; false
2024-04-23T14:44:37,754  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000055_0, true
2024-04-23T14:44:37,754  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:37,754  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000056_0, priority=1, startTime=0, containerId=null, uniqueId=61, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:37,754  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000056_0; false
2024-04-23T14:44:37,754  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000056_0, true
2024-04-23T14:44:37,754  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,763  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,763  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,764  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,764  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,764  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,764  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,764  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,764 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,777  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,778  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,778  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,779  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,779  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,779  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,779  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,779  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,780  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,780  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,780  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,780  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:37,780  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000057_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,780  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,780  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000058_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,781  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,781  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000057_0, priority=1, startTime=0, containerId=null, uniqueId=62, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,781  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000057_0; false
2024-04-23T14:44:37,781  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000057_0, true
2024-04-23T14:44:37,781  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,781  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,782  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,782  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000058_0, priority=2, startTime=0, containerId=null, uniqueId=63, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,782  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000058_0; false
2024-04-23T14:44:37,782  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000058_0, true
2024-04-23T14:44:37,782  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,783  INFO [test-update-thread] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:37,783  INFO [test-update-thread] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:37,783  INFO [test-update-thread] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,783  INFO [test-update-thread] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:37,783  INFO [test-update-thread] GuaranteedTasks: Distributed 1
2024-04-23T14:44:37,783  INFO [test-update-thread] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:37,783  INFO [test-update-thread] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:37,783  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:37,783  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:37,783  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,783  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000057_0 to update - already pending
2024-04-23T14:44:37,783  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:37,783  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:37,783  INFO [test-update-thread] GuaranteedTasks: Not sending update to attempt_1_0001_0_00_000057_0
2024-04-23T14:44:37,783  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is 1
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000057_0, true
2024-04-23T14:44:37,784  INFO [test-update-thread] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:37,784  INFO [test-update-thread] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:37,784  INFO [test-update-thread] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,784  INFO [test-update-thread] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:37,784  INFO [test-update-thread] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:37,784  INFO [test-update-thread] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is 1
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000057_0 to update - already pending
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:37,784  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:37,785  INFO [test-update-thread] GuaranteedTasks: Not sending update to attempt_1_0001_0_00_000057_0
2024-04-23T14:44:37,785  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000057_0; true
2024-04-23T14:44:37,785  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000057_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,785  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:37,785  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:37,785  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000058_0 to update
2024-04-23T14:44:37,785  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000058_0; true
2024-04-23T14:44:37,785  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000058_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,785  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:37,785  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:37,785  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,785  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,785  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,785  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,786  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,786  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,786  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,786 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,799  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:37,799  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:37,800  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,800  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:37,801  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:37,801  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,801  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000059_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,801  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,801  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,801  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000060_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,801  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,802  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:37,802  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000059_0, priority=1, startTime=0, containerId=null, uniqueId=64, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,802  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000059_0; false
2024-04-23T14:44:37,802  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000059_0, true
2024-04-23T14:44:37,803  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,803  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000060_0, priority=1, startTime=0, containerId=null, uniqueId=65, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,803  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000060_0; false
2024-04-23T14:44:37,803  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000060_0, true
2024-04-23T14:44:37,803  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,804  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,804  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,804  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,804  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,804  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,804  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,804  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,804 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,813  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,814  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,815  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,815  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,815  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,815  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,815  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,815  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,815  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,816  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,816  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,816  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:37,816  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000061_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,816  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,816  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,816  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000061_0, priority=1, startTime=0, containerId=null, uniqueId=66, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,816  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000061_0; false
2024-04-23T14:44:37,816  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000061_0, true
2024-04-23T14:44:37,817  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000061_0 to update
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000061_0 to update - already pending
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:37,817  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000061_0, false
2024-04-23T14:44:37,818  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000061_0; false
2024-04-23T14:44:37,818  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000061_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,818  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,818  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,818  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,818  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,818  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,818  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,818  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,818  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,818 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,828  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,830  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,830  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,831  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,831  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,831  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,831  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,831  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,831  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,831  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,832  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,832  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775807); the delta to adjust by is 1
2024-04-23T14:44:37,832  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:37,832  INFO [Time-limited test] GuaranteedTasks: Distributed 0
2024-04-23T14:44:37,832  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:37,832  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:37,832  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000062_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,832  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,832  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,832  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,832  INFO [LlapScheduler] GuaranteedTasks: Using an unused duck for attempt_1_0001_0_00_000062_0; unused is now 0
2024-04-23T14:44:37,832  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000062_0, priority=1, startTime=0, containerId=null, uniqueId=67, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000002
2024-04-23T14:44:37,832  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000062_0; true
2024-04-23T14:44:37,833  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000062_0, true
2024-04-23T14:44:37,833  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000063_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,833  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,833  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,833  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:37,834  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000063_0, priority=1, startTime=0, containerId=null, uniqueId=68, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,834  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000063_0; false
2024-04-23T14:44:37,834  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000063_0, true
2024-04-23T14:44:37,834  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000062_0; true
2024-04-23T14:44:37,834  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000062_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,834  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:37,834  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,834  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:37,834  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000063_0 to update
2024-04-23T14:44:37,834  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000063_0; true
2024-04-23T14:44:37,834  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000063_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:37,834  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:37,834  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:37,835  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:37,835  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:37,835  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:37,835  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,835  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:37,835  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:37,835  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:37,835 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:37,845  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=1000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:37,845  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:37,846  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:37,846  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,846  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:37,846  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:37,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:37,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:37,847  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000064_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000065_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,847  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,848  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000066_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,848  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,848  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,848  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000064_0, priority=1, startTime=0, containerId=null, uniqueId=69, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:37,848  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000064_0; false
2024-04-23T14:44:37,848  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000064_0, true
2024-04-23T14:44:37,849  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,849  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000065_0, priority=1, startTime=0, containerId=null, uniqueId=70, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:37,849  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000065_0; false
2024-04-23T14:44:37,849  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000065_0, true
2024-04-23T14:44:37,849  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host3. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:37,849  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000066_0, priority=1, startTime=0, containerId=null, uniqueId=71, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:37,849  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000066_0; false
2024-04-23T14:44:37,849  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000066_0, true
2024-04-23T14:44:37,849  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:37,851  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000064_0; false
2024-04-23T14:44:37,851  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000064_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:37,851  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:37,851  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000065_0; false
2024-04-23T14:44:37,851  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000065_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host2:0, id=host-host2, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:37,852  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000066_0; false
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000066_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host3:0, id=host-host3, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000067_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000068_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000069_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:37,852  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:37,852  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,852  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:38,852  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host3:0, id=host-host3, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:38,852  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,852  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host2:0, id=host-host2, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:38,853  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,853  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000067_0, priority=1, startTime=0, containerId=null, uniqueId=72, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:38,853  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000067_0; false
2024-04-23T14:44:38,853  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000067_0, true
2024-04-23T14:44:38,854  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,854  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000068_0, priority=1, startTime=0, containerId=null, uniqueId=73, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:38,855  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000068_0; false
2024-04-23T14:44:38,855  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000068_0, true
2024-04-23T14:44:38,855  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host3. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,855  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #6, task=TaskInfo{task=attempt_1_0001_0_00_000069_0, priority=1, startTime=0, containerId=null, uniqueId=74, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000013
2024-04-23T14:44:38,856  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000069_0; false
2024-04-23T14:44:38,856  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000069_0, true
2024-04-23T14:44:38,856  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,860  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:38,860  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:38,860  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:38,860  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,861  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:38,861  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,861  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:38,861 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:38,875  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:38,876  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:38,877  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:38,877  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:38,878  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:38,878  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000070_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000071_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000072_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000073_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000074_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,878  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=5]. runningTasks=0. totalPendingTasks=5. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,879  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,879  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000070_0, priority=1, startTime=0, containerId=null, uniqueId=75, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:38,879  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000070_0; false
2024-04-23T14:44:38,879  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000070_0, true
2024-04-23T14:44:38,879  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,880  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000071_0, priority=1, startTime=0, containerId=null, uniqueId=76, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:38,880  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000071_0; false
2024-04-23T14:44:38,880  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000071_0, true
2024-04-23T14:44:38,880  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:44:38,880  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000072_0, priority=1, startTime=0, containerId=null, uniqueId=77, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:38,880  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000072_0; false
2024-04-23T14:44:38,880  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000072_0, true
2024-04-23T14:44:38,880  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,880  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000073_0, priority=1, startTime=0, containerId=null, uniqueId=78, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:38,880  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000073_0; false
2024-04-23T14:44:38,880  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000073_0, true
2024-04-23T14:44:38,880  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,882  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000070_0; false
2024-04-23T14:44:38,882  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000070_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:38,882  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:38,882  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000074_0, priority=1, startTime=0, containerId=null, uniqueId=79, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:38,882  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000074_0; false
2024-04-23T14:44:38,882  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000074_0, true
2024-04-23T14:44:38,882  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,883  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:38,883  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:38,883  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:38,883  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,883  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:38,883  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,883  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:38,883 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:38,891  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:38,892  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:38,893  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:38,893  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:38,893  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:38,893  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,894  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:38,894  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:38,894  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:38,894  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:38,894  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,894  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000075_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,894  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,895  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:38,895  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000075_0, priority=1, startTime=0, containerId=null, uniqueId=80, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:38,895  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000075_0; false
2024-04-23T14:44:38,895  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000075_0, true
2024-04-23T14:44:38,895  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,896  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:38,896  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:38,896  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:38,896  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,896  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:38,896  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,896  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:38,896 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:38,905  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:38,905  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:38,906  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:38,906  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:38,906  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:38,907  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:38,907  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000076_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000077_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000078_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000079_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000080_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,907  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=5]. runningTasks=0. totalPendingTasks=5. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,908  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,908  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000076_0, priority=1, startTime=0, containerId=null, uniqueId=81, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:38,908  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000076_0; false
2024-04-23T14:44:38,908  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000076_0, true
2024-04-23T14:44:38,908  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,909  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000077_0, priority=1, startTime=0, containerId=null, uniqueId=82, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:38,909  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000077_0; false
2024-04-23T14:44:38,909  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000077_0, true
2024-04-23T14:44:38,909  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,909  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000079_0, priority=1, startTime=0, containerId=null, uniqueId=84, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:38,909  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000079_0; false
2024-04-23T14:44:38,909  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000079_0, true
2024-04-23T14:44:38,909  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:38,909  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000080_0, priority=1, startTime=0, containerId=null, uniqueId=85, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:38,909  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000080_0; false
2024-04-23T14:44:38,909  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000080_0, true
2024-04-23T14:44:38,910  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,911  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000076_0; false
2024-04-23T14:44:38,911  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000076_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:38,911  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:38,911  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000078_0, priority=1, startTime=0, containerId=null, uniqueId=83, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:38,911  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000078_0; false
2024-04-23T14:44:38,912  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000078_0, true
2024-04-23T14:44:38,912  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,912  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:38,912  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:38,912  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:38,912  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,912  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:38,912  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,912  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:38,912 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:38,921  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:38,921  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:38,922  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:38,923  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:38,923  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:38,923  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,923  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:38,923  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:38,923  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:38,923  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:38,923  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,924  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:38,924  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000081_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,924  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,924  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000082_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,924  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,924  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,924  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:38,924  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000081_0, priority=1, startTime=0, containerId=null, uniqueId=86, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:38,924  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000081_0; false
2024-04-23T14:44:38,924  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, true
2024-04-23T14:44:38,925  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:38,925  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000082_0, priority=1, startTime=0, containerId=null, uniqueId=87, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:38,925  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000082_0; false
2024-04-23T14:44:38,925  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000082_0, true
2024-04-23T14:44:38,925  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 2
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000082_0 to update
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000082_0, false
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000082_0, true
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels; on failure
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 2
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:38,925  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000081_0 to update - already pending
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, false
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000082_0; false
2024-04-23T14:44:38,926  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000082_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:38,926  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000083_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:38,926  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:38,926  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:38,926  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000083_0, priority=2, startTime=0, containerId=null, uniqueId=88, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:38,926  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000083_0; false
2024-04-23T14:44:38,926  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000083_0, true
2024-04-23T14:44:38,926  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is 1
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:38,926  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:38,927  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:38,927  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:38,927  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:38,927  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, false
2024-04-23T14:44:38,927  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000081_0, true
2024-04-23T14:44:38,927  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels; on failure
2024-04-23T14:44:38,927  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:38,927  INFO [Time-limited test] GuaranteedTasks: Adding failed attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:38,927  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:38,927  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:38,927  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:38,927  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,927  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:38,927  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:38,927  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:38,927 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
