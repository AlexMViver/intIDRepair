SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,088984 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@7f31245a
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=7f31245a, org.apache.logging.log4j.core.LoggerContext@3ba987b8]...
DEBUG StatusLogger Reconfiguration started for context[name=7f31245a] at URI null (org.apache.logging.log4j.core.LoggerContext@3ba987b8) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@303cf2ba
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@15a34df2
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,018088 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null, Configuration(HiveLog4j2Test), Replace=null, charset="null", alwaysWriteExceptions="null", disableAnsi="null", noConsoleNoAnsi="null", header="null", footer="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(target="SYSTEM_ERR", follow="null", direct="null", bufferedIo="null", bufferSize="null", immediateFlush="null", ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="console", Configuration(HiveLog4j2Test), Filter=null, ={})
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null, Configuration(HiveLog4j2Test), Replace=null, charset="null", alwaysWriteExceptions="null", disableAnsi="null", noConsoleNoAnsi="null", header="null", footer="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(interval="1", modulate="true", maxRandomDelay="null")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(max="30", min="null", fileIndex="null", compressionLevel="null", ={}, stopCustomActionsOnError="null", tempCompressedFilePattern="null", Configuration(HiveLog4j2Test))
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", append="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), advertise="null", advertiseURI="null", filePermissions="null", fileOwner="null", fileGroup="null", bufferedIo="null", bufferSize="null", immediateFlush="null", ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="DRFA", Configuration(HiveLog4j2Test), Filter=null, ={})
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 320777815
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T17:14:56.777-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-17:15:00.302, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-17:15:00.303, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@15a34df2 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@15a34df2
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@15a34df2 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@7530ad9c...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@7530ad9c OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@2f48b3d2
TRACE StatusLogger Reregistering context (1/1): '7f31245a' org.apache.logging.log4j.core.LoggerContext@3ba987b8
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=7f31245a] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@3ba987b8) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=7f31245a, org.apache.logging.log4j.core.LoggerContext@3ba987b8] started OK.
2024-04-23T17:15:00,405  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T17:15:00,779  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-23T17:15:00,839  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T17:15:00,840  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T17:15:00,840  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T17:15:00,840  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T17:15:00,841  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T17:15:00,841  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T17:15:00,842  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T17:15:00,842  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T17:15:00,842  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T17:15:00,842  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T17:15:00,843  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T17:15:00,925  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T17:15:00,930  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-23T17:15:01,491  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T17:15:01,495  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
2024-04-23T17:15:01,497  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T17:15:01,502  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-23T17:15:01,506  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T17:15:01,506  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-23T17:15:01,668  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
2024-04-23T17:15:01,676  INFO [main] utils.TestTxnDbUtil: Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/ql/target/tmp/junit_metastore_db;create=true
Hive Session ID = 4080a4ea-fe7a-41f7-baf2-e212126673e5
2024-04-23T17:15:02,339  INFO [main] SessionState: Hive Session ID = 4080a4ea-fe7a-41f7-baf2-e212126673e5
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:02,350  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
log4j: Trying to find [log4j.xml] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@1d75e7af.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@7f31245a class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@1d75e7af.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@7f31245a class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
log4j:WARN No appenders could be found for logger (org.apache.htrace.core.Tracer).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-23T17:15:02,690  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4080a4ea-fe7a-41f7-baf2-e212126673e5
2024-04-23T17:15:02,693  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5
2024-04-23T17:15:02,696  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4080a4ea-fe7a-41f7-baf2-e212126673e5/_tmp_space.db
2024-04-23T17:15:02,717  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=4080a4ea-fe7a-41f7-baf2-e212126673e5, clientType=HIVECLI]
2024-04-23T17:15:02,754  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T17:15:02,900  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T17:15:02,932  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T17:15:02,935  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-23T17:15:02,935  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-23T17:15:02,937  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T17:15:02,939  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-23T17:15:02,941  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T17:15:02,941  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-23T17:15:03,325  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-23T17:15:03,326  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@38cedb7d, with PersistenceManager: null will be shutdown
2024-04-23T17:15:03,353  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@38cedb7d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@45adc393 created in the thread with id: 1
2024-04-23T17:15:05,303  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@38cedb7d from thread id: 1
2024-04-23T17:15:05,315  INFO [main] metastore.HMSHandler: Setting location of default catalog, as it hasn't been done after upgrade
2024-04-23T17:15:05,341  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-23T17:15:05,384  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-23T17:15:05,404  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-23T17:15:05,407  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-23T17:15:05,486  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-23T17:15:05,491  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-23T17:15:05,492  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-23T17:15:05,495  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-23T17:15:05,499  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-23T17:15:05,501  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-23T17:15:05,502  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-23T17:15:05,505  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T17:15:05,619  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T17:15:05,648  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:05,678  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171505_d91f58ff-af1a-41b3-894b-03783084f85e): drop table if exists acidTbl
2024-04-23T17:15:06,520  INFO [main] reflections.Reflections: Reflections took 179 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T17:15:06,622  INFO [main] reflections.Reflections: Reflections took 74 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T17:15:06,700  INFO [main] reflections.Reflections: Reflections took 71 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T17:15:06,733  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T17:15:06,747  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T17:15:06,759  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:06,849  INFO [main] reflections.Reflections: Reflections took 67 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T17:15:06,885  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:06,886  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:06,889  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:06,889  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=37, isCompatibleWith_(Configuration)=2, flushCache_()=0, getValidTxns_(long)=9}
2024-04-23T17:15:06,889  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171505_d91f58ff-af1a-41b3-894b-03783084f85e); Time taken: 1.214 seconds
2024-04-23T17:15:06,892  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423171505_d91f58ff-af1a-41b3-894b-03783084f85e
2024-04-23T17:15:06,892  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:06,894  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171505_d91f58ff-af1a-41b3-894b-03783084f85e): drop table if exists acidTbl
2024-04-23T17:15:06,897  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:06,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:06,913  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:06,913  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:06,913  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171505_d91f58ff-af1a-41b3-894b-03783084f85e); Time taken: 0.019 seconds
2024-04-23T17:15:06,913  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171505_d91f58ff-af1a-41b3-894b-03783084f85e
2024-04-23T17:15:06,923  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T17:15:06,938  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:06,941  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T17:15:06,942  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:06,944  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171506_54aa8332-5648-4554-ad25-9d77993244bb): drop table if exists acidTblPart
2024-04-23T17:15:06,949  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T17:15:06,949  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T17:15:06,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:06,954  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:06,955  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:06,955  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:06,955  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=28, getValidTxns_(long)=1}
2024-04-23T17:15:06,955  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171506_54aa8332-5648-4554-ad25-9d77993244bb); Time taken: 0.011 seconds
2024-04-23T17:15:06,955  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423171506_54aa8332-5648-4554-ad25-9d77993244bb
2024-04-23T17:15:06,956  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:06,956  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171506_54aa8332-5648-4554-ad25-9d77993244bb): drop table if exists acidTblPart
2024-04-23T17:15:06,956  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:06,957  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:06,960  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:06,960  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:06,960  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171506_54aa8332-5648-4554-ad25-9d77993244bb); Time taken: 0.003 seconds
2024-04-23T17:15:06,960  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171506_54aa8332-5648-4554-ad25-9d77993244bb
2024-04-23T17:15:06,968  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T17:15:06,976  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:06,977  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T17:15:06,978  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:06,979  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171506_8e2bc105-517c-426d-9bf0-5f392ac92646): drop table if exists acidTbl2
2024-04-23T17:15:06,984  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T17:15:06,984  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T17:15:06,987  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:06,990  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:06,990  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:06,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:06,990  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=2}
2024-04-23T17:15:06,990  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171506_8e2bc105-517c-426d-9bf0-5f392ac92646); Time taken: 0.011 seconds
2024-04-23T17:15:06,990  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423171506_8e2bc105-517c-426d-9bf0-5f392ac92646
2024-04-23T17:15:06,991  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:06,991  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171506_8e2bc105-517c-426d-9bf0-5f392ac92646): drop table if exists acidTbl2
2024-04-23T17:15:06,991  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:06,992  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:06,994  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:06,994  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:06,994  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171506_8e2bc105-517c-426d-9bf0-5f392ac92646); Time taken: 0.003 seconds
2024-04-23T17:15:06,995  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171506_8e2bc105-517c-426d-9bf0-5f392ac92646
2024-04-23T17:15:07,002  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T17:15:07,010  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,010  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T17:15:07,011  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:07,012  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_ef629dde-dbc3-4926-8506-abfb148ce8a2): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:07,017  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T17:15:07,018  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T17:15:07,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:07,022  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,022  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,023  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=1}
2024-04-23T17:15:07,023  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_ef629dde-dbc3-4926-8506-abfb148ce8a2); Time taken: 0.01 seconds
2024-04-23T17:15:07,023  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423171507_ef629dde-dbc3-4926-8506-abfb148ce8a2
2024-04-23T17:15:07,023  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:07,023  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_ef629dde-dbc3-4926-8506-abfb148ce8a2): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:07,023  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:07,027  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,027  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:07,027  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_ef629dde-dbc3-4926-8506-abfb148ce8a2); Time taken: 0.004 seconds
2024-04-23T17:15:07,027  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_ef629dde-dbc3-4926-8506-abfb148ce8a2
2024-04-23T17:15:07,034  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T17:15:07,043  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,043  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T17:15:07,044  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:07,045  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_fc36bca2-d70e-4fa3-a460-2cc17d40ffe5): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:07,049  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T17:15:07,049  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T17:15:07,052  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:07,054  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,054  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,054  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,054  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=17, getValidTxns_(long)=1}
2024-04-23T17:15:07,054  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_fc36bca2-d70e-4fa3-a460-2cc17d40ffe5); Time taken: 0.009 seconds
2024-04-23T17:15:07,055  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423171507_fc36bca2-d70e-4fa3-a460-2cc17d40ffe5
2024-04-23T17:15:07,055  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:07,055  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_fc36bca2-d70e-4fa3-a460-2cc17d40ffe5): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:07,055  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,056  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:07,058  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,058  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:07,058  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_fc36bca2-d70e-4fa3-a460-2cc17d40ffe5); Time taken: 0.003 seconds
2024-04-23T17:15:07,059  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_fc36bca2-d70e-4fa3-a460-2cc17d40ffe5
2024-04-23T17:15:07,066  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T17:15:07,073  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,074  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T17:15:07,074  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:07,075  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_c07e0c5f-f72b-4a5d-b11f-28278308de02): drop table if exists nonAcidNonBucket
2024-04-23T17:15:07,080  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T17:15:07,080  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T17:15:07,082  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:07,085  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,085  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=1}
2024-04-23T17:15:07,085  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_c07e0c5f-f72b-4a5d-b11f-28278308de02); Time taken: 0.01 seconds
2024-04-23T17:15:07,085  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423171507_c07e0c5f-f72b-4a5d-b11f-28278308de02
2024-04-23T17:15:07,085  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:07,086  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_c07e0c5f-f72b-4a5d-b11f-28278308de02): drop table if exists nonAcidNonBucket
2024-04-23T17:15:07,086  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,086  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:07,088  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,088  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:07,088  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_c07e0c5f-f72b-4a5d-b11f-28278308de02); Time taken: 0.002 seconds
2024-04-23T17:15:07,089  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_c07e0c5f-f72b-4a5d-b11f-28278308de02
2024-04-23T17:15:07,096  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T17:15:07,104  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,105  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T17:15:07,105  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,107  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_9e15ead0-8d2d-44ea-8194-74b300fd84a3): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,180  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T17:15:07,180  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T17:15:07,182  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:07,184  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:07,200  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T17:15:07,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:07,250  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:07,250  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,250  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,251  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,251  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getDatabase_(String)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=16, getValidWriteIds_(List, String)=11, getValidTxns_(long)=1}
2024-04-23T17:15:07,251  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_9e15ead0-8d2d-44ea-8194-74b300fd84a3); Time taken: 0.144 seconds
2024-04-23T17:15:07,251  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423171507_9e15ead0-8d2d-44ea-8194-74b300fd84a3
2024-04-23T17:15:07,257  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171507_9e15ead0-8d2d-44ea-8194-74b300fd84a3
2024-04-23T17:15:07,303  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171507_9e15ead0-8d2d-44ea-8194-74b300fd84a3 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T17:15:07,303  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:07,305  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_9e15ead0-8d2d-44ea-8194-74b300fd84a3): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,306  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,401  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713917707, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:07,410  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtbl
2024-04-23T17:15:07,499  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,499  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=98}
2024-04-23T17:15:07,499  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_9e15ead0-8d2d-44ea-8194-74b300fd84a3); Time taken: 0.194 seconds
2024-04-23T17:15:07,499  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_9e15ead0-8d2d-44ea-8194-74b300fd84a3
2024-04-23T17:15:07,505  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T17:15:07,513  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,513  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T17:15:07,514  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,514  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_5997b240-65eb-4f13-a3d6-863ac2e0765b): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,520  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T17:15:07,520  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T17:15:07,521  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:07,522  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:07,525  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T17:15:07,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:07,527  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:07,527  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,527  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,528  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:07,528  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_5997b240-65eb-4f13-a3d6-863ac2e0765b); Time taken: 0.014 seconds
2024-04-23T17:15:07,528  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423171507_5997b240-65eb-4f13-a3d6-863ac2e0765b
2024-04-23T17:15:07,528  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171507_5997b240-65eb-4f13-a3d6-863ac2e0765b
2024-04-23T17:15:07,553  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171507_5997b240-65eb-4f13-a3d6-863ac2e0765b LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T17:15:07,553  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:07,554  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_5997b240-65eb-4f13-a3d6-863ac2e0765b): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,554  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713917707, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:07,560  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtblpart
2024-04-23T17:15:07,577  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,577  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T17:15:07,577  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_5997b240-65eb-4f13-a3d6-863ac2e0765b); Time taken: 0.023 seconds
2024-04-23T17:15:07,577  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_5997b240-65eb-4f13-a3d6-863ac2e0765b
2024-04-23T17:15:07,583  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T17:15:07,591  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,593  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T17:15:07,593  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,594  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_0c229b9c-c8dc-405d-a8f8-cd07cc6d36f9): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,599  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T17:15:07,599  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T17:15:07,601  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:07,601  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:07,604  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T17:15:07,605  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:07,606  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:07,606  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,606  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,606  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,606  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=1, commitTxn_(CommitTxnRequest)=15, getValidWriteIds_(List, String)=3, getValidTxns_(long)=2}
2024-04-23T17:15:07,607  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_0c229b9c-c8dc-405d-a8f8-cd07cc6d36f9); Time taken: 0.012 seconds
2024-04-23T17:15:07,607  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423171507_0c229b9c-c8dc-405d-a8f8-cd07cc6d36f9
2024-04-23T17:15:07,607  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171507_0c229b9c-c8dc-405d-a8f8-cd07cc6d36f9
2024-04-23T17:15:07,631  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171507_0c229b9c-c8dc-405d-a8f8-cd07cc6d36f9 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T17:15:07,631  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:07,631  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_0c229b9c-c8dc-405d-a8f8-cd07cc6d36f9): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,631  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,632  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713917707, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:07,636  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl
2024-04-23T17:15:07,660  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,660  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=28}
2024-04-23T17:15:07,660  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_0c229b9c-c8dc-405d-a8f8-cd07cc6d36f9); Time taken: 0.029 seconds
2024-04-23T17:15:07,660  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_0c229b9c-c8dc-405d-a8f8-cd07cc6d36f9
2024-04-23T17:15:07,666  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T17:15:07,675  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,675  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T17:15:07,676  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,677  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_0a9be9ef-2419-4836-a303-e670aa5ca6cd): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,682  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T17:15:07,683  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T17:15:07,685  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:07,685  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:07,689  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T17:15:07,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:07,691  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:07,691  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,691  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidWriteIds_(List, String)=4, getValidTxns_(long)=2}
2024-04-23T17:15:07,692  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_0a9be9ef-2419-4836-a303-e670aa5ca6cd); Time taken: 0.014 seconds
2024-04-23T17:15:07,692  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423171507_0a9be9ef-2419-4836-a303-e670aa5ca6cd
2024-04-23T17:15:07,692  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171507_0a9be9ef-2419-4836-a303-e670aa5ca6cd
2024-04-23T17:15:07,722  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171507_0a9be9ef-2419-4836-a303-e670aa5ca6cd LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T17:15:07,722  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:07,722  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_0a9be9ef-2419-4836-a303-e670aa5ca6cd): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,723  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713917707, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:07,728  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl2
2024-04-23T17:15:07,748  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,748  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-23T17:15:07,748  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_0a9be9ef-2419-4836-a303-e670aa5ca6cd); Time taken: 0.026 seconds
2024-04-23T17:15:07,748  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_0a9be9ef-2419-4836-a303-e670aa5ca6cd
2024-04-23T17:15:07,754  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T17:15:07,761  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,762  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T17:15:07,762  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,763  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_454027c6-8f21-4493-b74d-e7c7ee74874b): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,768  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 2
2024-04-23T17:15:07,768  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T17:15:07,770  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:07,770  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:07,773  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T17:15:07,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:07,774  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:07,775  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,775  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,775  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,775  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:07,775  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_454027c6-8f21-4493-b74d-e7c7ee74874b); Time taken: 0.012 seconds
2024-04-23T17:15:07,775  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423171507_454027c6-8f21-4493-b74d-e7c7ee74874b
2024-04-23T17:15:07,775  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171507_454027c6-8f21-4493-b74d-e7c7ee74874b
2024-04-23T17:15:07,797  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171507_454027c6-8f21-4493-b74d-e7c7ee74874b LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T17:15:07,797  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:07,798  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_454027c6-8f21-4493-b74d-e7c7ee74874b): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:07,799  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,801  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4080a4ea-fe7a-41f7-baf2-e212126673e5/_tmp_space.db/90ff4502-e80c-4865-b8eb-6215c4c41da5
2024-04-23T17:15:07,804  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,804  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=4}
2024-04-23T17:15:07,805  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_454027c6-8f21-4493-b74d-e7c7ee74874b); Time taken: 0.006 seconds
2024-04-23T17:15:07,805  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_454027c6-8f21-4493-b74d-e7c7ee74874b
2024-04-23T17:15:07,810  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T17:15:07,817  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,817  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T17:15:07,818  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,818  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_b1e02bd5-f2de-4b6e-806e-ad92bfe4398a): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,823  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 2
2024-04-23T17:15:07,823  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T17:15:07,825  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:07,825  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:07,828  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T17:15:07,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:07,830  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:07,831  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,831  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,831  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,831  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:07,831  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_b1e02bd5-f2de-4b6e-806e-ad92bfe4398a); Time taken: 0.013 seconds
2024-04-23T17:15:07,831  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423171507_b1e02bd5-f2de-4b6e-806e-ad92bfe4398a
2024-04-23T17:15:07,831  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171507_b1e02bd5-f2de-4b6e-806e-ad92bfe4398a
2024-04-23T17:15:07,862  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171507_b1e02bd5-f2de-4b6e-806e-ad92bfe4398a LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T17:15:07,862  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:07,862  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_b1e02bd5-f2de-4b6e-806e-ad92bfe4398a): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:07,862  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713917707, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:07,868  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidnonbucket
2024-04-23T17:15:07,887  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,887  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-23T17:15:07,887  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_b1e02bd5-f2de-4b6e-806e-ad92bfe4398a); Time taken: 0.025 seconds
2024-04-23T17:15:07,888  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_b1e02bd5-f2de-4b6e-806e-ad92bfe4398a
2024-04-23T17:15:07,893  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T17:15:07,903  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,903  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T17:15:07,904  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Initializing local cache in HiveMetaStoreClient...
2024-04-23T17:15:07,935  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Local cache initialized in HiveMetaStoreClient: com.github.benmanes.caffeine.cache.BoundedLocalCache$BoundedLocalManualCache@341ccfd1
2024-04-23T17:15:07,935  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T17:15:07,936  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_bd04d578-ac09-4c46-b04a-ce31df2b3f43): drop table if exists T
2024-04-23T17:15:07,940  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 2
2024-04-23T17:15:07,940  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T17:15:07,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:07,943  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,943  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,943  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=1}
2024-04-23T17:15:07,944  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_bd04d578-ac09-4c46-b04a-ce31df2b3f43); Time taken: 0.007 seconds
2024-04-23T17:15:07,944  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423171507_bd04d578-ac09-4c46-b04a-ce31df2b3f43
2024-04-23T17:15:07,944  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:07,944  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_bd04d578-ac09-4c46-b04a-ce31df2b3f43): drop table if exists T
2024-04-23T17:15:07,944  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:07,946  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,946  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:07,946  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_bd04d578-ac09-4c46-b04a-ce31df2b3f43); Time taken: 0.002 seconds
2024-04-23T17:15:07,947  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_bd04d578-ac09-4c46-b04a-ce31df2b3f43
2024-04-23T17:15:07,952  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T17:15:07,959  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,959  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T17:15:07,960  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T17:15:07,960  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_4bd164a1-a27a-4926-b0f6-229ec0f34371): drop table if exists Tstage
2024-04-23T17:15:07,963  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 3
2024-04-23T17:15:07,964  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T17:15:07,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:07,968  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:07,968  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:07,968  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:07,968  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1}
2024-04-23T17:15:07,968  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_4bd164a1-a27a-4926-b0f6-229ec0f34371); Time taken: 0.008 seconds
2024-04-23T17:15:07,968  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423171507_4bd164a1-a27a-4926-b0f6-229ec0f34371
2024-04-23T17:15:07,968  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:07,968  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_4bd164a1-a27a-4926-b0f6-229ec0f34371): drop table if exists Tstage
2024-04-23T17:15:07,969  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:07,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:07,973  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:07,973  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:07,973  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_4bd164a1-a27a-4926-b0f6-229ec0f34371); Time taken: 0.005 seconds
2024-04-23T17:15:07,973  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_4bd164a1-a27a-4926-b0f6-229ec0f34371
2024-04-23T17:15:07,981  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T17:15:07,990  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:07,990  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T17:15:07,991  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T17:15:07,992  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171507_5dbee24d-a597-4844-957f-bc8627ad7fc1): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T17:15:07,997  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 4
2024-04-23T17:15:07,997  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T17:15:07,999  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:07,999  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:08,003  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T17:15:08,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:08,004  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:08,004  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:08,005  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:08,005  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:08,005  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=18, getValidWriteIds_(List, String)=4, getValidTxns_(long)=2}
2024-04-23T17:15:08,005  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171507_5dbee24d-a597-4844-957f-bc8627ad7fc1); Time taken: 0.014 seconds
2024-04-23T17:15:08,005  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423171507_5dbee24d-a597-4844-957f-bc8627ad7fc1
2024-04-23T17:15:08,005  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171507_5dbee24d-a597-4844-957f-bc8627ad7fc1
2024-04-23T17:15:08,026  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171507_5dbee24d-a597-4844-957f-bc8627ad7fc1 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T17:15:08,026  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:08,027  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171507_5dbee24d-a597-4844-957f-bc8627ad7fc1): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T17:15:08,027  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:08,028  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713917708, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional_properties=insert_only, bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:08,031  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:08,049  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:08,049  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T17:15:08,049  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171507_5dbee24d-a597-4844-957f-bc8627ad7fc1); Time taken: 0.022 seconds
2024-04-23T17:15:08,049  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171507_5dbee24d-a597-4844-957f-bc8627ad7fc1
2024-04-23T17:15:08,054  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T17:15:08,062  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:08,062  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T17:15:08,063  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:08,064  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171508_a6346ccb-c93b-437b-98ea-e82170960aa1): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:08,070  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 6
2024-04-23T17:15:08,070  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T17:15:08,072  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:08,072  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:08,076  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T17:15:08,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:08,077  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:08,078  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:08,078  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:08,078  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:08,078  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=2, getDatabase_(String)=1, flushCache_()=1, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=3, getValidTxns_(long)=2}
2024-04-23T17:15:08,078  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171508_a6346ccb-c93b-437b-98ea-e82170960aa1); Time taken: 0.015 seconds
2024-04-23T17:15:08,078  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423171508_a6346ccb-c93b-437b-98ea-e82170960aa1
2024-04-23T17:15:08,078  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171508_a6346ccb-c93b-437b-98ea-e82170960aa1
2024-04-23T17:15:08,099  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171508_a6346ccb-c93b-437b-98ea-e82170960aa1 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T17:15:08,099  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:08,099  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171508_a6346ccb-c93b-437b-98ea-e82170960aa1): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:08,099  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:08,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713917708, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:08,104  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:08,124  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:08,124  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-23T17:15:08,124  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171508_a6346ccb-c93b-437b-98ea-e82170960aa1); Time taken: 0.025 seconds
2024-04-23T17:15:08,124  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171508_a6346ccb-c93b-437b-98ea-e82170960aa1
2024-04-23T17:15:08,131  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T17:15:08,140  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:08,140  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T17:15:08,141  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:08,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763): insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:08,151  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 7
2024-04-23T17:15:08,152  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T17:15:08,153  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:08,153  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:08,746  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T17:15:08,749  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T17:15:08,752  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T17:15:08,753  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T17:15:08,753  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T17:15:08,754  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T17:15:08,754  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T17:15:08,796  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:08,861  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:08,862  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:08,862  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:08,862  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:08,862  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:08,865  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:08,877  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:08,878  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:08,878  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T17:15:09,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:10,397  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:10,397  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:10,397  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:10,399  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:10,401  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:10,401  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:10,403  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:10,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:10,413  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:10,448  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1
2024-04-23T17:15:10,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:10,455  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:10,463  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:10,512  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:10,524  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:10,551  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:10,560  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:10,565  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T17:15:10,568  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:10,577  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:10,610  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:10,615  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T17:15:10,615  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:10,616  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:10,616  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:10,616  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T17:15:10,616  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T17:15:10,618  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:10,618  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:10,618  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:10,618  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T17:15:10,618  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:10,618  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, getNotNullConstraints_(NotNullConstraintsRequest)=3, getAllTableConstraints_(AllTableConstraintsRequest)=41, getTable_(GetTableRequest)=108, flushCache_()=1, commitTxn_(CommitTxnRequest)=17, getValidWriteIds_(List, String)=6, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=2}
2024-04-23T17:15:10,618  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763); Time taken: 2.476 seconds
2024-04-23T17:15:10,618  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763
2024-04-23T17:15:10,619  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763
2024-04-23T17:15:10,640  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T17:15:10,640  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:10,640  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763): insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:10,640  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763
2024-04-23T17:15:10,641  INFO [main] ql.Driver: Query ID = alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763
Total jobs = 1
2024-04-23T17:15:10,641  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:10,641  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:10,656  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T17:15:10,656  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T17:15:10,666  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:10,668  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T17:15:10,669  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-08_141_3844990196297285106-1/dummy_path
2024-04-23T17:15:10,766  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:10,788  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,09KB
2024-04-23T17:15:10,897  INFO [main] beanutils.FluentPropertyBeanIntrospector: Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2024-04-23T17:15:10,911  WARN [main] impl.MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-jobtracker.properties,hadoop-metrics2.properties
2024-04-23T17:15:10,921  INFO [main] impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-04-23T17:15:10,921  INFO [main] impl.MetricsSystemImpl: JobTracker metrics system started
2024-04-23T17:15:10,931  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-08_141_3844990196297285106-1/-mr-10001
2024-04-23T17:15:10,946  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:10,994  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:11,001  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:11,006  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T17:15:11,006  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T17:15:11,006  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-08_141_3844990196297285106-1/dummy_path
2024-04-23T17:15:11,006  INFO [main] io.NullRowsInputFormat$NullRowsRecordReader: Using null rows input format
2024-04-23T17:15:11,010  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:11,042  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:11,116  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1763739552_0001
2024-04-23T17:15:11,116  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:11,261  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:11,262  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:11,263  INFO [Thread-80] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:11,264  INFO [Thread-80] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:11,274  INFO [Thread-80] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:11,278  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1763739552_0001_m_000000_0
2024-04-23T17:15:11,310  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:11,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-08_141_3844990196297285106-1/dummy_path/null:0+1
2024-04-23T17:15:11,322  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:11,347  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,09KB
2024-04-23T17:15:11,354  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T17:15:11,361  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:11,363  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:11,365  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:11,365  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:11,367  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T17:15:11,368  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T17:15:11,368  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:11,369  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T17:15:11,369  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:11,370  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1763739552_0001/job_local1763739552_0001.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@72db430c
2024-04-23T17:15:11,375  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:11,375  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:11,375  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:11,389  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:11,404  INFO [LocalJobRunner Map Task Executor #0] impl.HadoopShimsPre2_7: Can't get KeyProvider for ORC encryption from hadoop.security.key.provider.path.
2024-04-23T17:15:11,408  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T17:15:11,456  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T17:15:11,461  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:11,461  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:11,461  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T17:15:11,461  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:11,461  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:11,461  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T17:15:11,461  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:11,462  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T17:15:11,462  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T17:15:11,462  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:11,462  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:11,462  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:11,462  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:11,462  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T17:15:11,501  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, 
2024-04-23T17:15:11,504  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:11,510  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1763739552_0001_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:11,511  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:11,512  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1763739552_0001_m_000000_0' done.
2024-04-23T17:15:11,513  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1763739552_0001_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=6553
		FILE: Number of bytes written=1183044
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=882900992
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6148
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:11,513  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1763739552_0001_m_000000_0
2024-04-23T17:15:11,514  INFO [Thread-80] mapred.LocalJobRunner: map task executor complete.
2024-04-23 17:15:12,284 Stage-1 map = 100%,  reduce = 0%
2024-04-23T17:15:12,284  INFO [main] exec.Task: 2024-04-23 17:15:12,284 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1763739552_0001
2024-04-23T17:15:12,287  INFO [main] exec.Task: Ended Job = job_local1763739552_0001
2024-04-23T17:15:12,320  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T17:15:12,321  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T17:15:12,321  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T17:15:12,321  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T17:15:12,321  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/-ext-10000
2024-04-23T17:15:12,322  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/-ext-10002
2024-04-23T17:15:12,328  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T17:15:12,328  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1/-ext-10000
2024-04-23T17:15:12,328  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:12,336  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:12,343  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,349  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:12,349  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:12,385  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T17:15:12,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:12,392  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,392  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T17:15:12,393  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-08_141_3844990196297285106-1/-mr-10001
2024-04-23T17:15:12,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:12,402  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,404  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T17:15:12,405  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T17:15:12,405  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:12,405  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:12,426  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T17:15:12,426  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:12,426  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=30, alter_table_(String, String, String, Table, EnvironmentContext, String)=53}
MapReduce Jobs Launched: 
2024-04-23T17:15:12,426  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:12,433  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:12,433  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:12,433  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763); Time taken: 1.786 seconds
2024-04-23T17:15:12,433  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171508_699624fc-38eb-4dfc-a2ac-7f116ba3d763
2024-04-23T17:15:12,438  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T17:15:12,445  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:12,445  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T17:15:12,446  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:12,446  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1
2024-04-23T17:15:12,446  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-08_141_3844990196297285106-1 on fs with scheme file
2024-04-23T17:15:12,446  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-08_141_3844990196297285106-1
2024-04-23T17:15:12,447  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-08_141_3844990196297285106-1 on fs with scheme file
2024-04-23T17:15:12,447  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171512_70e0a739-edee-4bca-9e5d-cc71a772002b): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:12,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:12,457  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,461  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T17:15:12,461  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T17:15:12,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:12,474  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,477  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:12,477  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:12,477  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:12,477  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:12,480  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:12,481  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:12,481  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:12,481  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=5, getTable_(GetTableRequest)=15, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:12,481  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171512_70e0a739-edee-4bca-9e5d-cc71a772002b); Time taken: 0.034 seconds
2024-04-23T17:15:12,481  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423171512_70e0a739-edee-4bca-9e5d-cc71a772002b
2024-04-23T17:15:12,481  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171512_70e0a739-edee-4bca-9e5d-cc71a772002b
2024-04-23T17:15:12,500  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171512_70e0a739-edee-4bca-9e5d-cc71a772002b LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T17:15:12,500  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:12,500  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171512_70e0a739-edee-4bca-9e5d-cc71a772002b): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:12,500  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:12,500  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:12,500  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:12,501  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:12,501  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:12,535  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:12,541  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:12,541  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:12,541  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171512_70e0a739-edee-4bca-9e5d-cc71a772002b); Time taken: 0.041 seconds
2024-04-23T17:15:12,541  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171512_70e0a739-edee-4bca-9e5d-cc71a772002b
2024-04-23T17:15:12,546  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T17:15:12,553  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:12,553  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T17:15:12,554  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:12,554  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171512_e235be7e-0e40-4a27-960b-f62c90a5b173): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:12,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:12,566  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,569  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T17:15:12,569  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T17:15:12,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:12,579  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,579  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:12,579  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:12,579  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:12,579  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:12,580  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:12,580  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:12,580  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:12,580  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getCurrentNotificationEventId_()=0, getTable_(GetTableRequest)=19, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:12,580  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171512_e235be7e-0e40-4a27-960b-f62c90a5b173); Time taken: 0.026 seconds
2024-04-23T17:15:12,580  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423171512_e235be7e-0e40-4a27-960b-f62c90a5b173
2024-04-23T17:15:12,580  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171512_e235be7e-0e40-4a27-960b-f62c90a5b173
2024-04-23T17:15:12,599  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171512_e235be7e-0e40-4a27-960b-f62c90a5b173 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T17:15:12,599  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:12,600  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171512_e235be7e-0e40-4a27-960b-f62c90a5b173): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:12,600  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:12,600  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:12,600  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:12,600  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:12,600  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:12,612  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:12,618  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:12,618  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:12,618  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171512_e235be7e-0e40-4a27-960b-f62c90a5b173); Time taken: 0.018 seconds
2024-04-23T17:15:12,618  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171512_e235be7e-0e40-4a27-960b-f62c90a5b173
2024-04-23T17:15:12,623  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T17:15:12,630  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:12,630  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T17:15:12,630  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:12,631  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171512_bc908a68-f72a-4c2d-918a-6eed1697c14b): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:12,636  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T17:15:12,636  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T17:15:12,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:12,645  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,679  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T17:15:12,680  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-23T17:15:12,684  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:12,684  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:12,684  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:12,684  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, allocateTableWriteId_(long, String, String)=12, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:12,684  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171512_bc908a68-f72a-4c2d-918a-6eed1697c14b); Time taken: 0.053 seconds
2024-04-23T17:15:12,685  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423171512_bc908a68-f72a-4c2d-918a-6eed1697c14b
2024-04-23T17:15:12,685  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171512_bc908a68-f72a-4c2d-918a-6eed1697c14b
2024-04-23T17:15:12,703  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171512_bc908a68-f72a-4c2d-918a-6eed1697c14b LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T17:15:12,703  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:12,708  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171512_bc908a68-f72a-4c2d-918a-6eed1697c14b): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:12,708  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:12,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:12,716  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:12,734  INFO [HMSHandler #0] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:12,734  INFO [HMSHandler #1] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1
2024-04-23T17:15:12,734  INFO [HMSHandler #2] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2
2024-04-23T17:15:12,775  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T17:15:12,775  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data
2024-04-23T17:15:12,776  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:12,783  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:12,806  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T17:15:12,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:12,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:12,815  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:12,823  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T17:15:12,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:12,829  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T17:15:12,883  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:12,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:12,923  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-23T17:15:12,923  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data
2024-04-23T17:15:12,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:12,932  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:12,943  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T17:15:12,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:12,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:12,951  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:12,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:12,959  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-23T17:15:12,964  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:12,964  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T17:15:12,993  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:13,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:13,018  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:13,018  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=128, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=41, getPartitionWithAuthInfo_(String, String, List, String, List)=61, validatePartitionNameCharacters_(List)=0, getValidWriteIds_(List, String)=2, add_partitions_(List, boolean, boolean)=57}
2024-04-23T17:15:13,018  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171512_bc908a68-f72a-4c2d-918a-6eed1697c14b); Time taken: 0.31 seconds
2024-04-23T17:15:13,018  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171512_bc908a68-f72a-4c2d-918a-6eed1697c14b
2024-04-23T17:15:13,024  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T17:15:13,033  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:13,033  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T17:15:13,034  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b from T order by p, a, b
2024-04-23T17:15:13,034  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158): select p, a, b from T order by p, a, b
2024-04-23T17:15:13,041  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T17:15:13,041  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T17:15:13,043  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:13,043  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:13,050  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:13,050  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:13,051  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:13,057  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:13,057  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:13,057  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:13,058  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:13,061  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:13,183  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:13,183  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:13,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:13,239  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:13,239  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:13,264  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:13,264  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:13,311  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:13,311  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:13,311  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:13,319  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-13_034_64024742919065871-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-13_034_64024742919065871-1
2024-04-23T17:15:13,351  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:13,354  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:13,355  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:13,355  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:13,365  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:13,378  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:13,379  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:13,379  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:13,399  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:13,399  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T17:15:13,399  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:13,400  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:13,400  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:13,400  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:13,400  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:13,400  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:13,400  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:13,400  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:13,400  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:13,400  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:13,400  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:13,400  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T17:15:13,403  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T17:15:13,404  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:13,404  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, listPartitions_(String, String, short)=25, getAllTableConstraints_(AllTableConstraintsRequest)=31, getTable_(GetTableRequest)=6, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=31, commitTxn_(CommitTxnRequest)=16, getValidWriteIds_(List, String)=8, getValidTxns_(long)=1}
2024-04-23T17:15:13,405  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158); Time taken: 0.37 seconds
2024-04-23T17:15:13,405  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158
2024-04-23T17:15:13,405  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158
2024-04-23T17:15:13,432  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T17:15:13,432  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:13,433  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158): select p, a, b from T order by p, a, b
2024-04-23T17:15:13,433  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158
2024-04-23T17:15:13,433  INFO [main] ql.Driver: Query ID = alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158
Total jobs = 1
2024-04-23T17:15:13,433  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:13,433  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:13,436  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:13,436  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:13,436  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:13,437  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:13,437  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:13,437  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:13,437  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:13,437  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:13,439  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:13,440  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:13,440  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:13,448  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-13_034_64024742919065871-1/-mr-10004/954ad623-cae3-457b-9916-f5fa5fd1bd13 (false)
2024-04-23T17:15:13,459  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:13,466  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,99KB
2024-04-23T17:15:13,471  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:13,474  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,14KB
2024-04-23T17:15:13,475  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:13,479  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:13,485  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:13,489  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:13,490  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:13,490  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:13,491  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:13,505  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:13,510  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: insert_only 
2024-04-23T17:15:13,510  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:13,529  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T17:15:13,529  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 24 ms
2024-04-23T17:15:13,529  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T17:15:13,560  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T17:15:13,584  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1576843313_0002
2024-04-23T17:15:13,584  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:13,659  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:13,659  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:13,660  INFO [Thread-161] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:13,660  INFO [Thread-161] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:13,663  INFO [Thread-161] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:13,663  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1576843313_0002_m_000000_0
2024-04-23T17:15:13,664  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:13,665  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:13,666  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:13,673  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,99KB
2024-04-23T17:15:13,675  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:13,694  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:13,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:13,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:13,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:13,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:13,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:13,708  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:13,709  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:13,712  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:13,713  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:13,713  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:13,715  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:13,716  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:13,726  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:13,727  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:13,727  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:13,727  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:13,727  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:13,727  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:13,728  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:13,728  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:13,728  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:13,728  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:13,728  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:13,729  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:13,729  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:13,729  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:13,729  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T17:15:13,729  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:13,748  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:13,752  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1576843313_0002_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:13,753  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:13,753  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1576843313_0002_m_000000_0' done.
2024-04-23T17:15:13,754  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1576843313_0002_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=18660
		FILE: Number of bytes written=2377724
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=957874176
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8132
2024-04-23T17:15:13,754  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1576843313_0002_m_000000_0
2024-04-23T17:15:13,754  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1576843313_0002_m_000001_0
2024-04-23T17:15:13,754  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:13,755  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:13,756  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:13,757  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,99KB
2024-04-23T17:15:13,759  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:13,760  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:13,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:13,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:13,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:13,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:13,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:13,765  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:13,765  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:13,765  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:13,766  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:13,766  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:13,766  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:13,766  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:13,767  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:13,768  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:13,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:13,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:13,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T17:15:13,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:13,776  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:13,779  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1576843313_0002_m_000001_0 is done. And is in the process of committing
2024-04-23T17:15:13,780  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:13,780  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1576843313_0002_m_000001_0' done.
2024-04-23T17:15:13,781  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1576843313_0002_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=27347
		FILE: Number of bytes written=2377814
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=957874176
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8132
2024-04-23T17:15:13,781  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1576843313_0002_m_000001_0
2024-04-23T17:15:13,781  INFO [Thread-161] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:13,783  INFO [Thread-161] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:13,784  INFO [pool-16-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1576843313_0002_r_000000_0
2024-04-23T17:15:13,787  INFO [pool-16-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:13,790  INFO [pool-16-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@38ba066e
2024-04-23T17:15:13,791  WARN [pool-16-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:13,804  INFO [pool-16-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:13,806  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1576843313_0002_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:13,832  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local1576843313_0002_m_000000_0 decomp: 54 len: 58 to MEMORY
2024-04-23T17:15:13,835  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1576843313_0002_m_000000_0
2024-04-23T17:15:13,838  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->54
2024-04-23T17:15:13,842  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local1576843313_0002_m_000001_0 decomp: 54 len: 58 to MEMORY
2024-04-23T17:15:13,842  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1576843313_0002_m_000001_0
2024-04-23T17:15:13,843  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 2, commitMemory -> 54, usedMemory ->108
2024-04-23T17:15:13,843  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:13,843  INFO [pool-16-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T17:15:13,844  INFO [pool-16-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:13,855  INFO [pool-16-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T17:15:13,855  INFO [pool-16-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 64 bytes
2024-04-23T17:15:13,858  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 108 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:13,858  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merging 1 files, 110 bytes from disk
2024-04-23T17:15:13,859  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:13,859  INFO [pool-16-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:13,859  INFO [pool-16-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 84 bytes
2024-04-23T17:15:13,860  INFO [pool-16-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T17:15:13,862  INFO [pool-16-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:13,864  INFO [pool-16-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,14KB
2024-04-23T17:15:13,865  INFO [pool-16-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:13,865  INFO [pool-16-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:13,865  INFO [pool-16-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<>>
2024-04-23T17:15:13,866  INFO [pool-16-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:13,866  INFO [pool-16-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@6a223711, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@9883a07, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2] : [int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@4eb7a2c5
2024-04-23T17:15:13,869  INFO [pool-16-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-13_034_64024742919065871-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-13_034_64024742919065871-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:13,869  INFO [pool-16-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-13_034_64024742919065871-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-13_034_64024742919065871-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:13,869  INFO [pool-16-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-13_034_64024742919065871-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-13_034_64024742919065871-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:13,892  INFO [pool-16-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:13,893  INFO [pool-16-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:13,893  INFO [pool-16-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:13,893  INFO [pool-16-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:13,893  INFO [pool-16-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T17:15:13,894  INFO [pool-16-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, 
2024-04-23T17:15:13,895  INFO [pool-16-thread-1] mapred.Task: Task:attempt_local1576843313_0002_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:13,895  INFO [pool-16-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:13,896  INFO [pool-16-thread-1] mapred.Task: Task 'attempt_local1576843313_0002_r_000000_0' done.
2024-04-23T17:15:13,896  INFO [pool-16-thread-1] mapred.Task: Final Counters for attempt_local1576843313_0002_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=34840
		FILE: Number of bytes written=2378095
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=116
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=957874176
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:13,896  INFO [pool-16-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1576843313_0002_r_000000_0
2024-04-23T17:15:13,896  INFO [Thread-161] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:14,671 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:14,671  INFO [main] exec.Task: 2024-04-23 17:15:14,671 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1576843313_0002
2024-04-23T17:15:14,677  INFO [main] exec.Task: Ended Job = job_local1576843313_0002
2024-04-23T17:15:14,684  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:14,684  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:14,685  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:14,685  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:14,685  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:14,685  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158); Time taken: 1.251 seconds
2024-04-23T17:15:14,685  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171513_df91c863-8986-4660-aa1b-2e6410846158
2024-04-23T17:15:14,696  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T17:15:14,707  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:14,708  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T17:15:14,719  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:14,741  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T17:15:14,741  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:14,741  WARN [main] ql.TestTxnAddPartition: addPartitionMMVectorized: read data(add 2 parts w/data and 1 empty vect): 
2024-04-23T17:15:14,741  INFO [main] ql.TestTxnAddPartition: 0	0	2
0	0	4
1	0	2
1	0	4

2024-04-23T17:15:14,741  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T17:15:14,741  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-13_034_64024742919065871-1
2024-04-23T17:15:14,742  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-13_034_64024742919065871-1 on fs with scheme file
2024-04-23T17:15:14,743  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171514_0fd70578-7f4b-467d-92d6-409f306ccb35): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T17:15:14,751  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T17:15:14,751  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T17:15:14,753  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:14,758  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:14,758  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:14,759  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:14,768  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:14,768  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:14,768  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:14,768  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:14,772  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:14,785  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:14,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:14,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:14,813  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:14,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:14,822  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:14,822  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:14,868  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:14,868  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:14,868  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:14,870  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:14,873  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:14,873  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:14,874  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:14,908  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:14,918  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:14,919  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:14,919  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:14,921  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:14,921  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T17:15:14,921  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:14,921  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=3, listPartitions_(String, String, short)=6, getAllTableConstraints_(AllTableConstraintsRequest)=4, getTable_(GetTableRequest)=9, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=17, commitTxn_(CommitTxnRequest)=22, getValidWriteIds_(List, String)=6, getValidTxns_(long)=1}
2024-04-23T17:15:14,922  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171514_0fd70578-7f4b-467d-92d6-409f306ccb35); Time taken: 0.178 seconds
2024-04-23T17:15:14,922  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171514_0fd70578-7f4b-467d-92d6-409f306ccb35): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T17:15:14,922  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T17:15:14,942  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:14,942  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T17:15:14,942  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171514_0fd70578-7f4b-467d-92d6-409f306ccb35); Time taken: 0.02 seconds
2024-04-23T17:15:14,942  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:14,948  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T17:15:14,955  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:14,955  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T17:15:14,957  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:14,957  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-14_743_2786262776866386673-1
2024-04-23T17:15:14,958  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-14_743_2786262776866386673-1 on fs with scheme file
2024-04-23T17:15:14,958  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171514_76dfa917-8d38-44d2-91d4-5ea11d85db52): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:14,959  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:14,965  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:14,968  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T17:15:14,969  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T17:15:14,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:14,978  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:14,978  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:14,978  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:14,978  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:14,978  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:14,978  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:14,978  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:14,979  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:14,979  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=12, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1}
2024-04-23T17:15:14,979  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171514_76dfa917-8d38-44d2-91d4-5ea11d85db52); Time taken: 0.02 seconds
2024-04-23T17:15:14,979  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423171514_76dfa917-8d38-44d2-91d4-5ea11d85db52
2024-04-23T17:15:14,979  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171514_76dfa917-8d38-44d2-91d4-5ea11d85db52
2024-04-23T17:15:14,999  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171514_76dfa917-8d38-44d2-91d4-5ea11d85db52 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T17:15:14,999  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:14,999  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171514_76dfa917-8d38-44d2-91d4-5ea11d85db52): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:14,999  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:14,999  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:14,999  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:14,999  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:14,999  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:15,011  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:15,018  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:15,018  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:15,018  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171514_76dfa917-8d38-44d2-91d4-5ea11d85db52); Time taken: 0.019 seconds
2024-04-23T17:15:15,018  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171514_76dfa917-8d38-44d2-91d4-5ea11d85db52
2024-04-23T17:15:15,023  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T17:15:15,031  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:15,031  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T17:15:15,033  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171515_414c3fae-4ffe-46cd-afa0-3f935484e7dd): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:15,038  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T17:15:15,039  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T17:15:15,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:15,050  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:15,063  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-23T17:15:15,063  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-23T17:15:15,064  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:15,064  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:15,064  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:15,064  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9, allocateTableWriteId_(long, String, String)=10, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=2}
2024-04-23T17:15:15,064  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171515_414c3fae-4ffe-46cd-afa0-3f935484e7dd); Time taken: 0.031 seconds
2024-04-23T17:15:15,064  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423171515_414c3fae-4ffe-46cd-afa0-3f935484e7dd
2024-04-23T17:15:15,064  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171515_414c3fae-4ffe-46cd-afa0-3f935484e7dd
2024-04-23T17:15:15,089  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171515_414c3fae-4ffe-46cd-afa0-3f935484e7dd LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T17:15:15,089  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:15,096  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171515_414c3fae-4ffe-46cd-afa0-3f935484e7dd): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:15,096  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:15,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:15,105  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:15,105  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:15,134 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T17:15:15,134 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T17:15:15,136 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-23T17:15:15,138 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T17:15:15,143 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T17:15:15,143  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:15,143  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T17:15:15,143  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171515_414c3fae-4ffe-46cd-afa0-3f935484e7dd); Time taken: 0.047 seconds
2024-04-23T17:15:15,143  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171515_414c3fae-4ffe-46cd-afa0-3f935484e7dd
2024-04-23T17:15:15,146  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:15,158  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:15,159  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171515_3c36ddef-bc88-414c-8919-391f9ba14ca3): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:15,164  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T17:15:15,164  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T17:15:15,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:15,175  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:15,178  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:15,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-23T17:15:15,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:15,214  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-23T17:15:15,214  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-23T17:15:15,215  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:15,215  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:15,215  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:15,215  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9, allocateTableWriteId_(long, String, String)=8, flushCache_()=0, getPartitionWithAuthInfo_(String, String, List, String, List)=20, rollbackTxn_(long)=13, getValidTxns_(long)=1}
2024-04-23T17:15:15,215  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171515_3c36ddef-bc88-414c-8919-391f9ba14ca3); Time taken: 0.056 seconds
2024-04-23T17:15:15,215  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423171515_3c36ddef-bc88-414c-8919-391f9ba14ca3
2024-04-23T17:15:15,215  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171515_3c36ddef-bc88-414c-8919-391f9ba14ca3
2024-04-23T17:15:15,242  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171515_3c36ddef-bc88-414c-8919-391f9ba14ca3 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T17:15:15,242  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:15,253  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171515_3c36ddef-bc88-414c-8919-391f9ba14ca3): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:15,253  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:15,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:15,262  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:15,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:15,271  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T17:15:15,273  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T17:15:15,274  INFO [HMSHandler #3] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3
2024-04-23T17:15:15,303  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-23T17:15:15,304  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data
2024-04-23T17:15:15,304  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:15,312  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:15,313  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:15,323  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-23T17:15:15,323  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:15,323  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:15,331  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:15,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:15,339  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-23T17:15:15,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:15,345  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-23T17:15:15,388  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:15,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:15,419  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:15,419  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=67, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=25, getPartitionWithAuthInfo_(String, String, List, String, List)=23, validatePartitionNameCharacters_(List)=0, getValidWriteIds_(List, String)=1, add_partitions_(List, boolean, boolean)=41}
2024-04-23T17:15:15,419  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171515_3c36ddef-bc88-414c-8919-391f9ba14ca3); Time taken: 0.166 seconds
2024-04-23T17:15:15,419  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171515_3c36ddef-bc88-414c-8919-391f9ba14ca3
2024-04-23T17:15:15,425  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T17:15:15,434  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:15,437  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T17:15:15,437  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b from T order by p, a, b
2024-04-23T17:15:15,438  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782): select p, a, b from T order by p, a, b
2024-04-23T17:15:15,451  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T17:15:15,452  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T17:15:15,455  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:15,455  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:15,464  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:15,464  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:15,465  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:15,473  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:15,474  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:15,474  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:15,474  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:15,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:15,523  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:15,524  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:15,567  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:15,573  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:15,573  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:15,588  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:15,588  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:15,628  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:15,628  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:15,628  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:15,630  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-15_437_7104623721822511955-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-15_437_7104623721822511955-1
2024-04-23T17:15:15,638  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:15,640  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:15,640  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:15,640  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:15,641  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:15,651  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:15,652  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:15,652  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:15,653  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:15,653  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:15,653  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:15,653  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:15,653  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T17:15:15,654  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T17:15:15,655  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:15,655  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=13, isCompatibleWith_(Configuration)=1, listPartitions_(String, String, short)=24, getAllTableConstraints_(AllTableConstraintsRequest)=39, getTable_(GetTableRequest)=9, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=20, commitTxn_(CommitTxnRequest)=17, getValidWriteIds_(List, String)=8, getValidTxns_(long)=3}
2024-04-23T17:15:15,655  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782); Time taken: 0.217 seconds
2024-04-23T17:15:15,655  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782
2024-04-23T17:15:15,656  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782
2024-04-23T17:15:15,679  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782 LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T17:15:15,679  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:15,680  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782): select p, a, b from T order by p, a, b
2024-04-23T17:15:15,680  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782
2024-04-23T17:15:15,680  INFO [main] ql.Driver: Query ID = alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782
Total jobs = 1
2024-04-23T17:15:15,680  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:15,680  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:15,685  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:15,685  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:15,686  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:15,686  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:15,686  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:15,686  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:15,686  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:15,686  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:15,689  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:15,689  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:15,689  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:15,699  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-15_437_7104623721822511955-1/-mr-10004/ab1ac861-4eff-47d5-a8d0-33e656de235b (false)
2024-04-23T17:15:15,711  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:15,713  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,35KB
2024-04-23T17:15:15,719  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:15,721  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,15KB
2024-04-23T17:15:15,722  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:15,727  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:15,737  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:15,743  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:15,744  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:15,744  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:15,744  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:15,765  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:15,765  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: insert_only 
2024-04-23T17:15:15,765  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:15,774  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-23T17:15:15,774  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 9 ms
2024-04-23T17:15:15,775  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-23T17:15:15,794  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-23T17:15:15,821  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local464170151_0003
2024-04-23T17:15:15,821  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:15,920  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:16,045  INFO [Thread-256] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:16,045  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:16,045  INFO [Thread-256] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:16,049  INFO [Thread-256] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:16,050  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local464170151_0003_m_000000_0
2024-04-23T17:15:16,050  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:16,051  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:16,052  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:16,053  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-23T17:15:16,054  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:16,056  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:16,062  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:16,062  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:16,062  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:16,062  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:16,062  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:16,063  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:16,063  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:16,064  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:16,064  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:16,064  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:16,064  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:16,065  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:16,065  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:16,065  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:16,065  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:16,065  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T17:15:16,066  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:16,078  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:16,081  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local464170151_0003_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:16,082  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:16,082  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local464170151_0003_m_000000_0' done.
2024-04-23T17:15:16,082  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local464170151_0003_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=51479
		FILE: Number of bytes written=3570927
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=965738496
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-23T17:15:16,083  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local464170151_0003_m_000000_0
2024-04-23T17:15:16,083  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local464170151_0003_m_000001_0
2024-04-23T17:15:16,083  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:16,084  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:16,084  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:16,086  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-23T17:15:16,088  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:16,089  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:16,094  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:16,095  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:16,095  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:16,095  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:16,095  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:16,096  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:16,096  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:16,096  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:16,097  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:16,097  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:16,097  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:16,097  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:16,098  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:16,099  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:16,102  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:16,102  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:16,102  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T17:15:16,102  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:16,111  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:16,115  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local464170151_0003_m_000001_0 is done. And is in the process of committing
2024-04-23T17:15:16,116  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:16,116  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local464170151_0003_m_000001_0' done.
2024-04-23T17:15:16,116  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local464170151_0003_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=61053
		FILE: Number of bytes written=3571017
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=965738496
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-23T17:15:16,116  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local464170151_0003_m_000001_0
2024-04-23T17:15:16,116  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local464170151_0003_m_000002_0
2024-04-23T17:15:16,117  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:16,118  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:16,118  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:16,120  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-23T17:15:16,122  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:16,124  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:16,131  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:16,132  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:16,132  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:16,132  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:16,132  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:16,132  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:16,133  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:16,133  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:16,134  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:16,134  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:16,134  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:16,134  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:16,135  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:16,136  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:16,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:16,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:16,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T17:15:16,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:16,146  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:16,149  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local464170151_0003_m_000002_0 is done. And is in the process of committing
2024-04-23T17:15:16,150  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:16,150  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local464170151_0003_m_000002_0' done.
2024-04-23T17:15:16,150  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local464170151_0003_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=70115
		FILE: Number of bytes written=3571107
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=965738496
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-23T17:15:16,150  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local464170151_0003_m_000002_0
2024-04-23T17:15:16,150  INFO [Thread-256] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:16,152  INFO [Thread-256] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:16,153  INFO [pool-21-thread-1] mapred.LocalJobRunner: Starting task: attempt_local464170151_0003_r_000000_0
2024-04-23T17:15:16,153  INFO [pool-21-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:16,153  INFO [pool-21-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@24209be1
2024-04-23T17:15:16,153  WARN [pool-21-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:16,154  INFO [pool-21-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:16,155  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local464170151_0003_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:16,158  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local464170151_0003_m_000000_0 decomp: 54 len: 58 to MEMORY
2024-04-23T17:15:16,158  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local464170151_0003_m_000000_0
2024-04-23T17:15:16,158  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->54
2024-04-23T17:15:16,161  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local464170151_0003_m_000001_0 decomp: 54 len: 58 to MEMORY
2024-04-23T17:15:16,161  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local464170151_0003_m_000001_0
2024-04-23T17:15:16,161  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 2, commitMemory -> 54, usedMemory ->108
2024-04-23T17:15:16,164  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local464170151_0003_m_000002_0 decomp: 54 len: 58 to MEMORY
2024-04-23T17:15:16,164  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local464170151_0003_m_000002_0
2024-04-23T17:15:16,164  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 3, commitMemory -> 108, usedMemory ->162
2024-04-23T17:15:16,164  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:16,165  INFO [pool-21-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T17:15:16,165  INFO [pool-21-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:16,171  INFO [pool-21-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-23T17:15:16,171  INFO [pool-21-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 96 bytes
2024-04-23T17:15:16,174  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 162 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:16,174  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merging 1 files, 162 bytes from disk
2024-04-23T17:15:16,174  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:16,174  INFO [pool-21-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:16,174  INFO [pool-21-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 136 bytes
2024-04-23T17:15:16,175  INFO [pool-21-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T17:15:16,175  INFO [pool-21-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:16,176  INFO [pool-21-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,15KB
2024-04-23T17:15:16,177  INFO [pool-21-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:16,177  INFO [pool-21-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:16,177  INFO [pool-21-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<>>
2024-04-23T17:15:16,177  INFO [pool-21-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:16,178  INFO [pool-21-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@68c2631a, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@6b16d464, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2] : [int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@284a24d9
2024-04-23T17:15:16,178  INFO [pool-21-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-15_437_7104623721822511955-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-15_437_7104623721822511955-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:16,178  INFO [pool-21-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-15_437_7104623721822511955-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-15_437_7104623721822511955-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:16,178  INFO [pool-21-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-15_437_7104623721822511955-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-15_437_7104623721822511955-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:16,186  INFO [pool-21-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:16,187  INFO [pool-21-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:16,187  INFO [pool-21-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:16,187  INFO [pool-21-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:16,187  INFO [pool-21-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-23T17:15:16,188  INFO [pool-21-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, 
2024-04-23T17:15:16,188  INFO [pool-21-thread-1] mapred.Task: Task:attempt_local464170151_0003_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:16,191  INFO [pool-21-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:16,191  INFO [pool-21-thread-1] mapred.Task: Task 'attempt_local464170151_0003_r_000000_0' done.
2024-04-23T17:15:16,191  INFO [pool-21-thread-1] mapred.Task: Final Counters for attempt_local464170151_0003_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=77765
		FILE: Number of bytes written=3571476
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=174
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=965738496
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:16,191  INFO [pool-21-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local464170151_0003_r_000000_0
2024-04-23T17:15:16,191  INFO [Thread-256] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:17,063 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:17,064  INFO [main] exec.Task: 2024-04-23 17:15:17,063 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local464170151_0003
2024-04-23T17:15:17,068  INFO [main] exec.Task: Ended Job = job_local464170151_0003
2024-04-23T17:15:17,070  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,070  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:17,070  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:17,070  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:17,070  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:17,070  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782); Time taken: 1.39 seconds
2024-04-23T17:15:17,071  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171515_c665c119-01d6-44e8-816d-d49afa366782
2024-04-23T17:15:17,075  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T17:15:17,082  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,082  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T17:15:17,086  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:17,087  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T17:15:17,087  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:17,087  WARN [main] ql.TestTxnAddPartition: addPartitionMMVectorized: read data(add 2 existing parts and 1 empty vect): 
2024-04-23T17:15:17,087  INFO [main] ql.TestTxnAddPartition: 0	0	2
0	0	4
1	0	2
1	0	4
3	0	2
3	0	4

2024-04-23T17:15:17,087  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T17:15:17,087  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-15_437_7104623721822511955-1
2024-04-23T17:15:17,088  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-15_437_7104623721822511955-1 on fs with scheme file
2024-04-23T17:15:17,088  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_ba9cbec9-07ea-4780-b13b-64abbb4a894a): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T17:15:17,091  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-23T17:15:17,092  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T17:15:17,093  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:17,096  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:17,096  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:17,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:17,103  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,103  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:17,103  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:17,103  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:17,106  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:17,115  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:17,115  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:17,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:17,145  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,145  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:17,151  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:17,151  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:17,181  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:17,181  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:17,181  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:17,184  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:17,185  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:17,185  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:17,185  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:17,204  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:17,214  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:17,215  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:17,215  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:17,215  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:17,216  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:17,216  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:17,216  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,216  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T17:15:17,216  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,216  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=4, getAllTableConstraints_(AllTableConstraintsRequest)=3, getTable_(GetTableRequest)=6, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=15, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=5, getValidTxns_(long)=1}
2024-04-23T17:15:17,216  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_ba9cbec9-07ea-4780-b13b-64abbb4a894a); Time taken: 0.128 seconds
2024-04-23T17:15:17,216  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_ba9cbec9-07ea-4780-b13b-64abbb4a894a): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T17:15:17,217  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T17:15:17,226  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,226  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T17:15:17,226  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_ba9cbec9-07ea-4780-b13b-64abbb4a894a); Time taken: 0.01 seconds
2024-04-23T17:15:17,226  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:17,232  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T17:15:17,238  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,238  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T17:15:17,239  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:17,239  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-17_088_6696780479585027436-1
2024-04-23T17:15:17,240  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4080a4ea-fe7a-41f7-baf2-e212126673e5/hive_2024-04-23_17-15-17_088_6696780479585027436-1 on fs with scheme file
2024-04-23T17:15:17,240  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_0f4764c1-dd74-429c-9684-1424b61c6b83): drop table if exists acidTbl
2024-04-23T17:15:17,243  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-23T17:15:17,243  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T17:15:17,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:17,248  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,249  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,249  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,249  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,249  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:17,249  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_0f4764c1-dd74-429c-9684-1424b61c6b83); Time taken: 0.009 seconds
2024-04-23T17:15:17,249  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423171517_0f4764c1-dd74-429c-9684-1424b61c6b83
2024-04-23T17:15:17,249  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171517_0f4764c1-dd74-429c-9684-1424b61c6b83
2024-04-23T17:15:17,266  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171517_0f4764c1-dd74-429c-9684-1424b61c6b83 LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T17:15:17,267  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:17,267  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_0f4764c1-dd74-429c-9684-1424b61c6b83): drop table if exists acidTbl
2024-04-23T17:15:17,267  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,267  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:17,271  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,272  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:17,276  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,276  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:17,412  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,412  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=139, getTable_(GetTableRequest)=4}
2024-04-23T17:15:17,412  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_0f4764c1-dd74-429c-9684-1424b61c6b83); Time taken: 0.144 seconds
2024-04-23T17:15:17,412  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_0f4764c1-dd74-429c-9684-1424b61c6b83
2024-04-23T17:15:17,416  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T17:15:17,422  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,423  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T17:15:17,423  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:17,424  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_e58ef687-5aa7-4db8-83e4-7fefe6fd9969): drop table if exists acidTblPart
2024-04-23T17:15:17,427  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-23T17:15:17,427  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-23T17:15:17,428  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:17,447  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,447  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,447  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,447  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,447  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=19, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:17,447  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_e58ef687-5aa7-4db8-83e4-7fefe6fd9969); Time taken: 0.023 seconds
2024-04-23T17:15:17,447  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240423171517_e58ef687-5aa7-4db8-83e4-7fefe6fd9969
2024-04-23T17:15:17,448  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171517_e58ef687-5aa7-4db8-83e4-7fefe6fd9969
2024-04-23T17:15:17,470  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171517_e58ef687-5aa7-4db8-83e4-7fefe6fd9969 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T17:15:17,470  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:17,470  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_e58ef687-5aa7-4db8-83e4-7fefe6fd9969): drop table if exists acidTblPart
2024-04-23T17:15:17,470  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,470  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:17,474  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:17,478  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:17,510  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,510  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=35, getTable_(GetTableRequest)=4}
2024-04-23T17:15:17,510  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_e58ef687-5aa7-4db8-83e4-7fefe6fd9969); Time taken: 0.039 seconds
2024-04-23T17:15:17,510  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_e58ef687-5aa7-4db8-83e4-7fefe6fd9969
2024-04-23T17:15:17,514  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-23T17:15:17,521  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,521  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-23T17:15:17,522  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:17,522  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_30f08ecc-2fdd-490c-9321-b3408fc2541a): drop table if exists acidTbl2
2024-04-23T17:15:17,525  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-23T17:15:17,525  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-23T17:15:17,526  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,526  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,526  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,526  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:17,526  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_30f08ecc-2fdd-490c-9321-b3408fc2541a); Time taken: 0.004 seconds
2024-04-23T17:15:17,527  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240423171517_30f08ecc-2fdd-490c-9321-b3408fc2541a
2024-04-23T17:15:17,527  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:17,527  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_30f08ecc-2fdd-490c-9321-b3408fc2541a): drop table if exists acidTbl2
2024-04-23T17:15:17,527  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,527  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T17:15:17,528  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-23T17:15:17,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_30f08ecc-2fdd-490c-9321-b3408fc2541a); Time taken: 0.001 seconds
2024-04-23T17:15:17,528  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_30f08ecc-2fdd-490c-9321-b3408fc2541a
2024-04-23T17:15:17,534  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-23T17:15:17,540  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,541  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-23T17:15:17,541  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:17,541  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_03257f76-1c36-4f12-bfa0-f14237ec0c2d): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:17,544  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-23T17:15:17,545  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-23T17:15:17,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:17,563  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,563  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,563  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,564  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,564  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=17, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:17,564  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_03257f76-1c36-4f12-bfa0-f14237ec0c2d); Time taken: 0.023 seconds
2024-04-23T17:15:17,564  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240423171517_03257f76-1c36-4f12-bfa0-f14237ec0c2d
2024-04-23T17:15:17,564  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171517_03257f76-1c36-4f12-bfa0-f14237ec0c2d
2024-04-23T17:15:17,582  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171517_03257f76-1c36-4f12-bfa0-f14237ec0c2d LockResponse(lockid:20, state:ACQUIRED)
2024-04-23T17:15:17,582  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:17,582  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_03257f76-1c36-4f12-bfa0-f14237ec0c2d): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:17,582  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:17,588  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,588  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:17,593  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,594  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:17,642  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,642  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=54, getTable_(GetTableRequest)=6}
2024-04-23T17:15:17,642  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_03257f76-1c36-4f12-bfa0-f14237ec0c2d); Time taken: 0.06 seconds
2024-04-23T17:15:17,642  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_03257f76-1c36-4f12-bfa0-f14237ec0c2d
2024-04-23T17:15:17,647  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-23T17:15:17,654  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,654  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-23T17:15:17,655  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:17,655  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_10a78b5d-48d9-40bb-b3bd-9b94fb71b568): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:17,658  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-23T17:15:17,658  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-23T17:15:17,660  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:17,666  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,666  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,666  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,666  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,666  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=7, flushCache_()=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T17:15:17,666  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_10a78b5d-48d9-40bb-b3bd-9b94fb71b568); Time taken: 0.011 seconds
2024-04-23T17:15:17,667  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240423171517_10a78b5d-48d9-40bb-b3bd-9b94fb71b568
2024-04-23T17:15:17,667  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171517_10a78b5d-48d9-40bb-b3bd-9b94fb71b568
2024-04-23T17:15:17,686  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171517_10a78b5d-48d9-40bb-b3bd-9b94fb71b568 LockResponse(lockid:21, state:ACQUIRED)
2024-04-23T17:15:17,686  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:17,686  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_10a78b5d-48d9-40bb-b3bd-9b94fb71b568): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:17,686  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,687  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:17,694  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,695  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:17,702  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,702  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:17,725  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,725  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=31, getTable_(GetTableRequest)=8}
2024-04-23T17:15:17,725  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_10a78b5d-48d9-40bb-b3bd-9b94fb71b568); Time taken: 0.039 seconds
2024-04-23T17:15:17,725  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_10a78b5d-48d9-40bb-b3bd-9b94fb71b568
2024-04-23T17:15:17,729  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-23T17:15:17,736  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,737  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-23T17:15:17,737  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:17,738  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_229793c5-0636-45d9-9b68-e045e36f450d): drop table if exists nonAcidNonBucket
2024-04-23T17:15:17,741  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-23T17:15:17,741  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-23T17:15:17,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:17,749  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,749  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,749  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,749  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,749  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=7, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:17,749  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_229793c5-0636-45d9-9b68-e045e36f450d); Time taken: 0.011 seconds
2024-04-23T17:15:17,749  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240423171517_229793c5-0636-45d9-9b68-e045e36f450d
2024-04-23T17:15:17,750  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171517_229793c5-0636-45d9-9b68-e045e36f450d
2024-04-23T17:15:17,767  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171517_229793c5-0636-45d9-9b68-e045e36f450d LockResponse(lockid:22, state:ACQUIRED)
2024-04-23T17:15:17,767  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:17,767  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_229793c5-0636-45d9-9b68-e045e36f450d): drop table if exists nonAcidNonBucket
2024-04-23T17:15:17,768  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:17,773  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:17,779  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:17,779  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:17,801  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,801  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=28, getTable_(GetTableRequest)=5}
2024-04-23T17:15:17,801  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_229793c5-0636-45d9-9b68-e045e36f450d); Time taken: 0.034 seconds
2024-04-23T17:15:17,801  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_229793c5-0636-45d9-9b68-e045e36f450d
2024-04-23T17:15:17,806  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-23T17:15:17,813  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,813  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-23T17:15:17,814  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T17:15:17,895  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T17:15:17,895  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T17:15:17,895  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T17:15:17,895  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T17:15:17,895  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T17:15:17,895  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T17:15:17,896  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T17:15:17,896  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T17:15:17,896  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T17:15:17,896  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T17:15:17,896  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T17:15:17,898  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 0fc47427-43a2-4148-aad5-d480268957f0
2024-04-23T17:15:17,901  INFO [main] SessionState: Hive Session ID = 0fc47427-43a2-4148-aad5-d480268957f0
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:17,901  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:17,907  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0fc47427-43a2-4148-aad5-d480268957f0
2024-04-23T17:15:17,910  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0
2024-04-23T17:15:17,912  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0fc47427-43a2-4148-aad5-d480268957f0/_tmp_space.db
2024-04-23T17:15:17,913  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=0fc47427-43a2-4148-aad5-d480268957f0, clientType=HIVECLI]
2024-04-23T17:15:17,913  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:17,914  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_48a601b2-3731-4252-8771-5551e1e7fc5f): drop table if exists acidTbl
2024-04-23T17:15:17,922  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T17:15:17,923  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T17:15:17,926  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:17,927  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,928  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,928  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,928  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=9, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=2}
2024-04-23T17:15:17,928  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_48a601b2-3731-4252-8771-5551e1e7fc5f); Time taken: 0.015 seconds
2024-04-23T17:15:17,928  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423171517_48a601b2-3731-4252-8771-5551e1e7fc5f
2024-04-23T17:15:17,928  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:17,928  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_48a601b2-3731-4252-8771-5551e1e7fc5f): drop table if exists acidTbl
2024-04-23T17:15:17,928  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,928  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:17,930  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,930  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:17,930  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_48a601b2-3731-4252-8771-5551e1e7fc5f); Time taken: 0.002 seconds
2024-04-23T17:15:17,930  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_48a601b2-3731-4252-8771-5551e1e7fc5f
2024-04-23T17:15:17,937  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T17:15:17,944  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,944  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T17:15:17,945  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:17,945  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_84e20aa2-1385-4874-89e2-79452fa68cf9): drop table if exists acidTblPart
2024-04-23T17:15:17,948  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T17:15:17,949  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T17:15:17,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:17,951  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,951  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=0}
2024-04-23T17:15:17,952  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_84e20aa2-1385-4874-89e2-79452fa68cf9); Time taken: 0.007 seconds
2024-04-23T17:15:17,952  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423171517_84e20aa2-1385-4874-89e2-79452fa68cf9
2024-04-23T17:15:17,952  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:17,952  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_84e20aa2-1385-4874-89e2-79452fa68cf9): drop table if exists acidTblPart
2024-04-23T17:15:17,952  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,953  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:17,954  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,954  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:17,954  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_84e20aa2-1385-4874-89e2-79452fa68cf9); Time taken: 0.002 seconds
2024-04-23T17:15:17,954  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_84e20aa2-1385-4874-89e2-79452fa68cf9
2024-04-23T17:15:17,960  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T17:15:17,966  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,967  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T17:15:17,967  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:17,967  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_b2c65855-b8b2-4576-97e7-adf46f92ec97): drop table if exists acidTbl2
2024-04-23T17:15:17,970  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T17:15:17,971  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T17:15:17,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:17,973  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,973  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,973  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,973  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T17:15:17,973  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_b2c65855-b8b2-4576-97e7-adf46f92ec97); Time taken: 0.006 seconds
2024-04-23T17:15:17,974  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423171517_b2c65855-b8b2-4576-97e7-adf46f92ec97
2024-04-23T17:15:17,974  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:17,974  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_b2c65855-b8b2-4576-97e7-adf46f92ec97): drop table if exists acidTbl2
2024-04-23T17:15:17,974  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:17,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,976  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:17,976  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_b2c65855-b8b2-4576-97e7-adf46f92ec97); Time taken: 0.002 seconds
2024-04-23T17:15:17,976  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_b2c65855-b8b2-4576-97e7-adf46f92ec97
2024-04-23T17:15:17,982  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T17:15:17,988  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:17,989  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T17:15:17,989  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:17,989  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171517_6c3c3cba-0d84-4e2d-8c66-d4401b34df3d): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:17,992  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T17:15:17,993  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T17:15:17,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:17,995  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:17,995  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:17,995  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:17,995  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1}
2024-04-23T17:15:17,995  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171517_6c3c3cba-0d84-4e2d-8c66-d4401b34df3d); Time taken: 0.006 seconds
2024-04-23T17:15:17,996  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423171517_6c3c3cba-0d84-4e2d-8c66-d4401b34df3d
2024-04-23T17:15:17,996  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:17,996  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171517_6c3c3cba-0d84-4e2d-8c66-d4401b34df3d): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:17,996  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:17,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:17,998  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:17,998  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:17,998  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171517_6c3c3cba-0d84-4e2d-8c66-d4401b34df3d); Time taken: 0.002 seconds
2024-04-23T17:15:17,998  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171517_6c3c3cba-0d84-4e2d-8c66-d4401b34df3d
2024-04-23T17:15:18,003  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T17:15:18,009  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,009  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T17:15:18,009  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:18,010  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_6f9b5bf0-cf10-4476-9a03-95d7ecebf5e0): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:18,012  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T17:15:18,013  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T17:15:18,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:18,015  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,015  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,015  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,015  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T17:15:18,015  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_6f9b5bf0-cf10-4476-9a03-95d7ecebf5e0); Time taken: 0.005 seconds
2024-04-23T17:15:18,015  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423171518_6f9b5bf0-cf10-4476-9a03-95d7ecebf5e0
2024-04-23T17:15:18,015  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:18,016  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_6f9b5bf0-cf10-4476-9a03-95d7ecebf5e0): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:18,016  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:18,018  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,018  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:18,018  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_6f9b5bf0-cf10-4476-9a03-95d7ecebf5e0); Time taken: 0.002 seconds
2024-04-23T17:15:18,018  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_6f9b5bf0-cf10-4476-9a03-95d7ecebf5e0
2024-04-23T17:15:18,024  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T17:15:18,030  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,030  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T17:15:18,031  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:18,031  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_7ef5ac9c-1288-475d-bc70-572ec9e220e8): drop table if exists nonAcidNonBucket
2024-04-23T17:15:18,034  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T17:15:18,034  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T17:15:18,035  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:18,036  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,036  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,037  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1}
2024-04-23T17:15:18,037  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_7ef5ac9c-1288-475d-bc70-572ec9e220e8); Time taken: 0.006 seconds
2024-04-23T17:15:18,037  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423171518_7ef5ac9c-1288-475d-bc70-572ec9e220e8
2024-04-23T17:15:18,037  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:18,037  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_7ef5ac9c-1288-475d-bc70-572ec9e220e8): drop table if exists nonAcidNonBucket
2024-04-23T17:15:18,037  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,037  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:18,039  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,039  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:18,039  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_7ef5ac9c-1288-475d-bc70-572ec9e220e8); Time taken: 0.002 seconds
2024-04-23T17:15:18,039  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_7ef5ac9c-1288-475d-bc70-572ec9e220e8
2024-04-23T17:15:18,044  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T17:15:18,050  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,051  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T17:15:18,051  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,051  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_579e8cf8-c735-4145-8963-92111ab96842): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,055  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T17:15:18,055  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T17:15:18,056  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,056  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,063  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T17:15:18,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:18,064  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:18,064  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,064  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,064  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,064  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=6, getValidTxns_(long)=0}
2024-04-23T17:15:18,064  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_579e8cf8-c735-4145-8963-92111ab96842); Time taken: 0.013 seconds
2024-04-23T17:15:18,064  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423171518_579e8cf8-c735-4145-8963-92111ab96842
2024-04-23T17:15:18,065  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_579e8cf8-c735-4145-8963-92111ab96842
2024-04-23T17:15:18,086  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_579e8cf8-c735-4145-8963-92111ab96842 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T17:15:18,086  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:18,087  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_579e8cf8-c735-4145-8963-92111ab96842): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,087  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,088  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713917718, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:18,091  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtbl
2024-04-23T17:15:18,130  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,130  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=42}
2024-04-23T17:15:18,130  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_579e8cf8-c735-4145-8963-92111ab96842); Time taken: 0.043 seconds
2024-04-23T17:15:18,131  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_579e8cf8-c735-4145-8963-92111ab96842
2024-04-23T17:15:18,135  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T17:15:18,141  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,142  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T17:15:18,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_9092e852-cfd2-4a44-957d-756436443e44): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,147  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T17:15:18,147  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T17:15:18,148  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,148  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,151  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T17:15:18,151  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:18,152  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:18,152  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,152  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,152  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,152  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:18,153  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_9092e852-cfd2-4a44-957d-756436443e44); Time taken: 0.01 seconds
2024-04-23T17:15:18,153  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423171518_9092e852-cfd2-4a44-957d-756436443e44
2024-04-23T17:15:18,153  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_9092e852-cfd2-4a44-957d-756436443e44
2024-04-23T17:15:18,170  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_9092e852-cfd2-4a44-957d-756436443e44 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T17:15:18,170  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:18,170  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_9092e852-cfd2-4a44-957d-756436443e44): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,171  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713917718, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:18,174  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtblpart
2024-04-23T17:15:18,186  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,186  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=15}
2024-04-23T17:15:18,186  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_9092e852-cfd2-4a44-957d-756436443e44); Time taken: 0.016 seconds
2024-04-23T17:15:18,186  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_9092e852-cfd2-4a44-957d-756436443e44
2024-04-23T17:15:18,190  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T17:15:18,197  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,197  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T17:15:18,198  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,198  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_2797f8d3-8a85-4046-ad4f-f6473a192036): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,201  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T17:15:18,201  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T17:15:18,202  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,202  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,206  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T17:15:18,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:18,207  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:18,208  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,208  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,208  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0}
2024-04-23T17:15:18,208  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_2797f8d3-8a85-4046-ad4f-f6473a192036); Time taken: 0.01 seconds
2024-04-23T17:15:18,208  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423171518_2797f8d3-8a85-4046-ad4f-f6473a192036
2024-04-23T17:15:18,208  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_2797f8d3-8a85-4046-ad4f-f6473a192036
2024-04-23T17:15:18,225  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_2797f8d3-8a85-4046-ad4f-f6473a192036 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T17:15:18,225  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:18,225  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_2797f8d3-8a85-4046-ad4f-f6473a192036): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,225  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,226  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713917718, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:18,229  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl
2024-04-23T17:15:18,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=15}
2024-04-23T17:15:18,241  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_2797f8d3-8a85-4046-ad4f-f6473a192036); Time taken: 0.016 seconds
2024-04-23T17:15:18,241  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_2797f8d3-8a85-4046-ad4f-f6473a192036
2024-04-23T17:15:18,246  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T17:15:18,252  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,253  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T17:15:18,253  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,254  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_6777082b-a71b-45a8-a916-0863bf294062): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,257  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T17:15:18,257  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T17:15:18,258  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,258  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,262  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T17:15:18,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:18,264  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:18,264  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,264  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,264  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,264  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1}
2024-04-23T17:15:18,264  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_6777082b-a71b-45a8-a916-0863bf294062); Time taken: 0.01 seconds
2024-04-23T17:15:18,264  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423171518_6777082b-a71b-45a8-a916-0863bf294062
2024-04-23T17:15:18,264  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_6777082b-a71b-45a8-a916-0863bf294062
2024-04-23T17:15:18,282  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_6777082b-a71b-45a8-a916-0863bf294062 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T17:15:18,282  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:18,282  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_6777082b-a71b-45a8-a916-0863bf294062): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,282  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713917718, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:18,286  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl2
2024-04-23T17:15:18,297  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,297  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=14}
2024-04-23T17:15:18,297  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_6777082b-a71b-45a8-a916-0863bf294062); Time taken: 0.015 seconds
2024-04-23T17:15:18,297  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_6777082b-a71b-45a8-a916-0863bf294062
2024-04-23T17:15:18,302  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T17:15:18,309  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,309  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T17:15:18,309  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,310  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_4e7b661a-4e7f-485a-8c28-5e05dde1a571): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,313  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T17:15:18,314  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T17:15:18,315  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,315  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,318  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T17:15:18,318  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:18,319  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:18,319  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,319  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,319  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,319  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:18,319  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_4e7b661a-4e7f-485a-8c28-5e05dde1a571); Time taken: 0.009 seconds
2024-04-23T17:15:18,319  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423171518_4e7b661a-4e7f-485a-8c28-5e05dde1a571
2024-04-23T17:15:18,320  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_4e7b661a-4e7f-485a-8c28-5e05dde1a571
2024-04-23T17:15:18,339  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_4e7b661a-4e7f-485a-8c28-5e05dde1a571 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T17:15:18,339  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:18,340  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_4e7b661a-4e7f-485a-8c28-5e05dde1a571): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:18,340  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,341  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0fc47427-43a2-4148-aad5-d480268957f0/_tmp_space.db/5bcf4c9b-8f9e-470b-b082-4cd6116ecff9
2024-04-23T17:15:18,344  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,344  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T17:15:18,344  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_4e7b661a-4e7f-485a-8c28-5e05dde1a571); Time taken: 0.004 seconds
2024-04-23T17:15:18,344  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_4e7b661a-4e7f-485a-8c28-5e05dde1a571
2024-04-23T17:15:18,348  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T17:15:18,354  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,355  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T17:15:18,355  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,355  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_a5ec0581-4057-4885-acdc-5222e533c0a3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,359  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T17:15:18,359  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T17:15:18,360  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,360  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,363  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T17:15:18,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:18,364  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:18,364  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,364  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,364  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,364  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:18,364  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_a5ec0581-4057-4885-acdc-5222e533c0a3); Time taken: 0.009 seconds
2024-04-23T17:15:18,365  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423171518_a5ec0581-4057-4885-acdc-5222e533c0a3
2024-04-23T17:15:18,365  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_a5ec0581-4057-4885-acdc-5222e533c0a3
2024-04-23T17:15:18,382  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_a5ec0581-4057-4885-acdc-5222e533c0a3 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T17:15:18,382  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:18,383  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_a5ec0581-4057-4885-acdc-5222e533c0a3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:18,383  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713917718, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:18,387  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidnonbucket
2024-04-23T17:15:18,401  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,401  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=17}
2024-04-23T17:15:18,401  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_a5ec0581-4057-4885-acdc-5222e533c0a3); Time taken: 0.018 seconds
2024-04-23T17:15:18,402  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_a5ec0581-4057-4885-acdc-5222e533c0a3
2024-04-23T17:15:18,407  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T17:15:18,415  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,415  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T17:15:18,415  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T17:15:18,416  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_8f65e3cd-18a7-4c22-8a02-95c71977bce6): drop table if exists T
2024-04-23T17:15:18,419  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T17:15:18,419  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T17:15:18,420  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:18,453  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,454  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,454  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,454  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,454  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=33, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1}
2024-04-23T17:15:18,454  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_8f65e3cd-18a7-4c22-8a02-95c71977bce6); Time taken: 0.038 seconds
2024-04-23T17:15:18,454  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423171518_8f65e3cd-18a7-4c22-8a02-95c71977bce6
2024-04-23T17:15:18,454  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_8f65e3cd-18a7-4c22-8a02-95c71977bce6
2024-04-23T17:15:18,477  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_8f65e3cd-18a7-4c22-8a02-95c71977bce6 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T17:15:18,477  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:18,477  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_8f65e3cd-18a7-4c22-8a02-95c71977bce6): drop table if exists T
2024-04-23T17:15:18,477  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:18,482  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:18,487  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T17:15:18,633  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t does not exist; Force to delete it.
2024-04-23T17:15:18,634 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:18,634  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,634  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=152, getTable_(GetTableRequest)=5}
2024-04-23T17:15:18,634  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_8f65e3cd-18a7-4c22-8a02-95c71977bce6); Time taken: 0.157 seconds
2024-04-23T17:15:18,634  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_8f65e3cd-18a7-4c22-8a02-95c71977bce6
2024-04-23T17:15:18,639  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T17:15:18,647  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,649  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T17:15:18,650  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T17:15:18,650  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_5864c153-36cb-42e5-92a8-620b2ed50546): drop table if exists Tstage
2024-04-23T17:15:18,663  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T17:15:18,663  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T17:15:18,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:18,674  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,674  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,674  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,674  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,674  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=12, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=3}
2024-04-23T17:15:18,674  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_5864c153-36cb-42e5-92a8-620b2ed50546); Time taken: 0.024 seconds
2024-04-23T17:15:18,675  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423171518_5864c153-36cb-42e5-92a8-620b2ed50546
2024-04-23T17:15:18,675  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_5864c153-36cb-42e5-92a8-620b2ed50546
2024-04-23T17:15:18,700  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_5864c153-36cb-42e5-92a8-620b2ed50546 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T17:15:18,700  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:18,700  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_5864c153-36cb-42e5-92a8-620b2ed50546): drop table if exists Tstage
2024-04-23T17:15:18,700  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:18,706  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:18,712  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,713  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T17:15:18,737  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage does not exist; Force to delete it.
2024-04-23T17:15:18,737 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:18,738  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,738  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=32, getTable_(GetTableRequest)=6}
2024-04-23T17:15:18,738  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_5864c153-36cb-42e5-92a8-620b2ed50546); Time taken: 0.038 seconds
2024-04-23T17:15:18,738  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_5864c153-36cb-42e5-92a8-620b2ed50546
2024-04-23T17:15:18,743  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T17:15:18,750  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,750  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T17:15:18,750  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:18,751  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_d32f91ea-841a-46fd-8c03-d24acae1c094): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:18,754  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T17:15:18,754  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T17:15:18,755  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,755  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,761  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T17:15:18,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:18,762  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:18,762  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,762  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,762  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,762  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=6, getValidTxns_(long)=1}
2024-04-23T17:15:18,762  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_d32f91ea-841a-46fd-8c03-d24acae1c094); Time taken: 0.011 seconds
2024-04-23T17:15:18,762  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423171518_d32f91ea-841a-46fd-8c03-d24acae1c094
2024-04-23T17:15:18,762  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_d32f91ea-841a-46fd-8c03-d24acae1c094
2024-04-23T17:15:18,783  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_d32f91ea-841a-46fd-8c03-d24acae1c094 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T17:15:18,783  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:18,784  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_d32f91ea-841a-46fd-8c03-d24acae1c094): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:18,784  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713917718, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:18,787  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:18,819  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,819  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=33}
2024-04-23T17:15:18,819  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_d32f91ea-841a-46fd-8c03-d24acae1c094); Time taken: 0.034 seconds
2024-04-23T17:15:18,819  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_d32f91ea-841a-46fd-8c03-d24acae1c094
2024-04-23T17:15:18,823  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T17:15:18,829  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,829  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T17:15:18,829  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:18,830  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_7c1f99af-d995-479a-a90f-8a8e02dafa1c): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:18,832  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T17:15:18,833  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T17:15:18,834  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,834  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,836  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T17:15:18,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:18,838  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:18,838  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:18,838  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:18,838  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:18,838  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:18,838  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_7c1f99af-d995-479a-a90f-8a8e02dafa1c); Time taken: 0.008 seconds
2024-04-23T17:15:18,838  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423171518_7c1f99af-d995-479a-a90f-8a8e02dafa1c
2024-04-23T17:15:18,838  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_7c1f99af-d995-479a-a90f-8a8e02dafa1c
2024-04-23T17:15:18,855  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_7c1f99af-d995-479a-a90f-8a8e02dafa1c LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T17:15:18,855  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:18,855  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_7c1f99af-d995-479a-a90f-8a8e02dafa1c): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:18,855  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:18,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713917718, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:18,859  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:18,869  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:18,869  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=12}
2024-04-23T17:15:18,869  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_7c1f99af-d995-479a-a90f-8a8e02dafa1c); Time taken: 0.013 seconds
2024-04-23T17:15:18,869  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_7c1f99af-d995-479a-a90f-8a8e02dafa1c
2024-04-23T17:15:18,873  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T17:15:18,879  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:18,879  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T17:15:18,880  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:18,880  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1): insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:18,883  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T17:15:18,883  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T17:15:18,884  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:18,884  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:18,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:18,892  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,892  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:18,892  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:18,892  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:18,892  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:18,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:18,897  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,897  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:18,897  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T17:15:18,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:18,977  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:18,977  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:18,977  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:18,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:18,979  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:18,979  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:18,979  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:18,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:18,984  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:18,986  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1
2024-04-23T17:15:18,989  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:18,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:18,991  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:18,993  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:18,993  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:19,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:19,008  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:19,009  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T17:15:19,009  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:19,016  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:19,016  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:19,017  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T17:15:19,017  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:19,017  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:19,017  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:19,017  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T17:15:19,017  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T17:15:19,017  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:19,017  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:19,017  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:19,017  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T17:15:19,017  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:19,017  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=28, getTable_(GetTableRequest)=27, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T17:15:19,017  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1); Time taken: 0.137 seconds
2024-04-23T17:15:19,018  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1
2024-04-23T17:15:19,018  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1
2024-04-23T17:15:19,037  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T17:15:19,037  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:19,037  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1): insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:19,037  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1
2024-04-23T17:15:19,037  INFO [main] ql.Driver: Query ID = alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1
Total jobs = 1
2024-04-23T17:15:19,037  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:19,037  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:19,054  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T17:15:19,055  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T17:15:19,057  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:19,058  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T17:15:19,058  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-18_880_5447752229591170506-1/dummy_path
2024-04-23T17:15:19,068  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:19,069  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,11KB
2024-04-23T17:15:19,070  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:19,073  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-18_880_5447752229591170506-1/-mr-10001
2024-04-23T17:15:19,077  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:19,084  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:19,089  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:19,090  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T17:15:19,090  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T17:15:19,090  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-18_880_5447752229591170506-1/dummy_path
2024-04-23T17:15:19,091  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:19,113  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:19,142  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local158573124_0004
2024-04-23T17:15:19,142  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:19,221  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:19,222  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:19,222  INFO [Thread-365] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:19,222  INFO [Thread-365] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:19,224  INFO [Thread-365] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:19,224  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local158573124_0004_m_000000_0
2024-04-23T17:15:19,227  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:19,227  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-18_880_5447752229591170506-1/dummy_path/null:0+1
2024-04-23T17:15:19,230  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:19,231  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,11KB
2024-04-23T17:15:19,231  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T17:15:19,235  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:19,235  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:19,235  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:19,235  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:19,235  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T17:15:19,236  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T17:15:19,236  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:19,236  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T17:15:19,236  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:19,236  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local158573124_0004/job_local158573124_0004.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3e189f2c
2024-04-23T17:15:19,236  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:19,236  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:19,236  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:19,238  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:19,239  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:19,246  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:19,247  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T17:15:19,254  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, 
2024-04-23T17:15:19,254  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:19,256  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local158573124_0004_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:19,257  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:19,257  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local158573124_0004_m_000000_0' done.
2024-04-23T17:15:19,257  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local158573124_0004_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=88086
		FILE: Number of bytes written=4752925
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=985137152
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6168
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:19,257  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local158573124_0004_m_000000_0
2024-04-23T17:15:19,257  INFO [Thread-365] mapred.LocalJobRunner: map task executor complete.
2024-04-23 17:15:20,224 Stage-1 map = 100%,  reduce = 0%
2024-04-23T17:15:20,224  INFO [main] exec.Task: 2024-04-23 17:15:20,224 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local158573124_0004
2024-04-23T17:15:20,224  INFO [main] exec.Task: Ended Job = job_local158573124_0004
2024-04-23T17:15:20,226  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T17:15:20,227  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T17:15:20,227  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T17:15:20,227  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T17:15:20,227  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/-ext-10000
2024-04-23T17:15:20,227  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/-ext-10002
2024-04-23T17:15:20,228  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T17:15:20,228  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1/-ext-10000
2024-04-23T17:15:20,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:20,234  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:20,239  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,242  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:20,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:20,271  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T17:15:20,272  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:20,278  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,278  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T17:15:20,279  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-18_880_5447752229591170506-1/-mr-10001
2024-04-23T17:15:20,280  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:20,287  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,288  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T17:15:20,288  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T17:15:20,288  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:20,288  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:20,306  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T17:15:20,306  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:20,306  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=25, alter_table_(String, String, String, Table, EnvironmentContext, String)=47}
MapReduce Jobs Launched: 
2024-04-23T17:15:20,307  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:20,307  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:20,307  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:20,307  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1); Time taken: 1.269 seconds
2024-04-23T17:15:20,307  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171518_a3ec48c3-5100-4f88-a4bf-2e01ce7093b1
2024-04-23T17:15:20,312  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T17:15:20,320  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:20,320  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T17:15:20,321  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:20,321  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1
2024-04-23T17:15:20,322  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-18_880_5447752229591170506-1 on fs with scheme file
2024-04-23T17:15:20,322  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-18_880_5447752229591170506-1
2024-04-23T17:15:20,322  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-18_880_5447752229591170506-1 on fs with scheme file
2024-04-23T17:15:20,323  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171520_9b92a166-6a31-4cd1-8d3a-87b191ce4095): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:20,323  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:20,330  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,333  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T17:15:20,333  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T17:15:20,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:20,343  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,344  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:20,344  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:20,344  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:20,344  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:20,344  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:20,344  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:20,344  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:20,344  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=13, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1}
2024-04-23T17:15:20,344  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171520_9b92a166-6a31-4cd1-8d3a-87b191ce4095); Time taken: 0.021 seconds
2024-04-23T17:15:20,344  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423171520_9b92a166-6a31-4cd1-8d3a-87b191ce4095
2024-04-23T17:15:20,345  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171520_9b92a166-6a31-4cd1-8d3a-87b191ce4095
2024-04-23T17:15:20,364  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171520_9b92a166-6a31-4cd1-8d3a-87b191ce4095 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T17:15:20,364  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:20,365  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171520_9b92a166-6a31-4cd1-8d3a-87b191ce4095): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:20,365  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:20,365  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:20,365  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:20,365  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:20,365  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:20,376  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:20,382  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:20,382  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:20,382  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171520_9b92a166-6a31-4cd1-8d3a-87b191ce4095); Time taken: 0.017 seconds
2024-04-23T17:15:20,382  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171520_9b92a166-6a31-4cd1-8d3a-87b191ce4095
2024-04-23T17:15:20,385  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T17:15:20,390  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:20,390  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T17:15:20,391  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:20,391  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171520_5d1fd298-940d-4597-91bc-93d7f124a8d6): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:20,391  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:20,406  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,408  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T17:15:20,408  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T17:15:20,410  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:20,414  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,414  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:20,415  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:20,415  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:20,415  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:20,415  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:20,415  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:20,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:20,415  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=1, getTable_(GetTableRequest)=19, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:20,415  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171520_5d1fd298-940d-4597-91bc-93d7f124a8d6); Time taken: 0.024 seconds
2024-04-23T17:15:20,415  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423171520_5d1fd298-940d-4597-91bc-93d7f124a8d6
2024-04-23T17:15:20,416  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171520_5d1fd298-940d-4597-91bc-93d7f124a8d6
2024-04-23T17:15:20,441  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171520_5d1fd298-940d-4597-91bc-93d7f124a8d6 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T17:15:20,441  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:20,441  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171520_5d1fd298-940d-4597-91bc-93d7f124a8d6): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:20,442  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:20,442  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:20,442  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:20,442  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:20,442  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:20,573  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:20,579  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:20,579  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:20,579  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171520_5d1fd298-940d-4597-91bc-93d7f124a8d6); Time taken: 0.138 seconds
2024-04-23T17:15:20,579  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171520_5d1fd298-940d-4597-91bc-93d7f124a8d6
2024-04-23T17:15:20,584  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T17:15:20,589  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:20,590  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T17:15:20,590  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:20,591  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171520_f1c1cd83-189e-45c4-9ea2-60aff4f6f679): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:20,594  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T17:15:20,594  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T17:15:20,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:20,601  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,612  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T17:15:20,612  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-23T17:15:20,614  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:20,614  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:20,614  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:20,614  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, allocateTableWriteId_(long, String, String)=8, flushCache_()=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T17:15:20,614  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171520_f1c1cd83-189e-45c4-9ea2-60aff4f6f679); Time taken: 0.024 seconds
2024-04-23T17:15:20,615  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423171520_f1c1cd83-189e-45c4-9ea2-60aff4f6f679
2024-04-23T17:15:20,615  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171520_f1c1cd83-189e-45c4-9ea2-60aff4f6f679
2024-04-23T17:15:20,630  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171520_f1c1cd83-189e-45c4-9ea2-60aff4f6f679 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T17:15:20,630  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:20,634  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171520_f1c1cd83-189e-45c4-9ea2-60aff4f6f679): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:20,634  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:20,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:20,638  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:20,645  INFO [HMSHandler #4] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:20,645  INFO [HMSHandler #5] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1
2024-04-23T17:15:20,645  INFO [HMSHandler #6] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2
2024-04-23T17:15:20,669  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T17:15:20,669  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data
2024-04-23T17:15:20,669  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:20,674  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:20,686  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T17:15:20,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:20,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:20,690  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,690  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:20,698  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T17:15:20,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:20,704  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T17:15:20,729  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:20,745  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:20,750  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-23T17:15:20,751  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data
2024-04-23T17:15:20,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:20,755  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,756  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:20,762  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T17:15:20,762  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:20,762  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:20,767  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,767  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:20,775  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-23T17:15:20,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:20,781  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T17:15:20,805  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:20,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:20,820  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:20,820  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=75, isCompatibleWith_(Configuration)=3, getTable_(GetTableRequest)=21, getPartitionWithAuthInfo_(String, String, List, String, List)=42, validatePartitionNameCharacters_(List)=0, getValidWriteIds_(List, String)=0, add_partitions_(List, boolean, boolean)=31}
2024-04-23T17:15:20,820  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171520_f1c1cd83-189e-45c4-9ea2-60aff4f6f679); Time taken: 0.186 seconds
2024-04-23T17:15:20,820  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171520_f1c1cd83-189e-45c4-9ea2-60aff4f6f679
2024-04-23T17:15:20,825  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T17:15:20,830  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:20,830  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T17:15:20,831  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:20,831  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:20,834  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T17:15:20,835  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T17:15:20,835  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:20,836  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:20,840  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:20,840  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:20,841  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:20,844  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,844  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:20,844  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:20,844  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:20,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:20,889  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:20,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:20,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:20,923  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:20,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:20,936  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:20,937  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:20,984  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:20,984  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:20,984  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:20,987  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-20_831_2573260765036396658-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-20_831_2573260765036396658-1
2024-04-23T17:15:20,996  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:20,998  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:20,998  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:20,999  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:21,000  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:21,015  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:21,016  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:21,016  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:21,017  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:21,017  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:21,017  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:21,017  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:21,017  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T17:15:21,018  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T17:15:21,018  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:21,019  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, listPartitions_(String, String, short)=17, getAllTableConstraints_(AllTableConstraintsRequest)=33, getTable_(GetTableRequest)=3, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=17, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0}
2024-04-23T17:15:21,019  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89); Time taken: 0.187 seconds
2024-04-23T17:15:21,019  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89
2024-04-23T17:15:21,019  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89
2024-04-23T17:15:21,041  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T17:15:21,042  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:21,042  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:21,042  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89
2024-04-23T17:15:21,043  INFO [main] ql.Driver: Query ID = alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89
Total jobs = 1
2024-04-23T17:15:21,043  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:21,043  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:21,044  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:21,045  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:21,045  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:21,045  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:21,045  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:21,045  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:21,045  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:21,045  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:21,047  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:21,047  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:21,047  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:21,055  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-20_831_2573260765036396658-1/-mr-10004/53be4205-dfb2-4a8e-a19c-00b0e00ea4b8 (false)
2024-04-23T17:15:21,065  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:21,067  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,08KB
2024-04-23T17:15:21,072  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:21,073  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T17:15:21,074  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:21,079  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:21,086  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:21,091  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:21,092  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:21,093  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:21,093  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:21,093  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:21,093  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T17:15:21,093  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:21,103  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T17:15:21,103  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 10 ms
2024-04-23T17:15:21,103  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T17:15:21,122  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T17:15:21,142  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2138387811_0005
2024-04-23T17:15:21,142  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:21,203  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:21,204  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:21,204  INFO [Thread-440] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:21,204  INFO [Thread-440] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:21,205  INFO [Thread-440] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:21,206  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2138387811_0005_m_000000_0
2024-04-23T17:15:21,206  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:21,206  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:21,207  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:21,208  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-23T17:15:21,215  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T17:15:21,216  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:21,220  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T17:15:21,221  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:21,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:21,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:21,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:21,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:21,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:21,226  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:21,226  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:21,228  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:21,229  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:21,229  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:21,229  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T17:15:21,229  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:21,229  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:21,230  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:21,231  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:21,231  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:21,231  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:21,231  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T17:15:21,231  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:21,242  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:21,245  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2138387811_0005_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:21,246  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:21,246  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2138387811_0005_m_000000_0' done.
2024-04-23T17:15:21,246  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2138387811_0005_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=99216
		FILE: Number of bytes written=5945966
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1092091904
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7213
2024-04-23T17:15:21,246  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2138387811_0005_m_000000_0
2024-04-23T17:15:21,246  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2138387811_0005_m_000001_0
2024-04-23T17:15:21,247  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:21,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:21,248  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:21,248  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-23T17:15:21,249  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T17:15:21,249  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:21,253  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T17:15:21,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:21,257  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:21,257  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:21,257  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:21,257  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:21,257  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:21,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:21,258  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:21,260  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:21,260  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:21,260  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:21,260  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T17:15:21,260  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:21,260  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:21,261  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:21,262  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:21,262  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:21,262  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:21,262  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T17:15:21,262  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:21,271  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:21,273  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2138387811_0005_m_000001_0 is done. And is in the process of committing
2024-04-23T17:15:21,274  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:21,274  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2138387811_0005_m_000001_0' done.
2024-04-23T17:15:21,274  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2138387811_0005_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=107438
		FILE: Number of bytes written=5946414
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1092091904
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7213
2024-04-23T17:15:21,274  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2138387811_0005_m_000001_0
2024-04-23T17:15:21,274  INFO [Thread-440] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:21,275  INFO [Thread-440] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:21,275  INFO [pool-30-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2138387811_0005_r_000000_0
2024-04-23T17:15:21,275  INFO [pool-30-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:21,275  INFO [pool-30-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1dbaa7e2
2024-04-23T17:15:21,275  WARN [pool-30-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:21,276  INFO [pool-30-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:21,276  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2138387811_0005_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:21,281  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local2138387811_0005_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-23T17:15:21,281  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local2138387811_0005_m_000000_0
2024-04-23T17:15:21,281  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-23T17:15:21,284  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local2138387811_0005_m_000001_0 decomp: 412 len: 416 to MEMORY
2024-04-23T17:15:21,285  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local2138387811_0005_m_000001_0
2024-04-23T17:15:21,285  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 2, commitMemory -> 412, usedMemory ->824
2024-04-23T17:15:21,285  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:21,286  INFO [pool-30-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T17:15:21,286  INFO [pool-30-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:21,297  INFO [pool-30-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T17:15:21,298  INFO [pool-30-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 750 bytes
2024-04-23T17:15:21,304  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 824 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:21,305  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merging 1 files, 826 bytes from disk
2024-04-23T17:15:21,305  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:21,305  INFO [pool-30-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:21,305  INFO [pool-30-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 785 bytes
2024-04-23T17:15:21,306  INFO [pool-30-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T17:15:21,307  INFO [pool-30-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:21,309  INFO [pool-30-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T17:15:21,311  INFO [pool-30-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:21,311  INFO [pool-30-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:21,311  INFO [pool-30-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-23T17:15:21,311  INFO [pool-30-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:21,312  INFO [pool-30-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@690e6b40, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@61428675>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@7ed72e5, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@2057537a
2024-04-23T17:15:21,315  INFO [pool-30-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-20_831_2573260765036396658-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-20_831_2573260765036396658-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:21,315  INFO [pool-30-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-20_831_2573260765036396658-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-20_831_2573260765036396658-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:21,315  INFO [pool-30-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-20_831_2573260765036396658-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-20_831_2573260765036396658-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:21,332  INFO [pool-30-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:21,333  INFO [pool-30-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:21,333  INFO [pool-30-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:21,333  INFO [pool-30-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:21,333  INFO [pool-30-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T17:15:21,334  INFO [pool-30-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, 
2024-04-23T17:15:21,335  INFO [pool-30-thread-1] mapred.Task: Task:attempt_local2138387811_0005_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:21,335  INFO [pool-30-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:21,336  INFO [pool-30-thread-1] mapred.Task: Task 'attempt_local2138387811_0005_r_000000_0' done.
2024-04-23T17:15:21,336  INFO [pool-30-thread-1] mapred.Task: Final Counters for attempt_local2138387811_0005_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=115441
		FILE: Number of bytes written=5948115
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=832
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1092091904
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:21,336  INFO [pool-30-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2138387811_0005_r_000000_0
2024-04-23T17:15:21,336  INFO [Thread-440] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:22,207 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:22,207  INFO [main] exec.Task: 2024-04-23 17:15:22,207 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2138387811_0005
2024-04-23T17:15:22,208  INFO [main] exec.Task: Ended Job = job_local2138387811_0005
2024-04-23T17:15:22,210  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:22,210  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:22,210  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:22,210  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:22,210  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:22,210  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89); Time taken: 1.168 seconds
2024-04-23T17:15:22,210  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171520_7e9ce553-cc0b-4fda-bb48-4ac1df2acf89
2024-04-23T17:15:22,215  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T17:15:22,220  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:22,220  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T17:15:22,224  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:22,227  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T17:15:22,227  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:22,227  WARN [main] ql.TestTxnAddPartition: addPartition: read data(add 2 parts w/data and 1 empty): 
2024-04-23T17:15:22,227  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0

2024-04-23T17:15:22,227  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:22,227  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-20_831_2573260765036396658-1
2024-04-23T17:15:22,228  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-20_831_2573260765036396658-1 on fs with scheme file
2024-04-23T17:15:22,228  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171522_ca7a23f5-c479-4818-9344-91dc89f57d18): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:22,232  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T17:15:22,232  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T17:15:22,234  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:22,237  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:22,237  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:22,238  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:22,242  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,242  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:22,242  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:22,242  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:22,245  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:22,256  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:22,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:22,274  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:22,277  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,277  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:22,282  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:22,282  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:22,318  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:22,318  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:22,318  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:22,321  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:22,324  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:22,324  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:22,324  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:22,338  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:22,348  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:22,349  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:22,349  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:22,350  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:22,350  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T17:15:22,350  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:22,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=3, listPartitions_(String, String, short)=5, getAllTableConstraints_(AllTableConstraintsRequest)=3, getTable_(GetTableRequest)=4, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=7, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0}
2024-04-23T17:15:22,350  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171522_ca7a23f5-c479-4818-9344-91dc89f57d18); Time taken: 0.122 seconds
2024-04-23T17:15:22,350  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171522_ca7a23f5-c479-4818-9344-91dc89f57d18): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:22,350  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T17:15:22,360  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:22,360  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T17:15:22,360  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171522_ca7a23f5-c479-4818-9344-91dc89f57d18); Time taken: 0.009 seconds
2024-04-23T17:15:22,360  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:22,364  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T17:15:22,368  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:22,368  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T17:15:22,369  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:22,370  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_228_3019520421848514860-1
2024-04-23T17:15:22,370  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_228_3019520421848514860-1 on fs with scheme file
2024-04-23T17:15:22,370  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171522_02a0bda2-f15c-467d-8de3-5679c24b97b2): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:22,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:22,386  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,388  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T17:15:22,389  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T17:15:22,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:22,396  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,396  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:22,396  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:22,397  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:22,397  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:22,397  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:22,397  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:22,397  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:22,397  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=20, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:22,397  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171522_02a0bda2-f15c-467d-8de3-5679c24b97b2); Time taken: 0.027 seconds
2024-04-23T17:15:22,397  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423171522_02a0bda2-f15c-467d-8de3-5679c24b97b2
2024-04-23T17:15:22,397  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171522_02a0bda2-f15c-467d-8de3-5679c24b97b2
2024-04-23T17:15:22,412  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171522_02a0bda2-f15c-467d-8de3-5679c24b97b2 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T17:15:22,412  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:22,412  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171522_02a0bda2-f15c-467d-8de3-5679c24b97b2): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:22,412  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:22,412  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:22,413  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:22,413  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:22,413  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:22,424  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:22,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:22,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:22,430  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171522_02a0bda2-f15c-467d-8de3-5679c24b97b2); Time taken: 0.018 seconds
2024-04-23T17:15:22,430  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171522_02a0bda2-f15c-467d-8de3-5679c24b97b2
2024-04-23T17:15:22,434  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T17:15:22,439  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:22,440  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T17:15:22,440  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171522_ecbe0003-ae32-422b-bfa9-1a8c808e2ad6): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:22,443  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T17:15:22,443  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T17:15:22,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:22,448  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,459  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-23T17:15:22,459  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-23T17:15:22,460  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:22,460  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:22,460  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:22,460  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4, allocateTableWriteId_(long, String, String)=9, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:22,460  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171522_ecbe0003-ae32-422b-bfa9-1a8c808e2ad6); Time taken: 0.02 seconds
2024-04-23T17:15:22,460  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423171522_ecbe0003-ae32-422b-bfa9-1a8c808e2ad6
2024-04-23T17:15:22,460  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171522_ecbe0003-ae32-422b-bfa9-1a8c808e2ad6
2024-04-23T17:15:22,480  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171522_ecbe0003-ae32-422b-bfa9-1a8c808e2ad6 LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T17:15:22,480  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:22,485  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171522_ecbe0003-ae32-422b-bfa9-1a8c808e2ad6): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:22,485  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:22,485  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:22,488  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:22,501 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T17:15:22,501 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T17:15:22,502 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-23T17:15:22,503 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T17:15:22,504 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T17:15:22,504  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:22,504  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4}
2024-04-23T17:15:22,505  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171522_ecbe0003-ae32-422b-bfa9-1a8c808e2ad6); Time taken: 0.019 seconds
2024-04-23T17:15:22,505  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171522_ecbe0003-ae32-422b-bfa9-1a8c808e2ad6
2024-04-23T17:15:22,507  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:22,513  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:22,514  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171522_4f38a330-f4cf-4b30-8072-7ae2c803fe78): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:22,522  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T17:15:22,522  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T17:15:22,524  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:22,527  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,530  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:22,538  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-23T17:15:22,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:22,551  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-23T17:15:22,551  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-23T17:15:22,551  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:22,551  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:22,551  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:22,552  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4, allocateTableWriteId_(long, String, String)=5, flushCache_()=0, getPartitionWithAuthInfo_(String, String, List, String, List)=12, rollbackTxn_(long)=8, getValidTxns_(long)=2}
2024-04-23T17:15:22,552  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171522_4f38a330-f4cf-4b30-8072-7ae2c803fe78); Time taken: 0.037 seconds
2024-04-23T17:15:22,552  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423171522_4f38a330-f4cf-4b30-8072-7ae2c803fe78
2024-04-23T17:15:22,552  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171522_4f38a330-f4cf-4b30-8072-7ae2c803fe78
2024-04-23T17:15:22,566  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171522_4f38a330-f4cf-4b30-8072-7ae2c803fe78 LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T17:15:22,566  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:22,573  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171522_4f38a330-f4cf-4b30-8072-7ae2c803fe78): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:22,573  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:22,573  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:22,577  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:22,581  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T17:15:22,582  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T17:15:22,583  INFO [HMSHandler #7] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3
2024-04-23T17:15:22,598  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-23T17:15:22,598  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data
2024-04-23T17:15:22,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:22,601  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:22,607  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-23T17:15:22,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:22,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:22,611  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,611  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:22,616  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-23T17:15:22,620  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:22,620  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-23T17:15:22,643  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:22,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:22,664  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:22,664  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=39, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, getPartitionWithAuthInfo_(String, String, List, String, List)=14, validatePartitionNameCharacters_(List)=1, getValidWriteIds_(List, String)=1, add_partitions_(List, boolean, boolean)=21}
2024-04-23T17:15:22,664  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171522_4f38a330-f4cf-4b30-8072-7ae2c803fe78); Time taken: 0.091 seconds
2024-04-23T17:15:22,664  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171522_4f38a330-f4cf-4b30-8072-7ae2c803fe78
2024-04-23T17:15:22,668  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T17:15:22,674  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:22,675  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T17:15:22,675  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:22,676  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:22,678  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T17:15:22,679  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T17:15:22,679  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:22,680  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:22,685  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:22,685  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:22,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:22,689  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,689  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:22,689  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:22,689  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:22,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:22,720  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:22,720  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:22,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:22,757  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:22,757  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:22,763  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:22,763  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:22,794  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:22,794  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:22,794  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:22,796  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_675_8569230860279271571-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-22_675_8569230860279271571-1
2024-04-23T17:15:22,804  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:22,805  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:22,805  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:22,805  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:22,806  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:22,815  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:22,816  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:22,816  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:22,816  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:22,816  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:22,816  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T17:15:22,817  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T17:15:22,817  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:22,817  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, listPartitions_(String, String, short)=17, getAllTableConstraints_(AllTableConstraintsRequest)=24, getTable_(GetTableRequest)=4, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=9, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0}
2024-04-23T17:15:22,818  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9); Time taken: 0.141 seconds
2024-04-23T17:15:22,818  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9
2024-04-23T17:15:22,818  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9
2024-04-23T17:15:22,835  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T17:15:22,835  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:22,837  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:22,837  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9
2024-04-23T17:15:22,837  INFO [main] ql.Driver: Query ID = alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9
Total jobs = 1
2024-04-23T17:15:22,837  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:22,837  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:22,840  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:22,840  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:22,840  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:22,840  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:22,840  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:22,840  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:22,840  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:22,840  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:22,843  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:22,843  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:22,843  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:22,852  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_675_8569230860279271571-1/-mr-10004/6475ddca-5e3b-4027-921d-cc469f29c48f (false)
2024-04-23T17:15:22,863  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:22,864  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,43KB
2024-04-23T17:15:22,869  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:22,870  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T17:15:22,871  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:22,875  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:22,886  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:22,890  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:22,891  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:22,891  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:22,891  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:22,891  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:22,891  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: default 
2024-04-23T17:15:22,892  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:22,901  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-23T17:15:22,901  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 10 ms
2024-04-23T17:15:22,901  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-23T17:15:22,918  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-23T17:15:22,937  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local171948872_0006
2024-04-23T17:15:22,937  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:22,999  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:22,999  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:22,999  INFO [Thread-534] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:22,999  INFO [Thread-534] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:23,001  INFO [Thread-534] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:23,001  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local171948872_0006_m_000000_0
2024-04-23T17:15:23,002  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:23,002  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:23,003  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:23,004  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-23T17:15:23,005  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T17:15:23,005  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:23,010  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T17:15:23,010  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:23,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:23,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:23,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:23,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:23,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:23,016  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:23,016  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:23,019  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:23,020  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:23,020  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:23,020  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T17:15:23,020  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:23,020  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:23,021  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:23,022  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:23,022  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:23,022  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:23,022  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:23,022  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:23,022  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:23,022  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T17:15:23,022  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:23,037  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:23,041  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local171948872_0006_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:23,042  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:23,042  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local171948872_0006_m_000000_0' done.
2024-04-23T17:15:23,042  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local171948872_0006_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=130931
		FILE: Number of bytes written=7138407
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-23T17:15:23,042  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local171948872_0006_m_000000_0
2024-04-23T17:15:23,042  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local171948872_0006_m_000001_0
2024-04-23T17:15:23,043  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:23,043  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:23,044  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:23,045  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-23T17:15:23,047  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T17:15:23,047  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:23,051  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T17:15:23,051  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:23,057  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:23,058  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:23,058  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:23,058  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:23,058  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:23,058  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:23,058  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:23,061  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:23,062  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:23,062  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:23,062  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T17:15:23,062  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:23,062  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:23,063  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:23,064  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:23,064  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:23,064  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:23,064  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T17:15:23,064  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:23,072  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:23,076  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local171948872_0006_m_000001_0 is done. And is in the process of committing
2024-04-23T17:15:23,076  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:23,076  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local171948872_0006_m_000001_0' done.
2024-04-23T17:15:23,076  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local171948872_0006_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=140003
		FILE: Number of bytes written=7138855
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-23T17:15:23,077  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local171948872_0006_m_000001_0
2024-04-23T17:15:23,077  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local171948872_0006_m_000002_0
2024-04-23T17:15:23,077  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:23,078  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:23,078  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:23,079  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-23T17:15:23,081  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T17:15:23,081  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:23,086  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T17:15:23,086  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:23,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:23,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:23,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:23,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:23,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:23,093  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:23,093  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:23,096  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:23,096  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:23,097  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:23,097  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T17:15:23,097  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:23,097  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:23,097  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:23,097  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:23,097  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T17:15:23,098  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:23,108  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:23,111  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local171948872_0006_m_000002_0 is done. And is in the process of committing
2024-04-23T17:15:23,111  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:23,111  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local171948872_0006_m_000002_0' done.
2024-04-23T17:15:23,112  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local171948872_0006_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=148563
		FILE: Number of bytes written=7139303
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-23T17:15:23,112  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local171948872_0006_m_000002_0
2024-04-23T17:15:23,112  INFO [Thread-534] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:23,112  INFO [Thread-534] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:23,113  INFO [pool-34-thread-1] mapred.LocalJobRunner: Starting task: attempt_local171948872_0006_r_000000_0
2024-04-23T17:15:23,113  INFO [pool-34-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:23,113  INFO [pool-34-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@25692edd
2024-04-23T17:15:23,113  WARN [pool-34-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:23,114  INFO [pool-34-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:23,114  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local171948872_0006_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:23,115  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local171948872_0006_m_000002_0 decomp: 412 len: 416 to MEMORY
2024-04-23T17:15:23,116  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local171948872_0006_m_000002_0
2024-04-23T17:15:23,116  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-23T17:15:23,118  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local171948872_0006_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-23T17:15:23,118  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local171948872_0006_m_000000_0
2024-04-23T17:15:23,118  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 2, commitMemory -> 412, usedMemory ->824
2024-04-23T17:15:23,121  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local171948872_0006_m_000001_0 decomp: 412 len: 416 to MEMORY
2024-04-23T17:15:23,121  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local171948872_0006_m_000001_0
2024-04-23T17:15:23,121  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 3, commitMemory -> 824, usedMemory ->1236
2024-04-23T17:15:23,121  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:23,121  INFO [pool-34-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T17:15:23,121  INFO [pool-34-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:23,128  INFO [pool-34-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-23T17:15:23,128  INFO [pool-34-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 1125 bytes
2024-04-23T17:15:23,131  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 1236 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:23,131  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merging 1 files, 1236 bytes from disk
2024-04-23T17:15:23,131  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:23,131  INFO [pool-34-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:23,131  INFO [pool-34-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 1195 bytes
2024-04-23T17:15:23,132  INFO [pool-34-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T17:15:23,132  INFO [pool-34-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:23,133  INFO [pool-34-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T17:15:23,134  INFO [pool-34-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:23,134  INFO [pool-34-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:23,134  INFO [pool-34-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-23T17:15:23,134  INFO [pool-34-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:23,135  INFO [pool-34-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@35236b, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@61428675>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@2ca787c5, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@4cce06f
2024-04-23T17:15:23,135  INFO [pool-34-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_675_8569230860279271571-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-22_675_8569230860279271571-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:23,135  INFO [pool-34-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_675_8569230860279271571-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-22_675_8569230860279271571-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:23,135  INFO [pool-34-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_675_8569230860279271571-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-22_675_8569230860279271571-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:23,143  INFO [pool-34-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:23,144  INFO [pool-34-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:23,144  INFO [pool-34-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:23,144  INFO [pool-34-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:23,144  INFO [pool-34-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-23T17:15:23,145  INFO [pool-34-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, 
2024-04-23T17:15:23,145  INFO [pool-34-thread-1] mapred.Task: Task:attempt_local171948872_0006_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:23,145  INFO [pool-34-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:23,146  INFO [pool-34-thread-1] mapred.Task: Task 'attempt_local171948872_0006_r_000000_0' done.
2024-04-23T17:15:23,146  INFO [pool-34-thread-1] mapred.Task: Final Counters for attempt_local171948872_0006_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=157425
		FILE: Number of bytes written=7141804
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=1248
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:23,146  INFO [pool-34-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local171948872_0006_r_000000_0
2024-04-23T17:15:23,146  INFO [Thread-534] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:24,002 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:24,002  INFO [main] exec.Task: 2024-04-23 17:15:24,002 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local171948872_0006
2024-04-23T17:15:24,004  INFO [main] exec.Task: Ended Job = job_local171948872_0006
2024-04-23T17:15:24,006  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,006  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:24,006  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:24,006  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:24,006  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:24,006  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9); Time taken: 1.169 seconds
2024-04-23T17:15:24,006  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171522_3dd8a946-2b7e-4ab5-ad92-7b55dd338ef9
2024-04-23T17:15:24,010  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T17:15:24,017  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,017  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T17:15:24,022  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:24,023  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T17:15:24,023  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:24,023  WARN [main] ql.TestTxnAddPartition: addPartition: read data(add 2 existing parts and 1 empty): 
2024-04-23T17:15:24,023  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":3,"bucketid":536870912,"rowid":0}	3	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0
{"writeid":3,"bucketid":536870912,"rowid":1}	3	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0

2024-04-23T17:15:24,024  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:24,024  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_675_8569230860279271571-1
2024-04-23T17:15:24,025  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-22_675_8569230860279271571-1 on fs with scheme file
2024-04-23T17:15:24,025  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_2a12aaa7-965a-4fac-b8c4-9abece6afb4a): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:24,035  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-23T17:15:24,035  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T17:15:24,036  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:24,038  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:24,038  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:24,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:24,044  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,044  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:24,044  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:24,045  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:24,047  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:24,057  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:24,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:24,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:24,085  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,086  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:24,090  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:24,090  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:24,131  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:24,132  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:24,132  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:24,134  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:24,135  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:24,135  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:24,136  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:24,157  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:24,167  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:24,168  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:24,168  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:24,168  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,168  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T17:15:24,168  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,168  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=9, isCompatibleWith_(Configuration)=2, listPartitions_(String, String, short)=4, getAllTableConstraints_(AllTableConstraintsRequest)=3, getTable_(GetTableRequest)=5, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=9, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:24,169  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_2a12aaa7-965a-4fac-b8c4-9abece6afb4a); Time taken: 0.143 seconds
2024-04-23T17:15:24,169  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_2a12aaa7-965a-4fac-b8c4-9abece6afb4a): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:24,169  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T17:15:24,178  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,178  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T17:15:24,178  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_2a12aaa7-965a-4fac-b8c4-9abece6afb4a); Time taken: 0.009 seconds
2024-04-23T17:15:24,178  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:24,183  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T17:15:24,188  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,188  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T17:15:24,189  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:24,189  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-24_025_2039978106984932732-1
2024-04-23T17:15:24,189  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0fc47427-43a2-4148-aad5-d480268957f0/hive_2024-04-23_17-15-24_025_2039978106984932732-1 on fs with scheme file
2024-04-23T17:15:24,190  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_7afcd26b-db98-471a-9c1a-2732118b0521): drop table if exists acidTbl
2024-04-23T17:15:24,193  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-23T17:15:24,193  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T17:15:24,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:24,198  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,198  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,198  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,198  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,198  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:24,198  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_7afcd26b-db98-471a-9c1a-2732118b0521); Time taken: 0.009 seconds
2024-04-23T17:15:24,198  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423171524_7afcd26b-db98-471a-9c1a-2732118b0521
2024-04-23T17:15:24,199  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171524_7afcd26b-db98-471a-9c1a-2732118b0521
2024-04-23T17:15:24,214  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171524_7afcd26b-db98-471a-9c1a-2732118b0521 LockResponse(lockid:20, state:ACQUIRED)
2024-04-23T17:15:24,214  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:24,214  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_7afcd26b-db98-471a-9c1a-2732118b0521): drop table if exists acidTbl
2024-04-23T17:15:24,214  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:24,217  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:24,221  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:24,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=112, getTable_(GetTableRequest)=3}
2024-04-23T17:15:24,329  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_7afcd26b-db98-471a-9c1a-2732118b0521); Time taken: 0.115 seconds
2024-04-23T17:15:24,329  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_7afcd26b-db98-471a-9c1a-2732118b0521
2024-04-23T17:15:24,334  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T17:15:24,341  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,342  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T17:15:24,342  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:24,343  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_f0fe5817-d956-4a54-a2ce-30695de0d5b3): drop table if exists acidTblPart
2024-04-23T17:15:24,346  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-23T17:15:24,347  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-23T17:15:24,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:24,353  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,353  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,353  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,353  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,353  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=5, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:24,353  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_f0fe5817-d956-4a54-a2ce-30695de0d5b3); Time taken: 0.01 seconds
2024-04-23T17:15:24,353  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240423171524_f0fe5817-d956-4a54-a2ce-30695de0d5b3
2024-04-23T17:15:24,353  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171524_f0fe5817-d956-4a54-a2ce-30695de0d5b3
2024-04-23T17:15:24,377  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171524_f0fe5817-d956-4a54-a2ce-30695de0d5b3 LockResponse(lockid:21, state:ACQUIRED)
2024-04-23T17:15:24,377  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:24,377  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_f0fe5817-d956-4a54-a2ce-30695de0d5b3): drop table if exists acidTblPart
2024-04-23T17:15:24,377  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:24,382  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,382  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:24,386  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,386  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:24,420  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,420  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=38, getTable_(GetTableRequest)=5}
2024-04-23T17:15:24,420  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_f0fe5817-d956-4a54-a2ce-30695de0d5b3); Time taken: 0.043 seconds
2024-04-23T17:15:24,420  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_f0fe5817-d956-4a54-a2ce-30695de0d5b3
2024-04-23T17:15:24,424  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-23T17:15:24,430  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,430  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-23T17:15:24,430  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:24,431  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_3ff3493e-5af8-4cd9-b6d5-6955b291df30): drop table if exists acidTbl2
2024-04-23T17:15:24,433  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-23T17:15:24,433  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-23T17:15:24,434  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,434  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,434  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:24,435  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_3ff3493e-5af8-4cd9-b6d5-6955b291df30); Time taken: 0.003 seconds
2024-04-23T17:15:24,435  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240423171524_3ff3493e-5af8-4cd9-b6d5-6955b291df30
2024-04-23T17:15:24,435  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:24,435  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_3ff3493e-5af8-4cd9-b6d5-6955b291df30): drop table if exists acidTbl2
2024-04-23T17:15:24,435  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,435  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T17:15:24,436  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,436  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0}
2024-04-23T17:15:24,436  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_3ff3493e-5af8-4cd9-b6d5-6955b291df30); Time taken: 0.001 seconds
2024-04-23T17:15:24,436  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_3ff3493e-5af8-4cd9-b6d5-6955b291df30
2024-04-23T17:15:24,440  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-23T17:15:24,445  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,446  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-23T17:15:24,446  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:24,446  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_a5c84d0b-3b41-4c0e-aa20-db40971ae65a): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:24,449  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-23T17:15:24,449  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-23T17:15:24,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:24,464  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,464  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,464  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,464  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,465  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=14, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:24,465  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_a5c84d0b-3b41-4c0e-aa20-db40971ae65a); Time taken: 0.018 seconds
2024-04-23T17:15:24,465  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240423171524_a5c84d0b-3b41-4c0e-aa20-db40971ae65a
2024-04-23T17:15:24,465  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171524_a5c84d0b-3b41-4c0e-aa20-db40971ae65a
2024-04-23T17:15:24,485  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171524_a5c84d0b-3b41-4c0e-aa20-db40971ae65a LockResponse(lockid:22, state:ACQUIRED)
2024-04-23T17:15:24,485  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:24,485  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_a5c84d0b-3b41-4c0e-aa20-db40971ae65a): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:24,485  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:24,491  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,492  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:24,497  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,497  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:24,528  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=36, getTable_(GetTableRequest)=5}
2024-04-23T17:15:24,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_a5c84d0b-3b41-4c0e-aa20-db40971ae65a); Time taken: 0.043 seconds
2024-04-23T17:15:24,528  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_a5c84d0b-3b41-4c0e-aa20-db40971ae65a
2024-04-23T17:15:24,531  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-23T17:15:24,537  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,537  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-23T17:15:24,538  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:24,538  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_ccd2b081-b3f7-4142-b233-28f7c031b5ea): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:24,541  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-23T17:15:24,541  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-23T17:15:24,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:24,546  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,546  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,546  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,547  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,547  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:24,547  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_ccd2b081-b3f7-4142-b233-28f7c031b5ea); Time taken: 0.009 seconds
2024-04-23T17:15:24,547  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240423171524_ccd2b081-b3f7-4142-b233-28f7c031b5ea
2024-04-23T17:15:24,547  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171524_ccd2b081-b3f7-4142-b233-28f7c031b5ea
2024-04-23T17:15:24,561  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171524_ccd2b081-b3f7-4142-b233-28f7c031b5ea LockResponse(lockid:23, state:ACQUIRED)
2024-04-23T17:15:24,561  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:24,561  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_ccd2b081-b3f7-4142-b233-28f7c031b5ea): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:24,562  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,562  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:24,566  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,566  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:24,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:24,584  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,585  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=18, getTable_(GetTableRequest)=4}
2024-04-23T17:15:24,585  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_ccd2b081-b3f7-4142-b233-28f7c031b5ea); Time taken: 0.023 seconds
2024-04-23T17:15:24,585  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_ccd2b081-b3f7-4142-b233-28f7c031b5ea
2024-04-23T17:15:24,588  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-23T17:15:24,594  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,594  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-23T17:15:24,594  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:24,595  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_ea6226aa-ea5a-4894-90d6-7427983d408f): drop table if exists nonAcidNonBucket
2024-04-23T17:15:24,597  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-23T17:15:24,597  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-23T17:15:24,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:24,602  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,602  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,602  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,603  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,603  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:24,603  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_ea6226aa-ea5a-4894-90d6-7427983d408f); Time taken: 0.008 seconds
2024-04-23T17:15:24,603  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240423171524_ea6226aa-ea5a-4894-90d6-7427983d408f
2024-04-23T17:15:24,603  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171524_ea6226aa-ea5a-4894-90d6-7427983d408f
2024-04-23T17:15:24,618  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171524_ea6226aa-ea5a-4894-90d6-7427983d408f LockResponse(lockid:24, state:ACQUIRED)
2024-04-23T17:15:24,618  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:24,618  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_ea6226aa-ea5a-4894-90d6-7427983d408f): drop table if exists nonAcidNonBucket
2024-04-23T17:15:24,618  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:24,622  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,622  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:24,626  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:24,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:24,641  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,642  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=19, getTable_(GetTableRequest)=4}
2024-04-23T17:15:24,642  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_ea6226aa-ea5a-4894-90d6-7427983d408f); Time taken: 0.023 seconds
2024-04-23T17:15:24,642  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_ea6226aa-ea5a-4894-90d6-7427983d408f
2024-04-23T17:15:24,645  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-23T17:15:24,650  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,650  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-23T17:15:24,650  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T17:15:24,714  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T17:15:24,715  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T17:15:24,716  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 9b4ad973-e430-49c5-98b7-94d67e49f76a
2024-04-23T17:15:24,718  INFO [main] SessionState: Hive Session ID = 9b4ad973-e430-49c5-98b7-94d67e49f76a
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:24,719  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:24,724  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9b4ad973-e430-49c5-98b7-94d67e49f76a
2024-04-23T17:15:24,727  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a
2024-04-23T17:15:24,729  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9b4ad973-e430-49c5-98b7-94d67e49f76a/_tmp_space.db
2024-04-23T17:15:24,730  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9b4ad973-e430-49c5-98b7-94d67e49f76a, clientType=HIVECLI]
2024-04-23T17:15:24,730  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:24,730  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_98aa7d45-2dfc-4150-ad46-3a364d5a7832): drop table if exists acidTbl
2024-04-23T17:15:24,738  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T17:15:24,738  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T17:15:24,740  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:24,741  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,741  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,741  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,741  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=7, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=2}
2024-04-23T17:15:24,741  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_98aa7d45-2dfc-4150-ad46-3a364d5a7832); Time taken: 0.011 seconds
2024-04-23T17:15:24,742  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423171524_98aa7d45-2dfc-4150-ad46-3a364d5a7832
2024-04-23T17:15:24,742  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:24,742  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_98aa7d45-2dfc-4150-ad46-3a364d5a7832): drop table if exists acidTbl
2024-04-23T17:15:24,742  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:24,744  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,744  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:24,744  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_98aa7d45-2dfc-4150-ad46-3a364d5a7832); Time taken: 0.002 seconds
2024-04-23T17:15:24,744  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_98aa7d45-2dfc-4150-ad46-3a364d5a7832
2024-04-23T17:15:24,749  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T17:15:24,755  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,755  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T17:15:24,755  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:24,756  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_9d353cde-3a57-4c99-bd68-2c606ec08dba): drop table if exists acidTblPart
2024-04-23T17:15:24,758  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T17:15:24,758  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T17:15:24,759  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:24,760  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,760  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,760  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,760  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:24,760  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_9d353cde-3a57-4c99-bd68-2c606ec08dba); Time taken: 0.004 seconds
2024-04-23T17:15:24,760  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423171524_9d353cde-3a57-4c99-bd68-2c606ec08dba
2024-04-23T17:15:24,760  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:24,760  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_9d353cde-3a57-4c99-bd68-2c606ec08dba): drop table if exists acidTblPart
2024-04-23T17:15:24,760  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:24,762  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,762  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:24,762  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_9d353cde-3a57-4c99-bd68-2c606ec08dba); Time taken: 0.001 seconds
2024-04-23T17:15:24,762  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_9d353cde-3a57-4c99-bd68-2c606ec08dba
2024-04-23T17:15:24,766  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T17:15:24,771  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,772  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T17:15:24,772  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:24,772  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_3b2038b6-ce24-47c2-8061-7a2e6a344d86): drop table if exists acidTbl2
2024-04-23T17:15:24,775  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T17:15:24,775  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T17:15:24,777  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:24,778  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,778  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,778  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,778  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:24,779  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_3b2038b6-ce24-47c2-8061-7a2e6a344d86); Time taken: 0.006 seconds
2024-04-23T17:15:24,779  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423171524_3b2038b6-ce24-47c2-8061-7a2e6a344d86
2024-04-23T17:15:24,779  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:24,779  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_3b2038b6-ce24-47c2-8061-7a2e6a344d86): drop table if exists acidTbl2
2024-04-23T17:15:24,779  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,779  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:24,781  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,781  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:24,781  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_3b2038b6-ce24-47c2-8061-7a2e6a344d86); Time taken: 0.002 seconds
2024-04-23T17:15:24,781  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_3b2038b6-ce24-47c2-8061-7a2e6a344d86
2024-04-23T17:15:24,786  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T17:15:24,792  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,792  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T17:15:24,792  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:24,793  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_f2a957c7-cd6a-4b68-80b6-b5a8516d4b19): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:24,795  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T17:15:24,795  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T17:15:24,796  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:24,798  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,798  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,798  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,798  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T17:15:24,798  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_f2a957c7-cd6a-4b68-80b6-b5a8516d4b19); Time taken: 0.005 seconds
2024-04-23T17:15:24,798  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423171524_f2a957c7-cd6a-4b68-80b6-b5a8516d4b19
2024-04-23T17:15:24,798  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:24,798  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_f2a957c7-cd6a-4b68-80b6-b5a8516d4b19): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:24,798  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,799  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:24,800  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,800  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:24,800  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_f2a957c7-cd6a-4b68-80b6-b5a8516d4b19); Time taken: 0.002 seconds
2024-04-23T17:15:24,800  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_f2a957c7-cd6a-4b68-80b6-b5a8516d4b19
2024-04-23T17:15:24,807  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T17:15:24,812  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,812  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T17:15:24,813  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:24,813  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_dbf4965e-9313-46f2-be7b-d225c50a382b): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:24,816  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T17:15:24,816  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T17:15:24,817  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:24,819  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,819  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,819  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,819  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T17:15:24,819  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_dbf4965e-9313-46f2-be7b-d225c50a382b); Time taken: 0.006 seconds
2024-04-23T17:15:24,819  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423171524_dbf4965e-9313-46f2-be7b-d225c50a382b
2024-04-23T17:15:24,819  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:24,820  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_dbf4965e-9313-46f2-be7b-d225c50a382b): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:24,820  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,820  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:24,821  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,821  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:24,821  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_dbf4965e-9313-46f2-be7b-d225c50a382b); Time taken: 0.001 seconds
2024-04-23T17:15:24,821  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_dbf4965e-9313-46f2-be7b-d225c50a382b
2024-04-23T17:15:24,828  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T17:15:24,835  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,835  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T17:15:24,835  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:24,836  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_b819a0d7-efc1-4e95-a552-14d635ee4b3d): drop table if exists nonAcidNonBucket
2024-04-23T17:15:24,838  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T17:15:24,838  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T17:15:24,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:24,840  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,840  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,840  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,840  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0}
2024-04-23T17:15:24,840  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_b819a0d7-efc1-4e95-a552-14d635ee4b3d); Time taken: 0.004 seconds
2024-04-23T17:15:24,840  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423171524_b819a0d7-efc1-4e95-a552-14d635ee4b3d
2024-04-23T17:15:24,840  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:24,841  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_b819a0d7-efc1-4e95-a552-14d635ee4b3d): drop table if exists nonAcidNonBucket
2024-04-23T17:15:24,841  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,841  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:24,842  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,842  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:24,842  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_b819a0d7-efc1-4e95-a552-14d635ee4b3d); Time taken: 0.001 seconds
2024-04-23T17:15:24,842  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_b819a0d7-efc1-4e95-a552-14d635ee4b3d
2024-04-23T17:15:24,846  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T17:15:24,851  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,851  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T17:15:24,852  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:24,852  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_481403d6-6e46-4463-b073-e1cfbee7b174): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:24,855  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T17:15:24,855  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T17:15:24,856  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:24,856  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:24,862  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T17:15:24,862  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:24,863  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:24,863  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,863  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,863  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,863  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=6, getValidTxns_(long)=1}
2024-04-23T17:15:24,863  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_481403d6-6e46-4463-b073-e1cfbee7b174); Time taken: 0.011 seconds
2024-04-23T17:15:24,863  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423171524_481403d6-6e46-4463-b073-e1cfbee7b174
2024-04-23T17:15:24,864  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171524_481403d6-6e46-4463-b073-e1cfbee7b174
2024-04-23T17:15:24,881  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171524_481403d6-6e46-4463-b073-e1cfbee7b174 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T17:15:24,881  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:24,882  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_481403d6-6e46-4463-b073-e1cfbee7b174): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:24,882  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713917724, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:24,884  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtbl
2024-04-23T17:15:24,910  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,910  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=27}
2024-04-23T17:15:24,911  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_481403d6-6e46-4463-b073-e1cfbee7b174); Time taken: 0.028 seconds
2024-04-23T17:15:24,911  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_481403d6-6e46-4463-b073-e1cfbee7b174
2024-04-23T17:15:24,914  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T17:15:24,920  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,920  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T17:15:24,920  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:24,920  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_48f4dd77-9bc1-4dca-b8b4-2f685dbe7b0d): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:24,923  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T17:15:24,924  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T17:15:24,924  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:24,925  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:24,927  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T17:15:24,927  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:24,928  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:24,928  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,928  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,928  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,928  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:24,928  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_48f4dd77-9bc1-4dca-b8b4-2f685dbe7b0d); Time taken: 0.008 seconds
2024-04-23T17:15:24,928  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423171524_48f4dd77-9bc1-4dca-b8b4-2f685dbe7b0d
2024-04-23T17:15:24,929  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171524_48f4dd77-9bc1-4dca-b8b4-2f685dbe7b0d
2024-04-23T17:15:24,943  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171524_48f4dd77-9bc1-4dca-b8b4-2f685dbe7b0d LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T17:15:24,943  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:24,944  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_48f4dd77-9bc1-4dca-b8b4-2f685dbe7b0d): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:24,944  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713917724, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:24,947  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtblpart
2024-04-23T17:15:24,961  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:24,961  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=17}
2024-04-23T17:15:24,961  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_48f4dd77-9bc1-4dca-b8b4-2f685dbe7b0d); Time taken: 0.017 seconds
2024-04-23T17:15:24,961  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_48f4dd77-9bc1-4dca-b8b4-2f685dbe7b0d
2024-04-23T17:15:24,964  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T17:15:24,970  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:24,970  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T17:15:24,971  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:24,971  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171524_c008c40b-c72e-42c4-9f3c-b4a9c44286d7): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:24,974  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T17:15:24,974  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T17:15:24,975  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:24,975  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:24,978  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T17:15:24,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:24,979  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:24,979  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:24,979  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:24,979  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:24,979  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0}
2024-04-23T17:15:24,979  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171524_c008c40b-c72e-42c4-9f3c-b4a9c44286d7); Time taken: 0.008 seconds
2024-04-23T17:15:24,979  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423171524_c008c40b-c72e-42c4-9f3c-b4a9c44286d7
2024-04-23T17:15:24,979  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171524_c008c40b-c72e-42c4-9f3c-b4a9c44286d7
2024-04-23T17:15:24,995  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171524_c008c40b-c72e-42c4-9f3c-b4a9c44286d7 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T17:15:24,995  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:24,995  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171524_c008c40b-c72e-42c4-9f3c-b4a9c44286d7): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:24,995  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:24,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713917724, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:24,998  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl
2024-04-23T17:15:25,006  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:25,006  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=10}
2024-04-23T17:15:25,006  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171524_c008c40b-c72e-42c4-9f3c-b4a9c44286d7); Time taken: 0.011 seconds
2024-04-23T17:15:25,007  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171524_c008c40b-c72e-42c4-9f3c-b4a9c44286d7
2024-04-23T17:15:25,011  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T17:15:25,016  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:25,016  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T17:15:25,017  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:25,017  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171525_10f41253-5c6e-46b2-856c-87160993aa1d): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:25,020  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T17:15:25,020  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T17:15:25,021  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:25,021  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:25,023  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T17:15:25,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:25,025  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:25,025  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:25,025  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:25,025  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:25,025  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:25,025  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171525_10f41253-5c6e-46b2-856c-87160993aa1d); Time taken: 0.008 seconds
2024-04-23T17:15:25,025  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423171525_10f41253-5c6e-46b2-856c-87160993aa1d
2024-04-23T17:15:25,025  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171525_10f41253-5c6e-46b2-856c-87160993aa1d
2024-04-23T17:15:25,039  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171525_10f41253-5c6e-46b2-856c-87160993aa1d LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T17:15:25,039  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:25,039  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171525_10f41253-5c6e-46b2-856c-87160993aa1d): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:25,039  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:25,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713917725, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:25,042  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl2
2024-04-23T17:15:25,051  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:25,051  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=11}
2024-04-23T17:15:25,051  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171525_10f41253-5c6e-46b2-856c-87160993aa1d); Time taken: 0.012 seconds
2024-04-23T17:15:25,051  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171525_10f41253-5c6e-46b2-856c-87160993aa1d
2024-04-23T17:15:25,056  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T17:15:25,061  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:25,062  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T17:15:25,062  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:25,062  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171525_4e1cb2a8-9cb9-4650-8d12-f37cb0c2e55d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:25,065  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T17:15:25,065  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T17:15:25,066  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:25,066  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:25,070  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T17:15:25,070  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:25,071  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:25,071  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:25,071  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:25,071  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:25,071  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=2, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0}
2024-04-23T17:15:25,071  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171525_4e1cb2a8-9cb9-4650-8d12-f37cb0c2e55d); Time taken: 0.009 seconds
2024-04-23T17:15:25,071  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423171525_4e1cb2a8-9cb9-4650-8d12-f37cb0c2e55d
2024-04-23T17:15:25,071  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171525_4e1cb2a8-9cb9-4650-8d12-f37cb0c2e55d
2024-04-23T17:15:25,085  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171525_4e1cb2a8-9cb9-4650-8d12-f37cb0c2e55d LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T17:15:25,085  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:25,085  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171525_4e1cb2a8-9cb9-4650-8d12-f37cb0c2e55d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:25,086  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:25,087  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9b4ad973-e430-49c5-98b7-94d67e49f76a/_tmp_space.db/47cff2aa-4e08-4ebf-963a-89a00dd1c206
2024-04-23T17:15:25,090  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:25,090  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T17:15:25,090  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171525_4e1cb2a8-9cb9-4650-8d12-f37cb0c2e55d); Time taken: 0.005 seconds
2024-04-23T17:15:25,090  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171525_4e1cb2a8-9cb9-4650-8d12-f37cb0c2e55d
2024-04-23T17:15:25,093  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T17:15:25,099  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:25,099  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T17:15:25,099  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:25,100  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171525_dd36ca7d-546f-45a9-adc0-2b868002c3ae): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:25,102  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T17:15:25,103  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T17:15:25,103  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:25,103  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:25,106  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T17:15:25,106  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:25,107  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:25,107  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:25,107  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:25,107  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:25,107  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:25,107  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171525_dd36ca7d-546f-45a9-adc0-2b868002c3ae); Time taken: 0.007 seconds
2024-04-23T17:15:25,107  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423171525_dd36ca7d-546f-45a9-adc0-2b868002c3ae
2024-04-23T17:15:25,107  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171525_dd36ca7d-546f-45a9-adc0-2b868002c3ae
2024-04-23T17:15:25,121  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171525_dd36ca7d-546f-45a9-adc0-2b868002c3ae LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T17:15:25,121  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:25,121  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171525_dd36ca7d-546f-45a9-adc0-2b868002c3ae): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:25,122  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:25,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713917725, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:25,124  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidnonbucket
2024-04-23T17:15:25,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:25,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=10}
2024-04-23T17:15:25,133  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171525_dd36ca7d-546f-45a9-adc0-2b868002c3ae); Time taken: 0.012 seconds
2024-04-23T17:15:25,134  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171525_dd36ca7d-546f-45a9-adc0-2b868002c3ae
2024-04-23T17:15:25,137  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T17:15:25,143  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:25,143  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T17:15:25,143  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T17:15:25,143  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171525_6fb3c3ae-4e88-4c87-9b0d-a3bb66a8600d): drop table if exists T
2024-04-23T17:15:25,146  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T17:15:25,146  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T17:15:25,147  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:25,160  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,160  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:25,160  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:25,161  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:25,161  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=13, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:25,161  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171525_6fb3c3ae-4e88-4c87-9b0d-a3bb66a8600d); Time taken: 0.017 seconds
2024-04-23T17:15:25,161  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423171525_6fb3c3ae-4e88-4c87-9b0d-a3bb66a8600d
2024-04-23T17:15:25,161  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171525_6fb3c3ae-4e88-4c87-9b0d-a3bb66a8600d
2024-04-23T17:15:25,178  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171525_6fb3c3ae-4e88-4c87-9b0d-a3bb66a8600d LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T17:15:25,178  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:25,178  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171525_6fb3c3ae-4e88-4c87-9b0d-a3bb66a8600d): drop table if exists T
2024-04-23T17:15:25,178  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:25,179  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:25,181  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:25,184  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,184  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T17:15:25,297  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t does not exist; Force to delete it.
2024-04-23T17:15:25,297 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:25,297  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:25,297  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=116, getTable_(GetTableRequest)=3}
2024-04-23T17:15:25,297  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171525_6fb3c3ae-4e88-4c87-9b0d-a3bb66a8600d); Time taken: 0.119 seconds
2024-04-23T17:15:25,297  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171525_6fb3c3ae-4e88-4c87-9b0d-a3bb66a8600d
2024-04-23T17:15:25,300  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T17:15:25,305  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:25,306  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T17:15:25,312  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T17:15:25,312  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171525_951c3b85-7a22-4ac1-a31c-ff5dfed6bac0): drop table if exists Tstage
2024-04-23T17:15:25,317  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T17:15:25,317  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T17:15:25,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:25,334  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,334  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:25,334  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:25,334  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:25,334  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=15, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=2}
2024-04-23T17:15:25,334  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171525_951c3b85-7a22-4ac1-a31c-ff5dfed6bac0); Time taken: 0.022 seconds
2024-04-23T17:15:25,335  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423171525_951c3b85-7a22-4ac1-a31c-ff5dfed6bac0
2024-04-23T17:15:25,335  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171525_951c3b85-7a22-4ac1-a31c-ff5dfed6bac0
2024-04-23T17:15:25,349  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171525_951c3b85-7a22-4ac1-a31c-ff5dfed6bac0 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T17:15:25,349  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:25,349  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171525_951c3b85-7a22-4ac1-a31c-ff5dfed6bac0): drop table if exists Tstage
2024-04-23T17:15:25,349  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:25,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:25,353  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:25,358  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T17:15:25,372  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage does not exist; Force to delete it.
2024-04-23T17:15:25,372 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:25,372  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:25,372  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=18, getTable_(GetTableRequest)=5}
2024-04-23T17:15:25,372  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171525_951c3b85-7a22-4ac1-a31c-ff5dfed6bac0); Time taken: 0.023 seconds
2024-04-23T17:15:25,372  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171525_951c3b85-7a22-4ac1-a31c-ff5dfed6bac0
2024-04-23T17:15:25,376  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T17:15:25,382  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:25,382  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T17:15:25,382  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:25,382  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171525_e888c52b-b14e-43b2-b135-0c010c36a14c): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:25,388  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T17:15:25,389  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T17:15:25,389  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:25,389  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:25,394  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T17:15:25,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:25,395  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:25,395  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:25,395  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:25,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:25,395  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=6, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0}
2024-04-23T17:15:25,395  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171525_e888c52b-b14e-43b2-b135-0c010c36a14c); Time taken: 0.013 seconds
2024-04-23T17:15:25,395  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423171525_e888c52b-b14e-43b2-b135-0c010c36a14c
2024-04-23T17:15:25,395  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171525_e888c52b-b14e-43b2-b135-0c010c36a14c
2024-04-23T17:15:25,413  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171525_e888c52b-b14e-43b2-b135-0c010c36a14c LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T17:15:25,413  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:25,414  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171525_e888c52b-b14e-43b2-b135-0c010c36a14c): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:25,414  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:25,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713917725, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:25,416  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:25,439  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:25,439  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=25}
2024-04-23T17:15:25,439  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171525_e888c52b-b14e-43b2-b135-0c010c36a14c); Time taken: 0.025 seconds
2024-04-23T17:15:25,439  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171525_e888c52b-b14e-43b2-b135-0c010c36a14c
2024-04-23T17:15:25,442  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T17:15:25,447  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:25,447  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T17:15:25,447  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:25,448  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171525_aaa2b98a-126e-4a29-924c-bb2e74d81622): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:25,450  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T17:15:25,450  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T17:15:25,451  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:25,451  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:25,453  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T17:15:25,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:25,454  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:25,454  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:25,454  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:25,454  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:25,454  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:25,454  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171525_aaa2b98a-126e-4a29-924c-bb2e74d81622); Time taken: 0.006 seconds
2024-04-23T17:15:25,454  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423171525_aaa2b98a-126e-4a29-924c-bb2e74d81622
2024-04-23T17:15:25,454  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171525_aaa2b98a-126e-4a29-924c-bb2e74d81622
2024-04-23T17:15:25,468  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171525_aaa2b98a-126e-4a29-924c-bb2e74d81622 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T17:15:25,468  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:25,468  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171525_aaa2b98a-126e-4a29-924c-bb2e74d81622): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:25,468  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:25,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713917725, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:25,471  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:25,482  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:25,482  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=13}
2024-04-23T17:15:25,482  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171525_aaa2b98a-126e-4a29-924c-bb2e74d81622); Time taken: 0.014 seconds
2024-04-23T17:15:25,483  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171525_aaa2b98a-126e-4a29-924c-bb2e74d81622
2024-04-23T17:15:25,486  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T17:15:25,491  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:25,491  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T17:15:25,491  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(1,4)
2024-04-23T17:15:25,492  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311): insert into Tstage values(0,2),(1,4)
2024-04-23T17:15:25,494  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T17:15:25,494  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T17:15:25,495  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:25,495  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:25,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:25,502  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,502  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:25,502  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:25,502  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:25,502  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:25,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:25,506  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,506  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:25,506  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T17:15:25,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:25,571  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:25,571  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:25,571  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:25,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:25,573  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:25,573  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:25,573  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:25,573  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:25,576  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,578  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1
2024-04-23T17:15:25,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:25,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:25,583  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:25,584  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T17:15:25,584  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T17:15:25,585  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:25,585  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:25,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:25,598  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:25,599  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:25,599  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:25,599  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:25,599  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:25,599  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T17:15:25,600  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:25,600  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=22, getTable_(GetTableRequest)=15, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0, getCheckConstraints_(CheckConstraintsRequest)=0}
2024-04-23T17:15:25,600  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311); Time taken: 0.108 seconds
2024-04-23T17:15:25,600  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311
2024-04-23T17:15:25,600  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311
2024-04-23T17:15:25,614  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T17:15:25,614  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:25,614  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311): insert into Tstage values(0,2),(1,4)
2024-04-23T17:15:25,614  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311
2024-04-23T17:15:25,614  INFO [main] ql.Driver: Query ID = alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311
Total jobs = 1
2024-04-23T17:15:25,614  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:25,614  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:25,616  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T17:15:25,616  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:25,616  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:25,616  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:25,616  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:25,616  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:25,616  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:25,616  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:25,619  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:25,619  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T17:15:25,619  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-25_492_7900044074202694901-1/dummy_path
2024-04-23T17:15:25,630  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:25,630  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T17:15:25,635  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:25,636  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T17:15:25,636  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:25,639  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-25_492_7900044074202694901-1/-mr-10001
2024-04-23T17:15:25,643  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:25,648  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:25,654  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:25,655  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T17:15:25,655  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T17:15:25,655  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-25_492_7900044074202694901-1/dummy_path
2024-04-23T17:15:25,655  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:25,673  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:25,696  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2052931718_0007
2024-04-23T17:15:25,696  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:25,758  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:25,758  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:25,758  INFO [Thread-648] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:25,759  INFO [Thread-648] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:25,760  INFO [Thread-648] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:25,760  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2052931718_0007_m_000000_0
2024-04-23T17:15:25,763  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:25,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-25_492_7900044074202694901-1/dummy_path/null:0+1
2024-04-23T17:15:25,766  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:25,767  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T17:15:25,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T17:15:25,772  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:25,772  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:25,772  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:25,772  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:25,772  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:25,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:25,773  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:25,774  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:25,774  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:25,774  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:25,775  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T17:15:25,775  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T17:15:25,775  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:25,775  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T17:15:25,775  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T17:15:25,775  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:25,776  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T17:15:25,777  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T17:15:25,777  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:25,777  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:25,777  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T17:15:25,777  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:25,777  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:25,777  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T17:15:25,778  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:25,780  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:25,780  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:25,780  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:25,780  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T17:15:25,780  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:25,791  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:25,796  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2052931718_0007_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:25,796  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:25,797  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2052931718_0007_m_000000_0' done.
2024-04-23T17:15:25,797  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2052931718_0007_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=167134
		FILE: Number of bytes written=8333695
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091567616
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-23T17:15:25,797  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2052931718_0007_m_000000_0
2024-04-23T17:15:25,797  INFO [Thread-648] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:25,798  INFO [Thread-648] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:25,798  INFO [pool-37-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2052931718_0007_r_000000_0
2024-04-23T17:15:25,800  INFO [pool-37-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:25,800  INFO [pool-37-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@78da54be
2024-04-23T17:15:25,800  WARN [pool-37-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:25,801  INFO [pool-37-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:25,801  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2052931718_0007_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:25,804  INFO [localfetcher#5] reduce.LocalFetcher: localfetcher#5 about to shuffle output of map attempt_local2052931718_0007_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T17:15:25,804  INFO [localfetcher#5] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local2052931718_0007_m_000000_0
2024-04-23T17:15:25,804  INFO [localfetcher#5] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T17:15:25,805  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:25,805  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:25,805  INFO [pool-37-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:25,811  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:25,811  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T17:15:25,814  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:25,814  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T17:15:25,814  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:25,814  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:25,814  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T17:15:25,814  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:25,815  INFO [pool-37-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:25,816  INFO [pool-37-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T17:15:25,817  INFO [pool-37-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:25,817  INFO [pool-37-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:25,817  INFO [pool-37-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T17:15:25,817  INFO [pool-37-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T17:15:25,818  INFO [pool-37-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local2052931718_0007/job_local2052931718_0007.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6bf9dbec
2024-04-23T17:15:25,818  INFO [pool-37-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:25,818  INFO [pool-37-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:25,818  INFO [pool-37-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T17:15:25,818  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-23T17:15:25,818  INFO [pool-37-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/_tmp.-ext-10000/000000_0
2024-04-23T17:15:25,818  INFO [pool-37-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T17:15:25,818  INFO [pool-37-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/_tmp.-ext-10000/000000_0
2024-04-23T17:15:25,831  INFO [pool-37-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_1_default.tstage:0, RECORDS_OUT_OPERATOR_FS_6:0, 
2024-04-23T17:15:25,831  INFO [pool-37-thread-1] mapred.Task: Task:attempt_local2052931718_0007_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:25,831  INFO [pool-37-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:25,831  INFO [pool-37-thread-1] mapred.Task: Task 'attempt_local2052931718_0007_r_000000_0' done.
2024-04-23T17:15:25,831  INFO [pool-37-thread-1] mapred.Task: Final Counters for attempt_local2052931718_0007_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=173600
		FILE: Number of bytes written=8333761
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091567616
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:25,831  INFO [pool-37-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2052931718_0007_r_000000_0
2024-04-23T17:15:25,832  INFO [pool-37-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2052931718_0007_r_000001_0
2024-04-23T17:15:25,832  INFO [pool-37-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:25,832  INFO [pool-37-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7d58bcd8
2024-04-23T17:15:25,832  WARN [pool-37-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:25,833  INFO [pool-37-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:25,833  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2052931718_0007_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:25,836  INFO [localfetcher#6] reduce.LocalFetcher: localfetcher#6 about to shuffle output of map attempt_local2052931718_0007_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T17:15:25,836  INFO [localfetcher#6] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local2052931718_0007_m_000000_0
2024-04-23T17:15:25,836  INFO [localfetcher#6] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T17:15:25,836  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:25,837  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:25,837  INFO [pool-37-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:25,843  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:25,843  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T17:15:25,846  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:25,846  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T17:15:25,846  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:25,846  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:25,846  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T17:15:25,846  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:25,847  INFO [pool-37-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:25,848  INFO [pool-37-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T17:15:25,849  INFO [pool-37-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:25,849  INFO [pool-37-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:25,849  INFO [pool-37-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T17:15:25,849  INFO [pool-37-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T17:15:25,849  INFO [pool-37-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local2052931718_0007/job_local2052931718_0007.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@19de7772
2024-04-23T17:15:25,850  INFO [pool-37-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/_tmp.-ext-10000/000001_0
2024-04-23T17:15:25,850  INFO [pool-37-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T17:15:25,850  INFO [pool-37-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/_tmp.-ext-10000/000001_0
2024-04-23T17:15:25,850  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T17:15:25,850  INFO [pool-37-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T17:15:25,856  INFO [pool-37-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T17:15:25,856  INFO [pool-37-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:25,856  INFO [pool-37-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:25,856  INFO [pool-37-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T17:15:25,856  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T17:15:25,864  INFO [pool-37-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-23T17:15:25,865  INFO [pool-37-thread-1] mapred.Task: Task:attempt_local2052931718_0007_r_000001_0 is done. And is in the process of committing
2024-04-23T17:15:25,865  INFO [pool-37-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:25,865  INFO [pool-37-thread-1] mapred.Task: Task 'attempt_local2052931718_0007_r_000001_0' done.
2024-04-23T17:15:25,865  INFO [pool-37-thread-1] mapred.Task: Final Counters for attempt_local2052931718_0007_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=180096
		FILE: Number of bytes written=8334149
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091567616
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:25,865  INFO [pool-37-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2052931718_0007_r_000001_0
2024-04-23T17:15:25,866  INFO [Thread-648] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:26,762 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:26,762  INFO [main] exec.Task: 2024-04-23 17:15:26,762 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2052931718_0007
2024-04-23T17:15:26,763  INFO [main] exec.Task: Ended Job = job_local2052931718_0007
2024-04-23T17:15:26,765  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T17:15:26,765  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1/-ext-10000
2024-04-23T17:15:26,765  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:26,769  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,769  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:26,774  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,776  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:26,776  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:26,790  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T17:15:26,790  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:26,793  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,794  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T17:15:26,794  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-25_492_7900044074202694901-1/-mr-10001
2024-04-23T17:15:26,797  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:26,800  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,801  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T17:15:26,801  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T17:15:26,801  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:26,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:26,816  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=2, numRows=2, totalSize=252, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T17:15:26,816  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:26,817  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=17, alter_table_(String, String, String, Table, EnvironmentContext, String)=29}
MapReduce Jobs Launched: 
2024-04-23T17:15:26,817  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:26,817  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:26,817  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:26,817  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311); Time taken: 1.202 seconds
2024-04-23T17:15:26,817  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171525_9d8a7369-705d-412c-8c35-c4de44242311
2024-04-23T17:15:26,822  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T17:15:26,829  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:26,829  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T17:15:26,829  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:26,829  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1
2024-04-23T17:15:26,830  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-25_492_7900044074202694901-1 on fs with scheme file
2024-04-23T17:15:26,830  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-25_492_7900044074202694901-1
2024-04-23T17:15:26,830  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-25_492_7900044074202694901-1 on fs with scheme file
2024-04-23T17:15:26,830  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171526_9b62cf8c-cd68-4ed7-8c71-e0f5d47ebb2d): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:26,831  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:26,834  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,836  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T17:15:26,837  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T17:15:26,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:26,842  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,842  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:26,842  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:26,842  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:26,842  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:26,843  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:26,843  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:26,843  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:26,843  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=7, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T17:15:26,843  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171526_9b62cf8c-cd68-4ed7-8c71-e0f5d47ebb2d); Time taken: 0.013 seconds
2024-04-23T17:15:26,843  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423171526_9b62cf8c-cd68-4ed7-8c71-e0f5d47ebb2d
2024-04-23T17:15:26,843  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171526_9b62cf8c-cd68-4ed7-8c71-e0f5d47ebb2d
2024-04-23T17:15:26,858  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171526_9b62cf8c-cd68-4ed7-8c71-e0f5d47ebb2d LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T17:15:26,858  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:26,858  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171526_9b62cf8c-cd68-4ed7-8c71-e0f5d47ebb2d): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:26,858  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:26,858  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:26,858  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:26,858  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:26,858  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:26,870  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:26,880  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:26,880  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:26,880  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171526_9b62cf8c-cd68-4ed7-8c71-e0f5d47ebb2d); Time taken: 0.022 seconds
2024-04-23T17:15:26,881  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171526_9b62cf8c-cd68-4ed7-8c71-e0f5d47ebb2d
2024-04-23T17:15:26,885  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T17:15:26,892  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:26,892  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T17:15:26,892  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data'
2024-04-23T17:15:26,893  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171526_fdccb144-da02-4c21-b0a4-df8fd874ab3e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data'
2024-04-23T17:15:26,896  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T17:15:26,896  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T17:15:26,897  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:26,901  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,910  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 19
2024-04-23T17:15:26,911  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [19])
2024-04-23T17:15:26,912  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:26,912  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:26,912  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:26,912  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=4, allocateTableWriteId_(long, String, String)=8, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T17:15:26,912  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171526_fdccb144-da02-4c21-b0a4-df8fd874ab3e); Time taken: 0.019 seconds
2024-04-23T17:15:26,912  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423171526_fdccb144-da02-4c21-b0a4-df8fd874ab3e
2024-04-23T17:15:26,912  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171526_fdccb144-da02-4c21-b0a4-df8fd874ab3e
2024-04-23T17:15:26,929  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171526_fdccb144-da02-4c21-b0a4-df8fd874ab3e LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T17:15:26,929  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:26,933  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171526_fdccb144-da02-4c21-b0a4-df8fd874ab3e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data'
2024-04-23T17:15:26,933  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:26,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:26,936  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,936  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:26,942  INFO [HMSHandler #8] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:26,956  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T17:15:26,957  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data
2024-04-23T17:15:26,957  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:26,959  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,960  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:26,971  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T17:15:26,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:26,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:26,974  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:26,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:26,979  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T17:15:26,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:26,983  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T17:15:27,005  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:27,021  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:27,025  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:27,025  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=38, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8, getPartitionWithAuthInfo_(String, String, List, String, List)=17, validatePartitionNameCharacters_(List)=0, getValidWriteIds_(List, String)=0, add_partitions_(List, boolean, boolean)=20}
2024-04-23T17:15:27,025  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171526_fdccb144-da02-4c21-b0a4-df8fd874ab3e); Time taken: 0.092 seconds
2024-04-23T17:15:27,025  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171526_fdccb144-da02-4c21-b0a4-df8fd874ab3e
2024-04-23T17:15:27,029  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T17:15:27,034  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:27,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T17:15:27,034  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:27,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:27,037  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T17:15:27,038  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T17:15:27,039  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:27,039  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:27,044  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:27,044  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:27,045  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:27,047  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:27,048  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:27,048  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:27,048  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:27,050  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:27,076  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:27,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:27,090  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:27,092  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:27,093  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:27,100  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:27,100  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:27,129  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:27,129  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:27,129  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:27,131  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-27_034_1173072362552012256-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-27_034_1173072362552012256-1
2024-04-23T17:15:27,138  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:27,140  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:27,140  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:27,141  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:27,150  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:27,150  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:27,150  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:27,151  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:27,151  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:27,151  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:27,151  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:27,151  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T17:15:27,152  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T17:15:27,152  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:27,152  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=5, getAllTableConstraints_(AllTableConstraintsRequest)=21, getTable_(GetTableRequest)=3, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=10, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=6, getValidTxns_(long)=1}
2024-04-23T17:15:27,152  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987); Time taken: 0.117 seconds
2024-04-23T17:15:27,152  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987
2024-04-23T17:15:27,153  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987
2024-04-23T17:15:27,166  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T17:15:27,166  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:27,166  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:27,167  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987
2024-04-23T17:15:27,167  INFO [main] ql.Driver: Query ID = alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987
Total jobs = 1
2024-04-23T17:15:27,167  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:27,167  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:27,170  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:27,170  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:27,170  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:27,170  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:27,170  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:27,170  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:27,170  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:27,170  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:27,172  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:27,172  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:27,172  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:27,182  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:27,183  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,34KB
2024-04-23T17:15:27,188  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:27,191  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T17:15:27,192  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:27,195  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:27,201  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:27,206  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:27,207  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:27,207  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:27,207  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:27,207  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:27,207  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T17:15:27,207  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:27,217  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T17:15:27,217  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 1). duration: 10 ms
2024-04-23T17:15:27,217  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:27,237  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:27,258  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1961791391_0008
2024-04-23T17:15:27,258  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:27,337  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:27,338  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:27,338  INFO [Thread-729] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:27,338  INFO [Thread-729] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:27,339  INFO [Thread-729] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:27,340  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1961791391_0008_m_000000_0
2024-04-23T17:15:27,340  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:27,341  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:27,341  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:27,342  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,34KB
2024-04-23T17:15:27,343  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T17:15:27,344  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0 with {include: [true, true, true], offset: 0, length: 252, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:27,350  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T17:15:27,350  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:27,355  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:27,355  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:27,355  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:27,355  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:27,355  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:27,356  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:27,356  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:27,357  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:27,357  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:27,357  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:27,357  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T17:15:27,357  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:27,357  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:27,358  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:27,359  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:27,359  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:27,359  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:27,359  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T17:15:27,359  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:27,369  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:27,373  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1961791391_0008_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:27,373  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:27,373  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1961791391_0008_m_000000_0' done.
2024-04-23T17:15:27,373  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1961791391_0008_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=188106
		FILE: Number of bytes written=9523526
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091567616
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=6464
2024-04-23T17:15:27,373  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1961791391_0008_m_000000_0
2024-04-23T17:15:27,373  INFO [Thread-729] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:27,374  INFO [Thread-729] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:27,374  INFO [pool-43-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1961791391_0008_r_000000_0
2024-04-23T17:15:27,375  INFO [pool-43-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:27,375  INFO [pool-43-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@58439444
2024-04-23T17:15:27,375  WARN [pool-43-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:27,375  INFO [pool-43-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:27,375  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1961791391_0008_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:27,376  INFO [localfetcher#7] reduce.LocalFetcher: localfetcher#7 about to shuffle output of map attempt_local1961791391_0008_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-23T17:15:27,376  INFO [localfetcher#7] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1961791391_0008_m_000000_0
2024-04-23T17:15:27,376  INFO [localfetcher#7] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-23T17:15:27,377  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:27,377  INFO [pool-43-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:27,377  INFO [pool-43-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:27,383  INFO [pool-43-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:27,383  INFO [pool-43-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-23T17:15:27,386  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 412 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:27,386  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merging 1 files, 416 bytes from disk
2024-04-23T17:15:27,386  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:27,386  INFO [pool-43-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:27,386  INFO [pool-43-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-23T17:15:27,386  INFO [pool-43-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:27,387  INFO [pool-43-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:27,390  INFO [pool-43-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T17:15:27,391  INFO [pool-43-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:27,391  INFO [pool-43-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:27,391  INFO [pool-43-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-23T17:15:27,391  INFO [pool-43-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:27,391  INFO [pool-43-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@6cdc0cdf, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@61428675>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@32dfb392, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@7a573472
2024-04-23T17:15:27,392  INFO [pool-43-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-27_034_1173072362552012256-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-27_034_1173072362552012256-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:27,392  INFO [pool-43-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-27_034_1173072362552012256-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-27_034_1173072362552012256-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:27,392  INFO [pool-43-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-27_034_1173072362552012256-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-27_034_1173072362552012256-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:27,400  INFO [pool-43-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:27,400  INFO [pool-43-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:27,400  INFO [pool-43-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:27,400  INFO [pool-43-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:27,400  INFO [pool-43-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T17:15:27,400  INFO [pool-43-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:2, 
2024-04-23T17:15:27,401  INFO [pool-43-thread-1] mapred.Task: Task:attempt_local1961791391_0008_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:27,401  INFO [pool-43-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:27,401  INFO [pool-43-thread-1] mapred.Task: Task 'attempt_local1961791391_0008_r_000000_0' done.
2024-04-23T17:15:27,401  INFO [pool-43-thread-1] mapred.Task: Final Counters for attempt_local1961791391_0008_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=195251
		FILE: Number of bytes written=9524427
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=416
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091567616
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:27,401  INFO [pool-43-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1961791391_0008_r_000000_0
2024-04-23T17:15:27,401  INFO [Thread-729] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:28,340 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:28,340  INFO [main] exec.Task: 2024-04-23 17:15:28,340 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1961791391_0008
2024-04-23T17:15:28,341  INFO [main] exec.Task: Ended Job = job_local1961791391_0008
2024-04-23T17:15:28,342  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,342  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:28,342  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:28,342  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:28,343  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:28,343  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987); Time taken: 1.176 seconds
2024-04-23T17:15:28,343  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171527_f354982f-98c8-44d0-a424-ea7c56ee3987
2024-04-23T17:15:28,346  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T17:15:28,351  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,351  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T17:15:28,355  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:28,356  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T17:15:28,356  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:28,356  WARN [main] ql.TestTxnAddPartition: addPartitionBucketed: read data(add partition (p=0)): 
2024-04-23T17:15:28,356  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536936448,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0
{"writeid":1,"bucketid":536936448,"rowid":1}	0	1	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0

2024-04-23T17:15:28,356  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:28,356  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-27_034_1173072362552012256-1
2024-04-23T17:15:28,357  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9b4ad973-e430-49c5-98b7-94d67e49f76a/hive_2024-04-23_17-15-27_034_1173072362552012256-1 on fs with scheme file
2024-04-23T17:15:28,357  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_a97156de-27a4-4699-af20-1c6152d3e61f): drop table if exists acidTbl
2024-04-23T17:15:28,360  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-23T17:15:28,360  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T17:15:28,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:28,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,364  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,364  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,364  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,364  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:28,364  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_a97156de-27a4-4699-af20-1c6152d3e61f); Time taken: 0.007 seconds
2024-04-23T17:15:28,364  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423171528_a97156de-27a4-4699-af20-1c6152d3e61f
2024-04-23T17:15:28,365  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171528_a97156de-27a4-4699-af20-1c6152d3e61f
2024-04-23T17:15:28,378  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171528_a97156de-27a4-4699-af20-1c6152d3e61f LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T17:15:28,378  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:28,378  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_a97156de-27a4-4699-af20-1c6152d3e61f): drop table if exists acidTbl
2024-04-23T17:15:28,378  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:28,380  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,381  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:28,383  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:28,453  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,454  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=72, getTable_(GetTableRequest)=3}
2024-04-23T17:15:28,454  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_a97156de-27a4-4699-af20-1c6152d3e61f); Time taken: 0.075 seconds
2024-04-23T17:15:28,454  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_a97156de-27a4-4699-af20-1c6152d3e61f
2024-04-23T17:15:28,457  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T17:15:28,463  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,463  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T17:15:28,464  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:28,464  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_7c1d2a27-1384-4f4e-aeef-bc7f46d6124e): drop table if exists acidTblPart
2024-04-23T17:15:28,467  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 21
2024-04-23T17:15:28,467  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T17:15:28,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:28,471  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,471  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,471  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:28,471  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_7c1d2a27-1384-4f4e-aeef-bc7f46d6124e); Time taken: 0.007 seconds
2024-04-23T17:15:28,471  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423171528_7c1d2a27-1384-4f4e-aeef-bc7f46d6124e
2024-04-23T17:15:28,472  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171528_7c1d2a27-1384-4f4e-aeef-bc7f46d6124e
2024-04-23T17:15:28,487  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171528_7c1d2a27-1384-4f4e-aeef-bc7f46d6124e LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T17:15:28,487  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:28,487  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_7c1d2a27-1384-4f4e-aeef-bc7f46d6124e): drop table if exists acidTblPart
2024-04-23T17:15:28,487  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:28,490  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:28,493  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,494  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:28,516  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,516  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=26, getTable_(GetTableRequest)=3}
2024-04-23T17:15:28,516  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_7c1d2a27-1384-4f4e-aeef-bc7f46d6124e); Time taken: 0.029 seconds
2024-04-23T17:15:28,516  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_7c1d2a27-1384-4f4e-aeef-bc7f46d6124e
2024-04-23T17:15:28,520  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T17:15:28,525  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,525  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T17:15:28,525  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:28,526  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_056bede6-a265-4bb4-84ac-b0f8de791923): drop table if exists acidTbl2
2024-04-23T17:15:28,529  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 21
2024-04-23T17:15:28,529  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T17:15:28,530  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,530  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,530  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,530  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:28,530  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_056bede6-a265-4bb4-84ac-b0f8de791923); Time taken: 0.004 seconds
2024-04-23T17:15:28,530  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423171528_056bede6-a265-4bb4-84ac-b0f8de791923
2024-04-23T17:15:28,530  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:28,530  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_056bede6-a265-4bb4-84ac-b0f8de791923): drop table if exists acidTbl2
2024-04-23T17:15:28,531  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,531  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T17:15:28,531  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,531  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0}
2024-04-23T17:15:28,531  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_056bede6-a265-4bb4-84ac-b0f8de791923); Time taken: 0.001 seconds
2024-04-23T17:15:28,531  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_056bede6-a265-4bb4-84ac-b0f8de791923
2024-04-23T17:15:28,536  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T17:15:28,542  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,542  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T17:15:28,542  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:28,543  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_dac2b85a-0f8e-474d-ac12-1b7e6638349b): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:28,545  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 21
2024-04-23T17:15:28,545  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T17:15:28,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:28,560  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,560  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,560  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,560  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,560  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:28,560  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_dac2b85a-0f8e-474d-ac12-1b7e6638349b); Time taken: 0.017 seconds
2024-04-23T17:15:28,561  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423171528_dac2b85a-0f8e-474d-ac12-1b7e6638349b
2024-04-23T17:15:28,561  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171528_dac2b85a-0f8e-474d-ac12-1b7e6638349b
2024-04-23T17:15:28,574  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171528_dac2b85a-0f8e-474d-ac12-1b7e6638349b LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T17:15:28,574  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:28,574  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_dac2b85a-0f8e-474d-ac12-1b7e6638349b): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:28,574  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,574  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:28,578  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,578  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:28,582  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:28,642  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,642  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=64, getTable_(GetTableRequest)=4}
2024-04-23T17:15:28,642  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_dac2b85a-0f8e-474d-ac12-1b7e6638349b); Time taken: 0.068 seconds
2024-04-23T17:15:28,643  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_dac2b85a-0f8e-474d-ac12-1b7e6638349b
2024-04-23T17:15:28,646  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T17:15:28,652  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,652  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T17:15:28,653  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:28,653  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_38e6940b-c51b-44a1-a1a6-96e9834895d6): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:28,655  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 21
2024-04-23T17:15:28,656  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T17:15:28,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:28,660  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,661  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,661  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,661  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,661  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:28,661  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_38e6940b-c51b-44a1-a1a6-96e9834895d6); Time taken: 0.008 seconds
2024-04-23T17:15:28,661  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423171528_38e6940b-c51b-44a1-a1a6-96e9834895d6
2024-04-23T17:15:28,661  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171528_38e6940b-c51b-44a1-a1a6-96e9834895d6
2024-04-23T17:15:28,676  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171528_38e6940b-c51b-44a1-a1a6-96e9834895d6 LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T17:15:28,676  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:28,676  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_38e6940b-c51b-44a1-a1a6-96e9834895d6): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:28,676  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:28,680  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:28,683  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,683  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:28,696  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,696  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=16, getTable_(GetTableRequest)=4}
2024-04-23T17:15:28,696  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_38e6940b-c51b-44a1-a1a6-96e9834895d6); Time taken: 0.02 seconds
2024-04-23T17:15:28,697  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_38e6940b-c51b-44a1-a1a6-96e9834895d6
2024-04-23T17:15:28,700  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T17:15:28,706  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,706  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T17:15:28,706  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:28,707  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_45d403bf-3030-4a1d-a5a9-efbc8d2aa925): drop table if exists nonAcidNonBucket
2024-04-23T17:15:28,709  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 21
2024-04-23T17:15:28,709  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T17:15:28,717  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:28,720  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,720  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,721  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=7, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:28,721  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_45d403bf-3030-4a1d-a5a9-efbc8d2aa925); Time taken: 0.015 seconds
2024-04-23T17:15:28,721  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423171528_45d403bf-3030-4a1d-a5a9-efbc8d2aa925
2024-04-23T17:15:28,721  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171528_45d403bf-3030-4a1d-a5a9-efbc8d2aa925
2024-04-23T17:15:28,735  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171528_45d403bf-3030-4a1d-a5a9-efbc8d2aa925 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T17:15:28,735  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:28,735  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_45d403bf-3030-4a1d-a5a9-efbc8d2aa925): drop table if exists nonAcidNonBucket
2024-04-23T17:15:28,735  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:28,738  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,738  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:28,741  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:28,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:28,753  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,753  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=15, getTable_(GetTableRequest)=3}
2024-04-23T17:15:28,754  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_45d403bf-3030-4a1d-a5a9-efbc8d2aa925); Time taken: 0.018 seconds
2024-04-23T17:15:28,754  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_45d403bf-3030-4a1d-a5a9-efbc8d2aa925
2024-04-23T17:15:28,757  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T17:15:28,763  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,763  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T17:15:28,763  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T17:15:28,827  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T17:15:28,827  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T17:15:28,827  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T17:15:28,827  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T17:15:28,827  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T17:15:28,827  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T17:15:28,828  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T17:15:28,828  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T17:15:28,828  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T17:15:28,828  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T17:15:28,828  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T17:15:28,830  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 4dab02a3-51a3-4062-a1be-d3c2210ecdfe
2024-04-23T17:15:28,832  INFO [main] SessionState: Hive Session ID = 4dab02a3-51a3-4062-a1be-d3c2210ecdfe
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:28,833  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:28,838  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4dab02a3-51a3-4062-a1be-d3c2210ecdfe
2024-04-23T17:15:28,841  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4dab02a3-51a3-4062-a1be-d3c2210ecdfe
2024-04-23T17:15:28,843  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/_tmp_space.db
2024-04-23T17:15:28,843  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=4dab02a3-51a3-4062-a1be-d3c2210ecdfe, clientType=HIVECLI]
2024-04-23T17:15:28,844  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:28,844  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_3f441fc2-6ab5-41d4-ae1d-4c2a0187f2fb): drop table if exists acidTbl
2024-04-23T17:15:28,851  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T17:15:28,851  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T17:15:28,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:28,855  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,855  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,855  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,855  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=6, isCompatibleWith_(Configuration)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:28,855  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_3f441fc2-6ab5-41d4-ae1d-4c2a0187f2fb); Time taken: 0.011 seconds
2024-04-23T17:15:28,855  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423171528_3f441fc2-6ab5-41d4-ae1d-4c2a0187f2fb
2024-04-23T17:15:28,855  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:28,855  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_3f441fc2-6ab5-41d4-ae1d-4c2a0187f2fb): drop table if exists acidTbl
2024-04-23T17:15:28,855  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,855  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:28,856  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,856  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:28,856  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_3f441fc2-6ab5-41d4-ae1d-4c2a0187f2fb); Time taken: 0.001 seconds
2024-04-23T17:15:28,857  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_3f441fc2-6ab5-41d4-ae1d-4c2a0187f2fb
2024-04-23T17:15:28,862  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T17:15:28,868  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,868  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T17:15:28,869  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:28,869  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_3149bd2e-5ca3-4855-90dd-7e204affe47f): drop table if exists acidTblPart
2024-04-23T17:15:28,871  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T17:15:28,872  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T17:15:28,872  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:28,873  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,873  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,873  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,873  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T17:15:28,873  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_3149bd2e-5ca3-4855-90dd-7e204affe47f); Time taken: 0.004 seconds
2024-04-23T17:15:28,873  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423171528_3149bd2e-5ca3-4855-90dd-7e204affe47f
2024-04-23T17:15:28,874  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:28,874  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_3149bd2e-5ca3-4855-90dd-7e204affe47f): drop table if exists acidTblPart
2024-04-23T17:15:28,874  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:28,875  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,875  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:28,875  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_3149bd2e-5ca3-4855-90dd-7e204affe47f); Time taken: 0.001 seconds
2024-04-23T17:15:28,875  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_3149bd2e-5ca3-4855-90dd-7e204affe47f
2024-04-23T17:15:28,880  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T17:15:28,886  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,886  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T17:15:28,886  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:28,887  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_de4b0882-7962-4b02-8965-66bf1d0da200): drop table if exists acidTbl2
2024-04-23T17:15:28,889  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T17:15:28,890  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T17:15:28,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:28,891  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,891  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,891  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,891  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T17:15:28,891  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_de4b0882-7962-4b02-8965-66bf1d0da200); Time taken: 0.004 seconds
2024-04-23T17:15:28,892  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423171528_de4b0882-7962-4b02-8965-66bf1d0da200
2024-04-23T17:15:28,892  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:28,892  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_de4b0882-7962-4b02-8965-66bf1d0da200): drop table if exists acidTbl2
2024-04-23T17:15:28,892  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,892  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:28,893  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,893  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:28,893  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_de4b0882-7962-4b02-8965-66bf1d0da200); Time taken: 0.001 seconds
2024-04-23T17:15:28,893  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_de4b0882-7962-4b02-8965-66bf1d0da200
2024-04-23T17:15:28,898  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T17:15:28,903  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,903  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T17:15:28,904  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:28,904  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_91c16d33-a18e-4549-9da9-73885f23ff7d): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:28,907  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T17:15:28,907  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T17:15:28,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:28,908  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,909  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,909  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,909  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T17:15:28,909  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_91c16d33-a18e-4549-9da9-73885f23ff7d); Time taken: 0.005 seconds
2024-04-23T17:15:28,909  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423171528_91c16d33-a18e-4549-9da9-73885f23ff7d
2024-04-23T17:15:28,909  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:28,909  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_91c16d33-a18e-4549-9da9-73885f23ff7d): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:28,909  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:28,910  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,910  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:28,910  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_91c16d33-a18e-4549-9da9-73885f23ff7d); Time taken: 0.001 seconds
2024-04-23T17:15:28,911  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_91c16d33-a18e-4549-9da9-73885f23ff7d
2024-04-23T17:15:28,915  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T17:15:28,920  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,921  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T17:15:28,921  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:28,921  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_a2f7bbf1-565d-496e-aea5-6fbec1923134): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:28,924  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T17:15:28,924  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T17:15:28,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:28,925  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,925  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,925  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,925  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:28,926  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_a2f7bbf1-565d-496e-aea5-6fbec1923134); Time taken: 0.004 seconds
2024-04-23T17:15:28,926  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423171528_a2f7bbf1-565d-496e-aea5-6fbec1923134
2024-04-23T17:15:28,926  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:28,926  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_a2f7bbf1-565d-496e-aea5-6fbec1923134): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:28,926  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,926  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:28,927  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,927  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:28,927  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_a2f7bbf1-565d-496e-aea5-6fbec1923134); Time taken: 0.001 seconds
2024-04-23T17:15:28,927  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_a2f7bbf1-565d-496e-aea5-6fbec1923134
2024-04-23T17:15:28,932  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T17:15:28,937  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,937  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T17:15:28,938  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:28,938  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_0567c098-6c76-46b5-9d12-6becf85d409c): drop table if exists nonAcidNonBucket
2024-04-23T17:15:28,940  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T17:15:28,940  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T17:15:28,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:28,942  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,942  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,942  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,942  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:28,942  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_0567c098-6c76-46b5-9d12-6becf85d409c); Time taken: 0.004 seconds
2024-04-23T17:15:28,943  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423171528_0567c098-6c76-46b5-9d12-6becf85d409c
2024-04-23T17:15:28,943  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:28,943  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_0567c098-6c76-46b5-9d12-6becf85d409c): drop table if exists nonAcidNonBucket
2024-04-23T17:15:28,943  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:28,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:28,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:28,944  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_0567c098-6c76-46b5-9d12-6becf85d409c); Time taken: 0.001 seconds
2024-04-23T17:15:28,944  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_0567c098-6c76-46b5-9d12-6becf85d409c
2024-04-23T17:15:28,949  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T17:15:28,953  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:28,953  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T17:15:28,953  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:28,954  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171528_1c1732d7-a8e0-42b5-be55-78f783ce15d1): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:28,956  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T17:15:28,956  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T17:15:28,957  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:28,957  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:28,962  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T17:15:28,962  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:28,963  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:28,963  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:28,963  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:28,963  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:28,963  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0}
2024-04-23T17:15:28,963  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171528_1c1732d7-a8e0-42b5-be55-78f783ce15d1); Time taken: 0.009 seconds
2024-04-23T17:15:28,963  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423171528_1c1732d7-a8e0-42b5-be55-78f783ce15d1
2024-04-23T17:15:28,963  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171528_1c1732d7-a8e0-42b5-be55-78f783ce15d1
2024-04-23T17:15:28,980  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171528_1c1732d7-a8e0-42b5-be55-78f783ce15d1 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T17:15:28,980  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:28,981  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171528_1c1732d7-a8e0-42b5-be55-78f783ce15d1): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:28,981  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:28,982  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713917728, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:28,984  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtbl
2024-04-23T17:15:29,015  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,015  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=33}
2024-04-23T17:15:29,015  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171528_1c1732d7-a8e0-42b5-be55-78f783ce15d1); Time taken: 0.034 seconds
2024-04-23T17:15:29,016  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171528_1c1732d7-a8e0-42b5-be55-78f783ce15d1
2024-04-23T17:15:29,019  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T17:15:29,025  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,025  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T17:15:29,025  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:29,026  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_e5311993-5d45-41b8-8dee-f3cc06e113f4): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:29,029  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T17:15:29,029  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T17:15:29,029  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:29,029  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:29,032  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T17:15:29,032  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:29,033  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:29,033  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,033  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,033  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,033  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=1, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:29,033  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_e5311993-5d45-41b8-8dee-f3cc06e113f4); Time taken: 0.007 seconds
2024-04-23T17:15:29,033  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423171529_e5311993-5d45-41b8-8dee-f3cc06e113f4
2024-04-23T17:15:29,033  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_e5311993-5d45-41b8-8dee-f3cc06e113f4
2024-04-23T17:15:29,048  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_e5311993-5d45-41b8-8dee-f3cc06e113f4 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T17:15:29,048  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:29,048  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_e5311993-5d45-41b8-8dee-f3cc06e113f4): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:29,049  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713917729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:29,051  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtblpart
2024-04-23T17:15:29,060  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,060  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=11}
2024-04-23T17:15:29,060  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_e5311993-5d45-41b8-8dee-f3cc06e113f4); Time taken: 0.012 seconds
2024-04-23T17:15:29,061  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_e5311993-5d45-41b8-8dee-f3cc06e113f4
2024-04-23T17:15:29,064  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T17:15:29,069  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,069  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T17:15:29,069  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,070  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_1e56f24c-232f-4a6a-b99e-e79da163561c): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,072  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T17:15:29,073  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T17:15:29,073  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:29,073  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:29,076  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T17:15:29,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:29,077  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:29,077  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,077  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,077  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,077  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:29,077  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_1e56f24c-232f-4a6a-b99e-e79da163561c); Time taken: 0.007 seconds
2024-04-23T17:15:29,077  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423171529_1e56f24c-232f-4a6a-b99e-e79da163561c
2024-04-23T17:15:29,077  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_1e56f24c-232f-4a6a-b99e-e79da163561c
2024-04-23T17:15:29,090  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_1e56f24c-232f-4a6a-b99e-e79da163561c LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T17:15:29,090  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:29,090  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_1e56f24c-232f-4a6a-b99e-e79da163561c): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,090  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,091  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713917729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:29,093  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl
2024-04-23T17:15:29,101  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,101  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=9}
2024-04-23T17:15:29,101  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_1e56f24c-232f-4a6a-b99e-e79da163561c); Time taken: 0.011 seconds
2024-04-23T17:15:29,101  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_1e56f24c-232f-4a6a-b99e-e79da163561c
2024-04-23T17:15:29,104  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T17:15:29,109  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,109  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T17:15:29,110  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,110  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_bececa6d-6537-43a8-808c-36027429424a): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,113  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T17:15:29,113  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T17:15:29,114  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:29,114  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:29,116  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T17:15:29,116  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:29,117  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:29,117  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,117  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,117  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,117  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:29,117  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_bececa6d-6537-43a8-808c-36027429424a); Time taken: 0.007 seconds
2024-04-23T17:15:29,117  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423171529_bececa6d-6537-43a8-808c-36027429424a
2024-04-23T17:15:29,118  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_bececa6d-6537-43a8-808c-36027429424a
2024-04-23T17:15:29,133  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_bececa6d-6537-43a8-808c-36027429424a LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T17:15:29,133  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:29,133  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_bececa6d-6537-43a8-808c-36027429424a): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,134  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713917729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:29,137  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl2
2024-04-23T17:15:29,145  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,145  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=10}
2024-04-23T17:15:29,145  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_bececa6d-6537-43a8-808c-36027429424a); Time taken: 0.012 seconds
2024-04-23T17:15:29,145  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_bececa6d-6537-43a8-808c-36027429424a
2024-04-23T17:15:29,150  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T17:15:29,156  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,156  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T17:15:29,156  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:29,156  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_15432c6a-f907-4591-9214-77783769d19e): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:29,159  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T17:15:29,159  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T17:15:29,160  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:29,160  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:29,162  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T17:15:29,162  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:29,163  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:29,163  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,163  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,163  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,163  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:29,163  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_15432c6a-f907-4591-9214-77783769d19e); Time taken: 0.007 seconds
2024-04-23T17:15:29,163  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423171529_15432c6a-f907-4591-9214-77783769d19e
2024-04-23T17:15:29,163  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_15432c6a-f907-4591-9214-77783769d19e
2024-04-23T17:15:29,177  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_15432c6a-f907-4591-9214-77783769d19e LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T17:15:29,177  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:29,178  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_15432c6a-f907-4591-9214-77783769d19e): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:29,178  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,179  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/_tmp_space.db/b18fcbb1-cfcd-40ee-999f-40f9e63b1cc9
2024-04-23T17:15:29,182  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,182  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T17:15:29,182  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_15432c6a-f907-4591-9214-77783769d19e); Time taken: 0.004 seconds
2024-04-23T17:15:29,182  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_15432c6a-f907-4591-9214-77783769d19e
2024-04-23T17:15:29,186  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T17:15:29,191  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,191  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T17:15:29,192  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,192  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_fb4331d6-5852-4270-8807-5f9ff4e1fe8b): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,194  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T17:15:29,194  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T17:15:29,195  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:29,195  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:29,198  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T17:15:29,198  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:29,199  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:29,199  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,199  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,199  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,199  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0}
2024-04-23T17:15:29,199  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_fb4331d6-5852-4270-8807-5f9ff4e1fe8b); Time taken: 0.007 seconds
2024-04-23T17:15:29,199  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423171529_fb4331d6-5852-4270-8807-5f9ff4e1fe8b
2024-04-23T17:15:29,199  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_fb4331d6-5852-4270-8807-5f9ff4e1fe8b
2024-04-23T17:15:29,213  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_fb4331d6-5852-4270-8807-5f9ff4e1fe8b LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T17:15:29,213  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:29,213  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_fb4331d6-5852-4270-8807-5f9ff4e1fe8b): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:29,213  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,214  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713917729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:29,216  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidnonbucket
2024-04-23T17:15:29,224  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,224  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=10}
2024-04-23T17:15:29,224  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_fb4331d6-5852-4270-8807-5f9ff4e1fe8b); Time taken: 0.011 seconds
2024-04-23T17:15:29,224  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_fb4331d6-5852-4270-8807-5f9ff4e1fe8b
2024-04-23T17:15:29,228  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T17:15:29,234  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,235  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T17:15:29,241  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T17:15:29,241  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_d7955ee3-2726-4201-92de-c5dc9e607b2d): drop table if exists T
2024-04-23T17:15:29,244  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T17:15:29,244  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T17:15:29,245  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:29,259  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,259  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,259  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:29,259  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_d7955ee3-2726-4201-92de-c5dc9e607b2d); Time taken: 0.018 seconds
2024-04-23T17:15:29,259  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423171529_d7955ee3-2726-4201-92de-c5dc9e607b2d
2024-04-23T17:15:29,260  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_d7955ee3-2726-4201-92de-c5dc9e607b2d
2024-04-23T17:15:29,276  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_d7955ee3-2726-4201-92de-c5dc9e607b2d LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T17:15:29,276  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:29,276  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_d7955ee3-2726-4201-92de-c5dc9e607b2d): drop table if exists T
2024-04-23T17:15:29,276  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,276  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:29,279  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,279  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:29,282  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T17:15:29,380  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t does not exist; Force to delete it.
2024-04-23T17:15:29,380 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:29,381  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,381  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=102, getTable_(GetTableRequest)=3}
2024-04-23T17:15:29,381  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_d7955ee3-2726-4201-92de-c5dc9e607b2d); Time taken: 0.105 seconds
2024-04-23T17:15:29,381  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_d7955ee3-2726-4201-92de-c5dc9e607b2d
2024-04-23T17:15:29,384  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T17:15:29,389  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,389  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T17:15:29,390  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T17:15:29,390  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_2c335d68-c931-4f68-b448-d79638bd6ab3): drop table if exists Tstage
2024-04-23T17:15:29,393  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T17:15:29,393  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T17:15:29,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:29,408  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,408  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,408  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,408  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,408  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, flushCache_()=1, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:29,408  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_2c335d68-c931-4f68-b448-d79638bd6ab3); Time taken: 0.018 seconds
2024-04-23T17:15:29,408  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423171529_2c335d68-c931-4f68-b448-d79638bd6ab3
2024-04-23T17:15:29,409  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_2c335d68-c931-4f68-b448-d79638bd6ab3
2024-04-23T17:15:29,421  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_2c335d68-c931-4f68-b448-d79638bd6ab3 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T17:15:29,421  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:29,421  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_2c335d68-c931-4f68-b448-d79638bd6ab3): drop table if exists Tstage
2024-04-23T17:15:29,422  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:29,425  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:29,428  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,428  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T17:15:29,441  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage does not exist; Force to delete it.
2024-04-23T17:15:29,441 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:29,441  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,441  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=16, getTable_(GetTableRequest)=3}
2024-04-23T17:15:29,441  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_2c335d68-c931-4f68-b448-d79638bd6ab3); Time taken: 0.02 seconds
2024-04-23T17:15:29,441  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_2c335d68-c931-4f68-b448-d79638bd6ab3
2024-04-23T17:15:29,445  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T17:15:29,449  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,449  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T17:15:29,450  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:29,450  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_b6a9c46d-a28d-4105-89a1-234701e07982): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:29,452  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T17:15:29,452  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T17:15:29,453  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:29,453  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:29,458  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T17:15:29,458  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:29,459  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:29,459  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,459  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,460  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,460  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0}
2024-04-23T17:15:29,460  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_b6a9c46d-a28d-4105-89a1-234701e07982); Time taken: 0.009 seconds
2024-04-23T17:15:29,460  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423171529_b6a9c46d-a28d-4105-89a1-234701e07982
2024-04-23T17:15:29,460  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_b6a9c46d-a28d-4105-89a1-234701e07982
2024-04-23T17:15:29,478  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_b6a9c46d-a28d-4105-89a1-234701e07982 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T17:15:29,478  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:29,479  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_b6a9c46d-a28d-4105-89a1-234701e07982): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:29,479  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,480  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713917729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:29,481  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:29,505  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,505  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=26}
2024-04-23T17:15:29,505  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_b6a9c46d-a28d-4105-89a1-234701e07982); Time taken: 0.026 seconds
2024-04-23T17:15:29,505  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_b6a9c46d-a28d-4105-89a1-234701e07982
2024-04-23T17:15:29,509  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T17:15:29,514  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,515  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T17:15:29,515  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:29,515  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_cfc45dad-ac92-49bf-85e0-6235ac8d7e22): create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:29,519  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T17:15:29,519  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T17:15:29,520  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:29,520  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:29,523  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T17:15:29,523  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:29,524  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:29,524  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,524  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:29,524  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,524  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=2, getDatabase_(String)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:29,524  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_cfc45dad-ac92-49bf-85e0-6235ac8d7e22); Time taken: 0.009 seconds
2024-04-23T17:15:29,524  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423171529_cfc45dad-ac92-49bf-85e0-6235ac8d7e22
2024-04-23T17:15:29,524  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_cfc45dad-ac92-49bf-85e0-6235ac8d7e22
2024-04-23T17:15:29,538  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_cfc45dad-ac92-49bf-85e0-6235ac8d7e22 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T17:15:29,538  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:29,538  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_cfc45dad-ac92-49bf-85e0-6235ac8d7e22): create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:29,539  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:29,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713917729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:29,541  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:29,552  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:29,552  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=13}
2024-04-23T17:15:29,552  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_cfc45dad-ac92-49bf-85e0-6235ac8d7e22); Time taken: 0.014 seconds
2024-04-23T17:15:29,552  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_cfc45dad-ac92-49bf-85e0-6235ac8d7e22
2024-04-23T17:15:29,556  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T17:15:29,561  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:29,562  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T17:15:29,562  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-23T17:15:29,562  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e): insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-23T17:15:29,565  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T17:15:29,565  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T17:15:29,566  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:29,566  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:29,569  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:29,571  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,571  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:29,571  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:29,571  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:29,571  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:29,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:29,574  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,574  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T17:15:29,579  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:29,579  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T17:15:29,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:29,648  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:29,648  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:29,648  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:29,649  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:29,650  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:29,650  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:29,650  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:29,650  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:29,652  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T17:15:29,656  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:29,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:29,665  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 17
2024-04-23T17:15:29,665  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=tstage (txnIds: [17])
2024-04-23T17:15:29,666  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:29,667  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T17:15:29,667  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T17:15:29,667  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:29,668  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:29,677  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:29,680  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:29,680  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:29,681  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:29,681  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:29,681  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:29,681  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:29,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_ps_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T17:15:29,692  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T17:15:29,692  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:29,692  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, listPartitionsWithAuthInfo_(String, String, List, short, String, List)=10, getAllTableConstraints_(AllTableConstraintsRequest)=24, allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=5, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T17:15:29,692  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e); Time taken: 0.13 seconds
2024-04-23T17:15:29,693  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e
2024-04-23T17:15:29,693  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e
2024-04-23T17:15:29,710  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T17:15:29,710  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:29,712  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e): insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-23T17:15:29,713  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e
2024-04-23T17:15:29,713  INFO [main] ql.Driver: Query ID = alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e
Total jobs = 1
2024-04-23T17:15:29,713  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:29,713  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:29,715  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T17:15:29,715  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:29,715  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:29,715  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:29,715  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:29,715  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:29,715  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:29,715  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:29,717  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:29,718  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T17:15:29,718  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/hive_2024-04-23_17-15-29_562_7259034118599565248-1/dummy_path
2024-04-23T17:15:29,727  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:29,728  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T17:15:29,732  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:29,734  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T17:15:29,734  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:29,737  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/hive_2024-04-23_17-15-29_562_7259034118599565248-1/-mr-10000
2024-04-23T17:15:29,738  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:29,744  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:29,748  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:29,749  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T17:15:29,749  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T17:15:29,749  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/hive_2024-04-23_17-15-29_562_7259034118599565248-1/dummy_path
2024-04-23T17:15:29,749  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:29,767  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:29,788  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local5984401_0009
2024-04-23T17:15:29,788  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:29,852  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:29,852  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:29,853  INFO [Thread-816] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:29,853  INFO [Thread-816] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:29,854  INFO [Thread-816] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:29,854  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local5984401_0009_m_000000_0
2024-04-23T17:15:29,857  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:29,857  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/hive_2024-04-23_17-15-29_562_7259034118599565248-1/dummy_path/null:0+1
2024-04-23T17:15:29,860  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:29,860  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T17:15:29,861  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T17:15:29,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:29,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:29,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:29,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:29,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:29,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:29,866  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:29,866  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:29,866  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:29,866  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:29,867  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T17:15:29,867  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T17:15:29,867  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:29,867  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T17:15:29,867  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T17:15:29,867  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T17:15:29,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:29,871  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:29,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:29,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:29,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T17:15:29,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:29,882  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:29,886  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local5984401_0009_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:29,887  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:29,887  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local5984401_0009_m_000000_0' done.
2024-04-23T17:15:29,887  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local5984401_0009_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=201478
		FILE: Number of bytes written=10700608
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1090519040
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-23T17:15:29,887  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local5984401_0009_m_000000_0
2024-04-23T17:15:29,887  INFO [Thread-816] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:29,888  INFO [Thread-816] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:29,888  INFO [pool-46-thread-1] mapred.LocalJobRunner: Starting task: attempt_local5984401_0009_r_000000_0
2024-04-23T17:15:29,890  INFO [pool-46-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:29,890  INFO [pool-46-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1fd4c24a
2024-04-23T17:15:29,890  WARN [pool-46-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:29,891  INFO [pool-46-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:29,891  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local5984401_0009_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:29,894  INFO [localfetcher#8] reduce.LocalFetcher: localfetcher#8 about to shuffle output of map attempt_local5984401_0009_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T17:15:29,894  INFO [localfetcher#8] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local5984401_0009_m_000000_0
2024-04-23T17:15:29,894  INFO [localfetcher#8] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T17:15:29,895  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:29,895  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:29,895  INFO [pool-46-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:29,901  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:29,902  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T17:15:29,904  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:29,904  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T17:15:29,904  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:29,904  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:29,904  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T17:15:29,905  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:29,905  INFO [pool-46-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:29,906  INFO [pool-46-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local5984401_0009/job_local5984401_0009.xml], properties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@50846e76
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1
2024-04-23T17:15:29,907  INFO [pool-46-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1
2024-04-23T17:15:29,908  INFO [pool-46-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:29,915  INFO [pool-46-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_1_default.tstage:0, RECORDS_OUT_OPERATOR_FS_6:0, 
2024-04-23T17:15:29,915  INFO [pool-46-thread-1] mapred.Task: Task:attempt_local5984401_0009_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:29,915  INFO [pool-46-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:29,915  INFO [pool-46-thread-1] mapred.Task: Task 'attempt_local5984401_0009_r_000000_0' done.
2024-04-23T17:15:29,915  INFO [pool-46-thread-1] mapred.Task: Final Counters for attempt_local5984401_0009_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=207610
		FILE: Number of bytes written=10700670
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1090519040
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:29,915  INFO [pool-46-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local5984401_0009_r_000000_0
2024-04-23T17:15:29,915  INFO [pool-46-thread-1] mapred.LocalJobRunner: Starting task: attempt_local5984401_0009_r_000001_0
2024-04-23T17:15:29,916  INFO [pool-46-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:29,916  INFO [pool-46-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4c7779eb
2024-04-23T17:15:29,916  WARN [pool-46-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:29,917  INFO [pool-46-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:29,917  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local5984401_0009_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:29,920  INFO [localfetcher#9] reduce.LocalFetcher: localfetcher#9 about to shuffle output of map attempt_local5984401_0009_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T17:15:29,920  INFO [localfetcher#9] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local5984401_0009_m_000000_0
2024-04-23T17:15:29,920  INFO [localfetcher#9] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T17:15:29,921  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:29,921  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:29,921  INFO [pool-46-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:29,927  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:29,928  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T17:15:29,930  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:29,931  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T17:15:29,931  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:29,931  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:29,931  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T17:15:29,931  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:29,932  INFO [pool-46-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:29,933  INFO [pool-46-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T17:15:29,933  INFO [pool-46-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:29,934  INFO [pool-46-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:29,934  INFO [pool-46-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T17:15:29,934  INFO [pool-46-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T17:15:29,934  INFO [pool-46-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local5984401_0009/job_local5984401_0009.xml], properties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@5c0ffb62
2024-04-23T17:15:29,935  INFO [pool-46-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1
2024-04-23T17:15:29,935  INFO [pool-46-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1
2024-04-23T17:15:29,935  INFO [pool-46-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:29,935  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T17:15:29,935  INFO [pool-46-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T17:15:29,946  INFO [pool-46-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T17:15:29,953  INFO [pool-46-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:29,953  INFO [pool-46-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:29,953  INFO [pool-46-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T17:15:29,953  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T17:15:29,960  INFO [pool-46-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T17:15:29,972  INFO [pool-46-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-23T17:15:29,973  INFO [pool-46-thread-1] mapred.Task: Task:attempt_local5984401_0009_r_000001_0 is done. And is in the process of committing
2024-04-23T17:15:29,973  INFO [pool-46-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:29,973  INFO [pool-46-thread-1] mapred.Task: Task 'attempt_local5984401_0009_r_000001_0' done.
2024-04-23T17:15:29,973  INFO [pool-46-thread-1] mapred.Task: Final Counters for attempt_local5984401_0009_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=213772
		FILE: Number of bytes written=10701758
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1090519040
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:29,973  INFO [pool-46-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local5984401_0009_r_000001_0
2024-04-23T17:15:29,974  INFO [Thread-816] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:30,854 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:30,854  INFO [main] exec.Task: 2024-04-23 17:15:30,854 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local5984401_0009
2024-04-23T17:15:30,855  INFO [main] exec.Task: Ended Job = job_local5984401_0009
2024-04-23T17:15:30,856  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T17:15:30,856  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T17:15:30,857  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/_tmp.delta_0000001_0000001_0000
2024-04-23T17:15:30,858  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage partition (p=1)
2024-04-23T17:15:30,859  INFO [main] exec.Task: Loading data to table default.tstage partition (p=1) from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1
2024-04-23T17:15:30,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:30,863  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:30,863  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T17:15:30,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:30,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:30,866  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:30,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T17:15:30,876  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T17:15:30,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.default.tstage	
2024-04-23T17:15:30,896  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T17:15:30,909  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T17:15:30,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:30,912  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:30,912  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T17:15:30,912  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/hive_2024-04-23_17-15-29_562_7259034118599565248-1/-mr-10000
2024-04-23T17:15:30,913  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:30,916  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:30,916  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T17:15:30,929  WARN [stats-updater-thread-0] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T17:15:30,929  INFO [main] FileOperations: Read stats for default.tstage/p=1/, numRows, true, 2, false: 
2024-04-23T17:15:30,929  INFO [main] FileOperations: Read stats for default.tstage/p=1/, rawDataSize, true, 0, false: 
2024-04-23T17:15:30,929  INFO [main] stats.BasicStatsTask: Partition {p=1} stats: [numFiles=1, numRows=2, totalSize=692, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T17:15:30,930  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.tstage	
2024-04-23T17:15:30,930  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T17:15:30,969  INFO [main] FileOperations: Read stats for default.tstage/p=1/, insertCount, true, 2, false: 
2024-04-23T17:15:30,969  INFO [main] FileOperations: Read stats for default.tstage/p=1/, updateCount, true, 0, false: 
2024-04-23T17:15:30,969  INFO [main] FileOperations: Read stats for default.tstage/p=1/, deleteCount, true, 0, false: 
2024-04-23T17:15:30,972  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:30,972  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {validatePartitionNameCharacters_(List)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=18, add_partition_(Partition)=18, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, isCompatibleWith_(Configuration)=2, alter_partitions_(String, String, List, EnvironmentContext, String, long)=39, getTable_(GetTableRequest)=13, getValidWriteIds_(List, String)=0}
MapReduce Jobs Launched: 
2024-04-23T17:15:30,972  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:30,972  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:30,972  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:30,972  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e); Time taken: 1.26 seconds
2024-04-23T17:15:30,972  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171529_53d10b09-dd23-4d12-8b04-16cedafb473e
2024-04-23T17:15:30,981  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:30,982  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T17:15:30,982  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0'
2024-04-23T17:15:30,982  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/hive_2024-04-23_17-15-29_562_7259034118599565248-1
2024-04-23T17:15:30,983  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4dab02a3-51a3-4062-a1be-d3c2210ecdfe/hive_2024-04-23_17-15-29_562_7259034118599565248-1 on fs with scheme file
2024-04-23T17:15:30,983  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171530_16e5ded5-9908-4e24-879e-d37a8f4c9233): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0'
2024-04-23T17:15:30,986  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T17:15:30,987  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T17:15:30,987  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:30,990  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
FAILED: SemanticException [Error 10413]: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
2024-04-23T17:15:30,993 ERROR [main] ql.Driver: FAILED: SemanticException [Error 10413]: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
org.apache.hadoop.hive.ql.parse.SemanticException: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
	at org.apache.hadoop.hive.ql.io.AcidUtils.validateAcidFiles(AcidUtils.java:3072)
	at org.apache.hadoop.hive.ql.io.AcidUtils.validateAcidPartitionLocation(AcidUtils.java:3089)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionAnalyzer.postProcess(AlterTableAddPartitionAnalyzer.java:78)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AbstractAddPartitionAnalyzer.analyzeCommand(AbstractAddPartitionAnalyzer.java:78)
	at org.apache.hadoop.hive.ql.ddl.table.AbstractAlterTableAnalyzer.analyzeInternal(AbstractAlterTableAnalyzer.java:62)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionTransactional(TestTxnAddPartition.java:296)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T17:15:30,993  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:30,993  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:30,993  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171530_16e5ded5-9908-4e24-879e-d37a8f4c9233); Time taken: 0.01 seconds
2024-04-23T17:15:30,993  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:30,996  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,002  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:31,003  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_14e5ea39-c2e0-4679-a4fc-d39b161074ec): drop table if exists acidTbl
2024-04-23T17:15:31,005  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T17:15:31,005  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T17:15:31,006  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:31,009  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,009  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,009  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,009  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,009  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T17:15:31,009  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_14e5ea39-c2e0-4679-a4fc-d39b161074ec); Time taken: 0.006 seconds
2024-04-23T17:15:31,010  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423171531_14e5ea39-c2e0-4679-a4fc-d39b161074ec
2024-04-23T17:15:31,010  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_14e5ea39-c2e0-4679-a4fc-d39b161074ec
2024-04-23T17:15:31,028  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_14e5ea39-c2e0-4679-a4fc-d39b161074ec LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T17:15:31,028  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:31,028  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_14e5ea39-c2e0-4679-a4fc-d39b161074ec): drop table if exists acidTbl
2024-04-23T17:15:31,028  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,028  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:31,031  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:31,033  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,033  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:31,102  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,102  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=71, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:31,102  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_14e5ea39-c2e0-4679-a4fc-d39b161074ec); Time taken: 0.074 seconds
2024-04-23T17:15:31,102  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_14e5ea39-c2e0-4679-a4fc-d39b161074ec
2024-04-23T17:15:31,107  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T17:15:31,113  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,114  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T17:15:31,114  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:31,115  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_f12a98e4-61c4-4d44-9fa1-9a45cdb60cdd): drop table if exists acidTblPart
2024-04-23T17:15:31,120  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T17:15:31,120  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T17:15:31,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:31,133  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,133  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,133  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=5, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=12, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:31,133  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_f12a98e4-61c4-4d44-9fa1-9a45cdb60cdd); Time taken: 0.018 seconds
2024-04-23T17:15:31,133  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423171531_f12a98e4-61c4-4d44-9fa1-9a45cdb60cdd
2024-04-23T17:15:31,134  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_f12a98e4-61c4-4d44-9fa1-9a45cdb60cdd
2024-04-23T17:15:31,152  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_f12a98e4-61c4-4d44-9fa1-9a45cdb60cdd LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T17:15:31,152  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:31,152  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_f12a98e4-61c4-4d44-9fa1-9a45cdb60cdd): drop table if exists acidTblPart
2024-04-23T17:15:31,153  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,153  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:31,155  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:31,158  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:31,177  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,177  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=22, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=2}
2024-04-23T17:15:31,177  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_f12a98e4-61c4-4d44-9fa1-9a45cdb60cdd); Time taken: 0.025 seconds
2024-04-23T17:15:31,177  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_f12a98e4-61c4-4d44-9fa1-9a45cdb60cdd
2024-04-23T17:15:31,180  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T17:15:31,185  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,185  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T17:15:31,186  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:31,186  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_60434e42-8d1b-4d5b-91e1-f46666ca8711): drop table if exists acidTbl2
2024-04-23T17:15:31,188  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T17:15:31,188  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T17:15:31,189  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,189  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,189  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,190  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, flushCache_()=1, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:31,190  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_60434e42-8d1b-4d5b-91e1-f46666ca8711); Time taken: 0.003 seconds
2024-04-23T17:15:31,190  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423171531_60434e42-8d1b-4d5b-91e1-f46666ca8711
2024-04-23T17:15:31,190  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:31,190  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_60434e42-8d1b-4d5b-91e1-f46666ca8711): drop table if exists acidTbl2
2024-04-23T17:15:31,190  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,190  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T17:15:31,191  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,191  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T17:15:31,191  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_60434e42-8d1b-4d5b-91e1-f46666ca8711); Time taken: 0.001 seconds
2024-04-23T17:15:31,191  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_60434e42-8d1b-4d5b-91e1-f46666ca8711
2024-04-23T17:15:31,195  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T17:15:31,199  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,199  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T17:15:31,199  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:31,200  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_46c5619b-7ee1-4e3b-8804-c61613f0f03c): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:31,202  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 18
2024-04-23T17:15:31,202  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T17:15:31,203  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:31,217  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,217  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,217  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,217  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,218  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=1}
2024-04-23T17:15:31,218  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_46c5619b-7ee1-4e3b-8804-c61613f0f03c); Time taken: 0.017 seconds
2024-04-23T17:15:31,218  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423171531_46c5619b-7ee1-4e3b-8804-c61613f0f03c
2024-04-23T17:15:31,218  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_46c5619b-7ee1-4e3b-8804-c61613f0f03c
2024-04-23T17:15:31,230  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_46c5619b-7ee1-4e3b-8804-c61613f0f03c LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T17:15:31,230  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:31,230  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_46c5619b-7ee1-4e3b-8804-c61613f0f03c): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:31,230  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:31,234  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:31,237  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:31,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=24, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=3}
2024-04-23T17:15:31,259  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_46c5619b-7ee1-4e3b-8804-c61613f0f03c); Time taken: 0.028 seconds
2024-04-23T17:15:31,259  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_46c5619b-7ee1-4e3b-8804-c61613f0f03c
2024-04-23T17:15:31,262  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T17:15:31,266  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,266  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T17:15:31,267  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:31,268  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_3c0debde-89f8-48ca-a992-131fda6d6396): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:31,270  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 18
2024-04-23T17:15:31,270  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T17:15:31,271  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:31,274  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,274  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,274  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,274  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,274  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=1}
2024-04-23T17:15:31,274  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_3c0debde-89f8-48ca-a992-131fda6d6396); Time taken: 0.006 seconds
2024-04-23T17:15:31,274  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423171531_3c0debde-89f8-48ca-a992-131fda6d6396
2024-04-23T17:15:31,275  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_3c0debde-89f8-48ca-a992-131fda6d6396
2024-04-23T17:15:31,286  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_3c0debde-89f8-48ca-a992-131fda6d6396 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T17:15:31,287  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:31,287  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_3c0debde-89f8-48ca-a992-131fda6d6396): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:31,287  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,287  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:31,290  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:31,293  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,294  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:31,304  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,304  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=14, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:31,304  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_3c0debde-89f8-48ca-a992-131fda6d6396); Time taken: 0.017 seconds
2024-04-23T17:15:31,304  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_3c0debde-89f8-48ca-a992-131fda6d6396
2024-04-23T17:15:31,307  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T17:15:31,312  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,312  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T17:15:31,313  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:31,313  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_d3e76046-33ce-4185-9aec-0894301e50e6): drop table if exists nonAcidNonBucket
2024-04-23T17:15:31,315  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 18
2024-04-23T17:15:31,315  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T17:15:31,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:31,320  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,320  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,320  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,321  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,321  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:31,321  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_d3e76046-33ce-4185-9aec-0894301e50e6); Time taken: 0.008 seconds
2024-04-23T17:15:31,321  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423171531_d3e76046-33ce-4185-9aec-0894301e50e6
2024-04-23T17:15:31,321  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_d3e76046-33ce-4185-9aec-0894301e50e6
2024-04-23T17:15:31,333  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_d3e76046-33ce-4185-9aec-0894301e50e6 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T17:15:31,333  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:31,333  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_d3e76046-33ce-4185-9aec-0894301e50e6): drop table if exists nonAcidNonBucket
2024-04-23T17:15:31,334  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:31,337  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:31,340  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:31,352  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,352  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=15, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:31,352  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_d3e76046-33ce-4185-9aec-0894301e50e6); Time taken: 0.019 seconds
2024-04-23T17:15:31,352  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_d3e76046-33ce-4185-9aec-0894301e50e6
2024-04-23T17:15:31,357  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T17:15:31,365  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,365  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T17:15:31,365  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T17:15:31,428  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T17:15:31,428  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T17:15:31,428  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T17:15:31,428  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T17:15:31,428  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T17:15:31,428  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T17:15:31,429  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T17:15:31,429  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T17:15:31,429  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T17:15:31,429  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T17:15:31,435  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T17:15:31,436  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 38475517-2b8f-4165-a2da-c856e209dff6
2024-04-23T17:15:31,438  INFO [main] SessionState: Hive Session ID = 38475517-2b8f-4165-a2da-c856e209dff6
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:31,439  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:31,444  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/38475517-2b8f-4165-a2da-c856e209dff6
2024-04-23T17:15:31,446  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6
2024-04-23T17:15:31,449  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/38475517-2b8f-4165-a2da-c856e209dff6/_tmp_space.db
2024-04-23T17:15:31,449  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=38475517-2b8f-4165-a2da-c856e209dff6, clientType=HIVECLI]
2024-04-23T17:15:31,449  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:31,450  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_aefa0fde-2194-424b-a58e-b548366d98bc): drop table if exists acidTbl
2024-04-23T17:15:31,457  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T17:15:31,457  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T17:15:31,459  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:31,460  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,460  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,460  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,460  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=7, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1}
2024-04-23T17:15:31,460  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_aefa0fde-2194-424b-a58e-b548366d98bc); Time taken: 0.011 seconds
2024-04-23T17:15:31,461  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423171531_aefa0fde-2194-424b-a58e-b548366d98bc
2024-04-23T17:15:31,461  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:31,461  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_aefa0fde-2194-424b-a58e-b548366d98bc): drop table if exists acidTbl
2024-04-23T17:15:31,461  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:31,462  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,462  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:31,462  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_aefa0fde-2194-424b-a58e-b548366d98bc); Time taken: 0.001 seconds
2024-04-23T17:15:31,462  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_aefa0fde-2194-424b-a58e-b548366d98bc
2024-04-23T17:15:31,466  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T17:15:31,471  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,471  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T17:15:31,472  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:31,472  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_1a1d3fff-4404-4924-8381-bf2ded35c6b3): drop table if exists acidTblPart
2024-04-23T17:15:31,474  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T17:15:31,474  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T17:15:31,475  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:31,475  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,475  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,476  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,476  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:31,476  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_1a1d3fff-4404-4924-8381-bf2ded35c6b3); Time taken: 0.004 seconds
2024-04-23T17:15:31,476  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423171531_1a1d3fff-4404-4924-8381-bf2ded35c6b3
2024-04-23T17:15:31,476  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:31,476  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_1a1d3fff-4404-4924-8381-bf2ded35c6b3): drop table if exists acidTblPart
2024-04-23T17:15:31,476  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:31,477  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,477  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:31,477  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_1a1d3fff-4404-4924-8381-bf2ded35c6b3); Time taken: 0.001 seconds
2024-04-23T17:15:31,477  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_1a1d3fff-4404-4924-8381-bf2ded35c6b3
2024-04-23T17:15:31,481  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T17:15:31,486  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,486  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T17:15:31,487  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:31,487  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_282a3efd-51ad-4efc-9906-62f4e83f9be1): drop table if exists acidTbl2
2024-04-23T17:15:31,489  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T17:15:31,489  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T17:15:31,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:31,490  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,490  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,490  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,490  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:31,490  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_282a3efd-51ad-4efc-9906-62f4e83f9be1); Time taken: 0.003 seconds
2024-04-23T17:15:31,491  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423171531_282a3efd-51ad-4efc-9906-62f4e83f9be1
2024-04-23T17:15:31,491  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:31,491  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_282a3efd-51ad-4efc-9906-62f4e83f9be1): drop table if exists acidTbl2
2024-04-23T17:15:31,491  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,491  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:31,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,492  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:31,492  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_282a3efd-51ad-4efc-9906-62f4e83f9be1); Time taken: 0.001 seconds
2024-04-23T17:15:31,492  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_282a3efd-51ad-4efc-9906-62f4e83f9be1
2024-04-23T17:15:31,496  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T17:15:31,500  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,500  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T17:15:31,500  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:31,501  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_08487d4a-4b9c-4fd8-ba2e-c12bbcd8646f): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:31,503  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T17:15:31,503  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T17:15:31,504  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:31,504  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,504  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,504  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,505  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=1}
2024-04-23T17:15:31,505  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_08487d4a-4b9c-4fd8-ba2e-c12bbcd8646f); Time taken: 0.003 seconds
2024-04-23T17:15:31,505  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423171531_08487d4a-4b9c-4fd8-ba2e-c12bbcd8646f
2024-04-23T17:15:31,505  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:31,505  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_08487d4a-4b9c-4fd8-ba2e-c12bbcd8646f): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:31,505  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:31,506  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,506  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:31,506  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_08487d4a-4b9c-4fd8-ba2e-c12bbcd8646f); Time taken: 0.001 seconds
2024-04-23T17:15:31,506  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_08487d4a-4b9c-4fd8-ba2e-c12bbcd8646f
2024-04-23T17:15:31,510  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T17:15:31,514  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,514  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T17:15:31,515  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:31,515  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_8f0db936-6d33-4cf8-aca6-b34d66bf6ef6): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:31,517  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T17:15:31,517  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T17:15:31,518  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:31,519  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,519  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,519  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,519  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:31,519  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_8f0db936-6d33-4cf8-aca6-b34d66bf6ef6); Time taken: 0.004 seconds
2024-04-23T17:15:31,519  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423171531_8f0db936-6d33-4cf8-aca6-b34d66bf6ef6
2024-04-23T17:15:31,519  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:31,519  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_8f0db936-6d33-4cf8-aca6-b34d66bf6ef6): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:31,519  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,519  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:31,520  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,520  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:31,520  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_8f0db936-6d33-4cf8-aca6-b34d66bf6ef6); Time taken: 0.001 seconds
2024-04-23T17:15:31,520  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_8f0db936-6d33-4cf8-aca6-b34d66bf6ef6
2024-04-23T17:15:31,524  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T17:15:31,529  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,529  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T17:15:31,529  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:31,530  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_46588e23-9da1-4399-8762-1e2322d5378e): drop table if exists nonAcidNonBucket
2024-04-23T17:15:31,532  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T17:15:31,532  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T17:15:31,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:31,534  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,534  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,534  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,534  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:31,534  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_46588e23-9da1-4399-8762-1e2322d5378e); Time taken: 0.004 seconds
2024-04-23T17:15:31,534  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423171531_46588e23-9da1-4399-8762-1e2322d5378e
2024-04-23T17:15:31,534  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:31,534  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_46588e23-9da1-4399-8762-1e2322d5378e): drop table if exists nonAcidNonBucket
2024-04-23T17:15:31,534  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,535  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:31,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:31,536  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_46588e23-9da1-4399-8762-1e2322d5378e); Time taken: 0.002 seconds
2024-04-23T17:15:31,536  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_46588e23-9da1-4399-8762-1e2322d5378e
2024-04-23T17:15:31,541  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T17:15:31,546  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,546  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T17:15:31,546  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,547  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_170e928f-1cfe-45a3-aa5a-0c8099aaa390): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,550  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T17:15:31,550  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T17:15:31,550  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:31,550  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:31,556  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T17:15:31,556  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:31,557  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:31,557  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,557  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0}
2024-04-23T17:15:31,557  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_170e928f-1cfe-45a3-aa5a-0c8099aaa390); Time taken: 0.01 seconds
2024-04-23T17:15:31,557  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423171531_170e928f-1cfe-45a3-aa5a-0c8099aaa390
2024-04-23T17:15:31,557  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_170e928f-1cfe-45a3-aa5a-0c8099aaa390
2024-04-23T17:15:31,575  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_170e928f-1cfe-45a3-aa5a-0c8099aaa390 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T17:15:31,575  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:31,576  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_170e928f-1cfe-45a3-aa5a-0c8099aaa390): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,576  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713917731, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:31,579  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtbl
2024-04-23T17:15:31,605  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,605  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=28}
2024-04-23T17:15:31,605  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_170e928f-1cfe-45a3-aa5a-0c8099aaa390); Time taken: 0.029 seconds
2024-04-23T17:15:31,606  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_170e928f-1cfe-45a3-aa5a-0c8099aaa390
2024-04-23T17:15:31,609  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T17:15:31,614  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,614  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T17:15:31,615  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,615  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_22bcbacb-355b-4573-b945-f464a14006d2): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,617  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T17:15:31,618  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T17:15:31,618  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:31,618  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:31,621  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T17:15:31,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:31,625  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:31,625  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,625  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,626  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,626  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=4, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:31,626  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_22bcbacb-355b-4573-b945-f464a14006d2); Time taken: 0.011 seconds
2024-04-23T17:15:31,626  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423171531_22bcbacb-355b-4573-b945-f464a14006d2
2024-04-23T17:15:31,626  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_22bcbacb-355b-4573-b945-f464a14006d2
2024-04-23T17:15:31,646  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_22bcbacb-355b-4573-b945-f464a14006d2 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T17:15:31,646  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:31,647  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_22bcbacb-355b-4573-b945-f464a14006d2): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,647  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713917731, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:31,651  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtblpart
2024-04-23T17:15:31,661  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,661  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=13}
2024-04-23T17:15:31,661  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_22bcbacb-355b-4573-b945-f464a14006d2); Time taken: 0.014 seconds
2024-04-23T17:15:31,661  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_22bcbacb-355b-4573-b945-f464a14006d2
2024-04-23T17:15:31,665  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T17:15:31,669  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,670  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T17:15:31,670  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,670  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_d5e60a99-c410-4c5b-b740-0f5b034a9890): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,673  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T17:15:31,673  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T17:15:31,674  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:31,674  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:31,676  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T17:15:31,677  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:31,677  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:31,677  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,677  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,677  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,677  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:31,677  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_d5e60a99-c410-4c5b-b740-0f5b034a9890); Time taken: 0.007 seconds
2024-04-23T17:15:31,678  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423171531_d5e60a99-c410-4c5b-b740-0f5b034a9890
2024-04-23T17:15:31,678  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_d5e60a99-c410-4c5b-b740-0f5b034a9890
2024-04-23T17:15:31,692  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_d5e60a99-c410-4c5b-b740-0f5b034a9890 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T17:15:31,692  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:31,692  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_d5e60a99-c410-4c5b-b740-0f5b034a9890): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,692  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,693  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713917731, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:31,695  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl
2024-04-23T17:15:31,708  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,708  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=15}
2024-04-23T17:15:31,708  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_d5e60a99-c410-4c5b-b740-0f5b034a9890); Time taken: 0.016 seconds
2024-04-23T17:15:31,708  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_d5e60a99-c410-4c5b-b740-0f5b034a9890
2024-04-23T17:15:31,712  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T17:15:31,717  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,717  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T17:15:31,718  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,718  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_08914b49-15a9-465f-984a-33a29345fa07): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,721  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T17:15:31,721  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T17:15:31,722  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:31,722  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:31,724  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T17:15:31,725  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:31,725  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:31,725  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,725  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,725  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,725  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:31,725  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_08914b49-15a9-465f-984a-33a29345fa07); Time taken: 0.007 seconds
2024-04-23T17:15:31,726  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423171531_08914b49-15a9-465f-984a-33a29345fa07
2024-04-23T17:15:31,726  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_08914b49-15a9-465f-984a-33a29345fa07
2024-04-23T17:15:31,742  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_08914b49-15a9-465f-984a-33a29345fa07 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T17:15:31,742  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:31,742  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_08914b49-15a9-465f-984a-33a29345fa07): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,742  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,743  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713917731, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:31,745  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl2
2024-04-23T17:15:31,754  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,754  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=10}
2024-04-23T17:15:31,754  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_08914b49-15a9-465f-984a-33a29345fa07); Time taken: 0.012 seconds
2024-04-23T17:15:31,754  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_08914b49-15a9-465f-984a-33a29345fa07
2024-04-23T17:15:31,757  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T17:15:31,764  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,764  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T17:15:31,764  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,765  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_a0ec4422-586b-472c-b087-9d5e1b39a1bf): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,768  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T17:15:31,768  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T17:15:31,769  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:31,769  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:31,771  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T17:15:31,771  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:31,772  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:31,772  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,772  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,772  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,772  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:31,772  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_a0ec4422-586b-472c-b087-9d5e1b39a1bf); Time taken: 0.007 seconds
2024-04-23T17:15:31,772  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423171531_a0ec4422-586b-472c-b087-9d5e1b39a1bf
2024-04-23T17:15:31,772  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_a0ec4422-586b-472c-b087-9d5e1b39a1bf
2024-04-23T17:15:31,788  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_a0ec4422-586b-472c-b087-9d5e1b39a1bf LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T17:15:31,789  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:31,789  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_a0ec4422-586b-472c-b087-9d5e1b39a1bf): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:31,789  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,790  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/38475517-2b8f-4165-a2da-c856e209dff6/_tmp_space.db/e0e4bc02-541a-4d9e-a278-838efd8a2d05
2024-04-23T17:15:31,793  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,793  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=3}
2024-04-23T17:15:31,794  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_a0ec4422-586b-472c-b087-9d5e1b39a1bf); Time taken: 0.004 seconds
2024-04-23T17:15:31,794  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_a0ec4422-586b-472c-b087-9d5e1b39a1bf
2024-04-23T17:15:31,797  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T17:15:31,802  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,803  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T17:15:31,803  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,803  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_fc8e798f-5016-4efe-864c-e3d2df5064bf): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,807  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T17:15:31,807  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T17:15:31,808  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:31,808  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:31,811  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T17:15:31,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:31,812  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:31,812  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,812  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,812  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,812  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:31,812  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_fc8e798f-5016-4efe-864c-e3d2df5064bf); Time taken: 0.009 seconds
2024-04-23T17:15:31,812  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423171531_fc8e798f-5016-4efe-864c-e3d2df5064bf
2024-04-23T17:15:31,812  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_fc8e798f-5016-4efe-864c-e3d2df5064bf
2024-04-23T17:15:31,826  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_fc8e798f-5016-4efe-864c-e3d2df5064bf LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T17:15:31,826  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:31,826  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_fc8e798f-5016-4efe-864c-e3d2df5064bf): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:31,826  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,827  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713917731, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:31,829  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidnonbucket
2024-04-23T17:15:31,837  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,837  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=10}
2024-04-23T17:15:31,837  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_fc8e798f-5016-4efe-864c-e3d2df5064bf); Time taken: 0.011 seconds
2024-04-23T17:15:31,837  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_fc8e798f-5016-4efe-864c-e3d2df5064bf
2024-04-23T17:15:31,841  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T17:15:31,847  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,848  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T17:15:31,848  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T17:15:31,848  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_9965c2de-5c46-4215-add0-199d4448f8aa): drop table if exists T
2024-04-23T17:15:31,851  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T17:15:31,852  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T17:15:31,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:31,866  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,867  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,867  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,867  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,867  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=15, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:31,867  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_9965c2de-5c46-4215-add0-199d4448f8aa); Time taken: 0.019 seconds
2024-04-23T17:15:31,867  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423171531_9965c2de-5c46-4215-add0-199d4448f8aa
2024-04-23T17:15:31,867  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_9965c2de-5c46-4215-add0-199d4448f8aa
2024-04-23T17:15:31,886  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_9965c2de-5c46-4215-add0-199d4448f8aa LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T17:15:31,886  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:31,886  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_9965c2de-5c46-4215-add0-199d4448f8aa): drop table if exists T
2024-04-23T17:15:31,886  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:31,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:31,889  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:31,893  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T17:15:31,969  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t does not exist; Force to delete it.
2024-04-23T17:15:31,969 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:31,970  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:31,970  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=80, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=2}
2024-04-23T17:15:31,970  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_9965c2de-5c46-4215-add0-199d4448f8aa); Time taken: 0.084 seconds
2024-04-23T17:15:31,970  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_9965c2de-5c46-4215-add0-199d4448f8aa
2024-04-23T17:15:31,974  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T17:15:31,980  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:31,981  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T17:15:31,982  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T17:15:31,982  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171531_459416db-6219-4182-aef1-1e4b8b38270d): drop table if exists Tstage
2024-04-23T17:15:31,985  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T17:15:31,985  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T17:15:31,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:31,989  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:31,989  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:31,989  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:31,989  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:31,989  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:31,989  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171531_459416db-6219-4182-aef1-1e4b8b38270d); Time taken: 0.007 seconds
2024-04-23T17:15:31,989  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423171531_459416db-6219-4182-aef1-1e4b8b38270d
2024-04-23T17:15:31,989  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171531_459416db-6219-4182-aef1-1e4b8b38270d
2024-04-23T17:15:32,004  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171531_459416db-6219-4182-aef1-1e4b8b38270d LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T17:15:32,004  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:32,004  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171531_459416db-6219-4182-aef1-1e4b8b38270d): drop table if exists Tstage
2024-04-23T17:15:32,004  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:32,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:32,007  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:32,007  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:32,010  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:32,010  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T17:15:32,061  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage does not exist; Force to delete it.
2024-04-23T17:15:32,061 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:32,061  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:32,061  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=54, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:32,061  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171531_459416db-6219-4182-aef1-1e4b8b38270d); Time taken: 0.057 seconds
2024-04-23T17:15:32,062  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171531_459416db-6219-4182-aef1-1e4b8b38270d
2024-04-23T17:15:32,066  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T17:15:32,072  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:32,073  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T17:15:32,073  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:32,073  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171532_c1d71c50-a791-4cb5-8606-ed269760bfbe): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:32,081  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T17:15:32,081  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T17:15:32,082  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:32,082  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:32,087  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T17:15:32,087  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:32,087  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:32,088  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:32,088  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:32,088  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:32,088  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=7, getDatabase_(String)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=5, getValidTxns_(long)=1}
2024-04-23T17:15:32,088  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171532_c1d71c50-a791-4cb5-8606-ed269760bfbe); Time taken: 0.015 seconds
2024-04-23T17:15:32,088  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423171532_c1d71c50-a791-4cb5-8606-ed269760bfbe
2024-04-23T17:15:32,088  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171532_c1d71c50-a791-4cb5-8606-ed269760bfbe
2024-04-23T17:15:32,105  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171532_c1d71c50-a791-4cb5-8606-ed269760bfbe LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T17:15:32,105  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:32,106  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171532_c1d71c50-a791-4cb5-8606-ed269760bfbe): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:32,106  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:32,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713917732, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:32,108  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:32,132  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:32,132  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=25}
2024-04-23T17:15:32,133  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171532_c1d71c50-a791-4cb5-8606-ed269760bfbe); Time taken: 0.026 seconds
2024-04-23T17:15:32,133  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171532_c1d71c50-a791-4cb5-8606-ed269760bfbe
2024-04-23T17:15:32,136  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T17:15:32,141  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:32,141  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T17:15:32,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:32,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171532_52217dfa-7a88-4ff2-b6b0-251d36fb7707): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:32,145  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T17:15:32,145  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T17:15:32,146  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:32,146  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:32,149  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T17:15:32,149  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:32,149  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:32,149  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:32,150  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:32,150  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:32,150  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:32,150  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171532_52217dfa-7a88-4ff2-b6b0-251d36fb7707); Time taken: 0.008 seconds
2024-04-23T17:15:32,150  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423171532_52217dfa-7a88-4ff2-b6b0-251d36fb7707
2024-04-23T17:15:32,150  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171532_52217dfa-7a88-4ff2-b6b0-251d36fb7707
2024-04-23T17:15:32,163  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171532_52217dfa-7a88-4ff2-b6b0-251d36fb7707 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T17:15:32,163  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:32,163  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171532_52217dfa-7a88-4ff2-b6b0-251d36fb7707): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:32,164  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:32,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713917732, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:32,167  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:32,174  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:32,174  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=9}
2024-04-23T17:15:32,174  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171532_52217dfa-7a88-4ff2-b6b0-251d36fb7707); Time taken: 0.011 seconds
2024-04-23T17:15:32,174  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171532_52217dfa-7a88-4ff2-b6b0-251d36fb7707
2024-04-23T17:15:32,178  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T17:15:32,183  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:32,183  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T17:15:32,183  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:32,184  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619): insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:32,186  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T17:15:32,186  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T17:15:32,187  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:32,187  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:32,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:32,215  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:32,215  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:32,215  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:32,215  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:32,215  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:32,216  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:32,219  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:32,219  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:32,219  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T17:15:32,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:32,297  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:32,297  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:32,297  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:32,298  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:32,298  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:32,298  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:32,298  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:32,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:32,302  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:32,304  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1
2024-04-23T17:15:32,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:32,307  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:32,308  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:32,309  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:32,309  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:32,318  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:32,321  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:32,322  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T17:15:32,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:32,325  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:32,326  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:32,326  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T17:15:32,326  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:32,326  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:32,326  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:32,327  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T17:15:32,327  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T17:15:32,327  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:32,327  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:32,327  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:32,327  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T17:15:32,327  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:32,327  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=24, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=38, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T17:15:32,327  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619); Time taken: 0.143 seconds
2024-04-23T17:15:32,327  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619
2024-04-23T17:15:32,327  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619
2024-04-23T17:15:32,342  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T17:15:32,342  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:32,342  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619): insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:32,342  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619
2024-04-23T17:15:32,342  INFO [main] ql.Driver: Query ID = alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619
Total jobs = 1
2024-04-23T17:15:32,343  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:32,343  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:32,345  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T17:15:32,345  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T17:15:32,348  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:32,348  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T17:15:32,348  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-32_184_867280194273151872-1/dummy_path
2024-04-23T17:15:32,358  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:32,359  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,08KB
2024-04-23T17:15:32,360  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:32,363  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-32_184_867280194273151872-1/-mr-10001
2024-04-23T17:15:32,367  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:32,372  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:32,377  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:32,378  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T17:15:32,378  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T17:15:32,378  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-32_184_867280194273151872-1/dummy_path
2024-04-23T17:15:32,378  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:32,397  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:32,423  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1592256393_0010
2024-04-23T17:15:32,423  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:32,485  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:32,485  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:32,485  INFO [Thread-925] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:32,486  INFO [Thread-925] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:32,487  INFO [Thread-925] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:32,487  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1592256393_0010_m_000000_0
2024-04-23T17:15:32,490  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:32,490  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-32_184_867280194273151872-1/dummy_path/null:0+1
2024-04-23T17:15:32,492  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:32,493  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-23T17:15:32,493  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T17:15:32,496  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:32,496  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:32,496  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:32,496  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:32,496  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T17:15:32,497  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T17:15:32,497  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:32,497  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T17:15:32,497  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:32,497  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1592256393_0010/job_local1592256393_0010.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@11a2e087
2024-04-23T17:15:32,498  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:32,498  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:32,498  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:32,499  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:32,500  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T17:15:32,506  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T17:15:32,506  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:32,506  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:32,506  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T17:15:32,506  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:32,507  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T17:15:32,513  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, 
2024-04-23T17:15:32,514  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:32,516  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1592256393_0010_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:32,516  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:32,516  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1592256393_0010_m_000000_0' done.
2024-04-23T17:15:32,516  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1592256393_0010_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=221431
		FILE: Number of bytes written=11884383
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=360
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6142
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:32,516  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1592256393_0010_m_000000_0
2024-04-23T17:15:32,516  INFO [Thread-925] mapred.LocalJobRunner: map task executor complete.
2024-04-23 17:15:33,488 Stage-1 map = 100%,  reduce = 0%
2024-04-23T17:15:33,488  INFO [main] exec.Task: 2024-04-23 17:15:33,488 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1592256393_0010
2024-04-23T17:15:33,489  INFO [main] exec.Task: Ended Job = job_local1592256393_0010
2024-04-23T17:15:33,492  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T17:15:33,492  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T17:15:33,492  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T17:15:33,492  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T17:15:33,492  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/-ext-10000
2024-04-23T17:15:33,492  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/-ext-10002
2024-04-23T17:15:33,493  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T17:15:33,493  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1/-ext-10000
2024-04-23T17:15:33,493  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:33,496  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,496  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:33,499  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,501  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:33,501  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:33,513  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T17:15:33,513  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:33,517  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,517  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T17:15:33,517  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-32_184_867280194273151872-1/-mr-10001
2024-04-23T17:15:33,518  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:33,521  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,522  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T17:15:33,522  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T17:15:33,522  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:33,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:33,531  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T17:15:33,532  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:33,532  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, alter_table_(String, String, String, Table, EnvironmentContext, String)=21}
MapReduce Jobs Launched: 
2024-04-23T17:15:33,532  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:33,532  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:33,532  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:33,532  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619); Time taken: 1.19 seconds
2024-04-23T17:15:33,532  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171532_8e08e74a-7560-412d-bffe-df3049125619
2024-04-23T17:15:33,536  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T17:15:33,541  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:33,542  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T17:15:33,542  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:33,542  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1
2024-04-23T17:15:33,542  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-32_184_867280194273151872-1 on fs with scheme file
2024-04-23T17:15:33,543  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-32_184_867280194273151872-1
2024-04-23T17:15:33,543  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-32_184_867280194273151872-1 on fs with scheme file
2024-04-23T17:15:33,543  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171533_87b062c5-7116-4fd7-abb0-fd54a4e2f4cc): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:33,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:33,547  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,550  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T17:15:33,550  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T17:15:33,553  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:33,556  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,556  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:33,556  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:33,556  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:33,556  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:33,557  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:33,557  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:33,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:33,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=7, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:33,557  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171533_87b062c5-7116-4fd7-abb0-fd54a4e2f4cc); Time taken: 0.014 seconds
2024-04-23T17:15:33,557  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423171533_87b062c5-7116-4fd7-abb0-fd54a4e2f4cc
2024-04-23T17:15:33,557  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171533_87b062c5-7116-4fd7-abb0-fd54a4e2f4cc
2024-04-23T17:15:33,572  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171533_87b062c5-7116-4fd7-abb0-fd54a4e2f4cc LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T17:15:33,572  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:33,572  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171533_87b062c5-7116-4fd7-abb0-fd54a4e2f4cc): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:33,572  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:33,572  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:33,572  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:33,572  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:33,572  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:33,583  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:33,588  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:33,588  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:33,588  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171533_87b062c5-7116-4fd7-abb0-fd54a4e2f4cc); Time taken: 0.016 seconds
2024-04-23T17:15:33,588  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171533_87b062c5-7116-4fd7-abb0-fd54a4e2f4cc
2024-04-23T17:15:33,592  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T17:15:33,598  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:33,598  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T17:15:33,598  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:33,599  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171533_fed53cf2-2146-4ff7-88ba-c36724fafe12): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:33,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:33,605  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,611  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T17:15:33,611  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T17:15:33,612  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:33,616  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,616  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:33,616  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:33,616  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:33,616  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:33,616  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:33,616  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:33,616  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:33,616  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=5, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=0, getTable_(GetTableRequest)=11, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:33,616  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171533_fed53cf2-2146-4ff7-88ba-c36724fafe12); Time taken: 0.017 seconds
2024-04-23T17:15:33,617  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423171533_fed53cf2-2146-4ff7-88ba-c36724fafe12
2024-04-23T17:15:33,617  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171533_fed53cf2-2146-4ff7-88ba-c36724fafe12
2024-04-23T17:15:33,631  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171533_fed53cf2-2146-4ff7-88ba-c36724fafe12 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T17:15:33,631  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:33,631  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171533_fed53cf2-2146-4ff7-88ba-c36724fafe12): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:33,631  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:33,631  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:33,631  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:33,631  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:33,631  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:33,641  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:33,647  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:33,647  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:33,647  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171533_fed53cf2-2146-4ff7-88ba-c36724fafe12); Time taken: 0.016 seconds
2024-04-23T17:15:33,647  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171533_fed53cf2-2146-4ff7-88ba-c36724fafe12
2024-04-23T17:15:33,651  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T17:15:33,656  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:33,657  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T17:15:33,657  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:33,657  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171533_26f333aa-6a26-444c-8e87-e540b32dceee): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:33,660  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T17:15:33,660  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T17:15:33,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:33,663  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,671  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T17:15:33,671  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-23T17:15:33,672  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:33,672  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:33,672  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:33,673  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, allocateTableWriteId_(long, String, String)=6, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:33,673  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171533_26f333aa-6a26-444c-8e87-e540b32dceee); Time taken: 0.015 seconds
2024-04-23T17:15:33,673  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423171533_26f333aa-6a26-444c-8e87-e540b32dceee
2024-04-23T17:15:33,673  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171533_26f333aa-6a26-444c-8e87-e540b32dceee
2024-04-23T17:15:33,687  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171533_26f333aa-6a26-444c-8e87-e540b32dceee LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T17:15:33,687  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:33,692  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171533_26f333aa-6a26-444c-8e87-e540b32dceee): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:33,692  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:33,692  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:33,695  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:33,703  INFO [HMSHandler #10] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1
2024-04-23T17:15:33,703  INFO [HMSHandler #9] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:33,704  INFO [HMSHandler #11] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2
2024-04-23T17:15:33,724  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T17:15:33,724  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data
2024-04-23T17:15:33,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:33,726  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:33,737  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T17:15:33,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:33,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:33,739  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,740  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:33,743  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T17:15:33,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:33,747  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T17:15:33,768  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:33,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:33,786  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-23T17:15:33,786  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data
2024-04-23T17:15:33,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:33,789  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,789  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:33,794  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T17:15:33,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:33,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:33,797  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,797  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:33,801  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-23T17:15:33,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:33,805  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T17:15:33,825  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:33,834  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:33,839  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:33,839  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=28, validatePartitionNameCharacters_(List)=0, add_partitions_(List, boolean, boolean)=27, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=64, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=15, getValidWriteIds_(List, String)=1}
2024-04-23T17:15:33,839  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171533_26f333aa-6a26-444c-8e87-e540b32dceee); Time taken: 0.147 seconds
2024-04-23T17:15:33,839  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171533_26f333aa-6a26-444c-8e87-e540b32dceee
2024-04-23T17:15:33,844  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T17:15:33,852  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:33,854  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T17:15:33,854  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:33,855  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:33,862  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T17:15:33,862  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T17:15:33,865  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:33,865  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:33,871  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:33,871  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:33,872  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:33,875  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,875  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:33,875  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:33,875  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:33,878  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:33,908  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:33,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:33,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:33,944  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:33,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:33,951  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:33,951  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:33,985  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:33,985  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:33,985  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:33,987  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-33_855_6018692004169882578-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-33_855_6018692004169882578-1
2024-04-23T17:15:33,995  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:33,996  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:33,996  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:33,996  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:33,997  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:34,008  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:34,009  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:34,009  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:34,009  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:34,009  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T17:15:34,009  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:34,010  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:34,010  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:34,010  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:34,010  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:34,010  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:34,010  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:34,010  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:34,010  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:34,010  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:34,010  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:34,010  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T17:15:34,011  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T17:15:34,011  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:34,011  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=6, getAllTableConstraints_(AllTableConstraintsRequest)=24, getAggrColStatsFor_(String, String, List, List, String, String)=10, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=21, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidWriteIds_(List, String)=6, getValidTxns_(long)=3}
2024-04-23T17:15:34,011  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f); Time taken: 0.156 seconds
2024-04-23T17:15:34,011  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f
2024-04-23T17:15:34,012  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f
2024-04-23T17:15:34,034  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T17:15:34,034  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:34,035  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:34,035  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f
2024-04-23T17:15:34,035  INFO [main] ql.Driver: Query ID = alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f
Total jobs = 1
2024-04-23T17:15:34,035  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:34,035  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:34,037  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:34,037  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:34,037  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:34,037  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:34,037  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:34,037  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:34,037  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:34,037  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:34,040  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:34,040  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:34,040  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:34,048  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-33_855_6018692004169882578-1/-mr-10004/21c72a43-c34f-4cf7-b197-4c066d2c74f0 (false)
2024-04-23T17:15:34,059  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:34,061  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,06KB
2024-04-23T17:15:34,067  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:34,068  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T17:15:34,068  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:34,073  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:34,079  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:34,084  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:34,085  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:34,086  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:34,086  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:34,086  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:34,086  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T17:15:34,086  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:34,100  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T17:15:34,100  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 14 ms
2024-04-23T17:15:34,100  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T17:15:34,124  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T17:15:34,145  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1032997498_0011
2024-04-23T17:15:34,145  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:34,210  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:34,210  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:34,210  INFO [Thread-1002] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:34,210  INFO [Thread-1002] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:34,212  INFO [Thread-1002] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:34,212  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1032997498_0011_m_000000_0
2024-04-23T17:15:34,212  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:34,213  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:34,213  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:34,215  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,06KB
2024-04-23T17:15:34,216  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:34,219  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:34,220  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:34,224  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:34,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:34,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:34,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:34,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:34,225  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:34,225  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:34,226  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:34,226  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:34,226  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:34,227  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:34,227  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:34,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:34,229  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T17:15:34,229  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:34,240  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:34,243  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1032997498_0011_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:34,244  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:34,244  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1032997498_0011_m_000000_0' done.
2024-04-23T17:15:34,244  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1032997498_0011_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=233595
		FILE: Number of bytes written=13079203
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8203
2024-04-23T17:15:34,244  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1032997498_0011_m_000000_0
2024-04-23T17:15:34,244  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1032997498_0011_m_000001_0
2024-04-23T17:15:34,244  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:34,245  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:34,245  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:34,246  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,06KB
2024-04-23T17:15:34,247  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:34,248  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:34,249  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:34,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:34,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:34,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:34,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:34,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:34,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:34,254  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:34,254  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:34,254  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:34,254  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:34,255  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:34,255  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:34,255  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:34,255  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T17:15:34,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:34,264  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:34,267  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1032997498_0011_m_000001_0 is done. And is in the process of committing
2024-04-23T17:15:34,268  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:34,268  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1032997498_0011_m_000001_0' done.
2024-04-23T17:15:34,268  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1032997498_0011_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=242339
		FILE: Number of bytes written=13079327
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8203
2024-04-23T17:15:34,268  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1032997498_0011_m_000001_0
2024-04-23T17:15:34,268  INFO [Thread-1002] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:34,269  INFO [Thread-1002] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:34,269  INFO [pool-58-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1032997498_0011_r_000000_0
2024-04-23T17:15:34,270  INFO [pool-58-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:34,270  INFO [pool-58-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@23c1ac36
2024-04-23T17:15:34,270  WARN [pool-58-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:34,271  INFO [pool-58-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:34,272  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1032997498_0011_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:34,274  INFO [localfetcher#10] reduce.LocalFetcher: localfetcher#10 about to shuffle output of map attempt_local1032997498_0011_m_000001_0 decomp: 88 len: 92 to MEMORY
2024-04-23T17:15:34,274  INFO [localfetcher#10] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1032997498_0011_m_000001_0
2024-04-23T17:15:34,274  INFO [localfetcher#10] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->88
2024-04-23T17:15:34,276  INFO [localfetcher#10] reduce.LocalFetcher: localfetcher#10 about to shuffle output of map attempt_local1032997498_0011_m_000000_0 decomp: 88 len: 92 to MEMORY
2024-04-23T17:15:34,277  INFO [localfetcher#10] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1032997498_0011_m_000000_0
2024-04-23T17:15:34,277  INFO [localfetcher#10] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 2, commitMemory -> 88, usedMemory ->176
2024-04-23T17:15:34,277  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:34,277  INFO [pool-58-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T17:15:34,277  INFO [pool-58-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:34,284  INFO [pool-58-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T17:15:34,284  INFO [pool-58-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 104 bytes
2024-04-23T17:15:34,286  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 176 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:34,287  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merging 1 files, 178 bytes from disk
2024-04-23T17:15:34,287  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:34,287  INFO [pool-58-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:34,287  INFO [pool-58-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 138 bytes
2024-04-23T17:15:34,287  INFO [pool-58-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T17:15:34,288  INFO [pool-58-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:34,289  INFO [pool-58-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T17:15:34,290  INFO [pool-58-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:34,290  INFO [pool-58-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:34,290  INFO [pool-58-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int>>
2024-04-23T17:15:34,290  INFO [pool-58-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:34,291  INFO [pool-58-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@85adbe7, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@632e7a9e, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@5db728c9
2024-04-23T17:15:34,291  INFO [pool-58-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-33_855_6018692004169882578-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-33_855_6018692004169882578-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:34,291  INFO [pool-58-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-33_855_6018692004169882578-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-33_855_6018692004169882578-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:34,291  INFO [pool-58-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-33_855_6018692004169882578-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-33_855_6018692004169882578-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:34,299  INFO [pool-58-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:34,299  INFO [pool-58-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:34,300  INFO [pool-58-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:34,300  INFO [pool-58-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:34,300  INFO [pool-58-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T17:15:34,300  INFO [pool-58-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, 
2024-04-23T17:15:34,300  INFO [pool-58-thread-1] mapred.Task: Task:attempt_local1032997498_0011_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:34,301  INFO [pool-58-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:34,301  INFO [pool-58-thread-1] mapred.Task: Task 'attempt_local1032997498_0011_r_000000_0' done.
2024-04-23T17:15:34,301  INFO [pool-58-thread-1] mapred.Task: Final Counters for attempt_local1032997498_0011_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=250247
		FILE: Number of bytes written=13079732
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=184
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:34,301  INFO [pool-58-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1032997498_0011_r_000000_0
2024-04-23T17:15:34,301  INFO [Thread-1002] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:35,213 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:35,214  INFO [main] exec.Task: 2024-04-23 17:15:35,213 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1032997498_0011
2024-04-23T17:15:35,215  INFO [main] exec.Task: Ended Job = job_local1032997498_0011
2024-04-23T17:15:35,217  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:35,217  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:35,217  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:35,217  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:35,217  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:35,217  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f); Time taken: 1.182 seconds
2024-04-23T17:15:35,217  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171533_ae26c595-4061-43f0-bb55-df2afeddb82f
2024-04-23T17:15:35,221  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T17:15:35,226  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:35,226  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T17:15:35,229  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:35,230  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T17:15:35,230  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:35,230  WARN [main] ql.TestTxnAddPartition: addPartitionVectorized: read data(add 2 parts w/data and 1 empty vect): 
2024-04-23T17:15:35,230  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4

2024-04-23T17:15:35,230  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:35,231  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-33_855_6018692004169882578-1
2024-04-23T17:15:35,231  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-33_855_6018692004169882578-1 on fs with scheme file
2024-04-23T17:15:35,232  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171535_a3e3986e-022e-482b-acc3-09f97ac4642e): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:35,234  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T17:15:35,235  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T17:15:35,235  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:35,238  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:35,238  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:35,239  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:35,241  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,241  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:35,241  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:35,241  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:35,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:35,251  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:35,251  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:35,265  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:35,267  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:35,270  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:35,270  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:35,296  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:35,296  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:35,297  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:35,299  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:35,300  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:35,300  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:35,301  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:35,312  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:35,322  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:35,323  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:35,324  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:35,324  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:35,324  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T17:15:35,324  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:35,324  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=2, getAggrColStatsFor_(String, String, List, List, String, String)=5, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=2, getTable_(GetTableRequest)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0}
2024-04-23T17:15:35,324  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171535_a3e3986e-022e-482b-acc3-09f97ac4642e); Time taken: 0.092 seconds
2024-04-23T17:15:35,324  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171535_a3e3986e-022e-482b-acc3-09f97ac4642e): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:35,324  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T17:15:35,333  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:35,333  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T17:15:35,333  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171535_a3e3986e-022e-482b-acc3-09f97ac4642e); Time taken: 0.009 seconds
2024-04-23T17:15:35,333  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:35,338  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T17:15:35,344  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:35,344  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T17:15:35,345  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:35,345  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_231_519489301736438780-1
2024-04-23T17:15:35,345  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_231_519489301736438780-1 on fs with scheme file
2024-04-23T17:15:35,346  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171535_ea764648-d0db-4efd-835a-10c810760470): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:35,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:35,349  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,351  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T17:15:35,352  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T17:15:35,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:35,357  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,357  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:35,357  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:35,357  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:35,357  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:35,358  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:35,358  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:35,358  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:35,358  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=6, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T17:15:35,358  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171535_ea764648-d0db-4efd-835a-10c810760470); Time taken: 0.012 seconds
2024-04-23T17:15:35,358  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423171535_ea764648-d0db-4efd-835a-10c810760470
2024-04-23T17:15:35,359  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171535_ea764648-d0db-4efd-835a-10c810760470
2024-04-23T17:15:35,373  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171535_ea764648-d0db-4efd-835a-10c810760470 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T17:15:35,373  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:35,373  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171535_ea764648-d0db-4efd-835a-10c810760470): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:35,373  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:35,374  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:35,374  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:35,374  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:35,374  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:35,383  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:35,388  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:35,388  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:35,388  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171535_ea764648-d0db-4efd-835a-10c810760470); Time taken: 0.015 seconds
2024-04-23T17:15:35,388  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171535_ea764648-d0db-4efd-835a-10c810760470
2024-04-23T17:15:35,391  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T17:15:35,396  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:35,396  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T17:15:35,396  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171535_8f2fce47-5ab5-4bd3-98c6-1a638853a74f): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:35,399  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T17:15:35,399  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T17:15:35,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:35,402  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,410  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-23T17:15:35,411  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-23T17:15:35,411  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:35,411  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:35,411  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:35,411  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=1}
2024-04-23T17:15:35,411  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171535_8f2fce47-5ab5-4bd3-98c6-1a638853a74f); Time taken: 0.015 seconds
2024-04-23T17:15:35,412  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423171535_8f2fce47-5ab5-4bd3-98c6-1a638853a74f
2024-04-23T17:15:35,412  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171535_8f2fce47-5ab5-4bd3-98c6-1a638853a74f
2024-04-23T17:15:35,424  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171535_8f2fce47-5ab5-4bd3-98c6-1a638853a74f LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T17:15:35,424  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:35,428  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171535_8f2fce47-5ab5-4bd3-98c6-1a638853a74f): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:35,428  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:35,428  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:35,431  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,431  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:35,441 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T17:15:35,441 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T17:15:35,442 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-23T17:15:35,443 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T17:15:35,444 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T17:15:35,444  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:35,444  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:35,444  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171535_8f2fce47-5ab5-4bd3-98c6-1a638853a74f); Time taken: 0.016 seconds
2024-04-23T17:15:35,444  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171535_8f2fce47-5ab5-4bd3-98c6-1a638853a74f
2024-04-23T17:15:35,446  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:35,451  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:35,451  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171535_26c85357-e725-4180-85d3-d5eb852147be): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:35,454  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T17:15:35,455  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T17:15:35,455  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:35,458  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,459  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:35,471  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-23T17:15:35,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:35,486  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-23T17:15:35,486  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-23T17:15:35,486  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:35,486  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:35,486  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:35,486  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, allocateTableWriteId_(long, String, String)=7, getPartitionWithAuthInfo_(String, String, List, String, List)=16, rollbackTxn_(long)=7, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T17:15:35,486  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171535_26c85357-e725-4180-85d3-d5eb852147be); Time taken: 0.035 seconds
2024-04-23T17:15:35,487  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423171535_26c85357-e725-4180-85d3-d5eb852147be
2024-04-23T17:15:35,487  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171535_26c85357-e725-4180-85d3-d5eb852147be
2024-04-23T17:15:35,507  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171535_26c85357-e725-4180-85d3-d5eb852147be LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T17:15:35,507  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:35,523  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171535_26c85357-e725-4180-85d3-d5eb852147be): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:35,524  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:35,524  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:35,527  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,528  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:35,530  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T17:15:35,531  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T17:15:35,532  INFO [HMSHandler #12] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3
2024-04-23T17:15:35,545  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-23T17:15:35,545  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data
2024-04-23T17:15:35,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:35,548  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,549  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:35,553  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-23T17:15:35,553  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:35,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:35,556  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,556  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:35,560  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-23T17:15:35,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:35,564  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-23T17:15:35,583  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:35,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:35,598  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:35,598  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=11, validatePartitionNameCharacters_(List)=0, add_partitions_(List, boolean, boolean)=16, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=31, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, getValidWriteIds_(List, String)=1}
2024-04-23T17:15:35,599  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171535_26c85357-e725-4180-85d3-d5eb852147be); Time taken: 0.075 seconds
2024-04-23T17:15:35,599  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171535_26c85357-e725-4180-85d3-d5eb852147be
2024-04-23T17:15:35,602  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T17:15:35,607  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:35,608  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T17:15:35,608  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:35,609  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:35,611  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T17:15:35,611  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T17:15:35,612  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:35,612  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:35,617  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:35,617  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:35,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:35,620  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,620  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:35,620  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:35,620  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:35,622  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:35,648  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:35,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:35,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:35,684  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:35,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:35,690  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:35,690  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:35,716  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:35,716  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:35,716  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:35,717  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_609_8982460720257852001-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-35_609_8982460720257852001-1
2024-04-23T17:15:35,724  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:35,725  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:35,725  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:35,725  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:35,726  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:35,734  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:35,735  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:35,735  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:35,736  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:35,736  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:35,736  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:35,736  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:35,736  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T17:15:35,737  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T17:15:35,737  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:35,737  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=21, getAggrColStatsFor_(String, String, List, List, String, String)=9, isCompatibleWith_(Configuration)=1, listPartitions_(String, String, short)=17, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=6, getValidTxns_(long)=0}
2024-04-23T17:15:35,737  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7); Time taken: 0.128 seconds
2024-04-23T17:15:35,737  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7
2024-04-23T17:15:35,738  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7
2024-04-23T17:15:35,755  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T17:15:35,755  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:35,756  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:35,756  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7
2024-04-23T17:15:35,756  INFO [main] ql.Driver: Query ID = alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7
Total jobs = 1
2024-04-23T17:15:35,756  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:35,756  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:35,758  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:35,758  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:35,758  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:35,758  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:35,758  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:35,758  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:35,758  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:35,758  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:35,760  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:35,760  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:35,761  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:35,768  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_609_8982460720257852001-1/-mr-10004/7735793a-38d3-4c9b-9c7e-e902e95ae96e (false)
2024-04-23T17:15:35,777  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:35,778  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T17:15:35,782  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:35,783  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T17:15:35,783  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:35,787  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:35,792  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:35,796  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:35,797  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:35,797  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:35,797  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:35,798  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:35,798  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: default 
2024-04-23T17:15:35,798  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:35,810  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-23T17:15:35,810  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 12 ms
2024-04-23T17:15:35,810  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-23T17:15:35,827  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-23T17:15:35,848  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1345362032_0012
2024-04-23T17:15:35,848  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:35,912  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:35,912  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:35,913  INFO [Thread-1097] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:35,913  INFO [Thread-1097] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:35,914  INFO [Thread-1097] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:35,914  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1345362032_0012_m_000000_0
2024-04-23T17:15:35,915  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:35,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,916  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:35,917  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T17:15:35,918  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,919  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:35,920  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:35,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:35,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:35,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:35,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:35,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:35,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:35,927  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:35,928  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:35,928  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:35,928  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:35,928  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:35,928  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:35,929  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:35,930  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:35,930  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:35,930  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:35,930  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T17:15:35,930  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:35,941  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:35,943  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1345362032_0012_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:35,944  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,944  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1345362032_0012_m_000000_0' done.
2024-04-23T17:15:35,944  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1345362032_0012_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=267269
		FILE: Number of bytes written=14277758
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1090519040
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8553
2024-04-23T17:15:35,944  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1345362032_0012_m_000000_0
2024-04-23T17:15:35,944  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1345362032_0012_m_000001_0
2024-04-23T17:15:35,945  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:35,945  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,946  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:35,946  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T17:15:35,947  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,948  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:35,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:35,953  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:35,953  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:35,953  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:35,953  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:35,953  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:35,953  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:35,954  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:35,954  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:35,954  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:35,954  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:35,954  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:35,954  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:35,955  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:35,955  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:35,955  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:35,955  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:35,955  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:35,955  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:35,955  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:35,955  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:35,956  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:35,956  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:35,956  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:35,956  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:35,956  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:35,956  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:35,956  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T17:15:35,956  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:35,964  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:35,966  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1345362032_0012_m_000001_0 is done. And is in the process of committing
2024-04-23T17:15:35,967  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,967  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1345362032_0012_m_000001_0' done.
2024-04-23T17:15:35,967  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1345362032_0012_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=276880
		FILE: Number of bytes written=14277882
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1090519040
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8553
2024-04-23T17:15:35,967  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1345362032_0012_m_000001_0
2024-04-23T17:15:35,967  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1345362032_0012_m_000002_0
2024-04-23T17:15:35,967  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:35,968  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,968  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:35,969  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T17:15:35,970  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,970  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:35,971  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:35,975  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:35,975  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:35,975  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:35,975  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:35,975  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:35,976  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:35,976  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:35,976  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:35,977  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:35,977  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:35,977  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T17:15:35,977  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T17:15:35,977  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:35,978  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T17:15:35,979  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:35,986  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:35,989  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1345362032_0012_m_000002_0 is done. And is in the process of committing
2024-04-23T17:15:35,990  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:35,990  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1345362032_0012_m_000002_0' done.
2024-04-23T17:15:35,990  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1345362032_0012_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=285979
		FILE: Number of bytes written=14278006
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1090519040
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8553
2024-04-23T17:15:35,990  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1345362032_0012_m_000002_0
2024-04-23T17:15:35,990  INFO [Thread-1097] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:35,990  INFO [Thread-1097] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:35,991  INFO [pool-62-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1345362032_0012_r_000000_0
2024-04-23T17:15:35,991  INFO [pool-62-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:35,991  INFO [pool-62-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5ea200e4
2024-04-23T17:15:35,991  WARN [pool-62-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:35,992  INFO [pool-62-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:35,992  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1345362032_0012_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:35,995  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local1345362032_0012_m_000000_0 decomp: 88 len: 92 to MEMORY
2024-04-23T17:15:35,995  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1345362032_0012_m_000000_0
2024-04-23T17:15:35,995  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->88
2024-04-23T17:15:35,997  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local1345362032_0012_m_000002_0 decomp: 88 len: 92 to MEMORY
2024-04-23T17:15:35,997  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1345362032_0012_m_000002_0
2024-04-23T17:15:35,997  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 2, commitMemory -> 88, usedMemory ->176
2024-04-23T17:15:35,999  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local1345362032_0012_m_000001_0 decomp: 88 len: 92 to MEMORY
2024-04-23T17:15:35,999  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1345362032_0012_m_000001_0
2024-04-23T17:15:35,999  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 3, commitMemory -> 176, usedMemory ->264
2024-04-23T17:15:36,000  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:36,000  INFO [pool-62-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T17:15:36,000  INFO [pool-62-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:36,006  INFO [pool-62-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-23T17:15:36,006  INFO [pool-62-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 156 bytes
2024-04-23T17:15:36,009  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 264 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:36,009  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merging 1 files, 264 bytes from disk
2024-04-23T17:15:36,009  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:36,009  INFO [pool-62-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:36,009  INFO [pool-62-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 224 bytes
2024-04-23T17:15:36,009  INFO [pool-62-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T17:15:36,010  INFO [pool-62-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:36,010  INFO [pool-62-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T17:15:36,011  INFO [pool-62-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:36,011  INFO [pool-62-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:36,011  INFO [pool-62-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int>>
2024-04-23T17:15:36,011  INFO [pool-62-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:36,011  INFO [pool-62-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@3c86cce6, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@75391de2, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@61634c02
2024-04-23T17:15:36,012  INFO [pool-62-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_609_8982460720257852001-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-35_609_8982460720257852001-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:36,012  INFO [pool-62-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_609_8982460720257852001-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-35_609_8982460720257852001-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:36,012  INFO [pool-62-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_609_8982460720257852001-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-35_609_8982460720257852001-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:36,020  INFO [pool-62-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:36,020  INFO [pool-62-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:36,020  INFO [pool-62-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:36,021  INFO [pool-62-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:36,021  INFO [pool-62-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-23T17:15:36,021  INFO [pool-62-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, 
2024-04-23T17:15:36,021  INFO [pool-62-thread-1] mapred.Task: Task:attempt_local1345362032_0012_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:36,021  INFO [pool-62-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:36,021  INFO [pool-62-thread-1] mapred.Task: Task 'attempt_local1345362032_0012_r_000000_0' done.
2024-04-23T17:15:36,022  INFO [pool-62-thread-1] mapred.Task: Final Counters for attempt_local1345362032_0012_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=294097
		FILE: Number of bytes written=14278561
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=276
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1090519040
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:36,022  INFO [pool-62-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1345362032_0012_r_000000_0
2024-04-23T17:15:36,022  INFO [Thread-1097] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:36,917 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:36,917  INFO [main] exec.Task: 2024-04-23 17:15:36,917 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1345362032_0012
2024-04-23T17:15:36,919  INFO [main] exec.Task: Ended Job = job_local1345362032_0012
2024-04-23T17:15:36,921  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:36,921  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:36,921  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:36,921  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:36,921  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:36,921  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7); Time taken: 1.165 seconds
2024-04-23T17:15:36,921  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171535_ec485669-b1fd-412d-ad38-ce4881ee45b7
2024-04-23T17:15:36,924  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T17:15:36,930  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:36,930  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T17:15:36,934  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:36,935  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T17:15:36,935  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:36,935  WARN [main] ql.TestTxnAddPartition: addPartitionVectorized: read data(add 2 existing parts and 1 empty vect): 
2024-04-23T17:15:36,935  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4
{"writeid":3,"bucketid":536870912,"rowid":0}	3	0	2
{"writeid":3,"bucketid":536870912,"rowid":1}	3	0	4

2024-04-23T17:15:36,936  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:36,936  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_609_8982460720257852001-1
2024-04-23T17:15:36,936  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-35_609_8982460720257852001-1 on fs with scheme file
2024-04-23T17:15:36,937  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171536_814f0179-1312-496b-bd6b-9c88515fd960): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:36,942  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-23T17:15:36,942  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T17:15:36,943  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:36,945  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:36,945  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:36,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:36,948  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:36,948  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:36,948  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:36,948  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:36,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:36,958  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:36,958  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:36,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:36,981  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:36,981  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:36,983  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:36,983  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:37,014  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:37,014  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:37,014  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:37,017  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:37,018  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:37,018  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:37,019  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:37,038  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:37,047  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:37,048  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:37,048  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:37,048  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:37,048  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T17:15:37,048  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:37,048  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:37,048  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:37,048  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:37,049  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:37,049  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:37,049  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:37,049  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:37,049  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:37,049  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,049  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T17:15:37,049  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,049  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, getAllTableConstraints_(AllTableConstraintsRequest)=2, getAggrColStatsFor_(String, String, List, List, String, String)=5, isCompatibleWith_(Configuration)=1, listPartitions_(String, String, short)=3, getTable_(GetTableRequest)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:37,049  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171536_814f0179-1312-496b-bd6b-9c88515fd960); Time taken: 0.112 seconds
2024-04-23T17:15:37,049  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171536_814f0179-1312-496b-bd6b-9c88515fd960): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T17:15:37,049  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T17:15:37,058  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,058  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T17:15:37,058  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171536_814f0179-1312-496b-bd6b-9c88515fd960); Time taken: 0.009 seconds
2024-04-23T17:15:37,058  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:37,063  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T17:15:37,068  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,069  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T17:15:37,070  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:37,070  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-36_937_1970293113202823705-1
2024-04-23T17:15:37,070  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/38475517-2b8f-4165-a2da-c856e209dff6/hive_2024-04-23_17-15-36_937_1970293113202823705-1 on fs with scheme file
2024-04-23T17:15:37,070  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_fbe1305a-fb2f-4373-93b6-cc9897bcf66b): drop table if exists acidTbl
2024-04-23T17:15:37,073  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-23T17:15:37,073  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T17:15:37,074  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:37,077  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,077  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,077  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,077  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,077  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:37,077  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_fbe1305a-fb2f-4373-93b6-cc9897bcf66b); Time taken: 0.007 seconds
2024-04-23T17:15:37,077  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423171537_fbe1305a-fb2f-4373-93b6-cc9897bcf66b
2024-04-23T17:15:37,077  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_fbe1305a-fb2f-4373-93b6-cc9897bcf66b
2024-04-23T17:15:37,091  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_fbe1305a-fb2f-4373-93b6-cc9897bcf66b LockResponse(lockid:20, state:ACQUIRED)
2024-04-23T17:15:37,092  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:37,092  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_fbe1305a-fb2f-4373-93b6-cc9897bcf66b): drop table if exists acidTbl
2024-04-23T17:15:37,092  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:37,095  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:37,097  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,098  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:37,169  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,169  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=74, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:37,169  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_fbe1305a-fb2f-4373-93b6-cc9897bcf66b); Time taken: 0.077 seconds
2024-04-23T17:15:37,169  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_fbe1305a-fb2f-4373-93b6-cc9897bcf66b
2024-04-23T17:15:37,173  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T17:15:37,179  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,179  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T17:15:37,179  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:37,179  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_c5cafa5f-9f7f-4733-8a14-b772e8b5d38a): drop table if exists acidTblPart
2024-04-23T17:15:37,182  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-23T17:15:37,182  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-23T17:15:37,183  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:37,198  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,198  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,198  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,198  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,198  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=15, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:37,198  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_c5cafa5f-9f7f-4733-8a14-b772e8b5d38a); Time taken: 0.019 seconds
2024-04-23T17:15:37,198  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240423171537_c5cafa5f-9f7f-4733-8a14-b772e8b5d38a
2024-04-23T17:15:37,199  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_c5cafa5f-9f7f-4733-8a14-b772e8b5d38a
2024-04-23T17:15:37,217  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_c5cafa5f-9f7f-4733-8a14-b772e8b5d38a LockResponse(lockid:21, state:ACQUIRED)
2024-04-23T17:15:37,217  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:37,217  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_c5cafa5f-9f7f-4733-8a14-b772e8b5d38a): drop table if exists acidTblPart
2024-04-23T17:15:37,217  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:37,220  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:37,223  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:37,244  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,244  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=24, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:37,244  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_c5cafa5f-9f7f-4733-8a14-b772e8b5d38a); Time taken: 0.027 seconds
2024-04-23T17:15:37,244  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_c5cafa5f-9f7f-4733-8a14-b772e8b5d38a
2024-04-23T17:15:37,249  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-23T17:15:37,255  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,255  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-23T17:15:37,255  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:37,256  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_3052cf24-2212-4f9b-a03a-388a7ad52284): drop table if exists acidTbl2
2024-04-23T17:15:37,259  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-23T17:15:37,259  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-23T17:15:37,260  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,260  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,260  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,260  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:37,260  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_3052cf24-2212-4f9b-a03a-388a7ad52284); Time taken: 0.005 seconds
2024-04-23T17:15:37,260  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240423171537_3052cf24-2212-4f9b-a03a-388a7ad52284
2024-04-23T17:15:37,260  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:37,260  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_3052cf24-2212-4f9b-a03a-388a7ad52284): drop table if exists acidTbl2
2024-04-23T17:15:37,260  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,261  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T17:15:37,261  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,261  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T17:15:37,261  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_3052cf24-2212-4f9b-a03a-388a7ad52284); Time taken: 0.001 seconds
2024-04-23T17:15:37,261  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_3052cf24-2212-4f9b-a03a-388a7ad52284
2024-04-23T17:15:37,267  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-23T17:15:37,272  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,272  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-23T17:15:37,272  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:37,273  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_b2386dd6-ab80-4e6d-957d-de3191e50d62): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:37,275  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-23T17:15:37,276  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-23T17:15:37,277  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:37,290  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,290  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,290  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,290  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,290  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:37,290  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_b2386dd6-ab80-4e6d-957d-de3191e50d62); Time taken: 0.017 seconds
2024-04-23T17:15:37,290  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240423171537_b2386dd6-ab80-4e6d-957d-de3191e50d62
2024-04-23T17:15:37,291  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_b2386dd6-ab80-4e6d-957d-de3191e50d62
2024-04-23T17:15:37,303  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_b2386dd6-ab80-4e6d-957d-de3191e50d62 LockResponse(lockid:22, state:ACQUIRED)
2024-04-23T17:15:37,303  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:37,303  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_b2386dd6-ab80-4e6d-957d-de3191e50d62): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:37,303  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,304  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:37,309  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:37,312  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:37,362  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,362  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=53, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=5}
2024-04-23T17:15:37,362  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_b2386dd6-ab80-4e6d-957d-de3191e50d62); Time taken: 0.059 seconds
2024-04-23T17:15:37,362  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_b2386dd6-ab80-4e6d-957d-de3191e50d62
2024-04-23T17:15:37,366  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-23T17:15:37,372  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,372  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-23T17:15:37,372  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:37,373  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_dade0238-7571-4249-9661-0313339a2e18): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:37,376  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-23T17:15:37,376  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-23T17:15:37,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:37,380  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,380  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,380  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,380  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,380  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:37,381  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_dade0238-7571-4249-9661-0313339a2e18); Time taken: 0.007 seconds
2024-04-23T17:15:37,381  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240423171537_dade0238-7571-4249-9661-0313339a2e18
2024-04-23T17:15:37,381  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_dade0238-7571-4249-9661-0313339a2e18
2024-04-23T17:15:37,394  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_dade0238-7571-4249-9661-0313339a2e18 LockResponse(lockid:23, state:ACQUIRED)
2024-04-23T17:15:37,394  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:37,394  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_dade0238-7571-4249-9661-0313339a2e18): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:37,394  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:37,397  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:37,401  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,401  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:37,413  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,413  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=16, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:37,413  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_dade0238-7571-4249-9661-0313339a2e18); Time taken: 0.019 seconds
2024-04-23T17:15:37,413  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_dade0238-7571-4249-9661-0313339a2e18
2024-04-23T17:15:37,417  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-23T17:15:37,423  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,423  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-23T17:15:37,424  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:37,424  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_d952cb3f-e357-4e40-a26d-ca0802759811): drop table if exists nonAcidNonBucket
2024-04-23T17:15:37,427  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-23T17:15:37,427  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-23T17:15:37,428  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:37,431  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,432  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,432  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,432  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,432  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:37,432  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_d952cb3f-e357-4e40-a26d-ca0802759811); Time taken: 0.008 seconds
2024-04-23T17:15:37,432  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240423171537_d952cb3f-e357-4e40-a26d-ca0802759811
2024-04-23T17:15:37,432  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_d952cb3f-e357-4e40-a26d-ca0802759811
2024-04-23T17:15:37,445  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_d952cb3f-e357-4e40-a26d-ca0802759811 LockResponse(lockid:24, state:ACQUIRED)
2024-04-23T17:15:37,445  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:37,446  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_d952cb3f-e357-4e40-a26d-ca0802759811): drop table if exists nonAcidNonBucket
2024-04-23T17:15:37,446  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:37,449  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:37,452  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:37,465  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,465  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=15, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:37,465  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_d952cb3f-e357-4e40-a26d-ca0802759811); Time taken: 0.019 seconds
2024-04-23T17:15:37,465  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_d952cb3f-e357-4e40-a26d-ca0802759811
2024-04-23T17:15:37,468  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-23T17:15:37,474  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,474  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-23T17:15:37,474  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T17:15:37,540  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T17:15:37,540  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T17:15:37,540  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T17:15:37,540  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T17:15:37,540  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T17:15:37,540  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T17:15:37,541  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T17:15:37,541  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T17:15:37,541  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T17:15:37,541  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T17:15:37,541  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T17:15:37,543  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 87774604-9498-46cd-9cb1-b494340b69d0
2024-04-23T17:15:37,545  INFO [main] SessionState: Hive Session ID = 87774604-9498-46cd-9cb1-b494340b69d0
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:37,546  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:37,551  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/87774604-9498-46cd-9cb1-b494340b69d0
2024-04-23T17:15:37,553  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0
2024-04-23T17:15:37,556  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/87774604-9498-46cd-9cb1-b494340b69d0/_tmp_space.db
2024-04-23T17:15:37,556  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=87774604-9498-46cd-9cb1-b494340b69d0, clientType=HIVECLI]
2024-04-23T17:15:37,556  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:37,557  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_e1cae6b8-fddc-429f-a16d-16b0deb287a8): drop table if exists acidTbl
2024-04-23T17:15:37,565  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T17:15:37,565  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T17:15:37,568  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:37,575  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,575  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,575  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,575  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=2}
2024-04-23T17:15:37,575  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_e1cae6b8-fddc-429f-a16d-16b0deb287a8); Time taken: 0.018 seconds
2024-04-23T17:15:37,575  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423171537_e1cae6b8-fddc-429f-a16d-16b0deb287a8
2024-04-23T17:15:37,575  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:37,575  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_e1cae6b8-fddc-429f-a16d-16b0deb287a8): drop table if exists acidTbl
2024-04-23T17:15:37,575  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,576  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:37,577  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,577  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:37,577  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_e1cae6b8-fddc-429f-a16d-16b0deb287a8); Time taken: 0.002 seconds
2024-04-23T17:15:37,577  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_e1cae6b8-fddc-429f-a16d-16b0deb287a8
2024-04-23T17:15:37,582  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T17:15:37,589  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,589  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T17:15:37,589  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:37,590  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_779ec023-9cdd-40ef-bedd-8617441e8cc6): drop table if exists acidTblPart
2024-04-23T17:15:37,592  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T17:15:37,592  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T17:15:37,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:37,593  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,594  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,594  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,594  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:37,594  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_779ec023-9cdd-40ef-bedd-8617441e8cc6); Time taken: 0.004 seconds
2024-04-23T17:15:37,594  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423171537_779ec023-9cdd-40ef-bedd-8617441e8cc6
2024-04-23T17:15:37,594  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:37,594  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_779ec023-9cdd-40ef-bedd-8617441e8cc6): drop table if exists acidTblPart
2024-04-23T17:15:37,594  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:37,595  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,595  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:37,595  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_779ec023-9cdd-40ef-bedd-8617441e8cc6); Time taken: 0.001 seconds
2024-04-23T17:15:37,596  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_779ec023-9cdd-40ef-bedd-8617441e8cc6
2024-04-23T17:15:37,600  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T17:15:37,605  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,605  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T17:15:37,605  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:37,606  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_dc3fba95-57ca-44cc-8c20-9de46dd6879f): drop table if exists acidTbl2
2024-04-23T17:15:37,608  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T17:15:37,608  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T17:15:37,609  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:37,609  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,609  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,609  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,610  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:37,610  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_dc3fba95-57ca-44cc-8c20-9de46dd6879f); Time taken: 0.003 seconds
2024-04-23T17:15:37,610  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423171537_dc3fba95-57ca-44cc-8c20-9de46dd6879f
2024-04-23T17:15:37,610  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:37,610  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_dc3fba95-57ca-44cc-8c20-9de46dd6879f): drop table if exists acidTbl2
2024-04-23T17:15:37,610  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:37,611  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,611  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:37,611  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_dc3fba95-57ca-44cc-8c20-9de46dd6879f); Time taken: 0.001 seconds
2024-04-23T17:15:37,611  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_dc3fba95-57ca-44cc-8c20-9de46dd6879f
2024-04-23T17:15:37,616  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T17:15:37,621  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,621  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T17:15:37,621  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:37,621  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_a53383b7-9d80-4668-86e5-1b0a970edc3e): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:37,623  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T17:15:37,624  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T17:15:37,624  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:37,625  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,625  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,625  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,625  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:37,625  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_a53383b7-9d80-4668-86e5-1b0a970edc3e); Time taken: 0.004 seconds
2024-04-23T17:15:37,625  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423171537_a53383b7-9d80-4668-86e5-1b0a970edc3e
2024-04-23T17:15:37,625  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:37,626  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_a53383b7-9d80-4668-86e5-1b0a970edc3e): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:37,626  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:37,627  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,627  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:37,627  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_a53383b7-9d80-4668-86e5-1b0a970edc3e); Time taken: 0.001 seconds
2024-04-23T17:15:37,627  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_a53383b7-9d80-4668-86e5-1b0a970edc3e
2024-04-23T17:15:37,632  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T17:15:37,637  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,638  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T17:15:37,638  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:37,638  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_62c316fc-3fc5-4a72-bda9-0bc21c7bf5c4): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:37,641  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T17:15:37,641  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T17:15:37,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:37,643  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,643  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,643  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,643  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:37,643  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_62c316fc-3fc5-4a72-bda9-0bc21c7bf5c4); Time taken: 0.005 seconds
2024-04-23T17:15:37,643  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423171537_62c316fc-3fc5-4a72-bda9-0bc21c7bf5c4
2024-04-23T17:15:37,643  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:37,643  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_62c316fc-3fc5-4a72-bda9-0bc21c7bf5c4): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:37,643  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:37,645  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,645  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:37,645  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_62c316fc-3fc5-4a72-bda9-0bc21c7bf5c4); Time taken: 0.001 seconds
2024-04-23T17:15:37,645  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_62c316fc-3fc5-4a72-bda9-0bc21c7bf5c4
2024-04-23T17:15:37,649  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T17:15:37,654  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,655  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T17:15:37,655  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:37,655  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_0c42ecd7-d41b-4c7a-81ab-92d654e380fa): drop table if exists nonAcidNonBucket
2024-04-23T17:15:37,657  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T17:15:37,658  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T17:15:37,658  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:37,659  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,659  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,659  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,659  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:37,660  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_0c42ecd7-d41b-4c7a-81ab-92d654e380fa); Time taken: 0.004 seconds
2024-04-23T17:15:37,660  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423171537_0c42ecd7-d41b-4c7a-81ab-92d654e380fa
2024-04-23T17:15:37,660  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:37,660  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_0c42ecd7-d41b-4c7a-81ab-92d654e380fa): drop table if exists nonAcidNonBucket
2024-04-23T17:15:37,660  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,660  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:37,661  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,661  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:37,661  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_0c42ecd7-d41b-4c7a-81ab-92d654e380fa); Time taken: 0.001 seconds
2024-04-23T17:15:37,661  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_0c42ecd7-d41b-4c7a-81ab-92d654e380fa
2024-04-23T17:15:37,666  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T17:15:37,671  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,671  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T17:15:37,671  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,671  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_2c0dcabf-6e08-45b1-90e3-4e02a5e96310): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,675  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T17:15:37,675  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T17:15:37,676  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:37,676  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:37,681  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T17:15:37,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:37,682  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:37,682  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,682  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,682  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,682  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0}
2024-04-23T17:15:37,682  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_2c0dcabf-6e08-45b1-90e3-4e02a5e96310); Time taken: 0.011 seconds
2024-04-23T17:15:37,682  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423171537_2c0dcabf-6e08-45b1-90e3-4e02a5e96310
2024-04-23T17:15:37,683  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_2c0dcabf-6e08-45b1-90e3-4e02a5e96310
2024-04-23T17:15:37,701  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_2c0dcabf-6e08-45b1-90e3-4e02a5e96310 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T17:15:37,702  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:37,702  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_2c0dcabf-6e08-45b1-90e3-4e02a5e96310): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,702  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713917737, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:37,705  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtbl
2024-04-23T17:15:37,731  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,731  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=28}
2024-04-23T17:15:37,731  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_2c0dcabf-6e08-45b1-90e3-4e02a5e96310); Time taken: 0.029 seconds
2024-04-23T17:15:37,731  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_2c0dcabf-6e08-45b1-90e3-4e02a5e96310
2024-04-23T17:15:37,735  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T17:15:37,740  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,740  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T17:15:37,740  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,741  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_e775aafe-afa8-49aa-94f7-f93e8406959d): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,743  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T17:15:37,743  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T17:15:37,744  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:37,744  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:37,746  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T17:15:37,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:37,748  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:37,748  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,748  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,748  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,748  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:37,748  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_e775aafe-afa8-49aa-94f7-f93e8406959d); Time taken: 0.007 seconds
2024-04-23T17:15:37,748  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423171537_e775aafe-afa8-49aa-94f7-f93e8406959d
2024-04-23T17:15:37,748  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_e775aafe-afa8-49aa-94f7-f93e8406959d
2024-04-23T17:15:37,761  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_e775aafe-afa8-49aa-94f7-f93e8406959d LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T17:15:37,761  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:37,762  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_e775aafe-afa8-49aa-94f7-f93e8406959d): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,762  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,763  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713917737, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:37,764  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtblpart
2024-04-23T17:15:37,773  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,773  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=10}
2024-04-23T17:15:37,773  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_e775aafe-afa8-49aa-94f7-f93e8406959d); Time taken: 0.011 seconds
2024-04-23T17:15:37,773  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_e775aafe-afa8-49aa-94f7-f93e8406959d
2024-04-23T17:15:37,776  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T17:15:37,781  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,781  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T17:15:37,781  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,782  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_b4b082e6-a030-46ff-b0c9-8a8ad5c26243): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,784  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T17:15:37,784  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T17:15:37,785  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:37,785  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:37,787  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T17:15:37,787  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:37,788  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:37,788  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,788  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,788  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,788  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, getDatabase_(String)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:37,789  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_b4b082e6-a030-46ff-b0c9-8a8ad5c26243); Time taken: 0.006 seconds
2024-04-23T17:15:37,789  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423171537_b4b082e6-a030-46ff-b0c9-8a8ad5c26243
2024-04-23T17:15:37,789  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_b4b082e6-a030-46ff-b0c9-8a8ad5c26243
2024-04-23T17:15:37,802  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_b4b082e6-a030-46ff-b0c9-8a8ad5c26243 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T17:15:37,802  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:37,802  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_b4b082e6-a030-46ff-b0c9-8a8ad5c26243): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,802  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713917737, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:37,804  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl
2024-04-23T17:15:37,812  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,812  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=9}
2024-04-23T17:15:37,812  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_b4b082e6-a030-46ff-b0c9-8a8ad5c26243); Time taken: 0.01 seconds
2024-04-23T17:15:37,812  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_b4b082e6-a030-46ff-b0c9-8a8ad5c26243
2024-04-23T17:15:37,816  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T17:15:37,822  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,822  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T17:15:37,823  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,823  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_43fc1aa8-2cf1-4193-bf39-ddb7925c2796): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,826  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T17:15:37,826  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T17:15:37,827  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:37,827  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:37,829  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T17:15:37,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:37,830  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:37,830  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,830  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,830  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,830  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:37,830  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_43fc1aa8-2cf1-4193-bf39-ddb7925c2796); Time taken: 0.007 seconds
2024-04-23T17:15:37,830  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423171537_43fc1aa8-2cf1-4193-bf39-ddb7925c2796
2024-04-23T17:15:37,831  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_43fc1aa8-2cf1-4193-bf39-ddb7925c2796
2024-04-23T17:15:37,846  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_43fc1aa8-2cf1-4193-bf39-ddb7925c2796 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T17:15:37,846  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:37,846  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_43fc1aa8-2cf1-4193-bf39-ddb7925c2796): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,846  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713917737, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:37,849  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl2
2024-04-23T17:15:37,857  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,857  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=9}
2024-04-23T17:15:37,857  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_43fc1aa8-2cf1-4193-bf39-ddb7925c2796); Time taken: 0.01 seconds
2024-04-23T17:15:37,857  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_43fc1aa8-2cf1-4193-bf39-ddb7925c2796
2024-04-23T17:15:37,861  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T17:15:37,867  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,867  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T17:15:37,868  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,868  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_aa1efba3-bc14-4853-8dfb-35b4ac24fa38): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,870  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T17:15:37,871  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T17:15:37,871  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:37,871  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:37,874  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T17:15:37,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:37,875  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:37,875  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,875  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,875  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,875  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:37,875  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_aa1efba3-bc14-4853-8dfb-35b4ac24fa38); Time taken: 0.007 seconds
2024-04-23T17:15:37,875  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423171537_aa1efba3-bc14-4853-8dfb-35b4ac24fa38
2024-04-23T17:15:37,875  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_aa1efba3-bc14-4853-8dfb-35b4ac24fa38
2024-04-23T17:15:37,901  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_aa1efba3-bc14-4853-8dfb-35b4ac24fa38 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T17:15:37,901  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:37,902  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_aa1efba3-bc14-4853-8dfb-35b4ac24fa38): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:37,902  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,903  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/87774604-9498-46cd-9cb1-b494340b69d0/_tmp_space.db/5cf6bc58-36c1-4807-88e5-dae70869204c
2024-04-23T17:15:37,906  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,906  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T17:15:37,906  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_aa1efba3-bc14-4853-8dfb-35b4ac24fa38); Time taken: 0.004 seconds
2024-04-23T17:15:37,907  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_aa1efba3-bc14-4853-8dfb-35b4ac24fa38
2024-04-23T17:15:37,910  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T17:15:37,916  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,916  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T17:15:37,917  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,917  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_927ecdd0-0319-4ff3-b1cf-2e9a4260b6c7): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,919  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T17:15:37,920  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T17:15:37,920  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:37,920  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:37,923  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T17:15:37,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:37,923  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:37,923  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,923  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,924  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,924  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0}
2024-04-23T17:15:37,924  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_927ecdd0-0319-4ff3-b1cf-2e9a4260b6c7); Time taken: 0.006 seconds
2024-04-23T17:15:37,924  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423171537_927ecdd0-0319-4ff3-b1cf-2e9a4260b6c7
2024-04-23T17:15:37,924  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_927ecdd0-0319-4ff3-b1cf-2e9a4260b6c7
2024-04-23T17:15:37,942  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_927ecdd0-0319-4ff3-b1cf-2e9a4260b6c7 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T17:15:37,942  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:37,942  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_927ecdd0-0319-4ff3-b1cf-2e9a4260b6c7): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:37,943  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:37,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713917737, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:37,945  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidnonbucket
2024-04-23T17:15:37,956  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:37,956  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=13}
2024-04-23T17:15:37,957  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_927ecdd0-0319-4ff3-b1cf-2e9a4260b6c7); Time taken: 0.014 seconds
2024-04-23T17:15:37,957  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_927ecdd0-0319-4ff3-b1cf-2e9a4260b6c7
2024-04-23T17:15:37,961  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T17:15:37,969  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:37,970  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T17:15:37,970  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T17:15:37,970  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171537_e93a2e94-1264-4fd0-81e9-5eb166fd49b7): drop table if exists T
2024-04-23T17:15:37,973  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T17:15:37,973  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T17:15:37,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:37,993  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:37,993  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:37,993  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:37,993  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:37,993  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=19, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1}
2024-04-23T17:15:37,993  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171537_e93a2e94-1264-4fd0-81e9-5eb166fd49b7); Time taken: 0.023 seconds
2024-04-23T17:15:37,993  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423171537_e93a2e94-1264-4fd0-81e9-5eb166fd49b7
2024-04-23T17:15:37,994  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171537_e93a2e94-1264-4fd0-81e9-5eb166fd49b7
2024-04-23T17:15:38,019  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171537_e93a2e94-1264-4fd0-81e9-5eb166fd49b7 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T17:15:38,019  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:38,019  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171537_e93a2e94-1264-4fd0-81e9-5eb166fd49b7): drop table if exists T
2024-04-23T17:15:38,020  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:38,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:38,023  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,023  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:38,026  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,026  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T17:15:38,171  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t does not exist; Force to delete it.
2024-04-23T17:15:38,171 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:38,171  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:38,171  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=148, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:38,171  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171537_e93a2e94-1264-4fd0-81e9-5eb166fd49b7); Time taken: 0.152 seconds
2024-04-23T17:15:38,171  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171537_e93a2e94-1264-4fd0-81e9-5eb166fd49b7
2024-04-23T17:15:38,176  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T17:15:38,182  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:38,184  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T17:15:38,184  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T17:15:38,184  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171538_9855c491-9550-413e-abd1-65fe79afa611): drop table if exists Tstage
2024-04-23T17:15:38,186  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T17:15:38,187  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T17:15:38,187  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:38,203  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,203  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:38,203  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:38,203  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:38,203  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=16, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0}
2024-04-23T17:15:38,203  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171538_9855c491-9550-413e-abd1-65fe79afa611); Time taken: 0.019 seconds
2024-04-23T17:15:38,203  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423171538_9855c491-9550-413e-abd1-65fe79afa611
2024-04-23T17:15:38,204  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171538_9855c491-9550-413e-abd1-65fe79afa611
2024-04-23T17:15:38,217  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171538_9855c491-9550-413e-abd1-65fe79afa611 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T17:15:38,217  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:38,217  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171538_9855c491-9550-413e-abd1-65fe79afa611): drop table if exists Tstage
2024-04-23T17:15:38,218  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:38,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:38,222  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:38,225  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T17:15:38,236  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage does not exist; Force to delete it.
2024-04-23T17:15:38,236 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:38,236  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:38,236  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=14, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4}
2024-04-23T17:15:38,236  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171538_9855c491-9550-413e-abd1-65fe79afa611); Time taken: 0.019 seconds
2024-04-23T17:15:38,236  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171538_9855c491-9550-413e-abd1-65fe79afa611
2024-04-23T17:15:38,240  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T17:15:38,245  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:38,245  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T17:15:38,245  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:38,246  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171538_48c1a1ad-289b-4895-ba70-6ced777f010e): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:38,248  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T17:15:38,249  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T17:15:38,250  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:38,250  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:38,257  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T17:15:38,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:38,258  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:38,258  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:38,258  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:38,258  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:38,258  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=7, getValidTxns_(long)=1}
2024-04-23T17:15:38,258  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171538_48c1a1ad-289b-4895-ba70-6ced777f010e); Time taken: 0.012 seconds
2024-04-23T17:15:38,259  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423171538_48c1a1ad-289b-4895-ba70-6ced777f010e
2024-04-23T17:15:38,259  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171538_48c1a1ad-289b-4895-ba70-6ced777f010e
2024-04-23T17:15:38,278  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171538_48c1a1ad-289b-4895-ba70-6ced777f010e LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T17:15:38,278  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:38,278  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171538_48c1a1ad-289b-4895-ba70-6ced777f010e): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T17:15:38,279  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:38,279  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713917738, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:38,281  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:38,305  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:38,305  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=26}
2024-04-23T17:15:38,305  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171538_48c1a1ad-289b-4895-ba70-6ced777f010e); Time taken: 0.027 seconds
2024-04-23T17:15:38,305  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171538_48c1a1ad-289b-4895-ba70-6ced777f010e
2024-04-23T17:15:38,308  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T17:15:38,313  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:38,313  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T17:15:38,314  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:38,314  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171538_91e8edca-7835-4dec-b16d-fcacfbc2c066): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:38,317  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T17:15:38,318  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T17:15:38,319  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:38,319  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:38,321  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T17:15:38,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:38,322  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:38,322  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:38,322  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:38,322  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:38,322  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getDatabase_(String)=0, isCompatibleWith_(Configuration)=0, flushCache_()=1, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T17:15:38,322  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171538_91e8edca-7835-4dec-b16d-fcacfbc2c066); Time taken: 0.008 seconds
2024-04-23T17:15:38,322  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423171538_91e8edca-7835-4dec-b16d-fcacfbc2c066
2024-04-23T17:15:38,322  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171538_91e8edca-7835-4dec-b16d-fcacfbc2c066
2024-04-23T17:15:38,335  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171538_91e8edca-7835-4dec-b16d-fcacfbc2c066 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T17:15:38,335  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:38,335  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171538_91e8edca-7835-4dec-b16d-fcacfbc2c066): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:38,335  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:38,336  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713917738, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:38,337  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:38,347  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:38,347  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=10}
2024-04-23T17:15:38,347  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171538_91e8edca-7835-4dec-b16d-fcacfbc2c066); Time taken: 0.011 seconds
2024-04-23T17:15:38,347  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171538_91e8edca-7835-4dec-b16d-fcacfbc2c066
2024-04-23T17:15:38,351  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T17:15:38,356  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:38,356  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T17:15:38,357  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(1,4)
2024-04-23T17:15:38,357  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26): insert into Tstage values(0,2),(1,4)
2024-04-23T17:15:38,360  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T17:15:38,360  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T17:15:38,361  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:38,361  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:38,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:38,367  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,367  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:38,367  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:38,367  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:38,367  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:38,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:38,371  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,371  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:38,371  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T17:15:38,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:38,441  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:38,441  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:38,441  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:38,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:38,443  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:38,443  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:38,443  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:38,443  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:38,446  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,448  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1
2024-04-23T17:15:38,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:38,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:38,453  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:38,454  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T17:15:38,454  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T17:15:38,455  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:38,456  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:38,470  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:38,475  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:38,476  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:38,476  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:38,476  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:38,476  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:38,476  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T17:15:38,476  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:38,477  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getNotNullConstraints_(NotNullConstraintsRequest)=0, getAllTableConstraints_(AllTableConstraintsRequest)=23, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=16, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0, getCheckConstraints_(CheckConstraintsRequest)=0}
2024-04-23T17:15:38,477  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26); Time taken: 0.119 seconds
2024-04-23T17:15:38,477  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26
2024-04-23T17:15:38,477  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26
2024-04-23T17:15:38,492  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T17:15:38,492  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:38,492  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26): insert into Tstage values(0,2),(1,4)
2024-04-23T17:15:38,492  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26
2024-04-23T17:15:38,492  INFO [main] ql.Driver: Query ID = alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26
Total jobs = 1
2024-04-23T17:15:38,492  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:38,492  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:38,495  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T17:15:38,495  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:38,495  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:38,496  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:38,496  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:38,496  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:38,496  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:38,496  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:38,498  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:38,498  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T17:15:38,498  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-38_357_9132506030123224867-1/dummy_path
2024-04-23T17:15:38,508  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:38,509  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T17:15:38,514  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:38,514  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T17:15:38,515  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:38,518  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-38_357_9132506030123224867-1/-mr-10001
2024-04-23T17:15:38,521  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:38,527  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:38,531  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:38,532  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T17:15:38,532  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T17:15:38,532  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-38_357_9132506030123224867-1/dummy_path
2024-04-23T17:15:38,533  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:38,551  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:38,573  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local878496463_0013
2024-04-23T17:15:38,573  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:38,640  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:38,640  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:38,641  INFO [Thread-1208] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:38,641  INFO [Thread-1208] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:38,642  INFO [Thread-1208] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:38,643  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local878496463_0013_m_000000_0
2024-04-23T17:15:38,645  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:38,646  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-38_357_9132506030123224867-1/dummy_path/null:0+1
2024-04-23T17:15:38,648  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:38,648  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T17:15:38,649  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T17:15:38,654  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:38,654  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:38,654  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:38,654  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:38,654  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:38,654  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:38,655  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:38,655  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:38,655  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:38,655  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:38,655  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:38,656  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T17:15:38,657  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:38,659  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:38,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:38,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:38,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T17:15:38,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:38,670  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:38,675  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local878496463_0013_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:38,676  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:38,676  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local878496463_0013_m_000000_0' done.
2024-04-23T17:15:38,676  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local878496463_0013_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=303961
		FILE: Number of bytes written=15466761
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-23T17:15:38,676  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local878496463_0013_m_000000_0
2024-04-23T17:15:38,676  INFO [Thread-1208] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:38,677  INFO [Thread-1208] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:38,677  INFO [pool-65-thread-1] mapred.LocalJobRunner: Starting task: attempt_local878496463_0013_r_000000_0
2024-04-23T17:15:38,680  INFO [pool-65-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:38,680  INFO [pool-65-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2a150111
2024-04-23T17:15:38,680  WARN [pool-65-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:38,680  INFO [pool-65-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:38,681  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local878496463_0013_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:38,683  INFO [localfetcher#12] reduce.LocalFetcher: localfetcher#12 about to shuffle output of map attempt_local878496463_0013_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T17:15:38,683  INFO [localfetcher#12] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local878496463_0013_m_000000_0
2024-04-23T17:15:38,683  INFO [localfetcher#12] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T17:15:38,684  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:38,684  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:38,684  INFO [pool-65-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:38,690  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:38,691  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T17:15:38,694  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:38,694  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T17:15:38,694  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:38,694  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:38,694  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T17:15:38,694  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:38,694  INFO [pool-65-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:38,695  INFO [pool-65-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local878496463_0013/job_local878496463_0013.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2775839e
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/_tmp.-ext-10000/000000_0
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T17:15:38,696  INFO [pool-65-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/_tmp.-ext-10000/000000_0
2024-04-23T17:15:38,709  INFO [pool-65-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_1_default.tstage:0, RECORDS_OUT_OPERATOR_FS_6:0, 
2024-04-23T17:15:38,709  INFO [pool-65-thread-1] mapred.Task: Task:attempt_local878496463_0013_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:38,710  INFO [pool-65-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:38,710  INFO [pool-65-thread-1] mapred.Task: Task 'attempt_local878496463_0013_r_000000_0' done.
2024-04-23T17:15:38,710  INFO [pool-65-thread-1] mapred.Task: Final Counters for attempt_local878496463_0013_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=310427
		FILE: Number of bytes written=15466827
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:38,710  INFO [pool-65-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local878496463_0013_r_000000_0
2024-04-23T17:15:38,710  INFO [pool-65-thread-1] mapred.LocalJobRunner: Starting task: attempt_local878496463_0013_r_000001_0
2024-04-23T17:15:38,710  INFO [pool-65-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:38,710  INFO [pool-65-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@49f07bbd
2024-04-23T17:15:38,710  WARN [pool-65-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:38,711  INFO [pool-65-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:38,711  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local878496463_0013_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:38,714  INFO [localfetcher#13] reduce.LocalFetcher: localfetcher#13 about to shuffle output of map attempt_local878496463_0013_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T17:15:38,714  INFO [localfetcher#13] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local878496463_0013_m_000000_0
2024-04-23T17:15:38,714  INFO [localfetcher#13] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T17:15:38,715  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:38,715  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:38,715  INFO [pool-65-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:38,721  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:38,722  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T17:15:38,724  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:38,725  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T17:15:38,725  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:38,725  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:38,725  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T17:15:38,725  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:38,725  INFO [pool-65-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:38,726  INFO [pool-65-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T17:15:38,727  INFO [pool-65-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:38,727  INFO [pool-65-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T17:15:38,727  INFO [pool-65-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T17:15:38,727  INFO [pool-65-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T17:15:38,727  INFO [pool-65-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local878496463_0013/job_local878496463_0013.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@74672440
2024-04-23T17:15:38,727  INFO [pool-65-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/_tmp.-ext-10000/000001_0
2024-04-23T17:15:38,727  INFO [pool-65-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T17:15:38,727  INFO [pool-65-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/_tmp.-ext-10000/000001_0
2024-04-23T17:15:38,728  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T17:15:38,728  INFO [pool-65-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T17:15:38,733  INFO [pool-65-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T17:15:38,733  INFO [pool-65-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T17:15:38,733  INFO [pool-65-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:38,733  INFO [pool-65-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T17:15:38,733  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T17:15:38,739  INFO [pool-65-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-23T17:15:38,740  INFO [pool-65-thread-1] mapred.Task: Task:attempt_local878496463_0013_r_000001_0 is done. And is in the process of committing
2024-04-23T17:15:38,740  INFO [pool-65-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:38,740  INFO [pool-65-thread-1] mapred.Task: Task 'attempt_local878496463_0013_r_000001_0' done.
2024-04-23T17:15:38,740  INFO [pool-65-thread-1] mapred.Task: Final Counters for attempt_local878496463_0013_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=316923
		FILE: Number of bytes written=15467215
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:38,740  INFO [pool-65-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local878496463_0013_r_000001_0
2024-04-23T17:15:38,740  INFO [Thread-1208] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:39,645 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:39,646  INFO [main] exec.Task: 2024-04-23 17:15:39,645 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local878496463_0013
2024-04-23T17:15:39,648  INFO [main] exec.Task: Ended Job = job_local878496463_0013
2024-04-23T17:15:39,650  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T17:15:39,651  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1/-ext-10000
2024-04-23T17:15:39,651  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:39,654  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:39,658  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,659  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:39,660  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:39,671  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T17:15:39,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:39,674  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,674  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T17:15:39,675  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-38_357_9132506030123224867-1/-mr-10001
2024-04-23T17:15:39,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:39,679  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,679  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T17:15:39,679  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T17:15:39,680  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:39,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:39,691  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=2, numRows=2, totalSize=252, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T17:15:39,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:39,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=14, alter_table_(String, String, String, Table, EnvironmentContext, String)=22}
MapReduce Jobs Launched: 
2024-04-23T17:15:39,691  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:39,692  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:39,692  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:39,692  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26); Time taken: 1.199 seconds
2024-04-23T17:15:39,692  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171538_6a228478-2345-4ad3-9d6f-412c7f040c26
2024-04-23T17:15:39,696  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T17:15:39,701  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:39,702  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T17:15:39,702  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:39,702  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1
2024-04-23T17:15:39,702  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-38_357_9132506030123224867-1 on fs with scheme file
2024-04-23T17:15:39,702  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-38_357_9132506030123224867-1
2024-04-23T17:15:39,703  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-38_357_9132506030123224867-1 on fs with scheme file
2024-04-23T17:15:39,703  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171539_d5d02584-d2b2-45f9-9552-845832041129): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:39,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:39,707  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,709  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T17:15:39,709  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T17:15:39,712  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:39,714  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,715  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:39,715  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:39,715  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:39,715  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:39,715  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:39,715  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:39,715  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:39,715  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=6, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1}
2024-04-23T17:15:39,716  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171539_d5d02584-d2b2-45f9-9552-845832041129); Time taken: 0.012 seconds
2024-04-23T17:15:39,716  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423171539_d5d02584-d2b2-45f9-9552-845832041129
2024-04-23T17:15:39,716  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171539_d5d02584-d2b2-45f9-9552-845832041129
2024-04-23T17:15:39,728  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171539_d5d02584-d2b2-45f9-9552-845832041129 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T17:15:39,728  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:39,728  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171539_d5d02584-d2b2-45f9-9552-845832041129): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:39,729  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:39,729  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:39,729  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:39,729  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:39,729  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:39,738  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:39,748  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:39,748  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:39,748  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171539_d5d02584-d2b2-45f9-9552-845832041129); Time taken: 0.02 seconds
2024-04-23T17:15:39,748  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171539_d5d02584-d2b2-45f9-9552-845832041129
2024-04-23T17:15:39,752  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T17:15:39,757  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:39,757  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T17:15:39,758  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data'
2024-04-23T17:15:39,758  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171539_38b5dec8-3c0f-45b8-b883-71891fa0a13e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data'
2024-04-23T17:15:39,761  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T17:15:39,761  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T17:15:39,762  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:39,767  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,775  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 19
2024-04-23T17:15:39,775  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [19])
2024-04-23T17:15:39,775  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:39,775  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:39,775  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:39,775  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, allocateTableWriteId_(long, String, String)=6, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=5, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:39,775  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171539_38b5dec8-3c0f-45b8-b883-71891fa0a13e); Time taken: 0.017 seconds
2024-04-23T17:15:39,776  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423171539_38b5dec8-3c0f-45b8-b883-71891fa0a13e
2024-04-23T17:15:39,776  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171539_38b5dec8-3c0f-45b8-b883-71891fa0a13e
2024-04-23T17:15:39,791  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171539_38b5dec8-3c0f-45b8-b883-71891fa0a13e LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T17:15:39,791  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:39,794  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171539_38b5dec8-3c0f-45b8-b883-71891fa0a13e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data'
2024-04-23T17:15:39,794  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:39,795  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:39,797  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,797  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:39,802  INFO [HMSHandler #13] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:39,816  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T17:15:39,816  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data
2024-04-23T17:15:39,817  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:39,819  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,819  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:39,828  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T17:15:39,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:39,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:39,831  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,831  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:39,834  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T17:15:39,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:39,838  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T17:15:39,861  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:39,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:39,878  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:39,878  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=15, validatePartitionNameCharacters_(List)=1, add_partitions_(List, boolean, boolean)=19, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=36, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, getValidWriteIds_(List, String)=0}
2024-04-23T17:15:39,878  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171539_38b5dec8-3c0f-45b8-b883-71891fa0a13e); Time taken: 0.084 seconds
2024-04-23T17:15:39,878  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171539_38b5dec8-3c0f-45b8-b883-71891fa0a13e
2024-04-23T17:15:39,881  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T17:15:39,886  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:39,887  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T17:15:39,887  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:39,887  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:39,890  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T17:15:39,890  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T17:15:39,891  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:39,891  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:39,896  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:39,896  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:39,897  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:39,899  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,899  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:39,899  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:39,899  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:39,901  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:39,929  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:39,930  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:39,942  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:39,945  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:39,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:39,952  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:39,952  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:39,982  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:39,982  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:39,982  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:39,983  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-39_887_2921442751745956457-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-39_887_2921442751745956457-1
2024-04-23T17:15:39,991  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:39,992  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:39,992  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T17:15:39,993  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:39,993  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:40,002  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:40,002  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:40,003  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:40,003  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:40,003  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:40,003  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:40,003  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T17:15:40,004  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T17:15:40,004  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:40,004  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=23, getAggrColStatsFor_(String, String, List, List, String, String)=10, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=5, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1}
2024-04-23T17:15:40,004  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e); Time taken: 0.117 seconds
2024-04-23T17:15:40,004  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e
2024-04-23T17:15:40,005  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e
2024-04-23T17:15:40,021  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T17:15:40,021  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:40,021  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T17:15:40,022  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e
2024-04-23T17:15:40,022  INFO [main] ql.Driver: Query ID = alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e
Total jobs = 1
2024-04-23T17:15:40,022  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:40,022  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:40,025  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:40,025  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:40,025  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:40,025  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:40,025  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:40,025  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:40,025  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:40,025  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:40,028  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:40,028  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:40,028  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:40,038  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:40,038  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T17:15:40,043  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:40,044  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T17:15:40,044  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:40,049  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:40,054  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:40,059  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:40,060  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:40,060  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:40,060  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:40,060  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:40,060  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T17:15:40,060  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:40,070  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T17:15:40,070  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 1). duration: 10 ms
2024-04-23T17:15:40,070  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:40,089  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:40,117  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2103510579_0014
2024-04-23T17:15:40,117  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:40,202  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:40,202  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:40,205  INFO [Thread-1289] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:40,205  INFO [Thread-1289] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:40,207  INFO [Thread-1289] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:40,207  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2103510579_0014_m_000000_0
2024-04-23T17:15:40,208  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:40,208  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:40,209  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:40,210  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T17:15:40,211  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T17:15:40,211  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0 with {include: [true, true, true], offset: 0, length: 252, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:40,221  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T17:15:40,221  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:40,227  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:40,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:40,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:40,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:40,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:40,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:40,228  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:40,230  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:40,230  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:40,230  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:40,230  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T17:15:40,230  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:40,231  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:40,231  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T17:15:40,231  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:40,231  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:40,231  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T17:15:40,232  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:40,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:40,265  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2103510579_0014_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:40,265  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:40,265  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2103510579_0014_m_000000_0' done.
2024-04-23T17:15:40,265  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2103510579_0014_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=324874
		FILE: Number of bytes written=16656531
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=6405
2024-04-23T17:15:40,265  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2103510579_0014_m_000000_0
2024-04-23T17:15:40,266  INFO [Thread-1289] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:40,266  INFO [Thread-1289] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:40,267  INFO [pool-71-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2103510579_0014_r_000000_0
2024-04-23T17:15:40,267  INFO [pool-71-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:40,267  INFO [pool-71-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@32410b62
2024-04-23T17:15:40,267  WARN [pool-71-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:40,268  INFO [pool-71-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:40,268  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2103510579_0014_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:40,269  INFO [localfetcher#14] reduce.LocalFetcher: localfetcher#14 about to shuffle output of map attempt_local2103510579_0014_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-23T17:15:40,269  INFO [localfetcher#14] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local2103510579_0014_m_000000_0
2024-04-23T17:15:40,269  INFO [localfetcher#14] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-23T17:15:40,269  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:40,270  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:40,270  INFO [pool-71-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:40,276  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:40,276  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-23T17:15:40,279  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 412 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:40,279  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 1 files, 416 bytes from disk
2024-04-23T17:15:40,279  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:40,279  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:40,279  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-23T17:15:40,279  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T17:15:40,280  INFO [pool-71-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:40,280  INFO [pool-71-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T17:15:40,281  INFO [pool-71-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:40,281  INFO [pool-71-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:40,281  INFO [pool-71-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-23T17:15:40,281  INFO [pool-71-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:40,281  INFO [pool-71-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@24c2a8d3, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6ca1c072>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@61428675>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@19da7f13, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@4d41ffd8
2024-04-23T17:15:40,282  INFO [pool-71-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-39_887_2921442751745956457-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-39_887_2921442751745956457-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:40,282  INFO [pool-71-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-39_887_2921442751745956457-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-39_887_2921442751745956457-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:40,282  INFO [pool-71-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-39_887_2921442751745956457-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-39_887_2921442751745956457-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:40,289  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:40,289  INFO [pool-71-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:40,289  INFO [pool-71-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:40,289  INFO [pool-71-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:40,289  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T17:15:40,289  INFO [pool-71-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:2, 
2024-04-23T17:15:40,290  INFO [pool-71-thread-1] mapred.Task: Task:attempt_local2103510579_0014_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:40,290  INFO [pool-71-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:40,290  INFO [pool-71-thread-1] mapred.Task: Task 'attempt_local2103510579_0014_r_000000_0' done.
2024-04-23T17:15:40,290  INFO [pool-71-thread-1] mapred.Task: Final Counters for attempt_local2103510579_0014_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=332017
		FILE: Number of bytes written=16657432
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=416
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1091043328
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:40,290  INFO [pool-71-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2103510579_0014_r_000000_0
2024-04-23T17:15:40,290  INFO [Thread-1289] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:41,204 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:41,205  INFO [main] exec.Task: 2024-04-23 17:15:41,204 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2103510579_0014
2024-04-23T17:15:41,207  INFO [main] exec.Task: Ended Job = job_local2103510579_0014
2024-04-23T17:15:41,209  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,209  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:41,209  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:41,209  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:41,209  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:41,209  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e); Time taken: 1.187 seconds
2024-04-23T17:15:41,209  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171539_42ab7a6a-a3cb-4461-bed4-523deff5559e
2024-04-23T17:15:41,212  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T17:15:41,217  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,218  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T17:15:41,222  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:41,222  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T17:15:41,223  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:41,223  WARN [main] ql.TestTxnAddPartition: addPartitionRename: read data(add partition (p=0)): 
2024-04-23T17:15:41,223  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536936448,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0
{"writeid":1,"bucketid":536936448,"rowid":1}	0	1	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0

2024-04-23T17:15:41,223  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:41,223  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-39_887_2921442751745956457-1
2024-04-23T17:15:41,223  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/87774604-9498-46cd-9cb1-b494340b69d0/hive_2024-04-23_17-15-39_887_2921442751745956457-1 on fs with scheme file
2024-04-23T17:15:41,223  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_5f77029a-92a5-4f61-a70a-b7fe9a11473a): drop table if exists acidTbl
2024-04-23T17:15:41,225  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-23T17:15:41,226  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T17:15:41,226  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:41,229  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,229  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,229  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,229  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,229  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:41,229  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_5f77029a-92a5-4f61-a70a-b7fe9a11473a); Time taken: 0.006 seconds
2024-04-23T17:15:41,229  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423171541_5f77029a-92a5-4f61-a70a-b7fe9a11473a
2024-04-23T17:15:41,229  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_5f77029a-92a5-4f61-a70a-b7fe9a11473a
2024-04-23T17:15:41,243  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_5f77029a-92a5-4f61-a70a-b7fe9a11473a LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T17:15:41,243  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:41,243  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_5f77029a-92a5-4f61-a70a-b7fe9a11473a): drop table if exists acidTbl
2024-04-23T17:15:41,243  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:41,246  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:41,249  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,249  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:41,321  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,321  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=75, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:41,321  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_5f77029a-92a5-4f61-a70a-b7fe9a11473a); Time taken: 0.078 seconds
2024-04-23T17:15:41,321  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_5f77029a-92a5-4f61-a70a-b7fe9a11473a
2024-04-23T17:15:41,325  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T17:15:41,330  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,330  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T17:15:41,330  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:41,330  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_8a601de8-43f4-491f-bc9b-100c026fdfb7): drop table if exists acidTblPart
2024-04-23T17:15:41,332  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 21
2024-04-23T17:15:41,333  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T17:15:41,333  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:41,336  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,336  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,336  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,336  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,336  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:41,336  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_8a601de8-43f4-491f-bc9b-100c026fdfb7); Time taken: 0.006 seconds
2024-04-23T17:15:41,337  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423171541_8a601de8-43f4-491f-bc9b-100c026fdfb7
2024-04-23T17:15:41,337  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_8a601de8-43f4-491f-bc9b-100c026fdfb7
2024-04-23T17:15:41,351  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_8a601de8-43f4-491f-bc9b-100c026fdfb7 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T17:15:41,351  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:41,351  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_8a601de8-43f4-491f-bc9b-100c026fdfb7): drop table if exists acidTblPart
2024-04-23T17:15:41,351  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:41,353  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,353  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:41,356  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:41,374  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,374  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=21, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=2}
2024-04-23T17:15:41,374  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_8a601de8-43f4-491f-bc9b-100c026fdfb7); Time taken: 0.023 seconds
2024-04-23T17:15:41,374  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_8a601de8-43f4-491f-bc9b-100c026fdfb7
2024-04-23T17:15:41,378  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T17:15:41,383  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,383  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T17:15:41,383  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:41,384  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_ca24348a-423d-4afb-a709-10f3f66cf195): drop table if exists acidTbl2
2024-04-23T17:15:41,386  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 21
2024-04-23T17:15:41,386  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T17:15:41,387  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,387  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,387  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,387  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:41,387  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_ca24348a-423d-4afb-a709-10f3f66cf195); Time taken: 0.004 seconds
2024-04-23T17:15:41,387  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423171541_ca24348a-423d-4afb-a709-10f3f66cf195
2024-04-23T17:15:41,387  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:41,387  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_ca24348a-423d-4afb-a709-10f3f66cf195): drop table if exists acidTbl2
2024-04-23T17:15:41,388  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,388  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T17:15:41,388  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,388  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T17:15:41,388  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_ca24348a-423d-4afb-a709-10f3f66cf195); Time taken: 0.001 seconds
2024-04-23T17:15:41,388  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_ca24348a-423d-4afb-a709-10f3f66cf195
2024-04-23T17:15:41,393  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T17:15:41,398  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,398  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T17:15:41,398  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:41,398  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_5162a037-93ee-4c75-b5b7-b45af8b64393): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:41,400  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 21
2024-04-23T17:15:41,400  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T17:15:41,401  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:41,414  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,414  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,414  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,414  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,414  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=13, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:41,414  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_5162a037-93ee-4c75-b5b7-b45af8b64393); Time taken: 0.016 seconds
2024-04-23T17:15:41,414  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423171541_5162a037-93ee-4c75-b5b7-b45af8b64393
2024-04-23T17:15:41,415  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_5162a037-93ee-4c75-b5b7-b45af8b64393
2024-04-23T17:15:41,427  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_5162a037-93ee-4c75-b5b7-b45af8b64393 LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T17:15:41,427  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:41,427  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_5162a037-93ee-4c75-b5b7-b45af8b64393): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:41,427  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,427  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:41,430  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:41,433  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:41,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=41, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:41,471  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_5162a037-93ee-4c75-b5b7-b45af8b64393); Time taken: 0.044 seconds
2024-04-23T17:15:41,471  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_5162a037-93ee-4c75-b5b7-b45af8b64393
2024-04-23T17:15:41,474  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T17:15:41,479  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,480  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T17:15:41,480  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:41,480  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_de6ae9c3-692a-4a2d-aabd-ccdd213144e7): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:41,487  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 21
2024-04-23T17:15:41,488  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T17:15:41,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:41,493  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,493  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,493  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,493  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,493  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=7, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=2}
2024-04-23T17:15:41,493  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_de6ae9c3-692a-4a2d-aabd-ccdd213144e7); Time taken: 0.013 seconds
2024-04-23T17:15:41,493  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423171541_de6ae9c3-692a-4a2d-aabd-ccdd213144e7
2024-04-23T17:15:41,493  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_de6ae9c3-692a-4a2d-aabd-ccdd213144e7
2024-04-23T17:15:41,506  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_de6ae9c3-692a-4a2d-aabd-ccdd213144e7 LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T17:15:41,506  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:41,506  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_de6ae9c3-692a-4a2d-aabd-ccdd213144e7): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:41,507  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,507  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:41,510  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,510  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:41,512  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,513  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:41,524  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,524  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=14, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:41,524  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_de6ae9c3-692a-4a2d-aabd-ccdd213144e7); Time taken: 0.018 seconds
2024-04-23T17:15:41,524  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_de6ae9c3-692a-4a2d-aabd-ccdd213144e7
2024-04-23T17:15:41,528  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T17:15:41,533  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,533  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T17:15:41,541  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:41,541  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_ec91f36d-3ab3-4d20-b397-dd8a5ef67dbb): drop table if exists nonAcidNonBucket
2024-04-23T17:15:41,543  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 21
2024-04-23T17:15:41,544  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T17:15:41,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:41,547  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,547  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,547  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,547  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,547  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=1, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0}
2024-04-23T17:15:41,547  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_ec91f36d-3ab3-4d20-b397-dd8a5ef67dbb); Time taken: 0.006 seconds
2024-04-23T17:15:41,547  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423171541_ec91f36d-3ab3-4d20-b397-dd8a5ef67dbb
2024-04-23T17:15:41,548  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_ec91f36d-3ab3-4d20-b397-dd8a5ef67dbb
2024-04-23T17:15:41,560  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_ec91f36d-3ab3-4d20-b397-dd8a5ef67dbb LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T17:15:41,560  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:41,560  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_ec91f36d-3ab3-4d20-b397-dd8a5ef67dbb): drop table if exists nonAcidNonBucket
2024-04-23T17:15:41,560  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:41,563  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,563  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:41,566  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:41,566  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:41,575  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,575  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=12, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:41,575  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_ec91f36d-3ab3-4d20-b397-dd8a5ef67dbb); Time taken: 0.015 seconds
2024-04-23T17:15:41,575  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_ec91f36d-3ab3-4d20-b397-dd8a5ef67dbb
2024-04-23T17:15:41,579  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T17:15:41,584  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,584  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T17:15:41,585  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T17:15:41,638  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T17:15:41,638  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T17:15:41,638  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T17:15:41,638  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T17:15:41,638  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T17:15:41,638  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T17:15:41,639  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T17:15:41,639  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T17:15:41,639  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T17:15:41,639  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T17:15:41,639  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T17:15:41,640  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 73be6845-0d30-4ec2-93c2-623b7a44172b
2024-04-23T17:15:41,643  INFO [main] SessionState: Hive Session ID = 73be6845-0d30-4ec2-93c2-623b7a44172b
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:41,643  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T17:15:41,648  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/73be6845-0d30-4ec2-93c2-623b7a44172b
2024-04-23T17:15:41,650  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b
2024-04-23T17:15:41,653  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/73be6845-0d30-4ec2-93c2-623b7a44172b/_tmp_space.db
2024-04-23T17:15:41,653  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=73be6845-0d30-4ec2-93c2-623b7a44172b, clientType=HIVECLI]
2024-04-23T17:15:41,653  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:41,654  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_e4f0e3ea-5710-4056-be0d-381dccba3b66): drop table if exists acidTbl
2024-04-23T17:15:41,660  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T17:15:41,661  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T17:15:41,663  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:41,664  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,664  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,664  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,664  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=7, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=1}
2024-04-23T17:15:41,664  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_e4f0e3ea-5710-4056-be0d-381dccba3b66); Time taken: 0.01 seconds
2024-04-23T17:15:41,664  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423171541_e4f0e3ea-5710-4056-be0d-381dccba3b66
2024-04-23T17:15:41,664  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:41,664  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_e4f0e3ea-5710-4056-be0d-381dccba3b66): drop table if exists acidTbl
2024-04-23T17:15:41,665  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,665  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:41,666  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,666  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:41,666  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_e4f0e3ea-5710-4056-be0d-381dccba3b66); Time taken: 0.002 seconds
2024-04-23T17:15:41,666  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_e4f0e3ea-5710-4056-be0d-381dccba3b66
2024-04-23T17:15:41,673  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T17:15:41,680  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,680  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T17:15:41,681  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:41,681  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_731236a9-fffa-4917-9fa5-041fc8c6ae79): drop table if exists acidTblPart
2024-04-23T17:15:41,683  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T17:15:41,684  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T17:15:41,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:41,685  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,685  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,685  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,685  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=0}
2024-04-23T17:15:41,685  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_731236a9-fffa-4917-9fa5-041fc8c6ae79); Time taken: 0.004 seconds
2024-04-23T17:15:41,685  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423171541_731236a9-fffa-4917-9fa5-041fc8c6ae79
2024-04-23T17:15:41,685  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:41,685  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_731236a9-fffa-4917-9fa5-041fc8c6ae79): drop table if exists acidTblPart
2024-04-23T17:15:41,685  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:41,686  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,686  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:41,686  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_731236a9-fffa-4917-9fa5-041fc8c6ae79); Time taken: 0.001 seconds
2024-04-23T17:15:41,686  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_731236a9-fffa-4917-9fa5-041fc8c6ae79
2024-04-23T17:15:41,692  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T17:15:41,698  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,699  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T17:15:41,699  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:41,699  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_fca58280-8ca8-4422-8560-f6fc11006d59): drop table if exists acidTbl2
2024-04-23T17:15:41,701  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T17:15:41,702  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T17:15:41,702  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:41,703  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,703  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,704  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T17:15:41,704  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_fca58280-8ca8-4422-8560-f6fc11006d59); Time taken: 0.005 seconds
2024-04-23T17:15:41,704  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423171541_fca58280-8ca8-4422-8560-f6fc11006d59
2024-04-23T17:15:41,704  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:41,704  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_fca58280-8ca8-4422-8560-f6fc11006d59): drop table if exists acidTbl2
2024-04-23T17:15:41,704  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T17:15:41,705  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,705  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:41,705  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_fca58280-8ca8-4422-8560-f6fc11006d59); Time taken: 0.001 seconds
2024-04-23T17:15:41,705  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_fca58280-8ca8-4422-8560-f6fc11006d59
2024-04-23T17:15:41,711  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T17:15:41,716  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,716  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T17:15:41,716  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:41,717  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_defd2cb4-f17c-4ff9-8b7e-638a84b74f37): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:41,718  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T17:15:41,719  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T17:15:41,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:41,720  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,720  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,720  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,720  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:41,720  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_defd2cb4-f17c-4ff9-8b7e-638a84b74f37); Time taken: 0.003 seconds
2024-04-23T17:15:41,720  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423171541_defd2cb4-f17c-4ff9-8b7e-638a84b74f37
2024-04-23T17:15:41,720  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:41,720  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_defd2cb4-f17c-4ff9-8b7e-638a84b74f37): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:41,720  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,721  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:41,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T17:15:41,721  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_defd2cb4-f17c-4ff9-8b7e-638a84b74f37); Time taken: 0.001 seconds
2024-04-23T17:15:41,721  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_defd2cb4-f17c-4ff9-8b7e-638a84b74f37
2024-04-23T17:15:41,726  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T17:15:41,730  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,730  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T17:15:41,731  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:41,731  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_32e68813-0515-48fc-a457-1fe5f7a43554): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:41,733  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T17:15:41,733  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T17:15:41,734  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:41,734  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,734  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,734  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,734  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:41,734  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_32e68813-0515-48fc-a457-1fe5f7a43554); Time taken: 0.003 seconds
2024-04-23T17:15:41,735  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423171541_32e68813-0515-48fc-a457-1fe5f7a43554
2024-04-23T17:15:41,735  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:41,735  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_32e68813-0515-48fc-a457-1fe5f7a43554): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:41,735  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:41,736  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,736  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:41,736  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_32e68813-0515-48fc-a457-1fe5f7a43554); Time taken: 0.001 seconds
2024-04-23T17:15:41,736  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_32e68813-0515-48fc-a457-1fe5f7a43554
2024-04-23T17:15:41,740  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T17:15:41,744  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,745  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T17:15:41,745  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:41,745  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_6ab93a5a-0c3f-46b5-8e56-9e105ae342a9): drop table if exists nonAcidNonBucket
2024-04-23T17:15:41,747  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T17:15:41,747  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T17:15:41,748  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:41,749  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,749  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,749  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,749  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:41,749  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_6ab93a5a-0c3f-46b5-8e56-9e105ae342a9); Time taken: 0.004 seconds
2024-04-23T17:15:41,749  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423171541_6ab93a5a-0c3f-46b5-8e56-9e105ae342a9
2024-04-23T17:15:41,749  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:41,749  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_6ab93a5a-0c3f-46b5-8e56-9e105ae342a9): drop table if exists nonAcidNonBucket
2024-04-23T17:15:41,749  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:41,750  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,750  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:41,750  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_6ab93a5a-0c3f-46b5-8e56-9e105ae342a9); Time taken: 0.001 seconds
2024-04-23T17:15:41,750  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_6ab93a5a-0c3f-46b5-8e56-9e105ae342a9
2024-04-23T17:15:41,754  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T17:15:41,759  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,759  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T17:15:41,759  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,760  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_68b202d4-bf42-4a1d-8793-2989ced43a37): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,762  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T17:15:41,762  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T17:15:41,763  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:41,763  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:41,767  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T17:15:41,767  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:41,768  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:41,768  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,768  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,768  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,768  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1}
2024-04-23T17:15:41,768  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_68b202d4-bf42-4a1d-8793-2989ced43a37); Time taken: 0.008 seconds
2024-04-23T17:15:41,768  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423171541_68b202d4-bf42-4a1d-8793-2989ced43a37
2024-04-23T17:15:41,768  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_68b202d4-bf42-4a1d-8793-2989ced43a37
2024-04-23T17:15:41,784  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_68b202d4-bf42-4a1d-8793-2989ced43a37 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T17:15:41,784  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:41,785  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_68b202d4-bf42-4a1d-8793-2989ced43a37): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,785  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713917741, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:41,787  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtbl
2024-04-23T17:15:41,820  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,821  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=34}
2024-04-23T17:15:41,821  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_68b202d4-bf42-4a1d-8793-2989ced43a37); Time taken: 0.035 seconds
2024-04-23T17:15:41,821  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_68b202d4-bf42-4a1d-8793-2989ced43a37
2024-04-23T17:15:41,824  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T17:15:41,830  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,831  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T17:15:41,832  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,832  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_328a15af-d0b1-4c45-81ed-58a4ffb92638): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,834  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T17:15:41,834  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T17:15:41,835  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:41,835  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:41,837  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T17:15:41,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:41,838  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:41,838  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,838  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,838  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,838  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, getDatabase_(String)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:41,838  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_328a15af-d0b1-4c45-81ed-58a4ffb92638); Time taken: 0.006 seconds
2024-04-23T17:15:41,838  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423171541_328a15af-d0b1-4c45-81ed-58a4ffb92638
2024-04-23T17:15:41,839  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_328a15af-d0b1-4c45-81ed-58a4ffb92638
2024-04-23T17:15:41,853  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_328a15af-d0b1-4c45-81ed-58a4ffb92638 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T17:15:41,853  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:41,854  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_328a15af-d0b1-4c45-81ed-58a4ffb92638): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,854  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,855  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713917741, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:41,856  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/acidtblpart
2024-04-23T17:15:41,865  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,865  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=10}
2024-04-23T17:15:41,865  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_328a15af-d0b1-4c45-81ed-58a4ffb92638); Time taken: 0.011 seconds
2024-04-23T17:15:41,865  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_328a15af-d0b1-4c45-81ed-58a4ffb92638
2024-04-23T17:15:41,869  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T17:15:41,875  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,875  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T17:15:41,875  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:41,876  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_7eb624ef-5b50-49ce-aa35-8d06fa73ec3e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:41,878  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T17:15:41,879  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T17:15:41,880  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:41,880  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:41,882  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T17:15:41,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:41,883  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:41,883  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,883  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,883  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,883  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:41,883  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_7eb624ef-5b50-49ce-aa35-8d06fa73ec3e); Time taken: 0.008 seconds
2024-04-23T17:15:41,883  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423171541_7eb624ef-5b50-49ce-aa35-8d06fa73ec3e
2024-04-23T17:15:41,884  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_7eb624ef-5b50-49ce-aa35-8d06fa73ec3e
2024-04-23T17:15:41,897  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_7eb624ef-5b50-49ce-aa35-8d06fa73ec3e LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T17:15:41,897  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:41,897  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_7eb624ef-5b50-49ce-aa35-8d06fa73ec3e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:41,898  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713917741, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:41,900  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl
2024-04-23T17:15:41,907  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,907  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=9}
2024-04-23T17:15:41,907  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_7eb624ef-5b50-49ce-aa35-8d06fa73ec3e); Time taken: 0.01 seconds
2024-04-23T17:15:41,907  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_7eb624ef-5b50-49ce-aa35-8d06fa73ec3e
2024-04-23T17:15:41,911  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T17:15:41,916  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,916  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T17:15:41,917  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:41,917  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_ffb95a02-bb0a-4eca-9ea8-3c8c76565992): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:41,920  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T17:15:41,920  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T17:15:41,920  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:41,920  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:41,924  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T17:15:41,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:41,925  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:41,925  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,925  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,925  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,925  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0}
2024-04-23T17:15:41,925  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_ffb95a02-bb0a-4eca-9ea8-3c8c76565992); Time taken: 0.008 seconds
2024-04-23T17:15:41,925  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423171541_ffb95a02-bb0a-4eca-9ea8-3c8c76565992
2024-04-23T17:15:41,925  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_ffb95a02-bb0a-4eca-9ea8-3c8c76565992
2024-04-23T17:15:41,940  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_ffb95a02-bb0a-4eca-9ea8-3c8c76565992 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T17:15:41,940  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:41,940  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_ffb95a02-bb0a-4eca-9ea8-3c8c76565992): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:41,941  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713917741, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:41,943  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidorctbl2
2024-04-23T17:15:41,950  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,950  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=9}
2024-04-23T17:15:41,950  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_ffb95a02-bb0a-4eca-9ea8-3c8c76565992); Time taken: 0.01 seconds
2024-04-23T17:15:41,950  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_ffb95a02-bb0a-4eca-9ea8-3c8c76565992
2024-04-23T17:15:41,953  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T17:15:41,958  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:41,959  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T17:15:41,959  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,959  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171541_e3c5612f-6a83-4b8c-969f-0b28e1a62fd3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,961  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T17:15:41,961  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T17:15:41,962  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:41,962  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:41,964  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T17:15:41,964  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:41,965  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:41,965  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:41,965  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:41,965  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:41,965  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=1, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T17:15:41,965  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171541_e3c5612f-6a83-4b8c-969f-0b28e1a62fd3); Time taken: 0.006 seconds
2024-04-23T17:15:41,965  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423171541_e3c5612f-6a83-4b8c-969f-0b28e1a62fd3
2024-04-23T17:15:41,965  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171541_e3c5612f-6a83-4b8c-969f-0b28e1a62fd3
2024-04-23T17:15:41,982  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171541_e3c5612f-6a83-4b8c-969f-0b28e1a62fd3 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T17:15:41,982  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:41,983  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171541_e3c5612f-6a83-4b8c-969f-0b28e1a62fd3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T17:15:41,983  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:41,984  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/73be6845-0d30-4ec2-93c2-623b7a44172b/_tmp_space.db/2766642a-dd17-4ce7-81fd-7b412758ca20
2024-04-23T17:15:41,987  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:41,987  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T17:15:41,987  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171541_e3c5612f-6a83-4b8c-969f-0b28e1a62fd3); Time taken: 0.004 seconds
2024-04-23T17:15:41,987  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171541_e3c5612f-6a83-4b8c-969f-0b28e1a62fd3
2024-04-23T17:15:41,992  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T17:15:42,000  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:42,000  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T17:15:42,001  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:42,001  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171542_d4120388-bedf-4d05-a66b-bc33a421993e): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:42,004  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T17:15:42,004  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T17:15:42,005  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:42,005  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:42,008  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T17:15:42,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:42,009  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:42,009  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:42,009  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:42,009  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:42,009  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:42,009  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171542_d4120388-bedf-4d05-a66b-bc33a421993e); Time taken: 0.008 seconds
2024-04-23T17:15:42,010  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423171542_d4120388-bedf-4d05-a66b-bc33a421993e
2024-04-23T17:15:42,010  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171542_d4120388-bedf-4d05-a66b-bc33a421993e
2024-04-23T17:15:42,030  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171542_d4120388-bedf-4d05-a66b-bc33a421993e LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T17:15:42,030  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:42,030  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171542_d4120388-bedf-4d05-a66b-bc33a421993e): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T17:15:42,030  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:42,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713917742, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:42,033  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/nonacidnonbucket
2024-04-23T17:15:42,042  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:42,042  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=11}
2024-04-23T17:15:42,042  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171542_d4120388-bedf-4d05-a66b-bc33a421993e); Time taken: 0.012 seconds
2024-04-23T17:15:42,042  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171542_d4120388-bedf-4d05-a66b-bc33a421993e
2024-04-23T17:15:42,048  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T17:15:42,057  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:42,057  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T17:15:42,058  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T17:15:42,058  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171542_9f225826-10d4-4eed-989e-a579bbec3a95): drop table if exists T
2024-04-23T17:15:42,061  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T17:15:42,061  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T17:15:42,062  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:42,082  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,082  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:42,082  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:42,082  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:42,082  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=20, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0}
2024-04-23T17:15:42,082  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171542_9f225826-10d4-4eed-989e-a579bbec3a95); Time taken: 0.024 seconds
2024-04-23T17:15:42,082  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423171542_9f225826-10d4-4eed-989e-a579bbec3a95
2024-04-23T17:15:42,082  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171542_9f225826-10d4-4eed-989e-a579bbec3a95
2024-04-23T17:15:42,104  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171542_9f225826-10d4-4eed-989e-a579bbec3a95 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T17:15:42,104  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:42,104  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171542_9f225826-10d4-4eed-989e-a579bbec3a95): drop table if exists T
2024-04-23T17:15:42,104  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:42,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:42,107  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:42,109  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,109  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T17:15:42,259  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t does not exist; Force to delete it.
2024-04-23T17:15:42,259 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:42,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:42,260  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=152, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:42,260  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171542_9f225826-10d4-4eed-989e-a579bbec3a95); Time taken: 0.155 seconds
2024-04-23T17:15:42,260  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171542_9f225826-10d4-4eed-989e-a579bbec3a95
2024-04-23T17:15:42,265  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T17:15:42,274  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:42,276  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T17:15:42,276  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T17:15:42,276  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171542_d119ddd0-679a-4ead-a969-6ede98c5d5a5): drop table if exists Tstage
2024-04-23T17:15:42,288  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T17:15:42,288  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T17:15:42,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:42,313  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,313  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:42,313  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:42,313  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:42,313  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=11, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=22, flushCache_()=0, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=2}
2024-04-23T17:15:42,313  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171542_d119ddd0-679a-4ead-a969-6ede98c5d5a5); Time taken: 0.037 seconds
2024-04-23T17:15:42,314  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423171542_d119ddd0-679a-4ead-a969-6ede98c5d5a5
2024-04-23T17:15:42,314  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171542_d119ddd0-679a-4ead-a969-6ede98c5d5a5
2024-04-23T17:15:42,335  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171542_d119ddd0-679a-4ead-a969-6ede98c5d5a5 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T17:15:42,335  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:42,335  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171542_d119ddd0-679a-4ead-a969-6ede98c5d5a5): drop table if exists Tstage
2024-04-23T17:15:42,335  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:42,335  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:42,339  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:42,344  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T17:15:42,361  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage does not exist; Force to delete it.
2024-04-23T17:15:42,361 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:42,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:42,361  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=21, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=5}
2024-04-23T17:15:42,361  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171542_d119ddd0-679a-4ead-a969-6ede98c5d5a5); Time taken: 0.026 seconds
2024-04-23T17:15:42,361  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171542_d119ddd0-679a-4ead-a969-6ede98c5d5a5
2024-04-23T17:15:42,367  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T17:15:42,375  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:42,376  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T17:15:42,376  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T17:15:42,376  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171542_0a96cb8e-158c-484f-b16a-84f7da28d350): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T17:15:42,380  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T17:15:42,380  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T17:15:42,381  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:42,381  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:42,388  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T17:15:42,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:42,389  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:42,389  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:42,389  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:42,389  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:42,389  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidWriteIds_(List, String)=7, getValidTxns_(long)=1}
2024-04-23T17:15:42,389  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171542_0a96cb8e-158c-484f-b16a-84f7da28d350); Time taken: 0.013 seconds
2024-04-23T17:15:42,389  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423171542_0a96cb8e-158c-484f-b16a-84f7da28d350
2024-04-23T17:15:42,389  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171542_0a96cb8e-158c-484f-b16a-84f7da28d350
2024-04-23T17:15:42,410  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171542_0a96cb8e-158c-484f-b16a-84f7da28d350 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T17:15:42,410  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:42,411  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171542_0a96cb8e-158c-484f-b16a-84f7da28d350): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T17:15:42,411  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:42,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713917742, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional_properties=insert_only, bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T17:15:42,413  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t
2024-04-23T17:15:42,451  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:42,451  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=39}
2024-04-23T17:15:42,451  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171542_0a96cb8e-158c-484f-b16a-84f7da28d350); Time taken: 0.04 seconds
2024-04-23T17:15:42,451  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171542_0a96cb8e-158c-484f-b16a-84f7da28d350
2024-04-23T17:15:42,457  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T17:15:42,466  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:42,466  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T17:15:42,467  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:42,467  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171542_cbfe878d-5d82-437a-8d61-0ea2e3188237): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:42,471  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T17:15:42,471  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T17:15:42,472  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:42,472  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:42,476  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T17:15:42,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T17:15:42,477  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:42,477  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:42,477  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:42,477  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:42,477  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getDatabase_(String)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=16, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:42,477  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171542_cbfe878d-5d82-437a-8d61-0ea2e3188237); Time taken: 0.01 seconds
2024-04-23T17:15:42,477  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423171542_cbfe878d-5d82-437a-8d61-0ea2e3188237
2024-04-23T17:15:42,477  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171542_cbfe878d-5d82-437a-8d61-0ea2e3188237
2024-04-23T17:15:42,501  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171542_cbfe878d-5d82-437a-8d61-0ea2e3188237 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T17:15:42,501  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T17:15:42,501  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171542_cbfe878d-5d82-437a-8d61-0ea2e3188237): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T17:15:42,501  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:42,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713917742, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T17:15:42,504  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage
2024-04-23T17:15:42,514  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:42,514  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=12}
2024-04-23T17:15:42,514  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171542_cbfe878d-5d82-437a-8d61-0ea2e3188237); Time taken: 0.013 seconds
2024-04-23T17:15:42,514  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171542_cbfe878d-5d82-437a-8d61-0ea2e3188237
2024-04-23T17:15:42,522  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T17:15:42,531  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:42,531  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T17:15:42,532  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:42,534  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a): insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:42,539  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T17:15:42,539  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T17:15:42,541  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:42,541  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:42,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:42,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,565  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:42,565  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:42,565  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:42,565  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:42,566  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:42,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,570  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:42,570  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T17:15:42,612  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:42,703  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:42,703  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:42,703  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:42,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T17:15:42,705  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:42,705  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:42,705  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:42,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:42,710  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,712  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1
2024-04-23T17:15:42,715  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:42,716  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T17:15:42,716  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:42,718  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:42,719  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:42,732  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:42,736  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,737  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T17:15:42,738  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:42,742  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:42,743  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:42,743  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T17:15:42,743  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:42,743  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:42,743  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:42,743  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T17:15:42,743  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T17:15:42,743  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:42,743  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:42,743  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:42,743  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T17:15:42,743  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:42,744  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getNotNullConstraints_(NotNullConstraintsRequest)=0, getAllTableConstraints_(AllTableConstraintsRequest)=38, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=24, flushCache_()=0, commitTxn_(CommitTxnRequest)=17, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T17:15:42,744  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a); Time taken: 0.209 seconds
2024-04-23T17:15:42,744  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a
2024-04-23T17:15:42,744  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a
2024-04-23T17:15:42,765  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T17:15:42,765  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:42,765  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a): insert into Tstage values(0,2),(0,4)
2024-04-23T17:15:42,765  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a
2024-04-23T17:15:42,766  INFO [main] ql.Driver: Query ID = alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a
Total jobs = 1
2024-04-23T17:15:42,766  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:42,766  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:42,768  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T17:15:42,768  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T17:15:42,771  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:42,771  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T17:15:42,772  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-42_534_9055628137617473721-1/dummy_path
2024-04-23T17:15:42,783  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:42,783  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,09KB
2024-04-23T17:15:42,784  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:42,788  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-42_534_9055628137617473721-1/-mr-10001
2024-04-23T17:15:42,791  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:42,798  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:42,803  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:42,803  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T17:15:42,803  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T17:15:42,803  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-42_534_9055628137617473721-1/dummy_path
2024-04-23T17:15:42,804  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T17:15:42,824  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T17:15:42,846  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1692641639_0015
2024-04-23T17:15:42,846  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:42,913  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:42,913  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:42,914  INFO [Thread-1376] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:42,914  INFO [Thread-1376] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:42,915  INFO [Thread-1376] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:42,915  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1692641639_0015_m_000000_0
2024-04-23T17:15:42,918  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:42,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-42_534_9055628137617473721-1/dummy_path/null:0+1
2024-04-23T17:15:42,921  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:42,921  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,09KB
2024-04-23T17:15:42,921  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T17:15:42,923  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:42,924  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:42,924  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:42,924  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:42,924  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T17:15:42,925  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T17:15:42,925  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:42,925  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T17:15:42,925  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:42,925  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@70635453, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1692641639_0015/job_local1692641639_0015.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@49b6f57b
2024-04-23T17:15:42,925  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:42,925  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:42,925  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:42,927  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:42,928  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:42,935  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T17:15:42,942  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, 
2024-04-23T17:15:42,943  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:42,945  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1692641639_0015_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:42,945  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:42,945  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1692641639_0015_m_000000_0' done.
2024-04-23T17:15:42,945  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1692641639_0015_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=339055
		FILE: Number of bytes written=17840134
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1093140480
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6148
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:42,945  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1692641639_0015_m_000000_0
2024-04-23T17:15:42,945  INFO [Thread-1376] mapred.LocalJobRunner: map task executor complete.
2024-04-23 17:15:43,915 Stage-1 map = 100%,  reduce = 0%
2024-04-23T17:15:43,915  INFO [main] exec.Task: 2024-04-23 17:15:43,915 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1692641639_0015
2024-04-23T17:15:43,915  INFO [main] exec.Task: Ended Job = job_local1692641639_0015
2024-04-23T17:15:43,916  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T17:15:43,917  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T17:15:43,917  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T17:15:43,917  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T17:15:43,917  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/-ext-10000
2024-04-23T17:15:43,917  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/-ext-10002
2024-04-23T17:15:43,917  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T17:15:43,917  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1/-ext-10000
2024-04-23T17:15:43,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:43,921  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:43,921  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:43,924  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:43,926  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:43,926  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:43,938  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T17:15:43,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:43,941  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:43,941  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T17:15:43,942  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-42_534_9055628137617473721-1/-mr-10001
2024-04-23T17:15:43,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T17:15:43,946  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:43,947  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T17:15:43,947  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T17:15:43,947  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T17:15:43,947  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T17:15:43,958  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T17:15:43,959  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:43,959  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=12, alter_table_(String, String, String, Table, EnvironmentContext, String)=23}
MapReduce Jobs Launched: 
2024-04-23T17:15:43,959  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:43,959  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:43,959  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:43,959  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a); Time taken: 1.194 seconds
2024-04-23T17:15:43,959  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171542_d778f0b4-99e4-4255-92ac-e1389c8b296a
2024-04-23T17:15:43,963  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T17:15:43,970  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:43,970  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T17:15:43,970  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:43,970  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1
2024-04-23T17:15:43,970  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/tstage/.hive-staging_hive_2024-04-23_17-15-42_534_9055628137617473721-1 on fs with scheme file
2024-04-23T17:15:43,971  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-42_534_9055628137617473721-1
2024-04-23T17:15:43,971  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-42_534_9055628137617473721-1 on fs with scheme file
2024-04-23T17:15:43,971  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171543_6e3835af-4818-4df2-a845-bcd7f4472836): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:43,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:43,975  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:43,977  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T17:15:43,977  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T17:15:43,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:43,983  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:43,983  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:43,983  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:43,983  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:43,983  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:43,984  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:43,984  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:43,984  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:43,984  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=6, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T17:15:43,984  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171543_6e3835af-4818-4df2-a845-bcd7f4472836); Time taken: 0.013 seconds
2024-04-23T17:15:43,984  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423171543_6e3835af-4818-4df2-a845-bcd7f4472836
2024-04-23T17:15:43,984  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171543_6e3835af-4818-4df2-a845-bcd7f4472836
2024-04-23T17:15:43,998  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171543_6e3835af-4818-4df2-a845-bcd7f4472836 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T17:15:43,998  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:43,998  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171543_6e3835af-4818-4df2-a845-bcd7f4472836): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1'
2024-04-23T17:15:43,999  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:43,999  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:43,999  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:43,999  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:43,999  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1
2024-04-23T17:15:44,009  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:44,014  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:44,014  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:44,014  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171543_6e3835af-4818-4df2-a845-bcd7f4472836); Time taken: 0.016 seconds
2024-04-23T17:15:44,014  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171543_6e3835af-4818-4df2-a845-bcd7f4472836
2024-04-23T17:15:44,018  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T17:15:44,023  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:44,023  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T17:15:44,024  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:44,024  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171544_0b524974-1b85-488e-b6f8-7b7065f764b7): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:44,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:44,027  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,029  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T17:15:44,029  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T17:15:44,030  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:44,033  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,034  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:44,034  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:44,034  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:44,034  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:44,034  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:44,034  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:44,034  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:44,034  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=0, getTable_(GetTableRequest)=6, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:44,034  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171544_0b524974-1b85-488e-b6f8-7b7065f764b7); Time taken: 0.01 seconds
2024-04-23T17:15:44,034  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423171544_0b524974-1b85-488e-b6f8-7b7065f764b7
2024-04-23T17:15:44,034  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171544_0b524974-1b85-488e-b6f8-7b7065f764b7
2024-04-23T17:15:44,048  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171544_0b524974-1b85-488e-b6f8-7b7065f764b7 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T17:15:44,048  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:44,049  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171544_0b524974-1b85-488e-b6f8-7b7065f764b7): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2'
2024-04-23T17:15:44,049  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:44,049  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:44,049  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:44,049  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:44,049  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2
2024-04-23T17:15:44,060  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:44,065  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:44,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:44,065  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171544_0b524974-1b85-488e-b6f8-7b7065f764b7); Time taken: 0.016 seconds
2024-04-23T17:15:44,065  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171544_0b524974-1b85-488e-b6f8-7b7065f764b7
2024-04-23T17:15:44,069  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T17:15:44,075  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:44,075  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T17:15:44,076  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:44,076  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171544_79ebf67e-70ae-4479-a50b-6d000fda30aa): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:44,079  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T17:15:44,079  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T17:15:44,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:44,084  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,093  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T17:15:44,093  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-23T17:15:44,095  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:44,095  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:44,095  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:44,095  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:44,095  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171544_79ebf67e-70ae-4479-a50b-6d000fda30aa); Time taken: 0.019 seconds
2024-04-23T17:15:44,095  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423171544_79ebf67e-70ae-4479-a50b-6d000fda30aa
2024-04-23T17:15:44,095  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171544_79ebf67e-70ae-4479-a50b-6d000fda30aa
2024-04-23T17:15:44,109  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171544_79ebf67e-70ae-4479-a50b-6d000fda30aa LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T17:15:44,109  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:44,112  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171544_79ebf67e-70ae-4479-a50b-6d000fda30aa): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data' PARTITION (p=2)
2024-04-23T17:15:44,113  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:44,113  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:44,116  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,116  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:44,123  INFO [HMSHandler #2] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1
2024-04-23T17:15:44,123  INFO [HMSHandler #0] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2
2024-04-23T17:15:44,123  INFO [HMSHandler #14] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:44,140  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T17:15:44,140  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/1/data
2024-04-23T17:15:44,140  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:44,143  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,144  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:44,153  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T17:15:44,153  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:44,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:44,157  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,157  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:44,160  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T17:15:44,164  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:44,164  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T17:15:44,190  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:44,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:44,210  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-23T17:15:44,211  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/2/data
2024-04-23T17:15:44,211  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:44,214  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,214  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:44,219  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T17:15:44,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:44,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:44,222  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:44,226  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-23T17:15:44,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:44,230  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T17:15:44,248  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:44,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T17:15:44,258  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:44,258  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=27, validatePartitionNameCharacters_(List)=0, add_partitions_(List, boolean, boolean)=24, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=67, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=16, getValidWriteIds_(List, String)=0}
2024-04-23T17:15:44,258  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171544_79ebf67e-70ae-4479-a50b-6d000fda30aa); Time taken: 0.146 seconds
2024-04-23T17:15:44,258  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171544_79ebf67e-70ae-4479-a50b-6d000fda30aa
2024-04-23T17:15:44,262  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T17:15:44,268  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:44,269  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T17:15:44,269  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:44,270  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:44,279  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T17:15:44,279  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T17:15:44,281  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:44,281  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:44,286  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:44,286  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:44,287  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:44,290  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,290  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:44,290  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:44,290  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:44,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:44,325  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:44,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:44,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:44,369  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:44,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:44,379  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:44,379  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:44,419  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:44,419  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:44,419  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:44,421  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-44_270_5252846583780159453-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-44_270_5252846583780159453-1
2024-04-23T17:15:44,429  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:44,430  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:44,430  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:44,430  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:44,431  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:44,444  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:44,445  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:44,445  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:44,446  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:44,446  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:44,446  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T17:15:44,447  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T17:15:44,447  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:44,447  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, getAllTableConstraints_(AllTableConstraintsRequest)=27, getAggrColStatsFor_(String, String, List, List, String, String)=15, isCompatibleWith_(Configuration)=2, listPartitions_(String, String, short)=27, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=5, getValidTxns_(long)=2}
2024-04-23T17:15:44,447  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656); Time taken: 0.177 seconds
2024-04-23T17:15:44,447  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656
2024-04-23T17:15:44,448  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656
2024-04-23T17:15:44,475  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T17:15:44,475  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:44,476  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:44,476  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656
2024-04-23T17:15:44,477  INFO [main] ql.Driver: Query ID = alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656
Total jobs = 1
2024-04-23T17:15:44,477  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:44,477  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:44,479  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:44,479  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:44,479  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:44,479  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:44,479  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:44,479  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:44,479  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:44,479  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:44,482  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:44,482  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:44,482  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:44,490  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-44_270_5252846583780159453-1/-mr-10004/55ea46df-bec8-48fb-97ce-0b5763d2d404 (false)
2024-04-23T17:15:44,499  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:44,500  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,90KB
2024-04-23T17:15:44,505  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:44,506  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T17:15:44,507  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:44,511  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:44,517  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:44,521  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:44,522  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:44,522  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:44,522  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:44,532  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:44,532  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: insert_only 
2024-04-23T17:15:44,532  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:44,537  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T17:15:44,537  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 5 ms
2024-04-23T17:15:44,537  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T17:15:44,555  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T17:15:44,574  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1896022226_0016
2024-04-23T17:15:44,575  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:44,632  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:44,632  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:44,632  INFO [Thread-1452] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:44,632  INFO [Thread-1452] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:44,634  INFO [Thread-1452] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:44,634  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1896022226_0016_m_000000_0
2024-04-23T17:15:44,635  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:44,635  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:44,636  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:44,636  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-23T17:15:44,638  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:44,639  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:44,644  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:44,644  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:44,644  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:44,644  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:44,644  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:44,645  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:44,645  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:44,647  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:44,647  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:44,647  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:44,647  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T17:15:44,647  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:44,648  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T17:15:44,649  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:44,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:44,662  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1896022226_0016_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:44,663  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:44,663  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1896022226_0016_m_000000_0' done.
2024-04-23T17:15:44,663  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1896022226_0016_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=350064
		FILE: Number of bytes written=19032540
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1093140480
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7034
2024-04-23T17:15:44,663  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1896022226_0016_m_000000_0
2024-04-23T17:15:44,663  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1896022226_0016_m_000001_0
2024-04-23T17:15:44,664  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:44,664  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:44,664  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:44,665  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-23T17:15:44,666  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:44,667  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:44,683  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:44,684  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:44,684  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:44,684  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:44,684  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:44,684  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:44,684  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:44,685  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:44,686  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:44,686  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:44,686  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T17:15:44,686  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:44,686  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:44,686  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:44,686  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:44,686  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:44,687  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:44,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:44,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:44,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T17:15:44,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:44,695  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:44,698  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1896022226_0016_m_000001_0 is done. And is in the process of committing
2024-04-23T17:15:44,699  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:44,699  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1896022226_0016_m_000001_0' done.
2024-04-23T17:15:44,699  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1896022226_0016_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=357653
		FILE: Number of bytes written=19032956
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=10
		Total committed heap usage (bytes)=1093140480
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7034
2024-04-23T17:15:44,699  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1896022226_0016_m_000001_0
2024-04-23T17:15:44,699  INFO [Thread-1452] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:44,700  INFO [Thread-1452] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:44,700  INFO [pool-81-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1896022226_0016_r_000000_0
2024-04-23T17:15:44,700  INFO [pool-81-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:44,700  INFO [pool-81-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@58bc1304
2024-04-23T17:15:44,700  WARN [pool-81-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:44,701  INFO [pool-81-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:44,701  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1896022226_0016_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:44,704  INFO [localfetcher#15] reduce.LocalFetcher: localfetcher#15 about to shuffle output of map attempt_local1896022226_0016_m_000001_0 decomp: 380 len: 384 to MEMORY
2024-04-23T17:15:44,704  INFO [localfetcher#15] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local1896022226_0016_m_000001_0
2024-04-23T17:15:44,704  INFO [localfetcher#15] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->380
2024-04-23T17:15:44,706  INFO [localfetcher#15] reduce.LocalFetcher: localfetcher#15 about to shuffle output of map attempt_local1896022226_0016_m_000000_0 decomp: 380 len: 384 to MEMORY
2024-04-23T17:15:44,707  INFO [localfetcher#15] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local1896022226_0016_m_000000_0
2024-04-23T17:15:44,707  INFO [localfetcher#15] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 2, commitMemory -> 380, usedMemory ->760
2024-04-23T17:15:44,707  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:44,707  INFO [pool-81-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T17:15:44,708  INFO [pool-81-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:44,714  INFO [pool-81-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T17:15:44,714  INFO [pool-81-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 714 bytes
2024-04-23T17:15:44,717  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 760 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:44,717  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merging 1 files, 762 bytes from disk
2024-04-23T17:15:44,717  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:44,717  INFO [pool-81-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:44,717  INFO [pool-81-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 735 bytes
2024-04-23T17:15:44,717  INFO [pool-81-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T17:15:44,718  INFO [pool-81-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:44,718  INFO [pool-81-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T17:15:44,719  INFO [pool-81-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:44,719  INFO [pool-81-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:44,719  INFO [pool-81-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<_col0:string>>
2024-04-23T17:15:44,719  INFO [pool-81-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:44,719  INFO [pool-81-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@732708c7, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@61428675>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@4640fe35, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@f9143af
2024-04-23T17:15:44,720  INFO [pool-81-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-44_270_5252846583780159453-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-44_270_5252846583780159453-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:44,720  INFO [pool-81-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-44_270_5252846583780159453-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-44_270_5252846583780159453-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:44,720  INFO [pool-81-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-44_270_5252846583780159453-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-44_270_5252846583780159453-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:44,727  INFO [pool-81-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:44,727  INFO [pool-81-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:44,727  INFO [pool-81-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:44,727  INFO [pool-81-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:44,727  INFO [pool-81-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T17:15:44,728  INFO [pool-81-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, 
2024-04-23T17:15:44,728  INFO [pool-81-thread-1] mapred.Task: Task:attempt_local1896022226_0016_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:44,728  INFO [pool-81-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:44,728  INFO [pool-81-thread-1] mapred.Task: Task 'attempt_local1896022226_0016_r_000000_0' done.
2024-04-23T17:15:44,728  INFO [pool-81-thread-1] mapred.Task: Final Counters for attempt_local1896022226_0016_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=365196
		FILE: Number of bytes written=19034537
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=768
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1093140480
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:44,728  INFO [pool-81-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1896022226_0016_r_000000_0
2024-04-23T17:15:44,728  INFO [Thread-1452] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:45,635 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:45,635  INFO [main] exec.Task: 2024-04-23 17:15:45,635 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1896022226_0016
2024-04-23T17:15:45,637  INFO [main] exec.Task: Ended Job = job_local1896022226_0016
2024-04-23T17:15:45,638  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:45,638  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:45,638  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:45,638  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:45,638  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:45,638  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656); Time taken: 1.162 seconds
2024-04-23T17:15:45,638  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171544_2913555b-d3c4-4f18-8d8b-5be9de98d656
2024-04-23T17:15:45,642  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T17:15:45,647  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:45,647  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T17:15:45,650  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:45,651  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T17:15:45,651  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:45,651  WARN [main] ql.TestTxnAddPartition: addPartitionMM: read data(add 2 parts w/data and 1 empty): 
2024-04-23T17:15:45,651  INFO [main] ql.TestTxnAddPartition: 0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0

2024-04-23T17:15:45,651  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:45,651  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-44_270_5252846583780159453-1
2024-04-23T17:15:45,652  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-44_270_5252846583780159453-1 on fs with scheme file
2024-04-23T17:15:45,652  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171545_6ba53da4-754e-4c2d-a714-af9c5afb9213): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:45,655  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T17:15:45,655  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T17:15:45,656  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:45,658  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:45,658  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:45,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:45,661  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,662  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:45,662  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:45,662  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:45,663  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:45,668  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:45,669  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:45,683  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:45,686  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:45,689  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:45,689  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:45,718  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:45,718  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:45,718  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:45,720  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:45,721  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:45,721  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:45,721  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:45,734  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:45,747  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:45,748  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:45,748  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:45,748  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T17:15:45,748  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:45,748  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=2, getAggrColStatsFor_(String, String, List, List, String, String)=7, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=3, getTable_(GetTableRequest)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T17:15:45,748  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171545_6ba53da4-754e-4c2d-a714-af9c5afb9213); Time taken: 0.096 seconds
2024-04-23T17:15:45,748  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171545_6ba53da4-754e-4c2d-a714-af9c5afb9213): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:45,748  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T17:15:45,756  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:45,756  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T17:15:45,756  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171545_6ba53da4-754e-4c2d-a714-af9c5afb9213); Time taken: 0.008 seconds
2024-04-23T17:15:45,756  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:45,763  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T17:15:45,770  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:45,770  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T17:15:45,771  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:45,771  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-45_652_4449563648690624146-1
2024-04-23T17:15:45,771  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-45_652_4449563648690624146-1 on fs with scheme file
2024-04-23T17:15:45,771  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171545_aed145d2-0af7-4a11-aee3-6f1282b8ad15): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:45,772  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:45,776  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,779  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T17:15:45,779  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T17:15:45,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T17:15:45,786  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,786  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:45,786  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:45,786  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:45,786  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:45,787  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:45,787  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:45,787  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:45,787  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=8, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1}
2024-04-23T17:15:45,787  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171545_aed145d2-0af7-4a11-aee3-6f1282b8ad15); Time taken: 0.016 seconds
2024-04-23T17:15:45,787  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423171545_aed145d2-0af7-4a11-aee3-6f1282b8ad15
2024-04-23T17:15:45,787  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171545_aed145d2-0af7-4a11-aee3-6f1282b8ad15
2024-04-23T17:15:45,806  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171545_aed145d2-0af7-4a11-aee3-6f1282b8ad15 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T17:15:45,806  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T17:15:45,806  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171545_aed145d2-0af7-4a11-aee3-6f1282b8ad15): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3'
2024-04-23T17:15:45,806  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T17:15:45,806  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:45,806  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:45,806  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:45,807  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3
2024-04-23T17:15:45,816  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T17:15:45,821  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:45,821  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T17:15:45,821  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171545_aed145d2-0af7-4a11-aee3-6f1282b8ad15); Time taken: 0.015 seconds
2024-04-23T17:15:45,821  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171545_aed145d2-0af7-4a11-aee3-6f1282b8ad15
2024-04-23T17:15:45,825  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T17:15:45,832  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:45,832  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T17:15:45,832  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171545_2b1932b6-a627-476e-8076-b44b0a7ea32b): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:45,835  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T17:15:45,836  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T17:15:45,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:45,841  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,850  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-23T17:15:45,850  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-23T17:15:45,851  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:45,851  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:45,851  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:45,851  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, allocateTableWriteId_(long, String, String)=8, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=5, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T17:15:45,851  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171545_2b1932b6-a627-476e-8076-b44b0a7ea32b); Time taken: 0.019 seconds
2024-04-23T17:15:45,851  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423171545_2b1932b6-a627-476e-8076-b44b0a7ea32b
2024-04-23T17:15:45,851  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171545_2b1932b6-a627-476e-8076-b44b0a7ea32b
2024-04-23T17:15:45,866  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171545_2b1932b6-a627-476e-8076-b44b0a7ea32b LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T17:15:45,866  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:45,871  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171545_2b1932b6-a627-476e-8076-b44b0a7ea32b): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:45,871  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:45,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:45,874  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:45,889 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T17:15:45,889 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T17:15:45,890 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-23T17:15:45,891 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T17:15:45,893 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T17:15:45,893  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:45,893  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:45,893  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171545_2b1932b6-a627-476e-8076-b44b0a7ea32b); Time taken: 0.022 seconds
2024-04-23T17:15:45,893  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171545_2b1932b6-a627-476e-8076-b44b0a7ea32b
2024-04-23T17:15:45,895  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:45,904  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:45,904  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171545_913b0f6b-831d-46d9-93de-37266ba0c382): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:45,913  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T17:15:45,913  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T17:15:45,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T17:15:45,917  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T17:15:45,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-23T17:15:45,926  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:45,933  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-23T17:15:45,933  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-23T17:15:45,933  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:45,933  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:45,933  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:45,934  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, allocateTableWriteId_(long, String, String)=5, getPartitionWithAuthInfo_(String, String, List, String, List)=6, rollbackTxn_(long)=10, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T17:15:45,934  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171545_913b0f6b-831d-46d9-93de-37266ba0c382); Time taken: 0.029 seconds
2024-04-23T17:15:45,934  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423171545_913b0f6b-831d-46d9-93de-37266ba0c382
2024-04-23T17:15:45,934  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171545_913b0f6b-831d-46d9-93de-37266ba0c382
2024-04-23T17:15:45,946  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171545_913b0f6b-831d-46d9-93de-37266ba0c382 LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T17:15:45,946  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T17:15:45,953  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171545_913b0f6b-831d-46d9-93de-37266ba0c382): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data'
2024-04-23T17:15:45,953  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:45,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:45,956  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,957  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T17:15:45,960  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T17:15:45,961  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T17:15:45,961  INFO [HMSHandler #1] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3
2024-04-23T17:15:45,974  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-23T17:15:45,974  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/3/data
2024-04-23T17:15:45,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:45,977  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:45,982  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-23T17:15:45,982  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T17:15:45,982  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:45,985  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:45,985  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:45,989  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-23T17:15:45,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T17:15:45,993  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-23T17:15:46,196  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T17:15:46,214  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T17:15:46,217  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:46,217  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=10, validatePartitionNameCharacters_(List)=0, add_partitions_(List, boolean, boolean)=17, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=220, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9, getValidWriteIds_(List, String)=1}
2024-04-23T17:15:46,217  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171545_913b0f6b-831d-46d9-93de-37266ba0c382); Time taken: 0.264 seconds
2024-04-23T17:15:46,217  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171545_913b0f6b-831d-46d9-93de-37266ba0c382
2024-04-23T17:15:46,220  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T17:15:46,225  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:46,225  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T17:15:46,225  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:46,226  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:46,229  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T17:15:46,229  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T17:15:46,230  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T17:15:46,230  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:46,234  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:46,234  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:46,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:46,237  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:46,237  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:46,237  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:46,238  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:46,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:46,264  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:46,264  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:46,298  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:46,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:46,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:46,309  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:46,309  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:46,338  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:46,338  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:46,338  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:46,339  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-46_226_482549604228478630-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-46_226_482549604228478630-1
2024-04-23T17:15:46,347  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:46,349  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:46,349  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:46,349  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:46,350  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:46,360  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:46,361  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:46,361  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:46,361  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T17:15:46,361  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:46,361  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T17:15:46,362  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T17:15:46,362  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:46,362  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=19, getAggrColStatsFor_(String, String, List, List, String, String)=11, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=16, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=5, getValidTxns_(long)=1}
2024-04-23T17:15:46,362  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941); Time taken: 0.136 seconds
2024-04-23T17:15:46,362  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941
2024-04-23T17:15:46,362  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941
2024-04-23T17:15:46,379  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T17:15:46,379  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T17:15:46,380  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:46,381  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941
2024-04-23T17:15:46,381  INFO [main] ql.Driver: Query ID = alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941
Total jobs = 1
2024-04-23T17:15:46,381  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T17:15:46,381  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T17:15:46,383  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T17:15:46,384  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T17:15:46,384  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T17:15:46,384  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T17:15:46,384  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T17:15:46,384  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T17:15:46,384  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T17:15:46,384  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T17:15:46,387  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T17:15:46,387  INFO [main] exec.Utilities: Processing alias t
2024-04-23T17:15:46,387  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:46,396  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-46_226_482549604228478630-1/-mr-10004/fe14a854-d1d6-4d50-826f-e3de571aa74b (false)
2024-04-23T17:15:46,406  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T17:15:46,407  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,25KB
2024-04-23T17:15:46,412  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T17:15:46,412  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,88KB
2024-04-23T17:15:46,413  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:46,417  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:46,422  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T17:15:46,427  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T17:15:46,428  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T17:15:46,428  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T17:15:46,428  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0
2024-04-23T17:15:46,438  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T17:15:46,438  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: insert_only 
2024-04-23T17:15:46,438  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T17:15:46,444  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-23T17:15:46,444  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 6 ms
2024-04-23T17:15:46,444  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-23T17:15:46,462  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-23T17:15:46,481  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local504889888_0017
2024-04-23T17:15:46,481  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T17:15:46,544  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T17:15:46,544  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T17:15:46,544  INFO [Thread-1546] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:46,544  INFO [Thread-1546] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T17:15:46,546  INFO [Thread-1546] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T17:15:46,546  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local504889888_0017_m_000000_0
2024-04-23T17:15:46,546  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:46,547  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:46,547  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-23T17:15:46,550  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:46,551  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:46,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:46,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:46,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:46,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:46,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:46,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:46,558  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:46,560  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T17:15:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:46,561  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:46,562  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:46,563  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:46,563  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:46,563  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:46,563  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T17:15:46,563  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:46,574  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:46,577  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local504889888_0017_m_000000_0 is done. And is in the process of committing
2024-04-23T17:15:46,577  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:46,577  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local504889888_0017_m_000000_0' done.
2024-04-23T17:15:46,577  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local504889888_0017_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=380331
		FILE: Number of bytes written=20224002
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1183318016
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7391
2024-04-23T17:15:46,577  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local504889888_0017_m_000000_0
2024-04-23T17:15:46,577  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local504889888_0017_m_000001_0
2024-04-23T17:15:46,578  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:46,578  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:46,579  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:46,579  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-23T17:15:46,580  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:46,581  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:46,586  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:46,586  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:46,586  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:46,586  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:46,586  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:46,587  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:46,587  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:46,589  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:46,590  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:46,590  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:46,590  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T17:15:46,590  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:46,590  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:46,591  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:46,592  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:46,592  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:46,592  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:46,592  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T17:15:46,592  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:46,600  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:46,603  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local504889888_0017_m_000001_0 is done. And is in the process of committing
2024-04-23T17:15:46,603  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:46,603  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local504889888_0017_m_000001_0' done.
2024-04-23T17:15:46,603  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local504889888_0017_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=388801
		FILE: Number of bytes written=20224418
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1183318016
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7391
2024-04-23T17:15:46,603  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local504889888_0017_m_000001_0
2024-04-23T17:15:46,603  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local504889888_0017_m_000002_0
2024-04-23T17:15:46,604  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:46,604  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T17:15:46,605  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T17:15:46,605  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-23T17:15:46,606  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T17:15:46,607  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T17:15:46,611  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T17:15:46,611  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T17:15:46,611  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T17:15:46,611  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T17:15:46,611  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T17:15:46,612  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T17:15:46,612  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T17:15:46,613  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T17:15:46,614  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T17:15:46,614  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T17:15:46,614  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T17:15:46,614  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T17:15:46,614  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T17:15:46,614  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T17:15:46,614  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T17:15:46,614  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T17:15:46,615  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T17:15:46,623  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T17:15:46,626  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local504889888_0017_m_000002_0 is done. And is in the process of committing
2024-04-23T17:15:46,627  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T17:15:46,627  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local504889888_0017_m_000002_0' done.
2024-04-23T17:15:46,627  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local504889888_0017_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=396759
		FILE: Number of bytes written=20224834
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1183318016
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7391
2024-04-23T17:15:46,627  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local504889888_0017_m_000002_0
2024-04-23T17:15:46,627  INFO [Thread-1546] mapred.LocalJobRunner: map task executor complete.
2024-04-23T17:15:46,628  INFO [Thread-1546] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T17:15:46,628  INFO [pool-86-thread-1] mapred.LocalJobRunner: Starting task: attempt_local504889888_0017_r_000000_0
2024-04-23T17:15:46,628  INFO [pool-86-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T17:15:46,629  INFO [pool-86-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@76e44380
2024-04-23T17:15:46,629  WARN [pool-86-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T17:15:46,629  INFO [pool-86-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T17:15:46,630  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local504889888_0017_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T17:15:46,632  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local504889888_0017_m_000001_0 decomp: 380 len: 384 to MEMORY
2024-04-23T17:15:46,632  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local504889888_0017_m_000001_0
2024-04-23T17:15:46,632  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->380
2024-04-23T17:15:46,635  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local504889888_0017_m_000002_0 decomp: 380 len: 384 to MEMORY
2024-04-23T17:15:46,635  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local504889888_0017_m_000002_0
2024-04-23T17:15:46,635  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 2, commitMemory -> 380, usedMemory ->760
2024-04-23T17:15:46,637  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local504889888_0017_m_000000_0 decomp: 380 len: 384 to MEMORY
2024-04-23T17:15:46,637  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local504889888_0017_m_000000_0
2024-04-23T17:15:46,637  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 3, commitMemory -> 760, usedMemory ->1140
2024-04-23T17:15:46,637  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T17:15:46,638  INFO [pool-86-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T17:15:46,638  INFO [pool-86-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T17:15:46,644  INFO [pool-86-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-23T17:15:46,644  INFO [pool-86-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 1071 bytes
2024-04-23T17:15:46,646  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 1140 bytes to disk to satisfy reduce memory limit
2024-04-23T17:15:46,647  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merging 1 files, 1140 bytes from disk
2024-04-23T17:15:46,647  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T17:15:46,647  INFO [pool-86-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T17:15:46,647  INFO [pool-86-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 1113 bytes
2024-04-23T17:15:46,647  INFO [pool-86-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T17:15:46,648  INFO [pool-86-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T17:15:46,648  INFO [pool-86-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,88KB
2024-04-23T17:15:46,649  INFO [pool-86-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T17:15:46,649  INFO [pool-86-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T17:15:46,649  INFO [pool-86-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<_col0:string>>
2024-04-23T17:15:46,649  INFO [pool-86-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T17:15:46,649  INFO [pool-86-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@246a2a29, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@38bce2ed,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@61428675>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@7b79bf94, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@146e9455
2024-04-23T17:15:46,649  INFO [pool-86-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-46_226_482549604228478630-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-46_226_482549604228478630-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:46,649  INFO [pool-86-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-46_226_482549604228478630-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-46_226_482549604228478630-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T17:15:46,650  INFO [pool-86-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-46_226_482549604228478630-1/-mr-10001/.hive-staging_hive_2024-04-23_17-15-46_226_482549604228478630-1/_tmp.-ext-10002/000000_0
2024-04-23T17:15:46,657  INFO [pool-86-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T17:15:46,657  INFO [pool-86-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T17:15:46,657  INFO [pool-86-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:46,658  INFO [pool-86-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T17:15:46,658  INFO [pool-86-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-23T17:15:46,658  INFO [pool-86-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, 
2024-04-23T17:15:46,658  INFO [pool-86-thread-1] mapred.Task: Task:attempt_local504889888_0017_r_000000_0 is done. And is in the process of committing
2024-04-23T17:15:46,659  INFO [pool-86-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T17:15:46,659  INFO [pool-86-thread-1] mapred.Task: Task 'attempt_local504889888_0017_r_000000_0' done.
2024-04-23T17:15:46,659  INFO [pool-86-thread-1] mapred.Task: Final Counters for attempt_local504889888_0017_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=405089
		FILE: Number of bytes written=20227155
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=1152
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1183318016
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T17:15:46,659  INFO [pool-86-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local504889888_0017_r_000000_0
2024-04-23T17:15:46,659  INFO [Thread-1546] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 17:15:47,548 Stage-1 map = 100%,  reduce = 100%
2024-04-23T17:15:47,548  INFO [main] exec.Task: 2024-04-23 17:15:47,548 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local504889888_0017
2024-04-23T17:15:47,550  INFO [main] exec.Task: Ended Job = job_local504889888_0017
2024-04-23T17:15:47,554  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:47,554  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T17:15:47,554  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T17:15:47,554  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:47,554  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T17:15:47,554  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941); Time taken: 1.174 seconds
2024-04-23T17:15:47,554  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171546_d3c6f703-1464-4ce3-a2de-d5a90680b941
2024-04-23T17:15:47,557  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T17:15:47,561  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:47,562  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T17:15:47,566  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T17:15:47,567  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T17:15:47,567  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T17:15:47,567  WARN [main] ql.TestTxnAddPartition: addPartitionMM: read data(add 2 existing parts and 1 empty): 
2024-04-23T17:15:47,567  INFO [main] ql.TestTxnAddPartition: 0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
3	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0
3	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713917700376/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0

2024-04-23T17:15:47,567  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:47,568  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-46_226_482549604228478630-1
2024-04-23T17:15:47,569  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-46_226_482549604228478630-1 on fs with scheme file
2024-04-23T17:15:47,569  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171547_d99c8bb9-c2e5-4bf8-82dc-40ae93bf0865): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:47,576  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-23T17:15:47,576  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T17:15:47,579  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T17:15:47,582  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T17:15:47,582  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:47,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:47,585  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,585  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:47,585  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:47,585  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T17:15:47,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T17:15:47,592  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T17:15:47,592  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T17:15:47,611  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T17:15:47,614  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,615  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T17:15:47,617  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T17:15:47,617  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T17:15:47,640  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T17:15:47,641  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T17:15:47,641  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T17:15:47,642  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T17:15:47,644  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:47,644  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T17:15:47,644  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T17:15:47,661  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T17:15:47,669  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T17:15:47,670  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T17:15:47,670  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T17:15:47,670  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:47,670  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T17:15:47,670  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:47,670  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=6, getAllTableConstraints_(AllTableConstraintsRequest)=1, getAggrColStatsFor_(String, String, List, List, String, String)=6, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=3, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=3, getValidTxns_(long)=2}
2024-04-23T17:15:47,670  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171547_d99c8bb9-c2e5-4bf8-82dc-40ae93bf0865); Time taken: 0.101 seconds
2024-04-23T17:15:47,670  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171547_d99c8bb9-c2e5-4bf8-82dc-40ae93bf0865): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T17:15:47,671  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T17:15:47,679  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:47,679  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T17:15:47,679  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171547_d99c8bb9-c2e5-4bf8-82dc-40ae93bf0865); Time taken: 0.009 seconds
2024-04-23T17:15:47,679  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T17:15:47,683  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T17:15:47,687  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:47,687  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T17:15:47,687  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T17:15:47,688  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-47_569_8152821607711574424-1
2024-04-23T17:15:47,688  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/73be6845-0d30-4ec2-93c2-623b7a44172b/hive_2024-04-23_17-15-47_569_8152821607711574424-1 on fs with scheme file
2024-04-23T17:15:47,688  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171547_0fed8aa0-a532-4a9a-8d99-4db094102edd): drop table if exists acidTbl
2024-04-23T17:15:47,690  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-23T17:15:47,690  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T17:15:47,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:47,693  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,694  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:47,694  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:47,694  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:47,694  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=1}
2024-04-23T17:15:47,694  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171547_0fed8aa0-a532-4a9a-8d99-4db094102edd); Time taken: 0.006 seconds
2024-04-23T17:15:47,694  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423171547_0fed8aa0-a532-4a9a-8d99-4db094102edd
2024-04-23T17:15:47,694  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171547_0fed8aa0-a532-4a9a-8d99-4db094102edd
2024-04-23T17:15:47,706  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171547_0fed8aa0-a532-4a9a-8d99-4db094102edd LockResponse(lockid:20, state:ACQUIRED)
2024-04-23T17:15:47,706  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:47,706  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171547_0fed8aa0-a532-4a9a-8d99-4db094102edd): drop table if exists acidTbl
2024-04-23T17:15:47,706  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:47,707  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:47,709  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:47,711  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,711  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T17:15:47,782  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:47,782  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=73, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=2}
2024-04-23T17:15:47,782  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171547_0fed8aa0-a532-4a9a-8d99-4db094102edd); Time taken: 0.076 seconds
2024-04-23T17:15:47,782  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171547_0fed8aa0-a532-4a9a-8d99-4db094102edd
2024-04-23T17:15:47,785  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T17:15:47,789  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:47,790  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T17:15:47,790  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T17:15:47,790  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171547_4226acb5-9b9d-4f92-b3b4-e23082511201): drop table if exists acidTblPart
2024-04-23T17:15:47,793  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-23T17:15:47,793  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-23T17:15:47,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:47,802  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,802  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:47,802  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:47,802  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:47,802  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8, flushCache_()=0, commitTxn_(CommitTxnRequest)=7, getValidTxns_(long)=0}
2024-04-23T17:15:47,802  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171547_4226acb5-9b9d-4f92-b3b4-e23082511201); Time taken: 0.012 seconds
2024-04-23T17:15:47,802  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240423171547_4226acb5-9b9d-4f92-b3b4-e23082511201
2024-04-23T17:15:47,802  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171547_4226acb5-9b9d-4f92-b3b4-e23082511201
2024-04-23T17:15:47,819  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171547_4226acb5-9b9d-4f92-b3b4-e23082511201 LockResponse(lockid:21, state:ACQUIRED)
2024-04-23T17:15:47,819  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:47,819  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171547_4226acb5-9b9d-4f92-b3b4-e23082511201): drop table if exists acidTblPart
2024-04-23T17:15:47,819  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:47,820  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:47,822  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,822  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:47,824  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T17:15:47,845  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:47,845  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=22, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:47,845  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171547_4226acb5-9b9d-4f92-b3b4-e23082511201); Time taken: 0.026 seconds
2024-04-23T17:15:47,845  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171547_4226acb5-9b9d-4f92-b3b4-e23082511201
2024-04-23T17:15:47,848  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-23T17:15:47,853  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:47,853  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-23T17:15:47,854  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T17:15:47,854  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171547_58f00d0b-2eaa-4be1-9cb1-f3775c33d77b): drop table if exists acidTbl2
2024-04-23T17:15:47,857  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-23T17:15:47,857  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-23T17:15:47,858  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:47,858  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:47,858  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:47,858  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T17:15:47,858  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171547_58f00d0b-2eaa-4be1-9cb1-f3775c33d77b); Time taken: 0.004 seconds
2024-04-23T17:15:47,858  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240423171547_58f00d0b-2eaa-4be1-9cb1-f3775c33d77b
2024-04-23T17:15:47,858  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T17:15:47,859  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171547_58f00d0b-2eaa-4be1-9cb1-f3775c33d77b): drop table if exists acidTbl2
2024-04-23T17:15:47,859  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:47,859  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T17:15:47,860  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:47,860  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T17:15:47,860  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171547_58f00d0b-2eaa-4be1-9cb1-f3775c33d77b); Time taken: 0.001 seconds
2024-04-23T17:15:47,860  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171547_58f00d0b-2eaa-4be1-9cb1-f3775c33d77b
2024-04-23T17:15:47,865  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-23T17:15:47,872  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:47,873  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-23T17:15:47,873  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T17:15:47,873  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171547_ba356e61-9c56-4240-b224-35e5d10ff595): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:47,876  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-23T17:15:47,876  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-23T17:15:47,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:47,897  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,897  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:47,897  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:47,897  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:47,898  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=20, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0}
2024-04-23T17:15:47,898  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171547_ba356e61-9c56-4240-b224-35e5d10ff595); Time taken: 0.024 seconds
2024-04-23T17:15:47,898  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240423171547_ba356e61-9c56-4240-b224-35e5d10ff595
2024-04-23T17:15:47,898  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171547_ba356e61-9c56-4240-b224-35e5d10ff595
2024-04-23T17:15:47,920  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171547_ba356e61-9c56-4240-b224-35e5d10ff595 LockResponse(lockid:22, state:ACQUIRED)
2024-04-23T17:15:47,920  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:47,920  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171547_ba356e61-9c56-4240-b224-35e5d10ff595): drop table if exists nonAcidOrcTbl
2024-04-23T17:15:47,920  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:47,921  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:47,932  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:47,936  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:47,937  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T17:15:47,985  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:47,985  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=53, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=11}
2024-04-23T17:15:47,985  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171547_ba356e61-9c56-4240-b224-35e5d10ff595); Time taken: 0.065 seconds
2024-04-23T17:15:47,985  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171547_ba356e61-9c56-4240-b224-35e5d10ff595
2024-04-23T17:15:47,990  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-23T17:15:47,998  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:47,998  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-23T17:15:47,998  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:47,999  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171547_6c64f69f-dc61-40d3-be9e-15cb43a7333f): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:48,002  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-23T17:15:48,002  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-23T17:15:48,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:48,009  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:48,009  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:48,009  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:48,009  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:48,009  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=5, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:48,009  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171547_6c64f69f-dc61-40d3-be9e-15cb43a7333f); Time taken: 0.01 seconds
2024-04-23T17:15:48,009  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240423171547_6c64f69f-dc61-40d3-be9e-15cb43a7333f
2024-04-23T17:15:48,010  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171547_6c64f69f-dc61-40d3-be9e-15cb43a7333f
2024-04-23T17:15:48,030  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171547_6c64f69f-dc61-40d3-be9e-15cb43a7333f LockResponse(lockid:23, state:ACQUIRED)
2024-04-23T17:15:48,030  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:48,030  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171547_6c64f69f-dc61-40d3-be9e-15cb43a7333f): drop table if exists nonAcidOrcTbl2
2024-04-23T17:15:48,031  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:48,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:48,035  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:48,036  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:48,040  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:48,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T17:15:48,056  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:48,056  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=21, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=4}
2024-04-23T17:15:48,056  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171547_6c64f69f-dc61-40d3-be9e-15cb43a7333f); Time taken: 0.026 seconds
2024-04-23T17:15:48,056  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171547_6c64f69f-dc61-40d3-be9e-15cb43a7333f
2024-04-23T17:15:48,061  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-23T17:15:48,067  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:48,067  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-23T17:15:48,068  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T17:15:48,068  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423171548_175bc730-80e2-4ee1-9e62-7a09d4bab486): drop table if exists nonAcidNonBucket
2024-04-23T17:15:48,071  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-23T17:15:48,071  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-23T17:15:48,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:48,078  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:48,078  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T17:15:48,078  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T17:15:48,078  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T17:15:48,078  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=5, flushCache_()=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1}
2024-04-23T17:15:48,079  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423171548_175bc730-80e2-4ee1-9e62-7a09d4bab486); Time taken: 0.01 seconds
2024-04-23T17:15:48,079  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240423171548_175bc730-80e2-4ee1-9e62-7a09d4bab486
2024-04-23T17:15:48,079  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423171548_175bc730-80e2-4ee1-9e62-7a09d4bab486
2024-04-23T17:15:48,096  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423171548_175bc730-80e2-4ee1-9e62-7a09d4bab486 LockResponse(lockid:24, state:ACQUIRED)
2024-04-23T17:15:48,096  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T17:15:48,096  INFO [main] ql.Driver: Executing command(queryId=alex_20240423171548_175bc730-80e2-4ee1-9e62-7a09d4bab486): drop table if exists nonAcidNonBucket
2024-04-23T17:15:48,096  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T17:15:48,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:48,099  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:48,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:48,102  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T17:15:48,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T17:15:48,118  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T17:15:48,118  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=19, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=3}
2024-04-23T17:15:48,118  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423171548_175bc730-80e2-4ee1-9e62-7a09d4bab486); Time taken: 0.022 seconds
2024-04-23T17:15:48,118  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423171548_175bc730-80e2-4ee1-9e62-7a09d4bab486
2024-04-23T17:15:48,123  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-23T17:15:48,129  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-23T17:15:48,129  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-23T17:15:48,129  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T17:15:48,168  INFO [pool-2-thread-1] lockmgr.DbTxnManager: Shutting down Heartbeater thread pool.
