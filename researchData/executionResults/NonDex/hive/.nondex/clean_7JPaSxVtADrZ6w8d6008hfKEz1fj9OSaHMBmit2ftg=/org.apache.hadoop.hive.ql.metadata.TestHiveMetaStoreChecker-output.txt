SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,085061 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@7f31245a
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=7f31245a, org.apache.logging.log4j.core.LoggerContext@2cb4893b]...
DEBUG StatusLogger Reconfiguration started for context[name=7f31245a] at URI null (org.apache.logging.log4j.core.LoggerContext@2cb4893b) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@305ffe9e
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5b7a7f33
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,020034 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null, Configuration(HiveLog4j2Test), Replace=null, charset="null", alwaysWriteExceptions="null", disableAnsi="null", noConsoleNoAnsi="null", header="null", footer="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(target="SYSTEM_ERR", follow="null", direct="null", bufferedIo="null", bufferSize="null", immediateFlush="null", ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="console", Configuration(HiveLog4j2Test), Filter=null, ={})
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null, Configuration(HiveLog4j2Test), Replace=null, charset="null", alwaysWriteExceptions="null", disableAnsi="null", noConsoleNoAnsi="null", header="null", footer="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(interval="1", modulate="true", maxRandomDelay="null")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(max="30", min="null", fileIndex="null", compressionLevel="null", ={}, stopCustomActionsOnError="null", tempCompressedFilePattern="null", Configuration(HiveLog4j2Test))
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", append="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), advertise="null", advertiseURI="null", filePermissions="null", fileOwner="null", fileGroup="null", bufferedIo="null", bufferSize="null", immediateFlush="null", ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="DRFA", Configuration(HiveLog4j2Test), Filter=null, ={})
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 1677100263
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T18:07:36.840-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-18:07:38.864, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-18:07:38.865, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5b7a7f33 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5b7a7f33
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5b7a7f33 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@291caca8...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@291caca8 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@42f8285e
TRACE StatusLogger Reregistering context (1/1): '7f31245a' org.apache.logging.log4j.core.LoggerContext@2cb4893b
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=7f31245a,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=7f31245a] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@2cb4893b) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=7f31245a, org.apache.logging.log4j.core.LoggerContext@2cb4893b] started OK.
2024-04-23T18:07:38,965  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T18:07:39,464  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-23T18:07:39,542  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T18:07:39,543  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T18:07:39,543  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T18:07:39,543  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T18:07:39,543  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T18:07:39,544  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T18:07:39,545  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T18:07:39,545  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T18:07:39,545  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T18:07:39,545  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T18:07:39,546  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T18:07:40,617  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T18:07:40,622  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T18:07:40,630  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T18:07:40,631  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T18:07:40,631  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T18:07:40,633  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T18:07:40,634  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T18:07:40,731  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:40,915  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:40,946  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:40,954  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-23T18:07:40,954  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-23T18:07:40,975  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T18:07:40,980  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-23T18:07:41,739  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T18:07:41,748  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
log4j: Trying to find [log4j.xml] using context classloader sun.misc.Launcher$AppClassLoader@7f31245a.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@7f31245a class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader sun.misc.Launcher$AppClassLoader@7f31245a.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@7f31245a class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
log4j:WARN No appenders could be found for logger (DataNucleus.General).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-23T18:07:42,739  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-23T18:07:42,739  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ba6ec50, with PersistenceManager: null will be shutdown
2024-04-23T18:07:42,771  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ba6ec50, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2ef0dd86 created in the thread with id: 1
2024-04-23T18:07:46,072  WARN [main] metastore.ObjectStore: Version information not found in metastore. metastore.schema.verification is not enabled so recording the schema version 4.0.0
2024-04-23T18:07:46,073  WARN [main] metastore.ObjectStore: setMetaStoreSchemaVersion called but recording version is disabled: version = 4.0.0, comment = Set by MetaStore alex@127.0.1.1
2024-04-23T18:07:46,073  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ba6ec50 from thread id: 1
2024-04-23T18:07:46,377  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-23T18:07:46,425  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-23T18:07:46,461  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-23T18:07:46,463  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-23T18:07:46,626  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-23T18:07:46,637  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-23T18:07:46,638  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-23T18:07:46,642  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-23T18:07:46,678  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T18:07:46,681  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-23T18:07:46,685  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T18:07:46,686  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-23T18:07:46,690  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T18:07:46,693  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-23T18:07:46,694  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T18:07:46,695  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-23T18:07:46,703  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-23T18:07:46,704  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-23T18:07:46,706  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-23T18:07:46,710  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:46,883  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:46,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_functions	
2024-04-23T18:07:47,009  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:47,010  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:47,012  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ba6ec50, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2ef0dd86 will be shutdown
2024-04-23T18:07:47,012  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ba6ec50, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5e3db14 created in the thread with id: 1
2024-04-23T18:07:47,041  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
Hive Session ID = 9f819be0-3388-4232-869d-e186459290d3
2024-04-23T18:07:47,044  INFO [main] SessionState: Hive Session ID = 9f819be0-3388-4232-869d-e186459290d3
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:47,047  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:47,110  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9f819be0-3388-4232-869d-e186459290d3
2024-04-23T18:07:47,114  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9f819be0-3388-4232-869d-e186459290d3
2024-04-23T18:07:47,120  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9f819be0-3388-4232-869d-e186459290d3/_tmp_space.db
2024-04-23T18:07:47,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:47,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:47,145  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:47,155  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:47,158  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:47,161  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:47,222  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:47,224  INFO [main] metastore.HiveMetaStoreClient: Mestastore configuration metastore.filter.hook changed from org.apache.hadoop.hive.metastore.DefaultMetaStoreFilterHookImpl to org.apache.hadoop.hive.ql.security.authorization.plugin.AuthorizationMetaStoreFilterHook
2024-04-23T18:07:47,226  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:47,227  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ba6ec50, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5e3db14 will be shutdown
2024-04-23T18:07:47,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:47,227  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -1
2024-04-23T18:07:47,229  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:47,231  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:47,231  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:47,233  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5d14e99e, with PersistenceManager: null will be shutdown
2024-04-23T18:07:47,234  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5d14e99e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@682618e5 created in the thread with id: 1
2024-04-23T18:07:47,242  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5d14e99e from thread id: 1
2024-04-23T18:07:47,243  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:47,243  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:47,273  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:47,274  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:47,274  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5d14e99e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@682618e5 will be shutdown
2024-04-23T18:07:47,275  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5d14e99e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@230232b0 created in the thread with id: 1
2024-04-23T18:07:47,279  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:47,279  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:47,280  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920867, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:), FieldSchema(name:part3, type:string, comment:), FieldSchema(name:part4, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:47,304  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:47,459  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:47,579  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:47,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:47,878  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:47,880  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,043  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0/part3=val_0/part4=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1/part3=val_1/part4=val_1, testhivemetastorechecker_table:part1=val_2/part2=val_2/part3=val_2/part4=val_2, testhivemetastorechecker_table:part1=val_3/part2=val_3/part3=val_3/part4=val_3, testhivemetastorechecker_table:part1=val_4/part2=val_4/part3=val_4/part4=val_4, testhivemetastorechecker_table:part1=val_5/part2=val_5/part3=val_5/part4=val_5, testhivemetastorechecker_table:part1=val_6/part2=val_6/part3=val_6/part4=val_6, testhivemetastorechecker_table:part1=val_7/part2=val_7/part3=val_7/part4=val_7, testhivemetastorechecker_table:part1=val_8/part2=val_8/part3=val_8/part4=val_8, testhivemetastorechecker_table:part1=val_9/part2=val_9/part3=val_9/part4=val_9], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:48,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,059  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:48,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:48,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:48,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:48,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:48,423  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:48,423  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:48,424  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:48,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:48,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:48,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:48,510  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:48,521  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:48,573  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:48,573  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:48,580  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:48,580 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:48,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:48,581  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5d14e99e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@230232b0 will be shutdown
2024-04-23T18:07:48,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:48,582  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -2
2024-04-23T18:07:48,589  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:48,590  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:48,590  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:48,591  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@48fc0211, with PersistenceManager: null will be shutdown
2024-04-23T18:07:48,591  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@48fc0211, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7d088813 created in the thread with id: 1
2024-04-23T18:07:48,609  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@48fc0211 from thread id: 1
2024-04-23T18:07:48,609  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:48,610  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:48,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:48,628  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:48,628  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:48,629  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@48fc0211, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7d088813 will be shutdown
2024-04-23T18:07:48,629  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@48fc0211, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2d4f67e created in the thread with id: 1
2024-04-23T18:07:48,637  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:48,637  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:48,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:48,641  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:48,642  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:48,644  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:48,651  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:48,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920868, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:48,657  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:48,713  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,772  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:48,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,793  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-23T18:07:48,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,843  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-23T18:07:48,861  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,876  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:48,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,891  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:48,963  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:48,993  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:48,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,042  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,055  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:49,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,074  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:49,089  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[testhivemetastorechecker_table:partdate=2008-01-01/partcity=london], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:49,090  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,099  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:49,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,327  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920868, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), rewriteEnabled:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T18:07:49,336  WARN [main] metastore.HMSHandler: Location: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table specified for non-external table:testhivemetastorechecker_table
2024-04-23T18:07:49,336  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:49,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-23T18:07:49,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,514  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:49,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,532  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:49,537  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
Test completed - partition check
2024-04-23T18:07:49,538  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,549  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:49,549  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,592  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:49,594  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:49,594  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:49,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:49,606  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:49,606  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:49,607  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:49,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:49,612  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:49,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:49,622  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:49,623  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:49,637  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:49,638  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:49,643  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:49,643 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:49,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:49,644  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@48fc0211, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2d4f67e will be shutdown
2024-04-23T18:07:49,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:49,644  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -3
2024-04-23T18:07:49,645  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:49,648  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:49,648  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:49,649  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4efe014f, with PersistenceManager: null will be shutdown
2024-04-23T18:07:49,650  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4efe014f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7c5ac0 created in the thread with id: 1
2024-04-23T18:07:49,680  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4efe014f from thread id: 1
2024-04-23T18:07:49,680  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:49,682  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:49,687  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:49,692  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:49,692  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:49,692  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4efe014f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7c5ac0 will be shutdown
2024-04-23T18:07:49,693  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4efe014f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@47c5cbf2 created in the thread with id: 1
2024-04-23T18:07:49,699  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:49,700  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:49,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:49,705  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:49,705  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:49,724  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:49,730  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:49,732  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920869, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:49,737  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:49,771  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:49,780  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:49,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,004  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,072  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1, testhivemetastorechecker_table:part1=val_2/part2=val_2, testhivemetastorechecker_table:part1=val_3/part2=val_3, testhivemetastorechecker_table:part1=val_4/part2=val_4, testhivemetastorechecker_table:part1=val_5/part2=val_5, testhivemetastorechecker_table:part1=val_6/part2=val_6, testhivemetastorechecker_table:part1=val_7/part2=val_7, testhivemetastorechecker_table:part1=val_8/part2=val_8, testhivemetastorechecker_table:part1=val_9/part2=val_9], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:50,072  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,080  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:50,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:50,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:50,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:50,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:50,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:50,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:50,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:50,127  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:50,128  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:50,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:50,132  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:50,137  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:50,137  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:50,142  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:50,142 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:50,143  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4efe014f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@47c5cbf2 will be shutdown
2024-04-23T18:07:50,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:50,143  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -4
2024-04-23T18:07:50,144  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:50,145  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:50,145  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:50,147  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a917017, with PersistenceManager: null will be shutdown
2024-04-23T18:07:50,147  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a917017, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4153a832 created in the thread with id: 1
2024-04-23T18:07:50,152  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a917017 from thread id: 1
2024-04-23T18:07:50,152  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:50,153  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:50,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:50,161  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:50,161  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:50,162  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a917017, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4153a832 will be shutdown
2024-04-23T18:07:50,162  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a917017, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@40c0437f created in the thread with id: 1
2024-04-23T18:07:50,169  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:50,169  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:50,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:50,172  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,172  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,174  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,176  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:50,177  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920870, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:50,182  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:50,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,205  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,287  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,294  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,294  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,314  WARN [MSCK-GetPaths-0] metastore.HiveMetaStoreChecker: Unexpected partition key part2 found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/part2=val_0
2024-04-23T18:07:50,314  WARN [MSCK-GetPaths-0] metastore.HiveMetaStoreChecker: Unexpected partition key part2 found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/part2=val_1
2024-04-23T18:07:50,319  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:50,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,324  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,325  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,357  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:50,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:50,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:50,359  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:50,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:50,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:50,362  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:50,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:50,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:50,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:50,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:50,368  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:50,371  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:50,371  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:50,375  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:50,375 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:50,376  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3a917017, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@40c0437f will be shutdown
2024-04-23T18:07:50,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:50,376  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -5
2024-04-23T18:07:50,377  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:50,378  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:50,378  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:50,378  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44948ac6, with PersistenceManager: null will be shutdown
2024-04-23T18:07:50,379  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44948ac6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3bc3d70e created in the thread with id: 1
2024-04-23T18:07:50,383  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44948ac6 from thread id: 1
2024-04-23T18:07:50,384  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:50,384  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:50,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:50,391  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:50,391  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:50,391  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44948ac6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3bc3d70e will be shutdown
2024-04-23T18:07:50,391  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44948ac6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3f5ac587 created in the thread with id: 1
2024-04-23T18:07:50,394  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:50,394  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:50,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:50,398  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,398  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,401  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,403  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:50,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920870, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:50,406  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:50,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,428  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,447  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:50,480  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:50,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:50,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:50,484  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:50,485  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:50,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:50,487  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:50,491  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:50,491  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:50,497  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:50,497 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,497  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:50,501  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:50,501  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44948ac6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3f5ac587 will be shutdown
2024-04-23T18:07:50,501  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:50,501  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -6
2024-04-23T18:07:50,502  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:50,503  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:50,503  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:50,503  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49c4118b, with PersistenceManager: null will be shutdown
2024-04-23T18:07:50,503  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49c4118b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@182dcd2b created in the thread with id: 1
2024-04-23T18:07:50,506  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49c4118b from thread id: 1
2024-04-23T18:07:50,506  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:50,507  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:50,513  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:50,518  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:50,518  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:50,518  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49c4118b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@182dcd2b will be shutdown
2024-04-23T18:07:50,519  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49c4118b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@63243c8f created in the thread with id: 1
2024-04-23T18:07:50,522  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:50,522  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:50,523  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:50,525  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,525  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,527  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:50,532  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:50,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920870, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:50,536  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:50,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,572  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,592  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-23T18:07:50,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,627  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-23T18:07:50,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,755  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,768  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,861  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,890  WARN [MSCK-GetPaths-0] metastore.HiveMetaStoreChecker: Unexpected partition key fakedate found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/fakedate=2009-01-01
2024-04-23T18:07:50,901  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=val_0/partcity=val_0, testhivemetastorechecker_table:partdate=val_1/partcity=val_1], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:50,901  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:50,909  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:50,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,115  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:51,117  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:51,117  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:51,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:51,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:51,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:51,126  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:51,126  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:51,132  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:51,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:51,141  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:51,142  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:51,164  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:51,164  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:51,171  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:51,171 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:51,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:51,171  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49c4118b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@63243c8f will be shutdown
2024-04-23T18:07:51,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:51,172  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -7
2024-04-23T18:07:51,173  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:51,174  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:51,174  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:51,174  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5c65fa69, with PersistenceManager: null will be shutdown
2024-04-23T18:07:51,174  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5c65fa69, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6b6f73d created in the thread with id: 1
2024-04-23T18:07:51,206  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5c65fa69 from thread id: 1
2024-04-23T18:07:51,207  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:51,207  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:51,213  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:51,217  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:51,218  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:51,219  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5c65fa69, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6b6f73d will be shutdown
2024-04-23T18:07:51,219  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5c65fa69, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@123e9094 created in the thread with id: 1
2024-04-23T18:07:51,222  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:51,223  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:51,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:51,226  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:51,226  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:51,230  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:51,237  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:51,238  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920871, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:51,241  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:51,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,494  INFO [Finalizer] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:51,495  INFO [Finalizer] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -8
2024-04-23T18:07:51,529  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:51,530  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,550  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-23T18:07:51,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,576  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-23T18:07:51,590  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,641  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:51,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,693  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:51,714 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key fakedate found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/fakedate=2009-01-01
	at java.util.concurrent.FutureTask.report(FutureTask.java:122) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.get(FutureTask.java:192) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testInvalidPartitionKeyName(TestHiveMetaStoreChecker.java:243) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.ExpectException.evaluate(ExpectException.java:19) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key fakedate found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/fakedate=2009-01-01
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-23T18:07:51,716  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,723  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:51,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:51,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:51,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:51,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:51,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:51,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:51,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:51,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:51,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:52,001  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:52,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:52,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:52,009  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:52,035  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:52,035  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:52,043  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:52,043 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:52,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:52,044  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5c65fa69, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@123e9094 will be shutdown
2024-04-23T18:07:52,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:52,044  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -9
2024-04-23T18:07:52,046  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:52,047  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:52,047  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:52,048  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2a9f7572, with PersistenceManager: null will be shutdown
2024-04-23T18:07:52,048  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2a9f7572, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2e60d4f4 created in the thread with id: 1
2024-04-23T18:07:52,087  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2a9f7572 from thread id: 1
2024-04-23T18:07:52,087  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:52,090  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:52,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:52,106  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:52,107  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:52,108  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2a9f7572, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2e60d4f4 will be shutdown
2024-04-23T18:07:52,108  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2a9f7572, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1c76b2fe created in the thread with id: 1
2024-04-23T18:07:52,113  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:52,113  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:52,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:52,121  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:52,121  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:52,127  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:52,133  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:52,136  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920872, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-23T18:07:52,146  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:52,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,208  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:52,208  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,221  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-23T18:07:52,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,263  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-23T18:07:52,277  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,354  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:52,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,401  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:52,439  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:52,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,444  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:52,445  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,620  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:52,620  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:52,627  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:52,632  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:52,632  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:52,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:52,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:52,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:52,645  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:52,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:52,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:52,656  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:52,660  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:52,662  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:52,682  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:52,682  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:52,688  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:52,688 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:52,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:52,689  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2a9f7572, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1c76b2fe will be shutdown
2024-04-23T18:07:52,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:52,689  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -10
2024-04-23T18:07:52,690  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:52,691  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:52,691  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:52,691  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3070f59f, with PersistenceManager: null will be shutdown
2024-04-23T18:07:52,692  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3070f59f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2314f013 created in the thread with id: 1
2024-04-23T18:07:52,724  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3070f59f from thread id: 1
2024-04-23T18:07:52,724  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:52,724  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:52,733  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:52,737  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:52,737  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:52,737  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3070f59f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2314f013 will be shutdown
2024-04-23T18:07:52,738  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3070f59f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@62129f97 created in the thread with id: 1
2024-04-23T18:07:52,741  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:52,741  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:52,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:52,748  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:52,748  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:52,752  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:52,756  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:52,757  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920872, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-23T18:07:52,761  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:52,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,824  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:52,825  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,836  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-23T18:07:52,869  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,874  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-23T18:07:52,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,967  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,975  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:52,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:52,989  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,035  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:53,091  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:53,091  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,103  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:53,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,306  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:53,306  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:53,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:53,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:53,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:53,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:53,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:53,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:53,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:53,339  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:53,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:53,349  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:53,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:53,355  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:53,373  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:53,373  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:53,384  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:53,385 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:53,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:53,385  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3070f59f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@62129f97 will be shutdown
2024-04-23T18:07:53,386  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:53,386  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -11
2024-04-23T18:07:53,387  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:53,388  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:53,389  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:53,390  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2bd67cf9, with PersistenceManager: null will be shutdown
2024-04-23T18:07:53,390  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2bd67cf9, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@581f1f40 created in the thread with id: 1
2024-04-23T18:07:53,423  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2bd67cf9 from thread id: 1
2024-04-23T18:07:53,423  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:53,424  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:53,436  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:53,439  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:53,440  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:53,440  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2bd67cf9, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@581f1f40 will be shutdown
2024-04-23T18:07:53,441  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2bd67cf9, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@fffb4a8 created in the thread with id: 1
2024-04-23T18:07:53,446  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:53,447  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:53,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:53,452  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:53,452  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:53,455  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:53,468  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:53,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920873, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-23T18:07:53,472  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:53,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,545  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:53,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,558  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-23T18:07:53,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,603  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-23T18:07:53,622  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,690  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,700  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:53,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,751  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:53,789  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:53,789  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,795  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:53,796  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:53,963  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:53,963  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:53,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:53,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:53,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:53,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:53,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:53,985  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:53,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:53,987  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:53,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:53,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:53,998  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:53,999  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:54,013  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:54,013  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:54,019  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:54,019 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:54,019  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2bd67cf9, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@fffb4a8 will be shutdown
2024-04-23T18:07:54,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:54,019  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -12
2024-04-23T18:07:54,020  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:54,021  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:54,021  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:54,021  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dc10682, with PersistenceManager: null will be shutdown
2024-04-23T18:07:54,022  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dc10682, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4de14c58 created in the thread with id: 1
2024-04-23T18:07:54,052  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dc10682 from thread id: 1
2024-04-23T18:07:54,052  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:54,053  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:54,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:54,062  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:54,063  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:54,064  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dc10682, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4de14c58 will be shutdown
2024-04-23T18:07:54,064  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dc10682, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@10fa270e created in the thread with id: 1
2024-04-23T18:07:54,068  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:54,069  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:54,070  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:54,074  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,074  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,078  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,084  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:54,085  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920874, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:54,087  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:54,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,156  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:54,387  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,396  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:54,397  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,458  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1, testhivemetastorechecker_table:part1=val_2/part2=val_2, testhivemetastorechecker_table:part1=val_3/part2=val_3, testhivemetastorechecker_table:part1=val_4/part2=val_4, testhivemetastorechecker_table:part1=val_5/part2=val_5, testhivemetastorechecker_table:part1=val_6/part2=val_6, testhivemetastorechecker_table:part1=val_7/part2=val_7, testhivemetastorechecker_table:part1=val_8/part2=val_8, testhivemetastorechecker_table:part1=val_9/part2=val_9], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:54,459  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,468  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:54,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,509  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:54,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:54,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:54,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:54,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:54,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:54,518  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:54,518  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:54,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:54,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:54,521  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:54,522  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:54,536  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:54,536  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:54,541  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:54,541 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,541  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:54,541  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dc10682, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@10fa270e will be shutdown
2024-04-23T18:07:54,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:54,542  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -13
2024-04-23T18:07:54,544  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:54,545  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:54,545  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:54,547  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53b5356, with PersistenceManager: null will be shutdown
2024-04-23T18:07:54,547  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53b5356, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@16c559c7 created in the thread with id: 1
2024-04-23T18:07:54,550  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53b5356 from thread id: 1
2024-04-23T18:07:54,550  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:54,551  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:54,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,557  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:54,558  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:54,559  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:54,560  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53b5356, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@16c559c7 will be shutdown
2024-04-23T18:07:54,560  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53b5356, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5522f9b created in the thread with id: 1
2024-04-23T18:07:54,563  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:54,564  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:54,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:54,566  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,566  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,569  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,570  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:54,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920874, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-23T18:07:54,573  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:54,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,600  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:54,601  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,609  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-23T18:07:54,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,631  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-23T18:07:54,641  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,699  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,703  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:54,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,708  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,737  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:54,774  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:54,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,783  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:54,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:54,935  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:54,935  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:54,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:54,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:54,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:54,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:54,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:54,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:54,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:54,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:54,956  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:54,960  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:54,963  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:54,964  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:54,977  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:54,977  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:54,983  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:54,983 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:54,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:54,983  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53b5356, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5522f9b will be shutdown
2024-04-23T18:07:54,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:54,984  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -14
2024-04-23T18:07:54,984  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:54,985  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:54,985  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:54,986  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@cf0e8b4, with PersistenceManager: null will be shutdown
2024-04-23T18:07:54,986  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@cf0e8b4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1e7245da created in the thread with id: 1
2024-04-23T18:07:54,999  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@cf0e8b4 from thread id: 1
2024-04-23T18:07:54,999  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:55,000  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:55,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:55,006  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:55,006  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:55,007  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@cf0e8b4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1e7245da will be shutdown
2024-04-23T18:07:55,007  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@cf0e8b4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6e245068 created in the thread with id: 1
2024-04-23T18:07:55,011  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:55,012  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:55,012  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:55,016  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,017  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,019  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,022  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:55,023  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920875, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:55,027  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:55,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,088  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:55,293  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,300  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:55,300  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,340 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at java.util.concurrent.FutureTask.report(FutureTask.java:122) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.get(FutureTask.java:192) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testErrorForMissingPartitionColumn(TestHiveMetaStoreChecker.java:560) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-23T18:07:55,352  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,359  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:55,359  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,400 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at java.util.concurrent.FutureTask.report(FutureTask.java:122) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.get(FutureTask.java:192) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testErrorForMissingPartitionColumn(TestHiveMetaStoreChecker.java:568) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-23T18:07:55,401  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,406  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:55,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,443  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:55,445  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:55,445  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:55,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:55,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:55,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:55,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:55,450  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:55,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:55,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:55,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:55,453  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:55,456  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:55,456  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:55,462  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:55,462 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:55,463  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@cf0e8b4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6e245068 will be shutdown
2024-04-23T18:07:55,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:55,463  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -15
2024-04-23T18:07:55,464  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:55,464  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:55,465  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:55,465  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b8d0c21, with PersistenceManager: null will be shutdown
2024-04-23T18:07:55,465  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b8d0c21, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4664fef created in the thread with id: 1
2024-04-23T18:07:55,468  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b8d0c21 from thread id: 1
2024-04-23T18:07:55,468  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:55,469  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:55,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:55,476  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:55,477  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:55,477  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b8d0c21, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4664fef will be shutdown
2024-04-23T18:07:55,478  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b8d0c21, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6311640d created in the thread with id: 1
2024-04-23T18:07:55,481  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:55,482  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:55,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:55,484  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,484  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,487  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,488  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:55,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920875, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:), FieldSchema(name:part3, type:string, comment:), FieldSchema(name:part4, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:55,492  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:55,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,514  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:55,765  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,770  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:55,770  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,866  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:part1=val_0/part2=val_0/part3=val_0/part4=val_0, testhivemetastorechecker_table:part1=val_1/part2=val_1/part3=val_1/part4=val_1, testhivemetastorechecker_table:part1=val_2/part2=val_2/part3=val_2/part4=val_2, testhivemetastorechecker_table:part1=val_3/part2=val_3/part3=val_3/part4=val_3, testhivemetastorechecker_table:part1=val_4/part2=val_4/part3=val_4/part4=val_4, testhivemetastorechecker_table:part1=val_5/part2=val_5/part3=val_5/part4=val_5, testhivemetastorechecker_table:part1=val_6/part2=val_6/part3=val_6/part4=val_6, testhivemetastorechecker_table:part1=val_7/part2=val_7/part3=val_7/part4=val_7, testhivemetastorechecker_table:part1=val_8/part2=val_8/part3=val_8/part4=val_8, testhivemetastorechecker_table:part1=val_9/part2=val_9/part3=val_9/part4=val_9], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:55,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,873  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:55,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,907  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:55,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:55,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:55,912  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:55,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:55,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:55,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:55,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:55,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:55,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:55,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:55,918  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:55,922  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:55,922  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:55,928  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:55,928 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,929  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:55,929  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b8d0c21, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6311640d will be shutdown
2024-04-23T18:07:55,929  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:55,930  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -16
2024-04-23T18:07:55,930  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:55,931  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:55,932  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:55,932  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@37a5ac85, with PersistenceManager: null will be shutdown
2024-04-23T18:07:55,932  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@37a5ac85, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2092b072 created in the thread with id: 1
2024-04-23T18:07:55,935  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@37a5ac85 from thread id: 1
2024-04-23T18:07:55,935  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:55,936  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:55,940  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:55,945  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:55,946  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:55,946  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@37a5ac85, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2092b072 will be shutdown
2024-04-23T18:07:55,946  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@37a5ac85, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@b0c4670 created in the thread with id: 1
2024-04-23T18:07:55,949  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:55,950  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:55,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:55,952  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,952  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,954  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:55,957  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:55,961  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920875, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:55,965  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:55,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:55,988  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,186  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,187  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,224 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key part2 found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/part2=val_9
	at java.util.concurrent.FutureTask.report(FutureTask.java:122) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.get(FutureTask.java:192) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testInvalidOrderForPartitionKeysOnFS(TestHiveMetaStoreChecker.java:586) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.ExpectException.evaluate(ExpectException.java:19) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key part2 found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/part2=val_9
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-23T18:07:56,226  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,231  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:56,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:56,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:56,258  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:56,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:56,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,260  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:56,264  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:56,264  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:56,268  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:56,268 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:56,268  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@37a5ac85, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@b0c4670 will be shutdown
2024-04-23T18:07:56,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:56,268  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -17
2024-04-23T18:07:56,269  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:56,270  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:56,270  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:56,270  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29b21fa6, with PersistenceManager: null will be shutdown
2024-04-23T18:07:56,270  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29b21fa6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@19a48bde created in the thread with id: 1
2024-04-23T18:07:56,272  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29b21fa6 from thread id: 1
2024-04-23T18:07:56,273  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:56,274  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:56,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:56,284  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:56,284  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:56,284  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29b21fa6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@19a48bde will be shutdown
2024-04-23T18:07:56,285  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29b21fa6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@19710bd9 created in the thread with id: 1
2024-04-23T18:07:56,287  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:56,287  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:56,288  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:56,290  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,291  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,294  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,295  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:56,296  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920876, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER, writeId:-1)	
2024-04-23T18:07:56,298  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:56,307  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,312  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,336  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,341  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,358  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:56,359  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,363  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,388  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:56,388  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:56,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:56,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:56,399  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,399  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:56,401  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:56,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:56,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,404  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:56,409  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:56,410  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:56,414  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:56,414 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,414  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:56,414  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29b21fa6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@19710bd9 will be shutdown
2024-04-23T18:07:56,414  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:56,414  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -18
2024-04-23T18:07:56,415  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:56,416  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:56,416  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:56,416  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46672a62, with PersistenceManager: null will be shutdown
2024-04-23T18:07:56,416  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46672a62, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@46e03c31 created in the thread with id: 1
2024-04-23T18:07:56,418  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46672a62 from thread id: 1
2024-04-23T18:07:56,418  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:56,418  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:56,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,424  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:56,426  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:56,426  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:56,427  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46672a62, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@46e03c31 will be shutdown
2024-04-23T18:07:56,427  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46672a62, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@64e41da0 created in the thread with id: 1
2024-04-23T18:07:56,429  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:56,429  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:56,429  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:56,430  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,430  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,432  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,434  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:56,434  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920876, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:part1, type:string, comment:), FieldSchema(name:part2, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:56,437  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:56,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,453  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,649  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,649  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,683 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at com.google.common.util.concurrent.AbstractFuture.getDoneValue(AbstractFuture.java:476) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractFuture.get(AbstractFuture.java:435) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractFuture$TrustedFuture.get(AbstractFuture.java:79) ~[guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testErrorForMissingPartitionsSingleThreaded(TestHiveMetaStoreChecker.java:630) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.MoreExecutors$DirectExecutorService.execute(MoreExecutors.java:310) ~[guava-19.0.jar:?]
	at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:134) ~[?:1.8.0_402]
	at com.google.common.util.concurrent.AbstractListeningExecutorService.submit(AbstractListeningExecutorService.java:61) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractListeningExecutorService.submit(AbstractListeningExecutorService.java:38) ~[guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:668) ~[classes/:?]
	... 54 more
2024-04-23T18:07:56,692  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,699  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,699  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,734 ERROR [main] metastore.HiveMetaStoreChecker: Exception received while listing partition directories
java.util.concurrent.ExecutionException: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at com.google.common.util.concurrent.AbstractFuture.getDoneValue(AbstractFuture.java:476) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractFuture.get(AbstractFuture.java:435) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractFuture$TrustedFuture.get(AbstractFuture.java:79) ~[guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:671) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:560) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.findUnknownPartitions(HiveMetaStoreChecker.java:398) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:359) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkTable(HiveMetaStoreChecker.java:278) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:157) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testErrorForMissingPartitionsSingleThreaded(TestHiveMetaStoreChecker.java:638) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.MetastoreException: Unexpected partition key dummyPart found at pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/dummyPart=error
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.logOrThrowExceptionWithMsg(HiveMetaStoreChecker.java:632) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.processPathDepthInfo(HiveMetaStoreChecker.java:618) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:583) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker$PathDepthInfoCallable.call(HiveMetaStoreChecker.java:565) ~[classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.MoreExecutors$DirectExecutorService.execute(MoreExecutors.java:310) ~[guava-19.0.jar:?]
	at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:134) ~[?:1.8.0_402]
	at com.google.common.util.concurrent.AbstractListeningExecutorService.submit(AbstractListeningExecutorService.java:61) ~[guava-19.0.jar:?]
	at com.google.common.util.concurrent.AbstractListeningExecutorService.submit(AbstractListeningExecutorService.java:38) ~[guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkPartitionDirs(HiveMetaStoreChecker.java:668) ~[classes/:?]
	... 54 more
2024-04-23T18:07:56,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,742  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:56,769  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,769  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,770  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,771  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:56,772  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,772  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:56,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:56,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:56,776  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:56,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:56,778  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:56,788  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:56,788  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:56,793  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:56,793 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:56,794  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46672a62, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@64e41da0 will be shutdown
2024-04-23T18:07:56,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:56,794  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -19
2024-04-23T18:07:56,795  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:56,795  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:56,796  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:56,796  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6a4859fc, with PersistenceManager: null will be shutdown
2024-04-23T18:07:56,796  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6a4859fc, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6d49bd08 created in the thread with id: 1
2024-04-23T18:07:56,798  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6a4859fc from thread id: 1
2024-04-23T18:07:56,798  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:56,799  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:56,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:56,804  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:56,804  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:56,805  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6a4859fc, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6d49bd08 will be shutdown
2024-04-23T18:07:56,805  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6a4859fc, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2cfde5a4 created in the thread with id: 1
2024-04-23T18:07:56,810  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:56,810  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:56,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:56,812  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,812  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,815  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:56,816  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:56,817  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920876, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[FieldSchema(name:partdate, type:string, comment:), FieldSchema(name:partcity, type:string, comment:)], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:56,818  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:56,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,834  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,846  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-01/partcity=london
2024-04-23T18:07:56,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,878  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table/partdate=2008-01-02/partcity=stockholm
2024-04-23T18:07:56,892  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_with_auth : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,931  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,938  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_by_names : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:56,972  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:56,999  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[testhivemetastorechecker_table:partdate=2017-01-01/partcity=paloalto], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:57,000  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,005  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,151  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:57,153  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:57,153  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:57,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:57,163  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:57,163  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:57,164  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:57,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:57,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:57,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:57,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:57,176  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:57,200  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:57,200  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:57,205  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:57,205 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:57,205  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:57,205  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6a4859fc, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2cfde5a4 will be shutdown
2024-04-23T18:07:57,205  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:57,205  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -20
2024-04-23T18:07:57,208  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:57,209  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T18:07:57,209  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:57,210  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1f5b3ef2, with PersistenceManager: null will be shutdown
2024-04-23T18:07:57,211  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1f5b3ef2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@77bff3d7 created in the thread with id: 1
2024-04-23T18:07:57,237  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1f5b3ef2 from thread id: 1
2024-04-23T18:07:57,237  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:57,239  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T18:07:57,247  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,249  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:57,250  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-23T18:07:57,260 ERROR [main] metastore.RetryingHMSHandler: UnknownDBException(message:Could not find database hive.testhivemetastorechecker_db: database hive.testhivemetastorechecker_db)
	at org.apache.hadoop.hive.metastore.ObjectStore.getTableObjectsByName(ObjectStore.java:2171)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy41.getTableObjectsByName(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.getTableObjectsInternal(HMSHandler.java:3825)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_table_objects_by_name_req(HMSHandler.java:3758)
	at sun.reflect.GeneratedMethodAccessor43.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy44.get_table_objects_by_name_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getTables(HiveMetaStoreClient.java:2724)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreChecker.checkMetastore(HiveMetaStoreChecker.java:143)
	at org.apache.hadoop.hive.ql.metadata.TestHiveMetaStoreChecker.testTableCheck(TestHiveMetaStoreChecker.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T18:07:57,261  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:57,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,263  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[testhivemetastorechecker_table], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:57,264  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:testhivemetastorechecker_db, description:null, locationUri:null, parameters:null, catalogName:hive)	
2024-04-23T18:07:57,267  INFO [main] metastore.HMSHandler: Creating database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:57,268  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:57,271  INFO [main] metastore.HMSHandler: Created database path in external directory pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:57,274  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9f819be0-3388-4232-869d-e186459290d3, clientType=HIVECLI]
2024-04-23T18:07:57,276  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T18:07:57,276  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T18:07:57,277  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1f5b3ef2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@77bff3d7 will be shutdown
2024-04-23T18:07:57,277  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1f5b3ef2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@40a38a44 created in the thread with id: 1
2024-04-23T18:07:57,280  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T18:07:57,281  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T18:07:57,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920877, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:57,286  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:57,313  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-23T18:07:57,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,362  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,371  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,375  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:57,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,383  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,386  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:57,386  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,394  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,394  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[testhivemetastorechecker_table], expiredPartitions=[]
2024-04-23T18:07:57,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-23T18:07:57,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,417  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,431  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,437  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[faketable], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:57,437  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,444  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,445  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:testhivemetastorechecker_table, dbName:testhivemetastorechecker_db, owner:alex, createTime:1713920877, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), catName:hive, ownerType:USER)	
2024-04-23T18:07:57,492  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db/testhivemetastorechecker_table
2024-04-23T18:07:57,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=null	
2024-04-23T18:07:57,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,521  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,534  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,534  INFO [main] metastore.HiveMetaStoreChecker: Number of partitionsNotInMs=[], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
2024-04-23T18:07:57,534  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,543  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T18:07:57,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.testhivemetastorechecker_db.testhivemetastorechecker_table	
2024-04-23T18:07:57,578  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: testhivemetastorechecker_db	
2024-04-23T18:07:57,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:57,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:57,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:57,584  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=testhivemetastorechecker_db tbls=	
2024-04-23T18:07:57,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#testhivemetastorechecker_db	
2024-04-23T18:07:57,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#testhivemetastorechecker_db	
2024-04-23T18:07:57,586  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#testhivemetastorechecker_db pat=*	
2024-04-23T18:07:57,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
2024-04-23T18:07:57,588  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
2024-04-23T18:07:57,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=testhivemetastorechecker_db pat=.*,type=MATERIALIZED_VIEW	
2024-04-23T18:07:57,591  INFO [main] metastore.ObjectStore: Dropping database hive.testhivemetastorechecker_db along with all tables
2024-04-23T18:07:57,611  INFO [main] txn.TxnHandler: Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
2024-04-23T18:07:57,612  WARN [main] txn.TxnHandler: Cannot perform cleanup since metastore table does not exist
2024-04-23T18:07:57,618  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db does not exist; Force to delete it.
2024-04-23T18:07:57,618 ERROR [main] utils.FileUtils: Failed to delete pfile:/home/alex/Repositories/hive/ql/target/warehouse/testhivemetastorechecker_db.db
2024-04-23T18:07:57,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T18:07:57,618  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1f5b3ef2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@40a38a44 will be shutdown
2024-04-23T18:07:57,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T18:07:57,619  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -21
